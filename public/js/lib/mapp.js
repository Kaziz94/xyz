var ru=Object.defineProperty;var Gn=(e,a)=>{for(var t in a)ru(e,t,{get:a[t],enumerable:!0})};var mn={};Gn(mn,{Chroma:()=>_i,acolorpicker:()=>ki,cloneDeep:()=>go,copyToClipboard:()=>ni,dataURLtoBlob:()=>ii,flatpickr:()=>vi,formatDate:()=>Jr,formatDateTime:()=>wi,getCircularReplacer:()=>ui,html:()=>st,idle:()=>oi,isoline_here_decode:()=>yi,meltDateStr:()=>bi,merge:()=>wo,nanoid:()=>_o,paramString:()=>ai,render:()=>ei,svg:()=>Fe,svg_symbols:()=>ti,toggleExpanderParent:()=>ri,turf:()=>Mv});var Ar=e=>({get:a=>e.get(a),set:(a,t)=>(e.set(a,t),t)}),qn=/([^\s\\>"'=]+)\s*=\s*(['"]?)$/,nu=/^(?:area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)$/i,iu=/<[a-z][^>]+$/i,ou=/>[^<>]*$/,lu=/<([a-z]+[a-z0-9:._-]*)([^>]*?)(\/>)/ig,su=/\s+$/,Vn=(e,a)=>0<a--&&(iu.test(e[a])||!ou.test(e[a])&&Vn(e,a)),cu=(e,a,t)=>nu.test(a)?e:`<${a}${t.replace(su,"")}></${a}>`,uu=(e,a,t)=>{let r=[],{length:i}=e;for(let s=1;s<i;s++){let o=e[s-1];r.push(qn.test(o)&&Vn(e,s)?o.replace(qn,(c,f,p)=>`${a}${s-1}=${p||'"'}${f}${p?"":'"'}`):`${o}<!--${a}${s-1}-->`)}r.push(e[i-1]);let n=r.join("").trim();return t?n:n.replace(lu,cu)},{isArray:Pr}=Array,{indexOf:du,slice:Un}=[],pu=1,Yn=111,fu=({firstChild:e,lastChild:a})=>{let t=document.createRange();return t.setStartAfter(e),t.setEndAfter(a),t.deleteContents(),e},gu=(e,a)=>e.nodeType===Yn?1/a<0?a?fu(e):e.lastChild:a?e.valueOf():e.firstChild:e,hu=e=>{let{childNodes:a}=e,{length:t}=a;if(t<2)return t?a[0]:e;let r=Un.call(a,0),i=r[0],n=r[t-1];return{ELEMENT_NODE:pu,nodeType:Yn,firstChild:i,lastChild:n,valueOf(){if(a.length!==t){let s=0;for(;s<t;)e.appendChild(r[s++])}return e}}},mu=(e,a,t,r,i)=>{let n=t.length,s=a.length,o=n,c=0,f=0,p=null;for(;c<s||f<o;)if(s===c){let u=o<n?f?r(t[f-1],-0).nextSibling:r(t[o-f],0):i;for(;f<o;)e.insertBefore(r(t[f++],1),u)}else if(o===f)for(;c<s;)(!p||!p.has(a[c]))&&e.removeChild(r(a[c],-1)),c++;else if(a[c]===t[f])c++,f++;else if(a[s-1]===t[o-1])s--,o--;else if(a[c]===t[o-1]&&t[f]===a[s-1]){let u=r(a[--s],-1).nextSibling;e.insertBefore(r(t[f++],1),r(a[c++],-1).nextSibling),e.insertBefore(r(t[--o],1),u),a[s]=t[o]}else{if(!p){p=new Map;let u=f;for(;u<o;)p.set(t[u],u++)}if(p.has(a[c])){let u=p.get(a[c]);if(f<u&&u<o){let h=c,w=1;for(;++h<s&&h<o&&p.get(a[h])===u+w;)w++;if(w>u-f){let D=r(a[c],0);for(;f<u;)e.insertBefore(r(t[f++],1),D)}else e.replaceChild(r(t[f++],1),r(a[c++],-1))}else c++}else e.removeChild(r(a[c++],-1))}return t},vu=e=>a=>{for(let t in a){let r=t==="role"?t:`aria-${t}`,i=a[t];i==null?e.removeAttribute(r):e.setAttribute(r,i)}},bu=(e,a)=>{let t,r=!0,i=document.createAttributeNS(null,a);return n=>{t!==n&&(t=n,t==null?r||(e.removeAttributeNode(i),r=!0):(i.value=n,r&&(e.setAttributeNodeNS(i),r=!1)))}},wu=(e,a,t)=>r=>{t!==!!r&&((t=!!r)?e.setAttribute(a,""):e.removeAttribute(a))},_u=({dataset:e})=>a=>{for(let t in a){let r=a[t];r==null?delete e[t]:e[t]=r}},yu=(e,a)=>{let t,r=a.slice(2);return!(a in e)&&a.toLowerCase()in e&&(r=r.toLowerCase()),i=>{let n=Pr(i)?i:[i,!1];t!==n[0]&&(t&&e.removeEventListener(r,t,n[1]),(t=n[0])&&e.addEventListener(r,t,n[1]))}},ku=e=>a=>{typeof a=="function"?a(e):a.current=e},Cu=(e,a)=>a==="dataset"?_u(e):t=>{e[a]=t},Su=e=>{let a;return t=>{a!=t&&(a=t,e.textContent=t??"")}};var Wn=function(e){var a="fragment",t="template",r="content"in s(t),i=r?function(c){var f=s(t);return f.innerHTML=c,f.content}:function(c){var f=s(a),p=s(t),u=null;if(/^[^\S]*?<(col(?:group)?|t(?:head|body|foot|r|d|h))/i.test(c)){var h=RegExp.$1;p.innerHTML="<table>"+c+"</table>",u=p.querySelectorAll(h)}else p.innerHTML=c,u=p.childNodes;return n(f,u),f};return function(f,p){return(p==="svg"?o:i)(f)};function n(c,f){for(var p=f.length;p--;)c.appendChild(f[0])}function s(c){return c===a?e.createDocumentFragment():e.createElementNS("http://www.w3.org/1999/xhtml",c)}function o(c){var f=s(a),p=s("div");return p.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+c+"</svg>",n(f,p.firstChild.childNodes),f}}(document),Eu=({childNodes:e},a)=>e[a],Ir=e=>{let a=[],{parentNode:t}=e;for(;t;)a.push(du.call(t.childNodes,e)),e=t,t=e.parentNode;return a},{createTreeWalker:Jn,importNode:xr}=document,Zn=xr.length!=1,Tu=Zn?(e,a,t)=>xr.call(document,Wn(e,a,t),!0):Wn,ju=Zn?e=>Jn.call(document,e,1|128,null,!1):e=>Jn.call(document,e,1|128),ha=(e,a,t)=>mu(e.parentNode,a,t,gu,e),Lu=e=>{let a,t,r=[],i=n=>{switch(typeof n){case"string":case"number":case"boolean":a!==n&&(a=n,t||(t=document.createTextNode("")),t.nodeValue=n,r=ha(e,r,[t]));break;case"object":case"undefined":if(n==null){a!=n&&(a=n,r=ha(e,r,[]));break}if(Pr(n)){a=n,n.length===0?r=ha(e,r,[]):typeof n[0]=="object"?r=ha(e,r,n):i(String(n));break}"ELEMENT_NODE"in n&&a!==n&&(a=n,r=ha(e,r,n.nodeType===11?Un.call(n.childNodes):[n]));break;case"function":i(n(e));break}};return i},Mu=(e,a)=>{switch(a[0]){case"?":return wu(e,a.slice(1),!1);case".":return Cu(e,a.slice(1));case"o":if(a[1]==="n")return yu(e,a)}switch(a){case"ref":return ku(e);case"aria":return vu(e)}return bu(e,a)};function $u(e){let{type:a,path:t}=e,r=t.reduceRight(Eu,this);return a==="node"?Lu(r):a==="attr"?Mu(r,e.name):Su(r)}var ma="isÂµ",Xn=Ar(new WeakMap),Fu=/^(?:plaintext|script|style|textarea|title|xmp)$/i,va=()=>({stack:[],entry:null,wire:null}),Ou=(e,a)=>{let{content:t,updates:r}=Du(e,a);return{type:e,template:a,content:t,updates:r,wire:null}},Au=(e,a)=>{let t=uu(a,ma,e==="svg"),r=Tu(t,e),i=ju(r),n=[],s=a.length-1,o=0,c=`${ma}${o}`;for(;o<s;){let f=i.nextNode();if(!f)throw`bad template: ${t}`;if(f.nodeType===8)f.nodeValue===c&&(n.push({type:"node",path:Ir(f)}),c=`${ma}${++o}`);else{for(;f.hasAttribute(c);)n.push({type:"attr",path:Ir(f),name:f.getAttribute(c)}),f.removeAttribute(c),c=`${ma}${++o}`;Fu.test(f.tagName)&&f.textContent.trim()===`<!--${c}-->`&&(f.textContent="",n.push({type:"text",path:Ir(f)}),c=`${ma}${++o}`)}}return{content:r,nodes:n}},Du=(e,a)=>{let{content:t,nodes:r}=Xn.get(a)||Xn.set(a,Au(e,a)),i=xr.call(document,t,!0),n=r.map($u,i);return{content:i,updates:n}},Pa=(e,{type:a,template:t,values:r})=>{let{length:i}=r;Kn(e,r,i);let{entry:n}=e;(!n||n.template!==t||n.type!==a)&&(e.entry=n=Ou(a,t));let{content:s,updates:o,wire:c}=n;for(let f=0;f<i;f++)o[f](r[f]);return c||(n.wire=hu(s))},Kn=({stack:e},a,t)=>{for(let r=0;r<t;r++){let i=a[r];i instanceof Rr?a[r]=Pa(e[r]||(e[r]=va()),i):Pr(i)?Kn(e[r]||(e[r]=va()),i,i.length):e[r]=null}t<e.length&&e.splice(t)};function Rr(e,a,t){this.type=e,this.template=a,this.values=t}var{create:Pu,defineProperties:Iu}=Object,Qn=e=>{let a=Ar(new WeakMap),t=r=>(i,...n)=>Pa(r,{type:e,template:i,values:n});return Iu((r,...i)=>new Rr(e,r,i),{for:{value(r,i){let n=a.get(r)||a.set(r,Pu(null));return n[i]||(n[i]=t(va()))}},node:{value:(r,...i)=>Pa(va(),{type:e,template:r,values:i}).valueOf()}})},zn=Ar(new WeakMap),ei=(e,a)=>{let t=typeof a=="function"?a():a,r=zn.get(e)||zn.set(e,va()),i=t instanceof Rr?Pa(r,t):t;return i!==r.wire&&(r.wire=i,e.textContent="",e.appendChild(i.valueOf())),e},st=Qn("html"),Fe=Qn("svg");var ti=e=>{if(e.svg&&!e.legend)return e.svg;let a={dot:Hr(e),target:xu(e),triangle:Ru(e),square:Hu(e),semiCircle:Bu(e),markerLetter:Gu(e),markerColor:qu(e),geo:Vu(),circle:Uu(e),diamond:Nu(e)};function t(r){let i=`height: ${r.cluster?40:24}px; width: ${r.cluster?40:24}px; position: relative;`,n=st.node`<div style="${i}">`;function s(o){let c=`position:absolute; height:${o.cluster?40:20}px; width:${o.cluster?40:20}px;`;return o.svg?n.appendChild(st.node`<img style="${c}" src="${o.svg}"/>`):o.type?n.appendChild(st.node`<img style="${c}" src="${a[o.type]}"/>`):n.appendChild(st.node`<img style="${c}" src="${Hr({color:"#666"})}"/>`)}return r.layers&&Array.isArray(r.layers)?r.layers.map(o=>s(o)):s(r),n}return e.legend?t(e):e.type?a[e.type]:Hr({color:"#666"})},ct=new XMLSerializer;function Hr(e){let a=Fe.node`
    <svg width=24 height=24 viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'>
      <circle cx=13 cy=13 r=10 fill='#333'></circle>
      <circle cx=12 cy=12 r=10 fill=${e.fillColor||"#fff"}></circle>`;return`data:image/svg+xml,${encodeURIComponent(ct.serializeToString(a))}`}function xu(e){let a=Fe.node`
  <svg width=24 height=24 viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'>
    <circle cx=13 cy=13 fill='#333' r=10 opacity=0.4></circle>
    <circle cx=12 cy=12 r=10 fill=${e.fillColor||"#FFF"}>`;return e.layers&&Object.entries(e.layers).forEach(t=>{a.appendChild(Fe.node`<circle cx=12 cy=12 r=${parseFloat(t[0])*10} fill=${t[1]}>`)}),`data:image/svg+xml,${encodeURIComponent(ct.serializeToString(a))}`}function Ru(e){let a=Fe.node`
  <svg width=24 height=24 viewBox='${"0 0 24 24"}' xmlns='http://www.w3.org/2000/svg'>
  <polygon points="12,4.68 2,22 22,22" 
  fill="#333" stroke="#333" opacity=0.4 stroke-opacity=0.4 stroke-width=3
  stroke-linejoin="round"/>`;return a.appendChild(Fe.node`<polygon
    fill=${e.fillColor||"#FFF"} stroke=${e.fillColor||"#FFF"} stroke-width=2
    points="12,4.68 2,22 22,22"  stroke-linejoin="round"/>`),e.layers&&Object.entries(e.layers).forEach(t=>{function r(s,o){return 12+(s-12)*o}function i(s,o){return 16+(s-16)*o}let n=`${r(12,t[0])},${i(4.68,t[0])} ${r(2,t[0])}, ${i(22,t[0])} ${r(22,t[0])}, ${i(22,t[0])}`;a.appendChild(Fe.node`<polygon
    fill=${t[1]} stroke=${t[1]||"#FFF"} stroke-width=1
    points="${n}" stroke-linejoin="round"/>`)}),`data:image/svg+xml,${encodeURIComponent(ct.serializeToString(a))}`}function Hu(e){let a=Fe.node`
  <svg width=24 height=24 viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'>
    <rect fill='#333' opacity=0.3 width=20 height=20 x=2 y=2 rx=1></rect>
    <rect fill=${e.fillColor||"#FFF"} width=20 height=20 x=0 y=0 rx=1></rect>`;return e.layers&&Object.entries(e.layers).forEach(t=>{a.appendChild(Fe.node`<rect fill=${t[1]}
      width=${parseFloat(t[0])*20}
      height=${parseFloat(t[0])*20}
      x=${10*(1-parseFloat(t[0]))}
      y=${10*(1-parseFloat(t[0]))} rx=${parseFloat(t[0])}></rect>`)}),`data:image/svg+xml,${encodeURIComponent(ct.serializeToString(a))}`}function Nu(e){let a=Fe.node`
  <svg width=24 height=24 viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'>
  <polygon fill='#333' opacity=0.3
    points="12 0, 24 12, 12 24, 0 12"
    ></polygon>
    <polygon fill=${e.fillColor||"#FFF"}
    points="12 0, 24 12, 12 24, 0 12"
    ></polygon>`;function t(r,i){return 12+(r-12)*i}return e.layers&&Object.entries(e.layers).forEach(r=>{let i=`${t(12,r[0])} ${t(0,r[0])},${t(24,r[0])} ${t(12,r[0])},${t(12,r[0])} ${t(24,r[0])}, ${t(0,r[0])} ${t(12,r[0])}`;a.appendChild(Fe.node`
      <polygon fill=${r[1]||"#FFF"}
      points="${i}"
      ></polygon>`)}),`data:image/svg+xml,${encodeURIComponent(ct.serializeToString(a))}`}function Bu(e){let a=Fe.node`
  <svg width=30 height=30 viewBox='0 0 20 24' xmlns='http://www.w3.org/2000/svg'>
    <defs>
      <clipPath id="cut-off-shade">
        <rect x="0" y="0" width="24" height="11"/>
      </clipPath>
      <clipPath id="cut-off">
        <rect x="0" y="0" width="24" height="10"/>
      </clipPath>
    </defs>
    <circle cx="11" cy="10" r="10" clip-path="url(#cut-off-shade)" fill="#333" opacity=0.4></circle>
    <circle cx=10 cy=10 r=10 fill=${e.fillColor||"#FFF"} clip-path="url(#cut-off-shade)">`;return e.layers&&Object.entries(e.layers).forEach(t=>{a.appendChild(Fe.node`
    <circle cx=10 cy=10 r=${parseFloat(t[0])*10} fill=${t[1]} clip-path="url(#cut-off-shade)">`)}),`data:image/svg+xml,${encodeURIComponent(ct.serializeToString(a))}`}function Gu(e){let a=Fe.node`
  <svg width=24 height=24 viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'>
    <path style="opacity: 0.5;" fill=${e.colorMarker}
      d=" M 12.692 1.969 C 8.605 1.969 5.334 5.239 5.334 9.328 C 5.334 10.963 5.743 12.189 6.764 14.028 C 8.808 17.504 11.922 21.996 11.922 21.996 C 11.922 21.996 16.576 17.504 18.62 14.028 C 19.642 12.189 20.051 10.963 20.051 9.328 C 20.051 5.239 16.78 1.969 12.692 1.969 Z "/>
    <path fill=${e.color}
      d=" M 12 1.969 C 7.878 1.969 4.813 5.239 4.813 9.328 C 4.813 10.554 5.222 12.189 6.244 14.028 C 8.289 17.504 12 22 12 22 C 12 22 16.055 17.504 18.099 14.028 C 19.122 12.189 19.341 10.963 19.341 9.328 C 19.341 5.239 16.054 1.969 12 1.969 Z "/>
    <circle cx="12.17192400568182" cy="8.918683238636365" r="5.109789772727275" opacity=0.8 fill="rgb(255, 255, 255)"/>
    <text x=12 y=12 style="text-anchor: middle; font-weight: 600; font-size: 10px; font-family: sans-serif; fill: rgb(85, 85, 85);">
    ${e.letter}`;return`data:image/svg+xml,${encodeURIComponent(ct.serializeToString(a))}`}function qu(e){let a=Fe.node`
  <svg width=18 height=24 viewBox='0 0 24 18' xmlns='http://www.w3.org/2000/svg'>
    <path style="opacity: 0.5;" fill=${e.colorMarker}
      d="M 10.797 1.238 C 6.308 1.238 2.716 4.83 2.716 9.32 C 2.716 11.116 3.165 12.463 4.287 14.483 C 6.532 18.3 9.952 23.234 9.952 23.234 C 9.952 23.234 15.063 18.3 17.308 14.483 C 18.43 12.463 18.879 11.116 18.879 9.32 C 18.879 4.83 15.287 1.238 10.797 1.238 Z"/>
    <path fill=${e.colorMarker}
      d="M 10 1.238 C 5.51 1.238 2.144 4.83 2.144 9.32 C 2.144 10.667 2.593 12.463 3.716 14.483 C 5.961 18.3 10 23.238 10 23.238 C 10 23.238 14.491 18.3 16.736 14.483 C 17.859 12.463 18.1 11.116 18.1 9.32 C 18.1 4.83 14.49 1.238 10 1.238 Z"/>
    <circle cx=10.226 cy=8.871 r=5.612 opacity=0.8 fill="rgb(255, 255, 255)"/>
    <circle cx=10.226 cy=8.871 r=2.806 opacity=0.8 fill=${e.colorDot}/>`;return`data:image/svg+xml,${encodeURIComponent(ct.serializeToString(a))}`}function Vu(){let e=Fe.node`
  <svg width=1000 height=1000 viewBox='0 0 1000 1000' xmlns='http://www.w3.org/2000/svg'>
    <circle cx=500 cy=500 r=350 stroke='#1F964D' opacity=0.8 stroke-width=75 fill=none></circle>
    <circle cx=500 cy=500 r=200 fill='#1F964D' opacity=0.8></circle>
    <path stroke='#1F964D' opacity=0.8 stroke-width=75 d="M500,150L500,0M500,850L500,1000M0,500L150,500M850,500L1000,500" />`;return`data:image/svg+xml,${encodeURIComponent(ct.serializeToString(e))}`}function Uu(e){let a=Fe.node`
  <svg width=24 height=24 viewBox='0 0 30 30' xmlns='http://www.w3.org/2000/svg'>
    <circle cx=16 cy=16 r=10
      stroke="#333"
      stroke-width="${e.strokeWidth||1}"
      fill="none"></circle>
    <circle cx=15 cy=15 r=10
      stroke="${e.strokeColor||"#333"}"
      stroke-width="${e.strokeWidth||1}"
      fill="${e.fillColor||"none"}"></circle>`;return`data:image/svg+xml,${encodeURIComponent(ct.serializeToString(a))}`}var ai=e=>Object.entries(e).filter(a=>a[1]===0||!!a[1]).filter(a=>a[1]!=="{}").filter(a=>typeof a[1]!="object"||a[1].length||Object.values(a[1]).some(t=>typeof t=="object"&&Object.keys(t).length)).map(a=>(typeof a[1]=="object"&&!a[1].length&&(a[1]=JSON.stringify(a[1])),encodeURI(`${a[0]}=${a[1]}`))).join("&");function ri(e,a){let t=e.closest(".expandable");if(!!t){if(t.classList.contains("expanded"))return t.classList.remove("expanded");a&&[...t.parentElement.children].forEach(r=>{r.classList.remove("expanded")}),t.classList.add("expanded")}}function ni(e){let a=_xyz.utils.html.node`<textarea style="visibility=none;">`;a.value=e,document.body.appendChild(a),a.select(),document.execCommand("copy"),a.remove()}function ii(e){if(e.indexOf(";base64,")==-1){let n=e.split(","),s=n[0].split(":")[1],o=n[1];return new Blob([o],{type:s})}let a=e.split(";base64,"),t=a[0].split(":")[1],r=window.atob(a[1]),i=new Uint8Array(r.length);for(let n=0;n<r.length;++n)i[n]=r.charCodeAt(n);return new Blob([i],{type:t})}var yt={renew:540,idle:600,host:""};function oi(e){Object.assign(yt,e),yt.idle!==0&&(window.onload=kt,window.onmousemove=kt,window.onmousedown=kt,window.ontouchstart=kt,window.onclick=kt,window.onkeypress=kt,kt(),Nr())}var li,si,Br;function kt(){Br||(clearTimeout(li),li=setTimeout(ci,yt.idle*1e3))}function ci(){Br=!0,clearTimeout(si);let e=new XMLHttpRequest;e.open("GET",`${yt.host}/api/user/cookie?destroy=true`),e.send();let a=document.body.appendChild(st.node`<div id="InputMask">`),t=a.appendChild(st.node`
    <form id="loginForm" action="${yt.host+"/api/user/login"}" method="post" autocomplete="off">
     
      <input style="display: none;" name="login" value=true>
  
      <input style="display:none;" name="language" required value="en">
  
      <div class="input-group">
        <input id="auth_user_email" name="email" type="email" required maxlength="50">
        <span class="bar"></span>
        <label for="auth_user_email">E-mail</label>
      </div>
  
      <div class="input-group">
        <input id="auth_user_password" name="password" type="password" required minlength="8">
        <span class="bar"></span>
        <label for="auth_user_password">Password</label>
      </div>
     
      <button id="btnLogin" type="submit">Log In</button>

      <div id="loginMessage" style="color: red"></div>
        
    </form>`);t.onsubmit=r=>{r.preventDefault();let i=new XMLHttpRequest;i.open("POST",`${yt.host}/api/user/login`),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.onload=n=>{n.target.status===401&&(document.getElementById("loginMessage").textContent=n.target.response),n.target.status===200&&(Br=!1,a.remove(),kt(),Nr())},i.send(`login=true&email=${document.getElementById("auth_user_email").value}&password=${document.getElementById("auth_user_password").value}`)}}function Nr(){si=setTimeout(e,yt.renew*1e3);function e(){let a=new XMLHttpRequest;a.open("GET",`${yt.host}/api/user/cookie?renew=true`),a.onload=t=>{if(t.target.status===401)return ci();Nr()},a.send()}}var ui=()=>{let e=new WeakSet;return(a,t)=>{if(typeof t=="object"&&t!==null){if(e.has(t))return;e.add(t)}return t}};var Gr=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],Qt={_disable:[],allowInput:!1,allowInvalidPreload:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:typeof window=="object"&&window.navigator.userAgent.indexOf("MSIE")===-1,ariaDateFormat:"F j, Y",autoFillDefaultTime:!0,clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enableSeconds:!1,enableTime:!1,errorHandler:e=>typeof console!="undefined"&&console.warn(e),getWeek:e=>{let a=new Date(e.getTime());a.setHours(0,0,0,0),a.setDate(a.getDate()+3-(a.getDay()+6)%7);var t=new Date(a.getFullYear(),0,4);return 1+Math.round(((a.getTime()-t.getTime())/864e5-3+(t.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1},ba={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:e=>{let a=e%100;if(a>3&&a<21)return"th";switch(a%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",monthAriaLabel:"Month",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},Ne=(e,a=2)=>`000${e}`.slice(a*-1),Xe=e=>e===!0?1:0;function di(e,a){let t;return function(){clearTimeout(t),t=setTimeout(()=>e.apply(this,arguments),a)}}var qr=e=>e instanceof Array?e:[e];function Pe(e,a,t){if(t===!0)return e.classList.add(a);e.classList.remove(a)}function ve(e,a,t){let r=window.document.createElement(e);return a=a||"",t=t||"",r.className=a,t!==void 0&&(r.textContent=t),r}function Ia(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function pi(e,a){if(a(e))return e;if(e.parentNode)return pi(e.parentNode,a)}function xa(e,a){let t=ve("div","numInputWrapper"),r=ve("input","numInput "+e),i=ve("span","arrowUp"),n=ve("span","arrowDown");if(navigator.userAgent.indexOf("MSIE 9.0")===-1?r.type="number":(r.type="text",r.pattern="\\d*"),a!==void 0)for(let s in a)r.setAttribute(s,a[s]);return t.appendChild(r),t.appendChild(i),t.appendChild(n),t}function Ve(e){try{return typeof e.composedPath=="function"?e.composedPath()[0]:e.target}catch(a){return e.target}}var Vr=()=>{},Ra=(e,a,t)=>t.months[a?"shorthand":"longhand"][e],Yu={D:Vr,F:function(e,a,t){e.setMonth(t.months.longhand.indexOf(a))},G:(e,a)=>{e.setHours(parseFloat(a))},H:(e,a)=>{e.setHours(parseFloat(a))},J:(e,a)=>{e.setDate(parseFloat(a))},K:(e,a,t)=>{e.setHours(e.getHours()%12+12*Xe(new RegExp(t.amPM[1],"i").test(a)))},M:function(e,a,t){e.setMonth(t.months.shorthand.indexOf(a))},S:(e,a)=>{e.setSeconds(parseFloat(a))},U:(e,a)=>new Date(parseFloat(a)*1e3),W:function(e,a,t){let r=parseInt(a),i=new Date(e.getFullYear(),0,2+(r-1)*7,0,0,0,0);return i.setDate(i.getDate()-i.getDay()+t.firstDayOfWeek),i},Y:(e,a)=>{e.setFullYear(parseFloat(a))},Z:(e,a)=>new Date(a),d:(e,a)=>{e.setDate(parseFloat(a))},h:(e,a)=>{e.setHours(parseFloat(a))},i:(e,a)=>{e.setMinutes(parseFloat(a))},j:(e,a)=>{e.setDate(parseFloat(a))},l:Vr,m:(e,a)=>{e.setMonth(parseFloat(a)-1)},n:(e,a)=>{e.setMonth(parseFloat(a)-1)},s:(e,a)=>{e.setSeconds(parseFloat(a))},u:(e,a)=>new Date(parseFloat(a)),w:Vr,y:(e,a)=>{e.setFullYear(2e3+parseFloat(a))}},Ur={D:"(\\w+)",F:"(\\w+)",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"(\\w+)",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"(\\w+)",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},wa={Z:e=>e.toISOString(),D:function(e,a,t){return a.weekdays.shorthand[wa.w(e,a,t)]},F:function(e,a,t){return Ra(wa.n(e,a,t)-1,!1,a)},G:function(e,a,t){return Ne(wa.h(e,a,t))},H:e=>Ne(e.getHours()),J:function(e,a){return a.ordinal!==void 0?e.getDate()+a.ordinal(e.getDate()):e.getDate()},K:(e,a)=>a.amPM[Xe(e.getHours()>11)],M:function(e,a){return Ra(e.getMonth(),!0,a)},S:e=>Ne(e.getSeconds()),U:e=>e.getTime()/1e3,W:function(e,a,t){return t.getWeek(e)},Y:e=>Ne(e.getFullYear(),4),d:e=>Ne(e.getDate()),h:e=>e.getHours()%12?e.getHours()%12:12,i:e=>Ne(e.getMinutes()),j:e=>e.getDate(),l:function(e,a){return a.weekdays.longhand[e.getDay()]},m:e=>Ne(e.getMonth()+1),n:e=>e.getMonth()+1,s:e=>e.getSeconds(),u:e=>e.getTime(),w:e=>e.getDay(),y:e=>String(e.getFullYear()).substring(2)},fi=({config:e=Qt,l10n:a=ba,isMobile:t=!1})=>(r,i,n)=>{let s=n||a;return e.formatDate!==void 0&&!t?e.formatDate(r,i,s):i.split("").map((o,c,f)=>wa[o]&&f[c-1]!=="\\"?wa[o](r,s,e):o!=="\\"?o:"").join("")},Yr=({config:e=Qt,l10n:a=ba})=>(t,r,i,n)=>{if(t!==0&&!t)return;let s=n||a,o,c=t;if(t instanceof Date)o=new Date(t.getTime());else if(typeof t!="string"&&t.toFixed!==void 0)o=new Date(t);else if(typeof t=="string"){let f=r||(e||Qt).dateFormat,p=String(t).trim();if(p==="today")o=new Date,i=!0;else if(/Z$/.test(p)||/GMT$/.test(p))o=new Date(t);else if(e&&e.parseDate)o=e.parseDate(t,f);else{o=!e||!e.noCalendar?new Date(new Date().getFullYear(),0,1,0,0,0,0):new Date(new Date().setHours(0,0,0,0));let u,h=[];for(let w=0,D=0,Z="";w<f.length;w++){let U=f[w],ae=U==="\\",F=f[w-1]==="\\"||ae;if(Ur[U]&&!F){Z+=Ur[U];let ie=new RegExp(Z).exec(t);ie&&(u=!0)&&h[U!=="Y"?"push":"unshift"]({fn:Yu[U],val:ie[++D]})}else ae||(Z+=".");h.forEach(({fn:ie,val:J})=>o=ie(o,J,s)||o)}o=u?o:void 0}}if(!(o instanceof Date&&!isNaN(o.getTime()))){e.errorHandler(new Error(`Invalid date provided: ${c}`));return}return i===!0&&o.setHours(0,0,0,0),o};function Ue(e,a,t=!0){return t!==!1?new Date(e.getTime()).setHours(0,0,0,0)-new Date(a.getTime()).setHours(0,0,0,0):e.getTime()-a.getTime()}var Wu=(e,a,t)=>e>Math.min(a,t)&&e<Math.max(a,t),Ju={DAY:864e5};function Wr(e){let a=e.defaultHour,t=e.defaultMinute,r=e.defaultSeconds;if(e.minDate!==void 0){let i=e.minDate.getHours(),n=e.minDate.getMinutes(),s=e.minDate.getSeconds();a<i&&(a=i),a===i&&t<n&&(t=n),a===i&&t===n&&r<s&&(r=e.minDate.getSeconds())}if(e.maxDate!==void 0){let i=e.maxDate.getHours(),n=e.maxDate.getMinutes();a=Math.min(a,i),a===i&&(t=Math.min(n,t)),a===i&&t===n&&(r=e.maxDate.getSeconds())}return{hours:a,minutes:t,seconds:r}}typeof Object.assign!="function"&&(Object.assign=function(e,...a){if(!e)throw TypeError("Cannot convert undefined or null to object");for(let t of a)t&&Object.keys(t).forEach(r=>e[r]=t[r]);return e});var Zu=300;function Xu(e,a){let t={config:Object.assign(Object.assign({},Qt),Me.defaultConfig),l10n:ba};t.parseDate=Yr({config:t.config,l10n:t.l10n}),t._handlers=[],t.pluginElements=[],t.loadedPlugins=[],t._bind=D,t._setHoursFromDate=u,t._positionCalendar=et,t.changeMonth=A,t.changeYear=mt,t.clear=ee,t.close=ue,t._createElement=ve,t.destroy=ge,t.isEnabled=Ge,t.jumpToDate=ae,t.open=vt,t.redraw=qt,t.set=ar,t.setDate=rr,t.toggle=lr;function r(){t.utils={getDaysInMonth(m=t.currentMonth,v=t.currentYear){return m===1&&(v%4==0&&v%100!=0||v%400==0)?29:t.l10n.daysInMonth[m]}}}function i(){t.element=t.input=e,t.isOpen=!1,Bt(),Tt(),ir(),nr(),r(),t.isMobile||J(),U(),(t.selectedDates.length||t.config.noCalendar)&&(t.config.enableTime&&u(t.config.noCalendar?t.latestSelectedDateObj:void 0),tt(!1)),s();let m=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!t.isMobile&&m&&et(),we("onReady")}function n(m){return m.bind(t)}function s(){let m=t.config;m.weekNumbers===!1&&m.showMonths===1||m.noCalendar!==!0&&window.requestAnimationFrame(function(){if(t.calendarContainer!==void 0&&(t.calendarContainer.style.visibility="hidden",t.calendarContainer.style.display="block"),t.daysContainer!==void 0){let v=(t.days.offsetWidth+1)*m.showMonths;t.daysContainer.style.width=v+"px",t.calendarContainer.style.width=v+(t.weekWrapper!==void 0?t.weekWrapper.offsetWidth:0)+"px",t.calendarContainer.style.removeProperty("visibility"),t.calendarContainer.style.removeProperty("display")}})}function o(m){if(t.selectedDates.length===0){let E=t.config.minDate===void 0||Ue(new Date,t.config.minDate)>=0?new Date:new Date(t.config.minDate.getTime()),$=Wr(t.config);E.setHours($.hours,$.minutes,$.seconds,E.getMilliseconds()),t.selectedDates=[E],t.latestSelectedDateObj=E}m!==void 0&&m.type!=="blur"&&ur(m);let v=t._input.value;p(),tt(),t._input.value!==v&&t._debouncedChange()}function c(m,v){return m%12+12*Xe(v===t.l10n.amPM[1])}function f(m){switch(m%24){case 0:case 12:return 12;default:return m%12}}function p(){if(t.hourElement===void 0||t.minuteElement===void 0)return;let m=(parseInt(t.hourElement.value.slice(-2),10)||0)%24,v=(parseInt(t.minuteElement.value,10)||0)%60,E=t.secondElement!==void 0?(parseInt(t.secondElement.value,10)||0)%60:0;t.amPM!==void 0&&(m=c(m,t.amPM.textContent));let $=t.config.minTime!==void 0||t.config.minDate&&t.minDateHasTime&&t.latestSelectedDateObj&&Ue(t.latestSelectedDateObj,t.config.minDate,!0)===0;if(t.config.maxTime!==void 0||t.config.maxDate&&t.maxDateHasTime&&t.latestSelectedDateObj&&Ue(t.latestSelectedDateObj,t.config.maxDate,!0)===0){let I=t.config.maxTime!==void 0?t.config.maxTime:t.config.maxDate;m=Math.min(m,I.getHours()),m===I.getHours()&&(v=Math.min(v,I.getMinutes())),v===I.getMinutes()&&(E=Math.min(E,I.getSeconds()))}if($){let I=t.config.minTime!==void 0?t.config.minTime:t.config.minDate;m=Math.max(m,I.getHours()),m===I.getHours()&&v<I.getMinutes()&&(v=I.getMinutes()),v===I.getMinutes()&&(E=Math.max(E,I.getSeconds()))}h(m,v,E)}function u(m){let v=m||t.latestSelectedDateObj;v&&h(v.getHours(),v.getMinutes(),v.getSeconds())}function h(m,v,E){t.latestSelectedDateObj!==void 0&&t.latestSelectedDateObj.setHours(m%24,v,E||0,0),!(!t.hourElement||!t.minuteElement||t.isMobile)&&(t.hourElement.value=Ne(t.config.time_24hr?m:(12+m)%12+12*Xe(m%12==0)),t.minuteElement.value=Ne(v),t.amPM!==void 0&&(t.amPM.textContent=t.l10n.amPM[Xe(m>=12)]),t.secondElement!==void 0&&(t.secondElement.value=Ne(E)))}function w(m){let v=Ve(m),E=parseInt(v.value)+(m.delta||0);(E/1e3>1||m.key==="Enter"&&!/[^\d]/.test(E.toString()))&&mt(E)}function D(m,v,E,$){if(v instanceof Array)return v.forEach(Y=>D(m,Y,E,$));if(m instanceof Array)return m.forEach(Y=>D(Y,v,E,$));m.addEventListener(v,E,$),t._handlers.push({remove:()=>m.removeEventListener(v,E)})}function Z(){we("onChange")}function U(){if(t.config.wrap&&["open","close","toggle","clear"].forEach(v=>{Array.prototype.forEach.call(t.element.querySelectorAll(`[data-${v}]`),E=>D(E,"click",t[v]))}),t.isMobile){or();return}let m=di(Nt,50);if(t._debouncedChange=di(Z,Zu),t.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&D(t.daysContainer,"mouseover",v=>{t.config.mode==="range"&&ze(Ve(v))}),D(window.document.body,"keydown",dt),!t.config.inline&&!t.config.static&&D(window,"resize",m),window.ontouchstart!==void 0?D(window.document,"touchstart",$e):D(window.document,"mousedown",$e),D(window.document,"focus",$e,{capture:!0}),t.config.clickOpens===!0&&(D(t._input,"focus",t.open),D(t._input,"click",t.open)),t.daysContainer!==void 0&&(D(t.monthNav,"click",cr),D(t.monthNav,["keyup","increment"],w),D(t.daysContainer,"click",Vt)),t.timeContainer!==void 0&&t.minuteElement!==void 0&&t.hourElement!==void 0){let v=E=>Ve(E).select();D(t.timeContainer,["increment"],o),D(t.timeContainer,"blur",o,{capture:!0}),D(t.timeContainer,"click",F),D([t.hourElement,t.minuteElement],["focus","click"],v),t.secondElement!==void 0&&D(t.secondElement,"focus",()=>t.secondElement&&t.secondElement.select()),t.amPM!==void 0&&D(t.amPM,"click",E=>{o(E),Z()})}t.config.allowInput&&D(t._input,"blur",ca)}function ae(m,v){let E=m!==void 0?t.parseDate(m):t.latestSelectedDateObj||(t.config.minDate&&t.config.minDate>t.now?t.config.minDate:t.config.maxDate&&t.config.maxDate<t.now?t.config.maxDate:t.now),$=t.currentYear,Y=t.currentMonth;try{E!==void 0&&(t.currentYear=E.getFullYear(),t.currentMonth=E.getMonth())}catch(I){I.message="Invalid date supplied: "+E,t.config.errorHandler(I)}v&&t.currentYear!==$&&(we("onYearChange"),P()),v&&(t.currentYear!==$||t.currentMonth!==Y)&&we("onMonthChange"),t.redraw()}function F(m){let v=Ve(m);~v.className.indexOf("arrow")&&ie(m,v.classList.contains("arrowUp")?1:-1)}function ie(m,v,E){let $=m&&Ve(m),Y=E||$&&$.parentNode&&$.parentNode.firstChild,I=ua("increment");I.delta=v,Y&&Y.dispatchEvent(I)}function J(){let m=window.document.createDocumentFragment();if(t.calendarContainer=ve("div","flatpickr-calendar"),t.calendarContainer.tabIndex=-1,!t.config.noCalendar){if(m.appendChild(M()),t.innerContainer=ve("div","flatpickr-innerContainer"),t.config.weekNumbers){let{weekWrapper:E,weekNumbers:$}=x();t.innerContainer.appendChild(E),t.weekNumbers=$,t.weekWrapper=E}t.rContainer=ve("div","flatpickr-rContainer"),t.rContainer.appendChild(N()),t.daysContainer||(t.daysContainer=ve("div","flatpickr-days"),t.daysContainer.tabIndex=-1),z(),t.rContainer.appendChild(t.daysContainer),t.innerContainer.appendChild(t.rContainer),m.appendChild(t.innerContainer)}t.config.enableTime&&m.appendChild(V()),Pe(t.calendarContainer,"rangeMode",t.config.mode==="range"),Pe(t.calendarContainer,"animate",t.config.animate===!0),Pe(t.calendarContainer,"multiMonth",t.config.showMonths>1),t.calendarContainer.appendChild(m);let v=t.config.appendTo!==void 0&&t.config.appendTo.nodeType!==void 0;if((t.config.inline||t.config.static)&&(t.calendarContainer.classList.add(t.config.inline?"inline":"static"),t.config.inline&&(!v&&t.element.parentNode?t.element.parentNode.insertBefore(t.calendarContainer,t._input.nextSibling):t.config.appendTo!==void 0&&t.config.appendTo.appendChild(t.calendarContainer)),t.config.static)){let E=ve("div","flatpickr-wrapper");t.element.parentNode&&t.element.parentNode.insertBefore(E,t.element),E.appendChild(t.element),t.altInput&&E.appendChild(t.altInput),E.appendChild(t.calendarContainer)}!t.config.static&&!t.config.inline&&(t.config.appendTo!==void 0?t.config.appendTo:window.document.body).appendChild(t.calendarContainer)}function Te(m,v,E,$){let Y=Ge(v,!0),I=ve("span","flatpickr-day "+m,v.getDate().toString());return I.dateObj=v,I.$i=$,I.setAttribute("aria-label",t.formatDate(v,t.config.ariaDateFormat)),m.indexOf("hidden")===-1&&Ue(v,t.now)===0&&(t.todayDateElem=I,I.classList.add("today"),I.setAttribute("aria-current","date")),Y?(I.tabIndex=-1,Ut(v)&&(I.classList.add("selected"),t.selectedDateElem=I,t.config.mode==="range"&&(Pe(I,"startRange",t.selectedDates[0]&&Ue(v,t.selectedDates[0],!0)===0),Pe(I,"endRange",t.selectedDates[1]&&Ue(v,t.selectedDates[1],!0)===0),m==="nextMonthDay"&&I.classList.add("inRange")))):I.classList.add("flatpickr-disabled"),t.config.mode==="range"&&sr(v)&&!Ut(v)&&I.classList.add("inRange"),t.weekNumbers&&t.config.showMonths===1&&m!=="prevMonthDay"&&E%7==1&&t.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+t.config.getWeek(v)+"</span>"),we("onDayCreate",I),I}function We(m){m.focus(),t.config.mode==="range"&&ze(m)}function Qe(m){let v=m>0?0:t.config.showMonths-1,E=m>0?t.config.showMonths:-1;for(let $=v;$!=E;$+=m){let Y=t.daysContainer.children[$],I=m>0?0:Y.children.length-1,te=m>0?Y.children.length:-1;for(let Q=I;Q!=te;Q+=m){let oe=Y.children[Q];if(oe.className.indexOf("hidden")===-1&&Ge(oe.dateObj))return oe}}}function T(m,v){let E=m.className.indexOf("Month")===-1?m.dateObj.getMonth():t.currentMonth,$=v>0?t.config.showMonths:-1,Y=v>0?1:-1;for(let I=E-t.currentMonth;I!=$;I+=Y){let te=t.daysContainer.children[I],Q=E-t.currentMonth===I?m.$i+v:v<0?te.children.length-1:0,oe=te.children.length;for(let se=Q;se>=0&&se<oe&&se!=(v>0?oe:-1);se+=Y){let he=te.children[se];if(he.className.indexOf("hidden")===-1&&Ge(he.dateObj)&&Math.abs(m.$i-se)>=Math.abs(v))return We(he)}}t.changeMonth(Y),G(Qe(Y),0)}function G(m,v){let E=Je(document.activeElement||document.body),$=m!==void 0?m:E?document.activeElement:t.selectedDateElem!==void 0&&Je(t.selectedDateElem)?t.selectedDateElem:t.todayDateElem!==void 0&&Je(t.todayDateElem)?t.todayDateElem:Qe(v>0?1:-1);$===void 0?t._input.focus():E?T($,v):We($)}function q(m,v){let E=(new Date(m,v,1).getDay()-t.l10n.firstDayOfWeek+7)%7,$=t.utils.getDaysInMonth((v-1+12)%12,m),Y=t.utils.getDaysInMonth(v,m),I=window.document.createDocumentFragment(),te=t.config.showMonths>1,Q=te?"prevMonthDay hidden":"prevMonthDay",oe=te?"nextMonthDay hidden":"nextMonthDay",se=$+1-E,he=0;for(;se<=$;se++,he++)I.appendChild(Te(Q,new Date(m,v-1,se),se,he));for(se=1;se<=Y;se++,he++)I.appendChild(Te("",new Date(m,v,se),se,he));for(let De=Y+1;De<=42-E&&(t.config.showMonths===1||he%7!=0);De++,he++)I.appendChild(Te(oe,new Date(m,v+1,De%Y),De,he));let Ie=ve("div","dayContainer");return Ie.appendChild(I),Ie}function z(){if(t.daysContainer===void 0)return;Ia(t.daysContainer),t.weekNumbers&&Ia(t.weekNumbers);let m=document.createDocumentFragment();for(let v=0;v<t.config.showMonths;v++){let E=new Date(t.currentYear,t.currentMonth,1);E.setMonth(t.currentMonth+v),m.appendChild(q(E.getFullYear(),E.getMonth()))}t.daysContainer.appendChild(m),t.days=t.daysContainer.firstChild,t.config.mode==="range"&&t.selectedDates.length===1&&ze()}function P(){if(t.config.showMonths>1||t.config.monthSelectorType!=="dropdown")return;let m=function(v){return t.config.minDate!==void 0&&t.currentYear===t.config.minDate.getFullYear()&&v<t.config.minDate.getMonth()?!1:!(t.config.maxDate!==void 0&&t.currentYear===t.config.maxDate.getFullYear()&&v>t.config.maxDate.getMonth())};t.monthsDropdownContainer.tabIndex=-1,t.monthsDropdownContainer.innerHTML="";for(let v=0;v<12;v++){if(!m(v))continue;let E=ve("option","flatpickr-monthDropdown-month");E.value=new Date(t.currentYear,v).getMonth().toString(),E.textContent=Ra(v,t.config.shorthandCurrentMonth,t.l10n),E.tabIndex=-1,t.currentMonth===v&&(E.selected=!0),t.monthsDropdownContainer.appendChild(E)}}function S(){let m=ve("div","flatpickr-month"),v=window.document.createDocumentFragment(),E;t.config.showMonths>1||t.config.monthSelectorType==="static"?E=ve("span","cur-month"):(t.monthsDropdownContainer=ve("select","flatpickr-monthDropdown-months"),t.monthsDropdownContainer.setAttribute("aria-label",t.l10n.monthAriaLabel),D(t.monthsDropdownContainer,"change",te=>{let Q=Ve(te),oe=parseInt(Q.value,10);t.changeMonth(oe-t.currentMonth),we("onMonthChange")}),P(),E=t.monthsDropdownContainer);let $=xa("cur-year",{tabindex:"-1"}),Y=$.getElementsByTagName("input")[0];Y.setAttribute("aria-label",t.l10n.yearAriaLabel),t.config.minDate&&Y.setAttribute("min",t.config.minDate.getFullYear().toString()),t.config.maxDate&&(Y.setAttribute("max",t.config.maxDate.getFullYear().toString()),Y.disabled=!!t.config.minDate&&t.config.minDate.getFullYear()===t.config.maxDate.getFullYear());let I=ve("div","flatpickr-current-month");return I.appendChild(E),I.appendChild($),v.appendChild(I),m.appendChild(v),{container:m,yearElement:Y,monthElement:E}}function C(){Ia(t.monthNav),t.monthNav.appendChild(t.prevMonthNav),t.config.showMonths&&(t.yearElements=[],t.monthElements=[]);for(let m=t.config.showMonths;m--;){let v=S();t.yearElements.push(v.yearElement),t.monthElements.push(v.monthElement),t.monthNav.appendChild(v.container)}t.monthNav.appendChild(t.nextMonthNav)}function M(){return t.monthNav=ve("div","flatpickr-months"),t.yearElements=[],t.monthElements=[],t.prevMonthNav=ve("span","flatpickr-prev-month"),t.prevMonthNav.innerHTML=t.config.prevArrow,t.nextMonthNav=ve("span","flatpickr-next-month"),t.nextMonthNav.innerHTML=t.config.nextArrow,C(),Object.defineProperty(t,"_hidePrevMonthArrow",{get:()=>t.__hidePrevMonthArrow,set(m){t.__hidePrevMonthArrow!==m&&(Pe(t.prevMonthNav,"flatpickr-disabled",m),t.__hidePrevMonthArrow=m)}}),Object.defineProperty(t,"_hideNextMonthArrow",{get:()=>t.__hideNextMonthArrow,set(m){t.__hideNextMonthArrow!==m&&(Pe(t.nextMonthNav,"flatpickr-disabled",m),t.__hideNextMonthArrow=m)}}),t.currentYearElement=t.yearElements[0],Yt(),t.monthNav}function V(){t.calendarContainer.classList.add("hasTime"),t.config.noCalendar&&t.calendarContainer.classList.add("noCalendar");let m=Wr(t.config);t.timeContainer=ve("div","flatpickr-time"),t.timeContainer.tabIndex=-1;let v=ve("span","flatpickr-time-separator",":"),E=xa("flatpickr-hour",{"aria-label":t.l10n.hourAriaLabel});t.hourElement=E.getElementsByTagName("input")[0];let $=xa("flatpickr-minute",{"aria-label":t.l10n.minuteAriaLabel});if(t.minuteElement=$.getElementsByTagName("input")[0],t.hourElement.tabIndex=t.minuteElement.tabIndex=-1,t.hourElement.value=Ne(t.latestSelectedDateObj?t.latestSelectedDateObj.getHours():t.config.time_24hr?m.hours:f(m.hours)),t.minuteElement.value=Ne(t.latestSelectedDateObj?t.latestSelectedDateObj.getMinutes():m.minutes),t.hourElement.setAttribute("step",t.config.hourIncrement.toString()),t.minuteElement.setAttribute("step",t.config.minuteIncrement.toString()),t.hourElement.setAttribute("min",t.config.time_24hr?"0":"1"),t.hourElement.setAttribute("max",t.config.time_24hr?"23":"12"),t.hourElement.setAttribute("maxlength","2"),t.minuteElement.setAttribute("min","0"),t.minuteElement.setAttribute("max","59"),t.minuteElement.setAttribute("maxlength","2"),t.timeContainer.appendChild(E),t.timeContainer.appendChild(v),t.timeContainer.appendChild($),t.config.time_24hr&&t.timeContainer.classList.add("time24hr"),t.config.enableSeconds){t.timeContainer.classList.add("hasSeconds");let Y=xa("flatpickr-second");t.secondElement=Y.getElementsByTagName("input")[0],t.secondElement.value=Ne(t.latestSelectedDateObj?t.latestSelectedDateObj.getSeconds():m.seconds),t.secondElement.setAttribute("step",t.minuteElement.getAttribute("step")),t.secondElement.setAttribute("min","0"),t.secondElement.setAttribute("max","59"),t.secondElement.setAttribute("maxlength","2"),t.timeContainer.appendChild(ve("span","flatpickr-time-separator",":")),t.timeContainer.appendChild(Y)}return t.config.time_24hr||(t.amPM=ve("span","flatpickr-am-pm",t.l10n.amPM[Xe((t.latestSelectedDateObj?t.hourElement.value:t.config.defaultHour)>11)]),t.amPM.title=t.l10n.toggleTitle,t.amPM.tabIndex=-1,t.timeContainer.appendChild(t.amPM)),t.timeContainer}function N(){t.weekdayContainer?Ia(t.weekdayContainer):t.weekdayContainer=ve("div","flatpickr-weekdays");for(let m=t.config.showMonths;m--;){let v=ve("div","flatpickr-weekdaycontainer");t.weekdayContainer.appendChild(v)}return W(),t.weekdayContainer}function W(){if(!t.weekdayContainer)return;let m=t.l10n.firstDayOfWeek,v=[...t.l10n.weekdays.shorthand];m>0&&m<v.length&&(v=[...v.splice(m,v.length),...v.splice(0,m)]);for(let E=t.config.showMonths;E--;)t.weekdayContainer.children[E].innerHTML=`
      <span class='flatpickr-weekday'>
        ${v.join("</span><span class='flatpickr-weekday'>")}
      </span>
      `}function x(){t.calendarContainer.classList.add("hasWeeks");let m=ve("div","flatpickr-weekwrapper");m.appendChild(ve("span","flatpickr-weekday",t.l10n.weekAbbreviation));let v=ve("div","flatpickr-weeks");return m.appendChild(v),{weekWrapper:m,weekNumbers:v}}function A(m,v=!0){let E=v?m:m-t.currentMonth;E<0&&t._hidePrevMonthArrow===!0||E>0&&t._hideNextMonthArrow===!0||(t.currentMonth+=E,(t.currentMonth<0||t.currentMonth>11)&&(t.currentYear+=t.currentMonth>11?1:-1,t.currentMonth=(t.currentMonth+12)%12,we("onYearChange"),P()),z(),we("onMonthChange"),Yt())}function ee(m=!0,v=!0){if(t.input.value="",t.altInput!==void 0&&(t.altInput.value=""),t.mobileInput!==void 0&&(t.mobileInput.value=""),t.selectedDates=[],t.latestSelectedDateObj=void 0,v===!0&&(t.currentYear=t._initialDate.getFullYear(),t.currentMonth=t._initialDate.getMonth()),t.config.enableTime===!0){let{hours:E,minutes:$,seconds:Y}=Wr(t.config);h(E,$,Y)}t.redraw(),m&&we("onChange")}function ue(){t.isOpen=!1,t.isMobile||(t.calendarContainer!==void 0&&t.calendarContainer.classList.remove("open"),t._input!==void 0&&t._input.classList.remove("active")),we("onClose")}function ge(){t.config!==void 0&&we("onDestroy");for(let m=t._handlers.length;m--;)t._handlers[m].remove();if(t._handlers=[],t.mobileInput)t.mobileInput.parentNode&&t.mobileInput.parentNode.removeChild(t.mobileInput),t.mobileInput=void 0;else if(t.calendarContainer&&t.calendarContainer.parentNode)if(t.config.static&&t.calendarContainer.parentNode){let m=t.calendarContainer.parentNode;if(m.lastChild&&m.removeChild(m.lastChild),m.parentNode){for(;m.firstChild;)m.parentNode.insertBefore(m.firstChild,m);m.parentNode.removeChild(m)}}else t.calendarContainer.parentNode.removeChild(t.calendarContainer);t.altInput&&(t.input.type="text",t.altInput.parentNode&&t.altInput.parentNode.removeChild(t.altInput),delete t.altInput),t.input&&(t.input.type=t.input._type,t.input.classList.remove("flatpickr-input"),t.input.removeAttribute("readonly")),["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach(m=>{try{delete t[m]}catch(v){}})}function be(m){return t.config.appendTo&&t.config.appendTo.contains(m)?!0:t.calendarContainer.contains(m)}function $e(m){if(t.isOpen&&!t.config.inline){let v=Ve(m),E=be(v),$=v===t.input||v===t.altInput||t.element.contains(v)||m.path&&m.path.indexOf&&(~m.path.indexOf(t.input)||~m.path.indexOf(t.altInput)),Y=m.type==="blur"?$&&m.relatedTarget&&!be(m.relatedTarget):!$&&!E&&!be(m.relatedTarget),I=!t.config.ignoredFocusElements.some(te=>te.contains(v));Y&&I&&(t.timeContainer!==void 0&&t.minuteElement!==void 0&&t.hourElement!==void 0&&t.input.value!==""&&t.input.value!==void 0&&o(),t.close(),t.config&&t.config.mode==="range"&&t.selectedDates.length===1&&(t.clear(!1),t.redraw()))}}function mt(m){if(!m||t.config.minDate&&m<t.config.minDate.getFullYear()||t.config.maxDate&&m>t.config.maxDate.getFullYear())return;let v=m,E=t.currentYear!==v;t.currentYear=v||t.currentYear,t.config.maxDate&&t.currentYear===t.config.maxDate.getFullYear()?t.currentMonth=Math.min(t.config.maxDate.getMonth(),t.currentMonth):t.config.minDate&&t.currentYear===t.config.minDate.getFullYear()&&(t.currentMonth=Math.max(t.config.minDate.getMonth(),t.currentMonth)),E&&(t.redraw(),we("onYearChange"),P())}function Ge(m,v=!0){var E;let $=t.parseDate(m,void 0,v);if(t.config.minDate&&$&&Ue($,t.config.minDate,v!==void 0?v:!t.minDateHasTime)<0||t.config.maxDate&&$&&Ue($,t.config.maxDate,v!==void 0?v:!t.maxDateHasTime)>0)return!1;if(!t.config.enable&&t.config.disable.length===0)return!0;if($===void 0)return!1;let Y=!!t.config.enable,I=(E=t.config.enable)!==null&&E!==void 0?E:t.config.disable;for(let te=0,Q;te<I.length;te++){if(Q=I[te],typeof Q=="function"&&Q($))return Y;if(Q instanceof Date&&$!==void 0&&Q.getTime()===$.getTime())return Y;if(typeof Q=="string"){let oe=t.parseDate(Q,void 0,!0);return oe&&oe.getTime()===$.getTime()?Y:!Y}else if(typeof Q=="object"&&$!==void 0&&Q.from&&Q.to&&$.getTime()>=Q.from.getTime()&&$.getTime()<=Q.to.getTime())return Y}return!Y}function Je(m){return t.daysContainer!==void 0?m.className.indexOf("hidden")===-1&&m.className.indexOf("flatpickr-disabled")===-1&&t.daysContainer.contains(m):!1}function ca(m){m.target===t._input&&(t.selectedDates.length>0||t._input.value.length>0)&&!(m.relatedTarget&&be(m.relatedTarget))&&t.setDate(t._input.value,!0,m.target===t.altInput?t.config.altFormat:t.config.dateFormat)}function dt(m){let v=Ve(m),E=t.config.wrap?e.contains(v):v===t._input,$=t.config.allowInput,Y=t.isOpen&&(!$||!E),I=t.config.inline&&E&&!$;if(m.keyCode===13&&E){if($)return t.setDate(t._input.value,!0,v===t.altInput?t.config.altFormat:t.config.dateFormat),v.blur();t.open()}else if(be(v)||Y||I){let te=!!t.timeContainer&&t.timeContainer.contains(v);switch(m.keyCode){case 13:te?(m.preventDefault(),o(),ot()):Vt(m);break;case 27:m.preventDefault(),ot();break;case 8:case 46:E&&!t.config.allowInput&&(m.preventDefault(),t.clear());break;case 37:case 39:if(!te&&!E){if(m.preventDefault(),t.daysContainer!==void 0&&($===!1||document.activeElement&&Je(document.activeElement))){let oe=m.keyCode===39?1:-1;m.ctrlKey?(m.stopPropagation(),A(oe),G(Qe(1),0)):G(void 0,oe)}}else t.hourElement&&t.hourElement.focus();break;case 38:case 40:m.preventDefault();let Q=m.keyCode===40?1:-1;t.daysContainer&&v.$i!==void 0||v===t.input||v===t.altInput?m.ctrlKey?(m.stopPropagation(),mt(t.currentYear-Q),G(Qe(1),0)):te||G(void 0,Q*7):v===t.currentYearElement?mt(t.currentYear-Q):t.config.enableTime&&(!te&&t.hourElement&&t.hourElement.focus(),o(m),t._debouncedChange());break;case 9:if(te){let oe=[t.hourElement,t.minuteElement,t.secondElement,t.amPM].concat(t.pluginElements).filter(he=>he),se=oe.indexOf(v);if(se!==-1){let he=oe[se+(m.shiftKey?-1:1)];m.preventDefault(),(he||t._input).focus()}}else!t.config.noCalendar&&t.daysContainer&&t.daysContainer.contains(v)&&m.shiftKey&&(m.preventDefault(),t._input.focus());break}}if(t.amPM!==void 0&&v===t.amPM)switch(m.key){case t.l10n.amPM[0].charAt(0):case t.l10n.amPM[0].charAt(0).toLowerCase():t.amPM.textContent=t.l10n.amPM[0],p(),tt();break;case t.l10n.amPM[1].charAt(0):case t.l10n.amPM[1].charAt(0).toLowerCase():t.amPM.textContent=t.l10n.amPM[1],p(),tt();break}(E||be(v))&&we("onKeyDown",m)}function ze(m){if(t.selectedDates.length!==1||m&&(!m.classList.contains("flatpickr-day")||m.classList.contains("flatpickr-disabled")))return;let v=m?m.dateObj.getTime():t.days.firstElementChild.dateObj.getTime(),E=t.parseDate(t.selectedDates[0],void 0,!0).getTime(),$=Math.min(v,t.selectedDates[0].getTime()),Y=Math.max(v,t.selectedDates[0].getTime()),I=!1,te=0,Q=0;for(let oe=$;oe<Y;oe+=Ju.DAY)Ge(new Date(oe),!0)||(I=I||oe>$&&oe<Y,oe<E&&(!te||oe>te)?te=oe:oe>E&&(!Q||oe<Q)&&(Q=oe));for(let oe=0;oe<t.config.showMonths;oe++){let se=t.daysContainer.children[oe];for(let he=0,Ie=se.children.length;he<Ie;he++){let De=se.children[he],Ze=De.dateObj.getTime(),Lt=te>0&&Ze<te||Q>0&&Ze>Q;if(Lt){De.classList.add("notAllowed"),["inRange","startRange","endRange"].forEach(Mt=>{De.classList.remove(Mt)});continue}else if(I&&!Lt)continue;["startRange","inRange","endRange","notAllowed"].forEach(Mt=>{De.classList.remove(Mt)}),m!==void 0&&(m.classList.add(v<=t.selectedDates[0].getTime()?"startRange":"endRange"),E<v&&Ze===E?De.classList.add("startRange"):E>v&&Ze===E&&De.classList.add("endRange"),Ze>=te&&(Q===0||Ze<=Q)&&Wu(Ze,E,v)&&De.classList.add("inRange"))}}}function Nt(){t.isOpen&&!t.config.static&&!t.config.inline&&et()}function vt(m,v=t._positionElement){if(t.isMobile===!0){if(m){m.preventDefault();let $=Ve(m);$&&$.blur()}t.mobileInput!==void 0&&(t.mobileInput.focus(),t.mobileInput.click()),we("onOpen");return}else if(t._input.disabled||t.config.inline)return;let E=t.isOpen;t.isOpen=!0,E||(t.calendarContainer.classList.add("open"),t._input.classList.add("active"),we("onOpen"),et(v)),t.config.enableTime===!0&&t.config.noCalendar===!0&&t.config.allowInput===!1&&(m===void 0||!t.timeContainer.contains(m.relatedTarget))&&setTimeout(()=>t.hourElement.select(),50)}function it(m){return v=>{let E=t.config[`_${m}Date`]=t.parseDate(v,t.config.dateFormat),$=t.config[`_${m==="min"?"max":"min"}Date`];E!==void 0&&(t[m==="min"?"minDateHasTime":"maxDateHasTime"]=E.getHours()>0||E.getMinutes()>0||E.getSeconds()>0),t.selectedDates&&(t.selectedDates=t.selectedDates.filter(Y=>Ge(Y)),!t.selectedDates.length&&m==="min"&&u(E),tt()),t.daysContainer&&(qt(),E!==void 0?t.currentYearElement[m]=E.getFullYear().toString():t.currentYearElement.removeAttribute(m),t.currentYearElement.disabled=!!$&&E!==void 0&&$.getFullYear()===E.getFullYear())}}function Bt(){let m=["wrap","weekNumbers","allowInput","allowInvalidPreload","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],v=Object.assign(Object.assign({},JSON.parse(JSON.stringify(e.dataset||{}))),a),E={};t.config.parseDate=v.parseDate,t.config.formatDate=v.formatDate,Object.defineProperty(t.config,"enable",{get:()=>t.config._enable,set:I=>{t.config._enable=La(I)}}),Object.defineProperty(t.config,"disable",{get:()=>t.config._disable,set:I=>{t.config._disable=La(I)}});let $=v.mode==="time";if(!v.dateFormat&&(v.enableTime||$)){let I=Me.defaultConfig.dateFormat||Qt.dateFormat;E.dateFormat=v.noCalendar||$?"H:i"+(v.enableSeconds?":S":""):I+" H:i"+(v.enableSeconds?":S":"")}if(v.altInput&&(v.enableTime||$)&&!v.altFormat){let I=Me.defaultConfig.altFormat||Qt.altFormat;E.altFormat=v.noCalendar||$?"h:i"+(v.enableSeconds?":S K":" K"):I+` h:i${v.enableSeconds?":S":""} K`}Object.defineProperty(t.config,"minDate",{get:()=>t.config._minDate,set:it("min")}),Object.defineProperty(t.config,"maxDate",{get:()=>t.config._maxDate,set:it("max")});let Y=I=>te=>{t.config[I==="min"?"_minTime":"_maxTime"]=t.parseDate(te,"H:i:S")};Object.defineProperty(t.config,"minTime",{get:()=>t.config._minTime,set:Y("min")}),Object.defineProperty(t.config,"maxTime",{get:()=>t.config._maxTime,set:Y("max")}),v.mode==="time"&&(t.config.noCalendar=!0,t.config.enableTime=!0),Object.assign(t.config,E,v);for(let I=0;I<m.length;I++)t.config[m[I]]=t.config[m[I]]===!0||t.config[m[I]]==="true";Gr.filter(I=>t.config[I]!==void 0).forEach(I=>{t.config[I]=qr(t.config[I]||[]).map(n)}),t.isMobile=!t.config.disableMobile&&!t.config.inline&&t.config.mode==="single"&&!t.config.disable.length&&!t.config.enable&&!t.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);for(let I=0;I<t.config.plugins.length;I++){let te=t.config.plugins[I](t)||{};for(let Q in te)Gr.indexOf(Q)>-1?t.config[Q]=qr(te[Q]).map(n).concat(t.config[Q]):typeof v[Q]=="undefined"&&(t.config[Q]=te[Q])}v.altInputClass||(t.config.altInputClass=pt().className+" "+t.config.altInputClass),we("onParseConfig")}function pt(){return t.config.wrap?e.querySelector("[data-input]"):e}function Tt(){typeof t.config.locale!="object"&&typeof Me.l10ns[t.config.locale]=="undefined"&&t.config.errorHandler(new Error(`flatpickr: invalid locale ${t.config.locale}`)),t.l10n=Object.assign(Object.assign({},Me.l10ns.default),typeof t.config.locale=="object"?t.config.locale:t.config.locale!=="default"?Me.l10ns[t.config.locale]:void 0),Ur.K=`(${t.l10n.amPM[0]}|${t.l10n.amPM[1]}|${t.l10n.amPM[0].toLowerCase()}|${t.l10n.amPM[1].toLowerCase()})`,Object.assign(Object.assign({},a),JSON.parse(JSON.stringify(e.dataset||{}))).time_24hr===void 0&&Me.defaultConfig.time_24hr===void 0&&(t.config.time_24hr=t.l10n.time_24hr),t.formatDate=fi(t),t.parseDate=Yr({config:t.config,l10n:t.l10n})}function et(m){if(typeof t.config.position=="function")return void t.config.position(t,m);if(t.calendarContainer===void 0)return;we("onPreCalendarPosition");let v=m||t._positionElement,E=Array.prototype.reduce.call(t.calendarContainer.children,($t,da)=>$t+da.offsetHeight,0),$=t.calendarContainer.offsetWidth,Y=t.config.position.split(" "),I=Y[0],te=Y.length>1?Y[1]:null,Q=v.getBoundingClientRect(),oe=window.innerHeight-Q.bottom,se=I==="above"||I!=="below"&&oe<E&&Q.top>E,he=window.pageYOffset+Q.top+(se?-E-2:v.offsetHeight+2);if(Pe(t.calendarContainer,"arrowTop",!se),Pe(t.calendarContainer,"arrowBottom",se),t.config.inline)return;let Ie=window.pageXOffset+Q.left,De=!1,Wt=!1;te==="center"?(Ie-=($-Q.width)/2,De=!0):te==="right"&&(Ie-=$-Q.width,Wt=!0),Pe(t.calendarContainer,"arrowLeft",!De&&!Wt),Pe(t.calendarContainer,"arrowCenter",De),Pe(t.calendarContainer,"arrowRight",Wt);let Ze=window.document.body.offsetWidth-(window.pageXOffset+Q.right),Lt=Ie+$>window.document.body.offsetWidth,Mt=Ze+$>window.document.body.offsetWidth;if(Pe(t.calendarContainer,"rightMost",Lt),!t.config.static)if(t.calendarContainer.style.top=`${he}px`,!Lt)t.calendarContainer.style.left=`${Ie}px`,t.calendarContainer.style.right="auto";else if(!Mt)t.calendarContainer.style.left="auto",t.calendarContainer.style.right=`${Ze}px`;else{let $t=Gt();if($t===void 0)return;let da=window.document.body.offsetWidth,dr=Math.max(0,da/2-$/2),pr=".flatpickr-calendar.centerMost:before",fr=".flatpickr-calendar.centerMost:after",gr=$t.cssRules.length,hr=`{left:${Q.left}px;right:auto;}`;Pe(t.calendarContainer,"rightMost",!1),Pe(t.calendarContainer,"centerMost",!0),$t.insertRule(`${pr},${fr}${hr}`,gr),t.calendarContainer.style.left=`${dr}px`,t.calendarContainer.style.right="auto"}}function Gt(){let m=null;for(let v=0;v<document.styleSheets.length;v++){let E=document.styleSheets[v];try{E.cssRules}catch($){continue}m=E;break}return m??jt()}function jt(){let m=document.createElement("style");return document.head.appendChild(m),m.sheet}function qt(){t.config.noCalendar||t.isMobile||(P(),Yt(),z())}function ot(){t._input.focus(),window.navigator.userAgent.indexOf("MSIE")!==-1||navigator.msMaxTouchPoints!==void 0?setTimeout(t.close,0):t.close()}function Vt(m){m.preventDefault(),m.stopPropagation();let v=te=>te.classList&&te.classList.contains("flatpickr-day")&&!te.classList.contains("flatpickr-disabled")&&!te.classList.contains("notAllowed"),E=pi(Ve(m),v);if(E===void 0)return;let $=E,Y=t.latestSelectedDateObj=new Date($.dateObj.getTime()),I=(Y.getMonth()<t.currentMonth||Y.getMonth()>t.currentMonth+t.config.showMonths-1)&&t.config.mode!=="range";if(t.selectedDateElem=$,t.config.mode==="single")t.selectedDates=[Y];else if(t.config.mode==="multiple"){let te=Ut(Y);te?t.selectedDates.splice(parseInt(te),1):t.selectedDates.push(Y)}else t.config.mode==="range"&&(t.selectedDates.length===2&&t.clear(!1,!1),t.latestSelectedDateObj=Y,t.selectedDates.push(Y),Ue(Y,t.selectedDates[0],!0)!==0&&t.selectedDates.sort((te,Q)=>te.getTime()-Q.getTime()));if(p(),I){let te=t.currentYear!==Y.getFullYear();t.currentYear=Y.getFullYear(),t.currentMonth=Y.getMonth(),te&&(we("onYearChange"),P()),we("onMonthChange")}if(Yt(),z(),tt(),!I&&t.config.mode!=="range"&&t.config.showMonths===1?We($):t.selectedDateElem!==void 0&&t.hourElement===void 0&&t.selectedDateElem&&t.selectedDateElem.focus(),t.hourElement!==void 0&&t.hourElement!==void 0&&t.hourElement.focus(),t.config.closeOnSelect){let te=t.config.mode==="single"&&!t.config.enableTime,Q=t.config.mode==="range"&&t.selectedDates.length===2&&!t.config.enableTime;(te||Q)&&ot()}Z()}let lt={locale:[Tt,W],showMonths:[C,s,N],minDate:[ae],maxDate:[ae],clickOpens:[()=>{t.config.clickOpens===!0?(D(t._input,"focus",t.open),D(t._input,"click",t.open)):(t._input.removeEventListener("focus",t.open),t._input.removeEventListener("click",t.open))}]};function ar(m,v){if(m!==null&&typeof m=="object"){Object.assign(t.config,m);for(let E in m)lt[E]!==void 0&&lt[E].forEach($=>$())}else t.config[m]=v,lt[m]!==void 0?lt[m].forEach(E=>E()):Gr.indexOf(m)>-1&&(t.config[m]=qr(v));t.redraw(),tt(!0)}function ja(m,v){let E=[];if(m instanceof Array)E=m.map($=>t.parseDate($,v));else if(m instanceof Date||typeof m=="number")E=[t.parseDate(m,v)];else if(typeof m=="string")switch(t.config.mode){case"single":case"time":E=[t.parseDate(m,v)];break;case"multiple":E=m.split(t.config.conjunction).map($=>t.parseDate($,v));break;case"range":E=m.split(t.l10n.rangeSeparator).map($=>t.parseDate($,v));break}else t.config.errorHandler(new Error(`Invalid date supplied: ${JSON.stringify(m)}`));t.selectedDates=t.config.allowInvalidPreload?E:E.filter($=>$ instanceof Date&&Ge($,!1)),t.config.mode==="range"&&t.selectedDates.sort(($,Y)=>$.getTime()-Y.getTime())}function rr(m,v=!1,E=t.config.dateFormat){if(m!==0&&!m||m instanceof Array&&m.length===0)return t.clear(v);ja(m,E),t.latestSelectedDateObj=t.selectedDates[t.selectedDates.length-1],t.redraw(),ae(void 0,v),u(),t.selectedDates.length===0&&t.clear(!1),tt(v),v&&we("onChange")}function La(m){return m.slice().map(v=>typeof v=="string"||typeof v=="number"||v instanceof Date?t.parseDate(v,void 0,!0):v&&typeof v=="object"&&v.from&&v.to?{from:t.parseDate(v.from,void 0),to:t.parseDate(v.to,void 0)}:v).filter(v=>v)}function nr(){t.selectedDates=[],t.now=t.parseDate(t.config.now)||new Date;let m=t.config.defaultDate||((t.input.nodeName==="INPUT"||t.input.nodeName==="TEXTAREA")&&t.input.placeholder&&t.input.value===t.input.placeholder?null:t.input.value);m&&ja(m,t.config.dateFormat),t._initialDate=t.selectedDates.length>0?t.selectedDates[0]:t.config.minDate&&t.config.minDate.getTime()>t.now.getTime()?t.config.minDate:t.config.maxDate&&t.config.maxDate.getTime()<t.now.getTime()?t.config.maxDate:t.now,t.currentYear=t._initialDate.getFullYear(),t.currentMonth=t._initialDate.getMonth(),t.selectedDates.length>0&&(t.latestSelectedDateObj=t.selectedDates[0]),t.config.minTime!==void 0&&(t.config.minTime=t.parseDate(t.config.minTime,"H:i")),t.config.maxTime!==void 0&&(t.config.maxTime=t.parseDate(t.config.maxTime,"H:i")),t.minDateHasTime=!!t.config.minDate&&(t.config.minDate.getHours()>0||t.config.minDate.getMinutes()>0||t.config.minDate.getSeconds()>0),t.maxDateHasTime=!!t.config.maxDate&&(t.config.maxDate.getHours()>0||t.config.maxDate.getMinutes()>0||t.config.maxDate.getSeconds()>0)}function ir(){if(t.input=pt(),!t.input){t.config.errorHandler(new Error("Invalid input element specified"));return}t.input._type=t.input.type,t.input.type="text",t.input.classList.add("flatpickr-input"),t._input=t.input,t.config.altInput&&(t.altInput=ve(t.input.nodeName,t.config.altInputClass),t._input=t.altInput,t.altInput.placeholder=t.input.placeholder,t.altInput.disabled=t.input.disabled,t.altInput.required=t.input.required,t.altInput.tabIndex=t.input.tabIndex,t.altInput.type="text",t.input.setAttribute("type","hidden"),!t.config.static&&t.input.parentNode&&t.input.parentNode.insertBefore(t.altInput,t.input.nextSibling)),t.config.allowInput||t._input.setAttribute("readonly","readonly"),t._positionElement=t.config.positionElement||t._input}function or(){let m=t.config.enableTime?t.config.noCalendar?"time":"datetime-local":"date";t.mobileInput=ve("input",t.input.className+" flatpickr-mobile"),t.mobileInput.tabIndex=1,t.mobileInput.type=m,t.mobileInput.disabled=t.input.disabled,t.mobileInput.required=t.input.required,t.mobileInput.placeholder=t.input.placeholder,t.mobileFormatStr=m==="datetime-local"?"Y-m-d\\TH:i:S":m==="date"?"Y-m-d":"H:i:S",t.selectedDates.length>0&&(t.mobileInput.defaultValue=t.mobileInput.value=t.formatDate(t.selectedDates[0],t.mobileFormatStr)),t.config.minDate&&(t.mobileInput.min=t.formatDate(t.config.minDate,"Y-m-d")),t.config.maxDate&&(t.mobileInput.max=t.formatDate(t.config.maxDate,"Y-m-d")),t.input.getAttribute("step")&&(t.mobileInput.step=String(t.input.getAttribute("step"))),t.input.type="hidden",t.altInput!==void 0&&(t.altInput.type="hidden");try{t.input.parentNode&&t.input.parentNode.insertBefore(t.mobileInput,t.input.nextSibling)}catch(v){}D(t.mobileInput,"change",v=>{t.setDate(Ve(v).value,!1,t.mobileFormatStr),we("onChange"),we("onClose")})}function lr(m){if(t.isOpen===!0)return t.close();t.open(m)}function we(m,v){if(t.config===void 0)return;let E=t.config[m];if(E!==void 0&&E.length>0)for(let $=0;E[$]&&$<E.length;$++)E[$](t.selectedDates,t.input.value,t,v);m==="onChange"&&(t.input.dispatchEvent(ua("change")),t.input.dispatchEvent(ua("input")))}function ua(m){let v=document.createEvent("Event");return v.initEvent(m,!0,!0),v}function Ut(m){for(let v=0;v<t.selectedDates.length;v++)if(Ue(t.selectedDates[v],m)===0)return""+v;return!1}function sr(m){return t.config.mode!=="range"||t.selectedDates.length<2?!1:Ue(m,t.selectedDates[0])>=0&&Ue(m,t.selectedDates[1])<=0}function Yt(){t.config.noCalendar||t.isMobile||!t.monthNav||(t.yearElements.forEach((m,v)=>{let E=new Date(t.currentYear,t.currentMonth,1);E.setMonth(t.currentMonth+v),t.config.showMonths>1||t.config.monthSelectorType==="static"?t.monthElements[v].textContent=Ra(E.getMonth(),t.config.shorthandCurrentMonth,t.l10n)+" ":t.monthsDropdownContainer.value=E.getMonth().toString(),m.value=E.getFullYear().toString()}),t._hidePrevMonthArrow=t.config.minDate!==void 0&&(t.currentYear===t.config.minDate.getFullYear()?t.currentMonth<=t.config.minDate.getMonth():t.currentYear<t.config.minDate.getFullYear()),t._hideNextMonthArrow=t.config.maxDate!==void 0&&(t.currentYear===t.config.maxDate.getFullYear()?t.currentMonth+1>t.config.maxDate.getMonth():t.currentYear>t.config.maxDate.getFullYear()))}function Ma(m){return t.selectedDates.map(v=>t.formatDate(v,m)).filter((v,E,$)=>t.config.mode!=="range"||t.config.enableTime||$.indexOf(v)===E).join(t.config.mode!=="range"?t.config.conjunction:t.l10n.rangeSeparator)}function tt(m=!0){t.mobileInput!==void 0&&t.mobileFormatStr&&(t.mobileInput.value=t.latestSelectedDateObj!==void 0?t.formatDate(t.latestSelectedDateObj,t.mobileFormatStr):""),t.input.value=Ma(t.config.dateFormat),t.altInput!==void 0&&(t.altInput.value=Ma(t.config.altFormat)),m!==!1&&we("onValueUpdate")}function cr(m){let v=Ve(m),E=t.prevMonthNav.contains(v),$=t.nextMonthNav.contains(v);E||$?A(E?-1:1):t.yearElements.indexOf(v)>=0?v.select():v.classList.contains("arrowUp")?t.changeYear(t.currentYear+1):v.classList.contains("arrowDown")&&t.changeYear(t.currentYear-1)}function ur(m){m.preventDefault();let v=m.type==="keydown",E=Ve(m),$=E;t.amPM!==void 0&&E===t.amPM&&(t.amPM.textContent=t.l10n.amPM[Xe(t.amPM.textContent===t.l10n.amPM[0])]);let Y=parseFloat($.getAttribute("min")),I=parseFloat($.getAttribute("max")),te=parseFloat($.getAttribute("step")),Q=parseInt($.value,10),oe=m.delta||(v?m.which===38?1:-1:0),se=Q+te*oe;if(typeof $.value!="undefined"&&$.value.length===2){let he=$===t.hourElement,Ie=$===t.minuteElement;se<Y?(se=I+se+Xe(!he)+(Xe(he)&&Xe(!t.amPM)),Ie&&ie(void 0,-1,t.hourElement)):se>I&&(se=$===t.hourElement?se-I-Xe(!t.amPM):Y,Ie&&ie(void 0,1,t.hourElement)),t.amPM&&he&&(te===1?se+Q===23:Math.abs(se-Q)>te)&&(t.amPM.textContent=t.l10n.amPM[Xe(t.amPM.textContent===t.l10n.amPM[0])]),$.value=Ne(se)}}return i(),t}function zt(e,a){let t=Array.prototype.slice.call(e).filter(i=>i instanceof HTMLElement),r=[];for(let i=0;i<t.length;i++){let n=t[i];try{if(n.getAttribute("data-fp-omit")!==null)continue;n._flatpickr!==void 0&&(n._flatpickr.destroy(),n._flatpickr=void 0),n._flatpickr=Xu(n,a||{}),r.push(n._flatpickr)}catch(s){console.error(s)}}return r.length===1?r[0]:r}typeof HTMLElement!="undefined"&&typeof HTMLCollection!="undefined"&&typeof NodeList!="undefined"&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(e){return zt(this,e)},HTMLElement.prototype.flatpickr=function(e){return zt([this],e)});var Me=function(e,a){return typeof e=="string"?zt(window.document.querySelectorAll(e),a):e instanceof Node?zt([e],a):zt(e,a)};Me.defaultConfig={};Me.l10ns={en:Object.assign({},ba),default:Object.assign({},ba)};Me.localize=e=>{Me.l10ns.default=Object.assign(Object.assign({},Me.l10ns.default),e)};Me.setDefaults=e=>{Me.defaultConfig=Object.assign(Object.assign({},Me.defaultConfig),e)};Me.parseDate=Yr({});Me.formatDate=fi({});Me.compareDates=Ue;typeof jQuery!="undefined"&&typeof jQuery.fn!="undefined"&&(jQuery.fn.flatpickr=function(e){return zt(this,e)});Date.prototype.fp_incr=function(e){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+(typeof e=="string"?parseInt(e,10):e))};typeof window!="undefined"&&(window.flatpickr=Me);var gi=Me;var Ye=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function ea(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Ke(e,a,t){return t={path:a,exports:{},require:function(r,i){return Ku(r,i??t.path)}},e(t,t.exports),t.exports}function Ku(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var Qu=Ke(function(e,a){(function(t,r){r(a)})(Ye,function(t){var r=typeof window!="undefined"&&window.flatpickr!==void 0?window.flatpickr:{l10ns:{}},i={firstDayOfWeek:1,weekdays:{shorthand:["dim","lun","mar","mer","jeu","ven","sam"],longhand:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},months:{shorthand:["janv","fÃ©vr","mars","avr","mai","juin","juil","aoÃ»t","sept","oct","nov","dÃ©c"],longhand:["janvier","fÃ©vrier","mars","avril","mai","juin","juillet","aoÃ»t","septembre","octobre","novembre","dÃ©cembre"]},ordinal:function(s){return s>1?"":"er"},rangeSeparator:" au ",weekAbbreviation:"Sem",scrollTitle:"DÃ©filer pour augmenter la valeur",toggleTitle:"Cliquer pour basculer",time_24hr:!0};r.l10ns.fr=i;var n=r.l10ns;t.French=i,t.default=n,Object.defineProperty(t,"__esModule",{value:!0})})}),zu=ea(Qu),hi=zu;var ed=Ke(function(e,a){(function(t,r){r(a)})(Ye,function(t){var r=typeof window!="undefined"&&window.flatpickr!==void 0?window.flatpickr:{l10ns:{}},i={weekdays:{shorthand:["Nd","Pn","Wt","År","Cz","Pt","So"],longhand:["Niedziela","PoniedziaÅek","Wtorek","Åroda","Czwartek","PiÄtek","Sobota"]},months:{shorthand:["Sty","Lut","Mar","Kwi","Maj","Cze","Lip","Sie","Wrz","PaÅº","Lis","Gru"],longhand:["StyczeÅ","Luty","Marzec","KwiecieÅ","Maj","Czerwiec","Lipiec","SierpieÅ","WrzesieÅ","PaÅºdziernik","Listopad","GrudzieÅ"]},rangeSeparator:" do ",weekAbbreviation:"tydz.",scrollTitle:"PrzewiÅ, aby zwiÄkszyÄ",toggleTitle:"Kliknij, aby przeÅÄczyÄ",firstDayOfWeek:1,time_24hr:!0,ordinal:function(){return"."}};r.l10ns.pl=i;var n=r.l10ns;t.Polish=i,t.default=n,Object.defineProperty(t,"__esModule",{value:!0})})}),td=ea(ed),mi=td;function vi(e){let a={pl:mi.default.pl,fr:hi.default.fr};return gi(e.element,{locale:e.locale&&a[e.locale]||null,defaultDate:e.value,enableTime:e.enableTime||!1,time_24hr:!0,dateFormat:e.enableTime?"Y/m/j H:i":"Y/m/j",onClose:(t,r,i)=>{e.callback(r)}})}function bi(e){return Math.round(new Date(e).getTime()/1e3)}function Jr(e){if(!e)return;if(e=parseInt(e)?e:e.getValue(),isNaN(parseInt(e)))return" ";let a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],t=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],r=new Date(e*1e3),i=r.getFullYear(),n=a[r.getMonth()],s=r.getDate(),o=t[r.getDay()];return`${s} ${n} ${i}`}function wi(e){if(!e)return;if(e=parseInt(e)?e:e.getValue(),isNaN(parseInt(e)))return" ";let a=Jr(e),t=new Date(e*1e3),r="0"+t.getHours(),i="0"+t.getMinutes(),n="0"+t.getSeconds();return`${a}, ${r.substr(-2)}:${i.substr(-2)}`}var ad=Ke(function(e,a){(function(t,r){e.exports=r()})(Ye,function(){for(var t=function(l,d,g){return d===void 0&&(d=0),g===void 0&&(g=1),l<d?d:l>g?g:l},r=function(l){l._clipped=!1,l._unclipped=l.slice(0);for(var d=0;d<=3;d++)d<3?((l[d]<0||l[d]>255)&&(l._clipped=!0),l[d]=t(l[d],0,255)):d===3&&(l[d]=t(l[d],0,1));return l},i={},n=0,s=["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"];n<s.length;n+=1){var o=s[n];i["[object "+o+"]"]=o.toLowerCase()}var c=function(l){return i[Object.prototype.toString.call(l)]||"object"},f=function(l,d){return d===void 0&&(d=null),l.length>=3?Array.prototype.slice.call(l):c(l[0])=="object"&&d?d.split("").filter(function(g){return l[0][g]!==void 0}).map(function(g){return l[0][g]}):l[0]},p=function(l){if(l.length<2)return null;var d=l.length-1;return c(l[d])=="string"?l[d].toLowerCase():null},u=Math.PI,h={clip_rgb:r,limit:t,type:c,unpack:f,last:p,PI:u,TWOPI:u*2,PITHIRD:u/3,DEG2RAD:u/180,RAD2DEG:180/u},w={format:{},autodetect:[]},D=h.last,Z=h.clip_rgb,U=h.type,ae=function(){for(var d=[],g=arguments.length;g--;)d[g]=arguments[g];var b=this;if(U(d[0])==="object"&&d[0].constructor&&d[0].constructor===this.constructor)return d[0];var y=D(d),k=!1;if(!y){k=!0,w.sorted||(w.autodetect=w.autodetect.sort(function(H,R){return R.p-H.p}),w.sorted=!0);for(var _=0,j=w.autodetect;_<j.length;_+=1){var L=j[_];if(y=L.test.apply(L,d),y)break}}if(w.format[y]){var O=w.format[y].apply(null,k?d:d.slice(0,-1));b._rgb=Z(O)}else throw new Error("unknown format: "+d);b._rgb.length===3&&b._rgb.push(1)};ae.prototype.toString=function(){return U(this.hex)=="function"?this.hex():"["+this._rgb.join(",")+"]"};var F=ae,ie=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];return new(Function.prototype.bind.apply(ie.Color,[null].concat(l)))};ie.Color=F,ie.version="2.1.0";var J=ie,Te=h.unpack,We=Math.max,Qe=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];var g=Te(l,"rgb"),b=g[0],y=g[1],k=g[2];b=b/255,y=y/255,k=k/255;var _=1-We(b,We(y,k)),j=_<1?1/(1-_):0,L=(1-b-_)*j,O=(1-y-_)*j,H=(1-k-_)*j;return[L,O,H,_]},T=Qe,G=h.unpack,q=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];l=G(l,"cmyk");var g=l[0],b=l[1],y=l[2],k=l[3],_=l.length>4?l[4]:1;return k===1?[0,0,0,_]:[g>=1?0:255*(1-g)*(1-k),b>=1?0:255*(1-b)*(1-k),y>=1?0:255*(1-y)*(1-k),_]},z=q,P=h.unpack,S=h.type;F.prototype.cmyk=function(){return T(this._rgb)},J.cmyk=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];return new(Function.prototype.bind.apply(F,[null].concat(l,["cmyk"])))},w.format.cmyk=z,w.autodetect.push({p:2,test:function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];if(l=P(l,"cmyk"),S(l)==="array"&&l.length===4)return"cmyk"}});var C=h.unpack,M=h.last,V=function(l){return Math.round(l*100)/100},N=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];var g=C(l,"hsla"),b=M(l)||"lsa";return g[0]=V(g[0]||0),g[1]=V(g[1]*100)+"%",g[2]=V(g[2]*100)+"%",b==="hsla"||g.length>3&&g[3]<1?(g[3]=g.length>3?g[3]:1,b="hsla"):g.length=3,b+"("+g.join(",")+")"},W=N,x=h.unpack,A=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];l=x(l,"rgba");var g=l[0],b=l[1],y=l[2];g/=255,b/=255,y/=255;var k=Math.min(g,b,y),_=Math.max(g,b,y),j=(_+k)/2,L,O;return _===k?(L=0,O=Number.NaN):L=j<.5?(_-k)/(_+k):(_-k)/(2-_-k),g==_?O=(b-y)/(_-k):b==_?O=2+(y-g)/(_-k):y==_&&(O=4+(g-b)/(_-k)),O*=60,O<0&&(O+=360),l.length>3&&l[3]!==void 0?[O,L,j,l[3]]:[O,L,j]},ee=A,ue=h.unpack,ge=h.last,be=Math.round,$e=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];var g=ue(l,"rgba"),b=ge(l)||"rgb";return b.substr(0,3)=="hsl"?W(ee(g),b):(g[0]=be(g[0]),g[1]=be(g[1]),g[2]=be(g[2]),(b==="rgba"||g.length>3&&g[3]<1)&&(g[3]=g.length>3?g[3]:1,b="rgba"),b+"("+g.slice(0,b==="rgb"?3:4).join(",")+")")},mt=$e,Ge=h.unpack,Je=Math.round,ca=function(){for(var l,d=[],g=arguments.length;g--;)d[g]=arguments[g];d=Ge(d,"hsl");var b=d[0],y=d[1],k=d[2],_,j,L;if(y===0)_=j=L=k*255;else{var O=[0,0,0],H=[0,0,0],R=k<.5?k*(1+y):k+y-k*y,K=2*k-R,X=b/360;O[0]=X+1/3,O[1]=X,O[2]=X-1/3;for(var ne=0;ne<3;ne++)O[ne]<0&&(O[ne]+=1),O[ne]>1&&(O[ne]-=1),6*O[ne]<1?H[ne]=K+(R-K)*6*O[ne]:2*O[ne]<1?H[ne]=R:3*O[ne]<2?H[ne]=K+(R-K)*(2/3-O[ne])*6:H[ne]=K;l=[Je(H[0]*255),Je(H[1]*255),Je(H[2]*255)],_=l[0],j=l[1],L=l[2]}return d.length>3?[_,j,L,d[3]]:[_,j,L,1]},dt=ca,ze=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,Nt=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,vt=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,it=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,Bt=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,pt=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,Tt=Math.round,et=function(l){l=l.toLowerCase().trim();var d;if(w.format.named)try{return w.format.named(l)}catch(ne){}if(d=l.match(ze)){for(var g=d.slice(1,4),b=0;b<3;b++)g[b]=+g[b];return g[3]=1,g}if(d=l.match(Nt)){for(var y=d.slice(1,5),k=0;k<4;k++)y[k]=+y[k];return y}if(d=l.match(vt)){for(var _=d.slice(1,4),j=0;j<3;j++)_[j]=Tt(_[j]*2.55);return _[3]=1,_}if(d=l.match(it)){for(var L=d.slice(1,5),O=0;O<3;O++)L[O]=Tt(L[O]*2.55);return L[3]=+L[3],L}if(d=l.match(Bt)){var H=d.slice(1,4);H[1]*=.01,H[2]*=.01;var R=dt(H);return R[3]=1,R}if(d=l.match(pt)){var K=d.slice(1,4);K[1]*=.01,K[2]*=.01;var X=dt(K);return X[3]=+d[4],X}};et.test=function(l){return ze.test(l)||Nt.test(l)||vt.test(l)||it.test(l)||Bt.test(l)||pt.test(l)};var Gt=et,jt=h.type;F.prototype.css=function(l){return mt(this._rgb,l)},J.css=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];return new(Function.prototype.bind.apply(F,[null].concat(l,["css"])))},w.format.css=Gt,w.autodetect.push({p:5,test:function(l){for(var d=[],g=arguments.length-1;g-- >0;)d[g]=arguments[g+1];if(!d.length&&jt(l)==="string"&&Gt.test(l))return"css"}});var qt=h.unpack;w.format.gl=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];var g=qt(l,"rgba");return g[0]*=255,g[1]*=255,g[2]*=255,g},J.gl=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];return new(Function.prototype.bind.apply(F,[null].concat(l,["gl"])))},F.prototype.gl=function(){var l=this._rgb;return[l[0]/255,l[1]/255,l[2]/255,l[3]]};var ot=h.unpack,Vt=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];var g=ot(l,"rgb"),b=g[0],y=g[1],k=g[2],_=Math.min(b,y,k),j=Math.max(b,y,k),L=j-_,O=L*100/255,H=_/(255-L)*100,R;return L===0?R=Number.NaN:(b===j&&(R=(y-k)/L),y===j&&(R=2+(k-b)/L),k===j&&(R=4+(b-y)/L),R*=60,R<0&&(R+=360)),[R,O,H]},lt=Vt,ar=h.unpack,ja=Math.floor,rr=function(){for(var l,d,g,b,y,k,_=[],j=arguments.length;j--;)_[j]=arguments[j];_=ar(_,"hcg");var L=_[0],O=_[1],H=_[2],R,K,X;H=H*255;var ne=O*255;if(O===0)R=K=X=H;else{L===360&&(L=0),L>360&&(L-=360),L<0&&(L+=360),L/=60;var de=ja(L),le=L-de,me=H*(1-O),ke=me+ne*(1-le),Oe=me+ne*le,Ae=me+ne;switch(de){case 0:l=[Ae,Oe,me],R=l[0],K=l[1],X=l[2];break;case 1:d=[ke,Ae,me],R=d[0],K=d[1],X=d[2];break;case 2:g=[me,Ae,Oe],R=g[0],K=g[1],X=g[2];break;case 3:b=[me,ke,Ae],R=b[0],K=b[1],X=b[2];break;case 4:y=[Oe,me,Ae],R=y[0],K=y[1],X=y[2];break;case 5:k=[Ae,me,ke],R=k[0],K=k[1],X=k[2];break}}return[R,K,X,_.length>3?_[3]:1]},La=rr,nr=h.unpack,ir=h.type;F.prototype.hcg=function(){return lt(this._rgb)},J.hcg=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];return new(Function.prototype.bind.apply(F,[null].concat(l,["hcg"])))},w.format.hcg=La,w.autodetect.push({p:1,test:function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];if(l=nr(l,"hcg"),ir(l)==="array"&&l.length===3)return"hcg"}});var or=h.unpack,lr=h.last,we=Math.round,ua=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];var g=or(l,"rgba"),b=g[0],y=g[1],k=g[2],_=g[3],j=lr(l)||"auto";_===void 0&&(_=1),j==="auto"&&(j=_<1?"rgba":"rgb"),b=we(b),y=we(y),k=we(k);var L=b<<16|y<<8|k,O="000000"+L.toString(16);O=O.substr(O.length-6);var H="0"+we(_*255).toString(16);switch(H=H.substr(H.length-2),j.toLowerCase()){case"rgba":return"#"+O+H;case"argb":return"#"+H+O;default:return"#"+O}},Ut=ua,sr=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,Yt=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,Ma=function(l){if(l.match(sr)){(l.length===4||l.length===7)&&(l=l.substr(1)),l.length===3&&(l=l.split(""),l=l[0]+l[0]+l[1]+l[1]+l[2]+l[2]);var d=parseInt(l,16),g=d>>16,b=d>>8&255,y=d&255;return[g,b,y,1]}if(l.match(Yt)){(l.length===5||l.length===9)&&(l=l.substr(1)),l.length===4&&(l=l.split(""),l=l[0]+l[0]+l[1]+l[1]+l[2]+l[2]+l[3]+l[3]);var k=parseInt(l,16),_=k>>24&255,j=k>>16&255,L=k>>8&255,O=Math.round((k&255)/255*100)/100;return[_,j,L,O]}throw new Error("unknown hex color: "+l)},tt=Ma,cr=h.type;F.prototype.hex=function(l){return Ut(this._rgb,l)},J.hex=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];return new(Function.prototype.bind.apply(F,[null].concat(l,["hex"])))},w.format.hex=tt,w.autodetect.push({p:4,test:function(l){for(var d=[],g=arguments.length-1;g-- >0;)d[g]=arguments[g+1];if(!d.length&&cr(l)==="string"&&[3,4,5,6,7,8,9].indexOf(l.length)>=0)return"hex"}});var ur=h.unpack,m=h.TWOPI,v=Math.min,E=Math.sqrt,$=Math.acos,Y=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];var g=ur(l,"rgb"),b=g[0],y=g[1],k=g[2];b/=255,y/=255,k/=255;var _,j=v(b,y,k),L=(b+y+k)/3,O=L>0?1-j/L:0;return O===0?_=NaN:(_=(b-y+(b-k))/2,_/=E((b-y)*(b-y)+(b-k)*(y-k)),_=$(_),k>y&&(_=m-_),_/=m),[_*360,O,L]},I=Y,te=h.unpack,Q=h.limit,oe=h.TWOPI,se=h.PITHIRD,he=Math.cos,Ie=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];l=te(l,"hsi");var g=l[0],b=l[1],y=l[2],k,_,j;return isNaN(g)&&(g=0),isNaN(b)&&(b=0),g>360&&(g-=360),g<0&&(g+=360),g/=360,g<1/3?(j=(1-b)/3,k=(1+b*he(oe*g)/he(se-oe*g))/3,_=1-(j+k)):g<2/3?(g-=1/3,k=(1-b)/3,_=(1+b*he(oe*g)/he(se-oe*g))/3,j=1-(k+_)):(g-=2/3,_=(1-b)/3,j=(1+b*he(oe*g)/he(se-oe*g))/3,k=1-(_+j)),k=Q(y*k*3),_=Q(y*_*3),j=Q(y*j*3),[k*255,_*255,j*255,l.length>3?l[3]:1]},De=Ie,Wt=h.unpack,Ze=h.type;F.prototype.hsi=function(){return I(this._rgb)},J.hsi=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];return new(Function.prototype.bind.apply(F,[null].concat(l,["hsi"])))},w.format.hsi=De,w.autodetect.push({p:2,test:function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];if(l=Wt(l,"hsi"),Ze(l)==="array"&&l.length===3)return"hsi"}});var Lt=h.unpack,Mt=h.type;F.prototype.hsl=function(){return ee(this._rgb)},J.hsl=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];return new(Function.prototype.bind.apply(F,[null].concat(l,["hsl"])))},w.format.hsl=dt,w.autodetect.push({p:2,test:function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];if(l=Lt(l,"hsl"),Mt(l)==="array"&&l.length===3)return"hsl"}});var $t=h.unpack,da=Math.min,dr=Math.max,pr=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];l=$t(l,"rgb");var g=l[0],b=l[1],y=l[2],k=da(g,b,y),_=dr(g,b,y),j=_-k,L,O,H;return H=_/255,_===0?(L=Number.NaN,O=0):(O=j/_,g===_&&(L=(b-y)/j),b===_&&(L=2+(y-g)/j),y===_&&(L=4+(g-b)/j),L*=60,L<0&&(L+=360)),[L,O,H]},fr=pr,gr=h.unpack,hr=Math.floor,ps=function(){for(var l,d,g,b,y,k,_=[],j=arguments.length;j--;)_[j]=arguments[j];_=gr(_,"hsv");var L=_[0],O=_[1],H=_[2],R,K,X;if(H*=255,O===0)R=K=X=H;else{L===360&&(L=0),L>360&&(L-=360),L<0&&(L+=360),L/=60;var ne=hr(L),de=L-ne,le=H*(1-O),me=H*(1-O*de),ke=H*(1-O*(1-de));switch(ne){case 0:l=[H,ke,le],R=l[0],K=l[1],X=l[2];break;case 1:d=[me,H,le],R=d[0],K=d[1],X=d[2];break;case 2:g=[le,H,ke],R=g[0],K=g[1],X=g[2];break;case 3:b=[le,me,H],R=b[0],K=b[1],X=b[2];break;case 4:y=[ke,le,H],R=y[0],K=y[1],X=y[2];break;case 5:k=[H,le,me],R=k[0],K=k[1],X=k[2];break}}return[R,K,X,_.length>3?_[3]:1]},fs=ps,gs=h.unpack,hs=h.type;F.prototype.hsv=function(){return fr(this._rgb)},J.hsv=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];return new(Function.prototype.bind.apply(F,[null].concat(l,["hsv"])))},w.format.hsv=fs,w.autodetect.push({p:2,test:function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];if(l=gs(l,"hsv"),hs(l)==="array"&&l.length===3)return"hsv"}});var xe={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452},ms=h.unpack,wn=Math.pow,vs=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];var g=ms(l,"rgb"),b=g[0],y=g[1],k=g[2],_=bs(b,y,k),j=_[0],L=_[1],O=_[2],H=116*L-16;return[H<0?0:H,500*(j-L),200*(L-O)]},mr=function(l){return(l/=255)<=.04045?l/12.92:wn((l+.055)/1.055,2.4)},vr=function(l){return l>xe.t3?wn(l,1/3):l/xe.t2+xe.t0},bs=function(l,d,g){l=mr(l),d=mr(d),g=mr(g);var b=vr((.4124564*l+.3575761*d+.1804375*g)/xe.Xn),y=vr((.2126729*l+.7151522*d+.072175*g)/xe.Yn),k=vr((.0193339*l+.119192*d+.9503041*g)/xe.Zn);return[b,y,k]},_n=vs,ws=h.unpack,_s=Math.pow,ys=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];l=ws(l,"lab");var g=l[0],b=l[1],y=l[2],k,_,j,L,O,H;return _=(g+16)/116,k=isNaN(b)?_:_+b/500,j=isNaN(y)?_:_-y/200,_=xe.Yn*wr(_),k=xe.Xn*wr(k),j=xe.Zn*wr(j),L=br(3.2404542*k-1.5371385*_-.4985314*j),O=br(-.969266*k+1.8760108*_+.041556*j),H=br(.0556434*k-.2040259*_+1.0572252*j),[L,O,H,l.length>3?l[3]:1]},br=function(l){return 255*(l<=.00304?12.92*l:1.055*_s(l,1/2.4)-.055)},wr=function(l){return l>xe.t1?l*l*l:xe.t2*(l-xe.t0)},yn=ys,ks=h.unpack,Cs=h.type;F.prototype.lab=function(){return _n(this._rgb)},J.lab=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];return new(Function.prototype.bind.apply(F,[null].concat(l,["lab"])))},w.format.lab=yn,w.autodetect.push({p:2,test:function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];if(l=ks(l,"lab"),Cs(l)==="array"&&l.length===3)return"lab"}});var Ss=h.unpack,Es=h.RAD2DEG,Ts=Math.sqrt,js=Math.atan2,Ls=Math.round,Ms=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];var g=Ss(l,"lab"),b=g[0],y=g[1],k=g[2],_=Ts(y*y+k*k),j=(js(k,y)*Es+360)%360;return Ls(_*1e4)===0&&(j=Number.NaN),[b,_,j]},$s=Ms,Fs=h.unpack,Ds=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];var g=Fs(l,"rgb"),b=g[0],y=g[1],k=g[2],_=_n(b,y,k),j=_[0],L=_[1],O=_[2];return $s(j,L,O)},kn=Ds,Os=h.unpack,As=h.DEG2RAD,Ps=Math.sin,Is=Math.cos,xs=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];var g=Os(l,"lch"),b=g[0],y=g[1],k=g[2];return isNaN(k)&&(k=0),k=k*As,[b,Is(k)*y,Ps(k)*y]},Rs=xs,Hs=h.unpack,Ns=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];l=Hs(l,"lch");var g=l[0],b=l[1],y=l[2],k=Rs(g,b,y),_=k[0],j=k[1],L=k[2],O=yn(_,j,L),H=O[0],R=O[1],K=O[2];return[H,R,K,l.length>3?l[3]:1]},Cn=Ns,Bs=h.unpack,Gs=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];var g=Bs(l,"hcl").reverse();return Cn.apply(void 0,g)},qs=Gs,Vs=h.unpack,Us=h.type;F.prototype.lch=function(){return kn(this._rgb)},F.prototype.hcl=function(){return kn(this._rgb).reverse()},J.lch=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];return new(Function.prototype.bind.apply(F,[null].concat(l,["lch"])))},J.hcl=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];return new(Function.prototype.bind.apply(F,[null].concat(l,["hcl"])))},w.format.lch=Cn,w.format.hcl=qs,["lch","hcl"].forEach(function(l){return w.autodetect.push({p:2,test:function(){for(var d=[],g=arguments.length;g--;)d[g]=arguments[g];if(d=Vs(d,l),Us(d)==="array"&&d.length===3)return l}})});var Ys={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},Jt=Ys,Ws=h.type;F.prototype.name=function(){for(var l=Ut(this._rgb,"rgb"),d=0,g=Object.keys(Jt);d<g.length;d+=1){var b=g[d];if(Jt[b]===l)return b.toLowerCase()}return l},w.format.named=function(l){if(l=l.toLowerCase(),Jt[l])return tt(Jt[l]);throw new Error("unknown color name: "+l)},w.autodetect.push({p:5,test:function(l){for(var d=[],g=arguments.length-1;g-- >0;)d[g]=arguments[g+1];if(!d.length&&Ws(l)==="string"&&Jt[l.toLowerCase()])return"named"}});var Js=h.unpack,Zs=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];var g=Js(l,"rgb"),b=g[0],y=g[1],k=g[2];return(b<<16)+(y<<8)+k},Xs=Zs,Ks=h.type,Qs=function(l){if(Ks(l)=="number"&&l>=0&&l<=16777215){var d=l>>16,g=l>>8&255,b=l&255;return[d,g,b,1]}throw new Error("unknown num color: "+l)},zs=Qs,ec=h.type;F.prototype.num=function(){return Xs(this._rgb)},J.num=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];return new(Function.prototype.bind.apply(F,[null].concat(l,["num"])))},w.format.num=zs,w.autodetect.push({p:5,test:function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];if(l.length===1&&ec(l[0])==="number"&&l[0]>=0&&l[0]<=16777215)return"num"}});var Sn=h.unpack,En=h.type,Tn=Math.round;F.prototype.rgb=function(l){return l===void 0&&(l=!0),l===!1?this._rgb.slice(0,3):this._rgb.slice(0,3).map(Tn)},F.prototype.rgba=function(l){return l===void 0&&(l=!0),this._rgb.slice(0,4).map(function(d,g){return g<3?l===!1?d:Tn(d):d})},J.rgb=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];return new(Function.prototype.bind.apply(F,[null].concat(l,["rgb"])))},w.format.rgb=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];var g=Sn(l,"rgba");return g[3]===void 0&&(g[3]=1),g},w.autodetect.push({p:3,test:function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];if(l=Sn(l,"rgba"),En(l)==="array"&&(l.length===3||l.length===4&&En(l[3])=="number"&&l[3]>=0&&l[3]<=1))return"rgb"}});var $a=Math.log,tc=function(l){var d=l/100,g,b,y;return d<66?(g=255,b=-155.25485562709179-.44596950469579133*(b=d-2)+104.49216199393888*$a(b),y=d<20?0:-254.76935184120902+.8274096064007395*(y=d-10)+115.67994401066147*$a(y)):(g=351.97690566805693+.114206453784165*(g=d-55)-40.25366309332127*$a(g),b=325.4494125711974+.07943456536662342*(b=d-50)-28.0852963507957*$a(b),y=255),[g,b,y,1]},jn=tc,ac=h.unpack,rc=Math.round,nc=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];for(var g=ac(l,"rgb"),b=g[0],y=g[2],k=1e3,_=4e4,j=.4,L;_-k>j;){L=(_+k)*.5;var O=jn(L);O[2]/O[0]>=y/b?_=L:k=L}return rc(L)},ic=nc;F.prototype.temp=F.prototype.kelvin=F.prototype.temperature=function(){return ic(this._rgb)},J.temp=J.kelvin=J.temperature=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];return new(Function.prototype.bind.apply(F,[null].concat(l,["temp"])))},w.format.temp=w.format.kelvin=w.format.temperature=jn;var oc=h.type;F.prototype.alpha=function(l,d){return d===void 0&&(d=!1),l!==void 0&&oc(l)==="number"?d?(this._rgb[3]=l,this):new F([this._rgb[0],this._rgb[1],this._rgb[2],l],"rgb"):this._rgb[3]},F.prototype.clipped=function(){return this._rgb._clipped||!1},F.prototype.darken=function(l){l===void 0&&(l=1);var d=this,g=d.lab();return g[0]-=xe.Kn*l,new F(g,"lab").alpha(d.alpha(),!0)},F.prototype.brighten=function(l){return l===void 0&&(l=1),this.darken(-l)},F.prototype.darker=F.prototype.darken,F.prototype.brighter=F.prototype.brighten,F.prototype.get=function(l){var d=l.split("."),g=d[0],b=d[1],y=this[g]();if(b){var k=g.indexOf(b);if(k>-1)return y[k];throw new Error("unknown channel "+b+" in mode "+g)}else return y};var lc=h.type,sc=Math.pow,cc=1e-7,uc=20;F.prototype.luminance=function(l){if(l!==void 0&&lc(l)==="number"){if(l===0)return new F([0,0,0,this._rgb[3]],"rgb");if(l===1)return new F([255,255,255,this._rgb[3]],"rgb");var d=this.luminance(),g="rgb",b=uc,y=function(_,j){var L=_.interpolate(j,.5,g),O=L.luminance();return Math.abs(l-O)<cc||!b--?L:O>l?y(_,L):y(L,j)},k=(d>l?y(new F([0,0,0]),this):y(this,new F([255,255,255]))).rgb();return new F(k.concat([this._rgb[3]]))}return dc.apply(void 0,this._rgb.slice(0,3))};var dc=function(l,d,g){return l=_r(l),d=_r(d),g=_r(g),.2126*l+.7152*d+.0722*g},_r=function(l){return l/=255,l<=.03928?l/12.92:sc((l+.055)/1.055,2.4)},Re={},Ln=h.type,Mn=function(l,d,g){g===void 0&&(g=.5);for(var b=[],y=arguments.length-3;y-- >0;)b[y]=arguments[y+3];var k=b[0]||"lrgb";if(!Re[k]&&!b.length&&(k=Object.keys(Re)[0]),!Re[k])throw new Error("interpolation mode "+k+" is not defined");return Ln(l)!=="object"&&(l=new F(l)),Ln(d)!=="object"&&(d=new F(d)),Re[k](l,d,g).alpha(l.alpha()+g*(d.alpha()-l.alpha()))};F.prototype.mix=F.prototype.interpolate=function(l,d){d===void 0&&(d=.5);for(var g=[],b=arguments.length-2;b-- >0;)g[b]=arguments[b+2];return Mn.apply(void 0,[this,l,d].concat(g))},F.prototype.premultiply=function(l){l===void 0&&(l=!1);var d=this._rgb,g=d[3];return l?(this._rgb=[d[0]*g,d[1]*g,d[2]*g,g],this):new F([d[0]*g,d[1]*g,d[2]*g,g],"rgb")},F.prototype.saturate=function(l){l===void 0&&(l=1);var d=this,g=d.lch();return g[1]+=xe.Kn*l,g[1]<0&&(g[1]=0),new F(g,"lch").alpha(d.alpha(),!0)},F.prototype.desaturate=function(l){return l===void 0&&(l=1),this.saturate(-l)};var $n=h.type;F.prototype.set=function(l,d,g){g===void 0&&(g=!1);var b=l.split("."),y=b[0],k=b[1],_=this[y]();if(k){var j=y.indexOf(k);if(j>-1){if($n(d)=="string")switch(d.charAt(0)){case"+":_[j]+=+d;break;case"-":_[j]+=+d;break;case"*":_[j]*=+d.substr(1);break;case"/":_[j]/=+d.substr(1);break;default:_[j]=+d}else if($n(d)==="number")_[j]=d;else throw new Error("unsupported value for Color.set");var L=new F(_,y);return g?(this._rgb=L._rgb,this):L}throw new Error("unknown channel "+k+" in mode "+y)}else return _};var pc=function(l,d,g){var b=l._rgb,y=d._rgb;return new F(b[0]+g*(y[0]-b[0]),b[1]+g*(y[1]-b[1]),b[2]+g*(y[2]-b[2]),"rgb")};Re.rgb=pc;var yr=Math.sqrt,Zt=Math.pow,fc=function(l,d,g){var b=l._rgb,y=b[0],k=b[1],_=b[2],j=d._rgb,L=j[0],O=j[1],H=j[2];return new F(yr(Zt(y,2)*(1-g)+Zt(L,2)*g),yr(Zt(k,2)*(1-g)+Zt(O,2)*g),yr(Zt(_,2)*(1-g)+Zt(H,2)*g),"rgb")};Re.lrgb=fc;var gc=function(l,d,g){var b=l.lab(),y=d.lab();return new F(b[0]+g*(y[0]-b[0]),b[1]+g*(y[1]-b[1]),b[2]+g*(y[2]-b[2]),"lab")};Re.lab=gc;var pa=function(l,d,g,b){var y,k,_,j;b==="hsl"?(_=l.hsl(),j=d.hsl()):b==="hsv"?(_=l.hsv(),j=d.hsv()):b==="hcg"?(_=l.hcg(),j=d.hcg()):b==="hsi"?(_=l.hsi(),j=d.hsi()):(b==="lch"||b==="hcl")&&(b="hcl",_=l.hcl(),j=d.hcl());var L,O,H,R,K,X;b.substr(0,1)==="h"&&(y=_,L=y[0],H=y[1],K=y[2],k=j,O=k[0],R=k[1],X=k[2]);var ne,de,le,me;return!isNaN(L)&&!isNaN(O)?(O>L&&O-L>180?me=O-(L+360):O<L&&L-O>180?me=O+360-L:me=O-L,de=L+g*me):isNaN(L)?isNaN(O)?de=Number.NaN:(de=O,(K==1||K==0)&&b!="hsv"&&(ne=R)):(de=L,(X==1||X==0)&&b!="hsv"&&(ne=H)),ne===void 0&&(ne=H+g*(R-H)),le=K+g*(X-K),new F([de,ne,le],b)},Fn=function(l,d,g){return pa(l,d,g,"lch")};Re.lch=Fn,Re.hcl=Fn;var hc=function(l,d,g){var b=l.num(),y=d.num();return new F(b+g*(y-b),"num")};Re.num=hc;var mc=function(l,d,g){return pa(l,d,g,"hcg")};Re.hcg=mc;var vc=function(l,d,g){return pa(l,d,g,"hsi")};Re.hsi=vc;var bc=function(l,d,g){return pa(l,d,g,"hsl")};Re.hsl=bc;var wc=function(l,d,g){return pa(l,d,g,"hsv")};Re.hsv=wc;var _c=h.clip_rgb,kr=Math.pow,Cr=Math.sqrt,Sr=Math.PI,Dn=Math.cos,On=Math.sin,yc=Math.atan2,kc=function(l,d,g){d===void 0&&(d="lrgb"),g===void 0&&(g=null);var b=l.length;g||(g=Array.from(new Array(b)).map(function(){return 1}));var y=b/g.reduce(function(de,le){return de+le});if(g.forEach(function(de,le){g[le]*=y}),l=l.map(function(de){return new F(de)}),d==="lrgb")return Cc(l,g);for(var k=l.shift(),_=k.get(d),j=[],L=0,O=0,H=0;H<_.length;H++)if(_[H]=(_[H]||0)*g[0],j.push(isNaN(_[H])?0:g[0]),d.charAt(H)==="h"&&!isNaN(_[H])){var R=_[H]/180*Sr;L+=Dn(R)*g[0],O+=On(R)*g[0]}var K=k.alpha()*g[0];l.forEach(function(de,le){var me=de.get(d);K+=de.alpha()*g[le+1];for(var ke=0;ke<_.length;ke++)if(!isNaN(me[ke]))if(j[ke]+=g[le+1],d.charAt(ke)==="h"){var Oe=me[ke]/180*Sr;L+=Dn(Oe)*g[le+1],O+=On(Oe)*g[le+1]}else _[ke]+=me[ke]*g[le+1]});for(var X=0;X<_.length;X++)if(d.charAt(X)==="h"){for(var ne=yc(O/j[X],L/j[X])/Sr*180;ne<0;)ne+=360;for(;ne>=360;)ne-=360;_[X]=ne}else _[X]=_[X]/j[X];return K/=b,new F(_,d).alpha(K>.99999?1:K,!0)},Cc=function(l,d){for(var g=l.length,b=[0,0,0,0],y=0;y<l.length;y++){var k=l[y],_=d[y]/g,j=k._rgb;b[0]+=kr(j[0],2)*_,b[1]+=kr(j[1],2)*_,b[2]+=kr(j[2],2)*_,b[3]+=j[3]*_}return b[0]=Cr(b[0]),b[1]=Cr(b[1]),b[2]=Cr(b[2]),b[3]>.9999999&&(b[3]=1),new F(_c(b))},Xt=h.type,Sc=Math.pow,Fa=function(l){var d="rgb",g=J("#ccc"),b=0,y=[0,1],k=[],_=[0,0],j=!1,L=[],O=!1,H=0,R=1,K=!1,X={},ne=!0,de=1,le=function(B){if(B=B||["#fff","#000"],B&&Xt(B)==="string"&&J.brewer&&J.brewer[B.toLowerCase()]&&(B=J.brewer[B.toLowerCase()]),Xt(B)==="array"){B.length===1&&(B=[B[0],B[0]]),B=B.slice(0);for(var re=0;re<B.length;re++)B[re]=J(B[re]);k.length=0;for(var pe=0;pe<B.length;pe++)k.push(pe/(B.length-1))}return qe(),L=B},me=function(B){if(j!=null){for(var re=j.length-1,pe=0;pe<re&&B>=j[pe];)pe++;return pe-1}return 0},ke=function(B){return B},Oe=function(B){return B},Ae=function(B,re){var pe,ce;if(re==null&&(re=!1),isNaN(B)||B===null)return g;if(re)ce=B;else if(j&&j.length>2){var He=me(B);ce=He/(j.length-2)}else R!==H?ce=(B-H)/(R-H):ce=1;ce=Oe(ce),re||(ce=ke(ce)),de!==1&&(ce=Sc(ce,de)),ce=_[0]+ce*(1-_[0]-_[1]),ce=Math.min(1,Math.max(0,ce));var je=Math.floor(ce*1e4);if(ne&&X[je])pe=X[je];else{if(Xt(L)==="array")for(var _e=0;_e<k.length;_e++){var ye=k[_e];if(ce<=ye){pe=L[_e];break}if(ce>=ye&&_e===k.length-1){pe=L[_e];break}if(ce>ye&&ce<k[_e+1]){ce=(ce-ye)/(k[_e+1]-ye),pe=J.interpolate(L[_e],L[_e+1],ce,d);break}}else Xt(L)==="function"&&(pe=L(ce));ne&&(X[je]=pe)}return pe},qe=function(){return X={}};le(l);var fe=function(B){var re=J(Ae(B));return O&&re[O]?re[O]():re};return fe.classes=function(B){if(B!=null){if(Xt(B)==="array")j=B,y=[B[0],B[B.length-1]];else{var re=J.analyze(y);B===0?j=[re.min,re.max]:j=J.limits(re,"e",B)}return fe}return j},fe.domain=function(B){if(!arguments.length)return y;H=B[0],R=B[B.length-1],k=[];var re=L.length;if(B.length===re&&H!==R)for(var pe=0,ce=Array.from(B);pe<ce.length;pe+=1){var He=ce[pe];k.push((He-H)/(R-H))}else{for(var je=0;je<re;je++)k.push(je/(re-1));if(B.length>2){var _e=B.map(function(Le,Ce){return Ce/(B.length-1)}),ye=B.map(function(Le){return(Le-H)/(R-H)});ye.every(function(Le,Ce){return _e[Ce]===Le})||(Oe=function(Le){if(Le<=0||Le>=1)return Le;for(var Ce=0;Le>=ye[Ce+1];)Ce++;var _t=(Le-ye[Ce])/(ye[Ce+1]-ye[Ce]),Kt=_e[Ce]+_t*(_e[Ce+1]-_e[Ce]);return Kt})}}return y=[H,R],fe},fe.mode=function(B){return arguments.length?(d=B,qe(),fe):d},fe.range=function(B,re){return le(B),fe},fe.out=function(B){return O=B,fe},fe.spread=function(B){return arguments.length?(b=B,fe):b},fe.correctLightness=function(B){return B==null&&(B=!0),K=B,qe(),K?ke=function(re){for(var pe=Ae(0,!0).lab()[0],ce=Ae(1,!0).lab()[0],He=pe>ce,je=Ae(re,!0).lab()[0],_e=pe+(ce-pe)*re,ye=je-_e,Le=0,Ce=1,_t=20;Math.abs(ye)>.01&&_t-- >0;)(function(){return He&&(ye*=-1),ye<0?(Le=re,re+=(Ce-re)*.5):(Ce=re,re+=(Le-re)*.5),je=Ae(re,!0).lab()[0],ye=je-_e})();return re}:ke=function(re){return re},fe},fe.padding=function(B){return B!=null?(Xt(B)==="number"&&(B=[B,B]),_=B,fe):_},fe.colors=function(B,re){arguments.length<2&&(re="hex");var pe=[];if(arguments.length===0)pe=L.slice(0);else if(B===1)pe=[fe(.5)];else if(B>1){var ce=y[0],He=y[1]-ce;pe=Ec(0,B,!1).map(function(Ce){return fe(ce+Ce/(B-1)*He)})}else{l=[];var je=[];if(j&&j.length>2)for(var _e=1,ye=j.length,Le=1<=ye;Le?_e<ye:_e>ye;Le?_e++:_e--)je.push((j[_e-1]+j[_e])*.5);else je=y;pe=je.map(function(Ce){return fe(Ce)})}return J[re]&&(pe=pe.map(function(Ce){return Ce[re]()})),pe},fe.cache=function(B){return B!=null?(ne=B,fe):ne},fe.gamma=function(B){return B!=null?(de=B,fe):de},fe.nodata=function(B){return B!=null?(g=J(B),fe):g},fe};function Ec(l,d,g){for(var b=[],y=l<d,k=g?y?d+1:d-1:d,_=l;y?_<k:_>k;y?_++:_--)b.push(_);return b}var Er=function(l){var d,g,b,y,k,_,j;if(l=l.map(function(R){return new F(R)}),l.length===2)d=l.map(function(R){return R.lab()}),k=d[0],_=d[1],y=function(R){var K=[0,1,2].map(function(X){return k[X]+R*(_[X]-k[X])});return new F(K,"lab")};else if(l.length===3)g=l.map(function(R){return R.lab()}),k=g[0],_=g[1],j=g[2],y=function(R){var K=[0,1,2].map(function(X){return(1-R)*(1-R)*k[X]+2*(1-R)*R*_[X]+R*R*j[X]});return new F(K,"lab")};else if(l.length===4){var L;b=l.map(function(R){return R.lab()}),k=b[0],_=b[1],j=b[2],L=b[3],y=function(R){var K=[0,1,2].map(function(X){return(1-R)*(1-R)*(1-R)*k[X]+3*(1-R)*(1-R)*R*_[X]+3*(1-R)*R*R*j[X]+R*R*R*L[X]});return new F(K,"lab")}}else if(l.length===5){var O=Er(l.slice(0,3)),H=Er(l.slice(2,5));y=function(R){return R<.5?O(R*2):H((R-.5)*2)}}return y},Tc=function(l){var d=Er(l);return d.scale=function(){return Fa(d)},d},at=function(l,d,g){if(!at[g])throw new Error("unknown blend mode "+g);return at[g](l,d)},bt=function(l){return function(d,g){var b=J(g).rgb(),y=J(d).rgb();return J.rgb(l(b,y))}},wt=function(l){return function(d,g){var b=[];return b[0]=l(d[0],g[0]),b[1]=l(d[1],g[1]),b[2]=l(d[2],g[2]),b}},jc=function(l){return l},Lc=function(l,d){return l*d/255},Mc=function(l,d){return l>d?d:l},$c=function(l,d){return l>d?l:d},Fc=function(l,d){return 255*(1-(1-l/255)*(1-d/255))},Dc=function(l,d){return d<128?2*l*d/255:255*(1-2*(1-l/255)*(1-d/255))},Oc=function(l,d){return 255*(1-(1-d/255)/(l/255))},Ac=function(l,d){return l===255?255:(l=255*(d/255)/(1-l/255),l>255?255:l)};at.normal=bt(wt(jc)),at.multiply=bt(wt(Lc)),at.screen=bt(wt(Fc)),at.overlay=bt(wt(Dc)),at.darken=bt(wt(Mc)),at.lighten=bt(wt($c)),at.dodge=bt(wt(Ac)),at.burn=bt(wt(Oc));for(var Pc=at,Tr=h.type,Ic=h.clip_rgb,xc=h.TWOPI,Rc=Math.pow,Hc=Math.sin,Nc=Math.cos,Bc=function(l,d,g,b,y){l===void 0&&(l=300),d===void 0&&(d=-1.5),g===void 0&&(g=1),b===void 0&&(b=1),y===void 0&&(y=[0,1]);var k=0,_;Tr(y)==="array"?_=y[1]-y[0]:(_=0,y=[y,y]);var j=function(L){var O=xc*((l+120)/360+d*L),H=Rc(y[0]+_*L,b),R=k!==0?g[0]+L*k:g,K=R*H*(1-H)/2,X=Nc(O),ne=Hc(O),de=H+K*(-.14861*X+1.78277*ne),le=H+K*(-.29227*X-.90649*ne),me=H+K*(1.97294*X);return J(Ic([de*255,le*255,me*255,1]))};return j.start=function(L){return L==null?l:(l=L,j)},j.rotations=function(L){return L==null?d:(d=L,j)},j.gamma=function(L){return L==null?b:(b=L,j)},j.hue=function(L){return L==null?g:(g=L,Tr(g)==="array"?(k=g[1]-g[0],k===0&&(g=g[1])):k=0,j)},j.lightness=function(L){return L==null?y:(Tr(L)==="array"?(y=L,_=L[1]-L[0]):(y=[L,L],_=0),j)},j.scale=function(){return J.scale(j)},j.hue(g),j},Gc="0123456789abcdef",qc=Math.floor,Vc=Math.random,Uc=function(){for(var l="#",d=0;d<6;d++)l+=Gc.charAt(qc(Vc()*16));return new F(l,"hex")},An=Math.log,Yc=Math.pow,Wc=Math.floor,Jc=Math.abs,Pn=function(l,d){d===void 0&&(d=null);var g={min:Number.MAX_VALUE,max:Number.MAX_VALUE*-1,sum:0,values:[],count:0};return c(l)==="object"&&(l=Object.values(l)),l.forEach(function(b){d&&c(b)==="object"&&(b=b[d]),b!=null&&!isNaN(b)&&(g.values.push(b),g.sum+=b,b<g.min&&(g.min=b),b>g.max&&(g.max=b),g.count+=1)}),g.domain=[g.min,g.max],g.limits=function(b,y){return In(g,b,y)},g},In=function(l,d,g){d===void 0&&(d="equal"),g===void 0&&(g=7),c(l)=="array"&&(l=Pn(l));var b=l.min,y=l.max,k=l.values.sort(function(Dr,Or){return Dr-Or});if(g===1)return[b,y];var _=[];if(d.substr(0,1)==="c"&&(_.push(b),_.push(y)),d.substr(0,1)==="e"){_.push(b);for(var j=1;j<g;j++)_.push(b+j/g*(y-b));_.push(y)}else if(d.substr(0,1)==="l"){if(b<=0)throw new Error("Logarithmic scales are only possible for values > 0");var L=Math.LOG10E*An(b),O=Math.LOG10E*An(y);_.push(b);for(var H=1;H<g;H++)_.push(Yc(10,L+H/g*(O-L)));_.push(y)}else if(d.substr(0,1)==="q"){_.push(b);for(var R=1;R<g;R++){var K=(k.length-1)*R/g,X=Wc(K);if(X===K)_.push(k[X]);else{var ne=K-X;_.push(k[X]*(1-ne)+k[X+1]*ne)}}_.push(y)}else if(d.substr(0,1)==="k"){var de,le=k.length,me=new Array(le),ke=new Array(g),Oe=!0,Ae=0,qe=null;qe=[],qe.push(b);for(var fe=1;fe<g;fe++)qe.push(b+fe/g*(y-b));for(qe.push(y);Oe;){for(var B=0;B<g;B++)ke[B]=0;for(var re=0;re<le;re++)for(var pe=k[re],ce=Number.MAX_VALUE,He=void 0,je=0;je<g;je++){var _e=Jc(qe[je]-pe);_e<ce&&(ce=_e,He=je),ke[He]++,me[re]=He}for(var ye=new Array(g),Le=0;Le<g;Le++)ye[Le]=null;for(var Ce=0;Ce<le;Ce++)de=me[Ce],ye[de]===null?ye[de]=k[Ce]:ye[de]+=k[Ce];for(var _t=0;_t<g;_t++)ye[_t]*=1/ke[_t];Oe=!1;for(var Kt=0;Kt<g;Kt++)if(ye[Kt]!==qe[Kt]){Oe=!0;break}qe=ye,Ae++,Ae>200&&(Oe=!1)}for(var fa={},Mr=0;Mr<g;Mr++)fa[Mr]=[];for(var Aa=0;Aa<le;Aa++)de=me[Aa],fa[de].push(k[Aa]);for(var Ft=[],ga=0;ga<g;ga++)Ft.push(fa[ga][0]),Ft.push(fa[ga][fa[ga].length-1]);Ft=Ft.sort(function(Dr,Or){return Dr-Or}),_.push(Ft[0]);for(var $r=1;$r<Ft.length;$r+=2){var Fr=Ft[$r];!isNaN(Fr)&&_.indexOf(Fr)===-1&&_.push(Fr)}}return _},xn={analyze:Pn,limits:In},Zc=function(l,d){l=new F(l),d=new F(d);var g=l.luminance(),b=d.luminance();return g>b?(g+.05)/(b+.05):(b+.05)/(g+.05)},Da=Math.sqrt,Xc=Math.atan2,Rn=Math.abs,Hn=Math.cos,jr=Math.PI,Kc=function(l,d,g,b){g===void 0&&(g=1),b===void 0&&(b=1),l=new F(l),d=new F(d);for(var y=Array.from(l.lab()),k=y[0],_=y[1],j=y[2],L=Array.from(d.lab()),O=L[0],H=L[1],R=L[2],K=Da(_*_+j*j),X=Da(H*H+R*R),ne=k<16?.511:.040975*k/(1+.01765*k),de=.0638*K/(1+.0131*K)+.638,le=K<1e-6?0:Xc(j,_)*180/jr;le<0;)le+=360;for(;le>=360;)le-=360;var me=le>=164&&le<=345?.56+Rn(.2*Hn(jr*(le+168)/180)):.36+Rn(.4*Hn(jr*(le+35)/180)),ke=K*K*K*K,Oe=Da(ke/(ke+1900)),Ae=de*(Oe*me+1-Oe),qe=k-O,fe=K-X,B=_-H,re=j-R,pe=B*B+re*re-fe*fe,ce=qe/(g*ne),He=fe/(b*de),je=Ae;return Da(ce*ce+He*He+pe/(je*je))},Qc=function(l,d,g){g===void 0&&(g="lab"),l=new F(l),d=new F(d);var b=l.get(g),y=d.get(g),k=0;for(var _ in b){var j=(b[_]||0)-(y[_]||0);k+=j*j}return Math.sqrt(k)},zc=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];try{return new(Function.prototype.bind.apply(F,[null].concat(l))),!0}catch(g){return!1}},eu={cool:function(){return Fa([J.hsl(180,1,.9),J.hsl(250,.7,.4)])},hot:function(){return Fa(["#000","#f00","#ff0","#fff"]).mode("rgb")}},Oa={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},Lr=0,Nn=Object.keys(Oa);Lr<Nn.length;Lr+=1){var Bn=Nn[Lr];Oa[Bn.toLowerCase()]=Oa[Bn]}var tu=Oa;J.average=kc,J.bezier=Tc,J.blend=Pc,J.cubehelix=Bc,J.mix=J.interpolate=Mn,J.random=Uc,J.scale=Fa,J.analyze=xn.analyze,J.contrast=Zc,J.deltaE=Kc,J.distance=Qc,J.limits=xn.limits,J.valid=zc,J.scales=eu,J.colors=Jt,J.brewer=tu;var au=J;return au})}),_i=ad;var rd=[62,-1,-1,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,63,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],nd=1;var rt=typeof BigInt!="undefined"?BigInt:Number;function yi(e){let a=id(e),t=od(a[0],a[1]),r=10**t.precision,i=10**t.thirdDimPrecision,{thirdDim:n}=t,s=0,o=0,c=0,f=[],p=2;for(;p<a.length;){let u=Zr(a[p])/r,h=Zr(a[p+1])/r;s+=u,o+=h,n?(c+=Zr(a[p+2])/i,f.push([s,o,c]),p+=3):(f.push([s,o]),p+=2)}if(p!==a.length)throw new Error("Invalid encoding. Premature ending reached");return{...t,polyline:f}}function ld(e){let a=e.charCodeAt(0);return rd[a-45]}function id(e){let a=rt(0),t=rt(0),r=[];if(e.split("").forEach(i=>{let n=rt(ld(i));a|=(n&rt(31))<<t,(n&rt(32))===rt(0)?(r.push(a),a=rt(0),t=rt(0)):t+=rt(5)}),t>0)throw new Error("Invalid encoding");return r}function od(e,a){if(+e.toString()!==nd)throw new Error("Invalid format version");let t=+a.toString(),r=t&15,i=t>>4&7,n=t>>7&15;return{precision:r,thirdDim:i,thirdDimPrecision:n}}function Zr(e){let a=e;return a&rt(1)&&(a=~a),a>>=rt(1),+a.toString()}var sd=Ke(function(e,a){(function(t,r){e.exports=r()})(typeof self!="undefined"?self:Ye,function(){return function(t){var r={};function i(n){if(r[n])return r[n].exports;var s=r[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=t,i.c=r,i.d=function(n,s,o){i.o(n,s)||Object.defineProperty(n,s,{enumerable:!0,get:o})},i.r=function(n){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},i.t=function(n,s){if(1&s&&(n=i(n)),8&s||4&s&&typeof n=="object"&&n&&n.__esModule)return n;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:n}),2&s&&typeof n!="string")for(var c in n)i.d(o,c,function(f){return n[f]}.bind(null,c));return o},i.n=function(n){var s=n&&n.__esModule?function(){return n.default}:function(){return n};return i.d(s,"a",s),s},i.o=function(n,s){return Object.prototype.hasOwnProperty.call(n,s)},i.p="",i(i.s=1)}([function(t,r,i){var n=i(3);function s(o){return n(o)===!0&&Object.prototype.toString.call(o)==="[object Object]"}t.exports=function(o){var c,f;return s(o)!==!1&&typeof(c=o.constructor)=="function"&&s(f=c.prototype)!==!1&&f.hasOwnProperty("isPrototypeOf")!==!1}},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.VERSION=r.PALETTE_MATERIAL_CHROME=r.PALETTE_MATERIAL_500=r.COLOR_NAMES=r.getLuminance=r.intToRgb=r.rgbToInt=r.rgbToHsv=r.rgbToHsl=r.hslToRgb=r.rgbToHex=r.parseColor=r.parseColorToHsla=r.parseColorToHsl=r.parseColorToRgba=r.parseColorToRgb=r.from=r.createPicker=void 0;var n=function(){function P(S,C){for(var M=0;M<C.length;M++){var V=C[M];V.enumerable=V.enumerable||!1,V.configurable=!0,"value"in V&&(V.writable=!0),Object.defineProperty(S,V.key,V)}}return function(S,C,M){return C&&P(S.prototype,C),M&&P(S,M),S}}(),s=function(P,S){if(Array.isArray(P))return P;if(Symbol.iterator in Object(P))return function(C,M){var V=[],N=!0,W=!1,x=void 0;try{for(var A,ee=C[Symbol.iterator]();!(N=(A=ee.next()).done)&&(V.push(A.value),!M||V.length!==M);N=!0);}catch(ue){W=!0,x=ue}finally{try{!N&&ee.return&&ee.return()}finally{if(W)throw x}}return V}(P,S);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=i(2),c=p(i(0)),f=p(i(4));function p(P){return P&&P.__esModule?P:{default:P}}function u(P,S){if(!(P instanceof S))throw new TypeError("Cannot call a class as a function")}function h(P){if(Array.isArray(P)){for(var S=0,C=Array(P.length);S<P.length;S++)C[S]=P[S];return C}return Array.from(P)}var w=typeof window!="undefined"&&window.navigator.userAgent.indexOf("Edge")>-1,D=typeof window!="undefined"&&window.navigator.userAgent.indexOf("rv:")>-1,Z={id:null,attachTo:"body",showHSL:!0,showRGB:!0,showHEX:!0,showAlpha:!1,color:"#ff0000",palette:null,paletteEditable:!1,useAlphaInPalette:"auto",slBarSize:[232,150],hueBarSize:[150,11],alphaBarSize:[150,11]},U="COLOR",ae="RGBA_USER",F="HSLA_USER";function ie(P,S,C){return P?P instanceof HTMLElement?P:P instanceof NodeList?P[0]:typeof P=="string"?document.querySelector(P):P.jquery?P.get(0):C?S:null:S}function J(P){var S=P.getContext("2d"),C=+P.width,M=+P.height,V=S.createLinearGradient(1,1,1,M-1);return V.addColorStop(0,"white"),V.addColorStop(1,"black"),{setHue:function(N){var W=S.createLinearGradient(1,0,C-1,0);W.addColorStop(0,"hsla("+N+", 100%, 50%, 0)"),W.addColorStop(1,"hsla("+N+", 100%, 50%, 1)"),S.fillStyle=V,S.fillRect(0,0,C,M),S.fillStyle=W,S.globalCompositeOperation="multiply",S.fillRect(0,0,C,M),S.globalCompositeOperation="source-over"},grabColor:function(N,W){return S.getImageData(N,W,1,1).data},findColor:function(N,W,x){var A=(0,o.rgbToHsv)(N,W,x),ee=s(A,3),ue=ee[1],ge=ee[2];return[ue*C,M-ge*M]}}}function Te(P,S,C){return P===null?S:/^\s*$/.test(P)?C:!!/true|yes|1/i.test(P)||!/false|no|0/i.test(P)&&S}function We(P,S,C){if(P===null)return S;if(/^\s*$/.test(P))return C;var M=P.split(",").map(Number);return M.length===2&&M[0]&&M[1]?M:S}var Qe=function(){function P(S,C){if(u(this,P),C?(S=ie(S),this.options=Object.assign({},Z,C)):S&&(0,c.default)(S)?(this.options=Object.assign({},Z,S),S=ie(this.options.attachTo)):(this.options=Object.assign({},Z),S=ie((0,o.nvl)(S,this.options.attachTo))),!S)throw new Error("Container not found: "+this.options.attachTo);(function(N,W){var x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"acp-";if(W.hasAttribute(x+"show-hsl")&&(N.showHSL=Te(W.getAttribute(x+"show-hsl"),Z.showHSL,!0)),W.hasAttribute(x+"show-rgb")&&(N.showRGB=Te(W.getAttribute(x+"show-rgb"),Z.showRGB,!0)),W.hasAttribute(x+"show-hex")&&(N.showHEX=Te(W.getAttribute(x+"show-hex"),Z.showHEX,!0)),W.hasAttribute(x+"show-alpha")&&(N.showAlpha=Te(W.getAttribute(x+"show-alpha"),Z.showAlpha,!0)),W.hasAttribute(x+"palette-editable")&&(N.paletteEditable=Te(W.getAttribute(x+"palette-editable"),Z.paletteEditable,!0)),W.hasAttribute(x+"sl-bar-size")&&(N.slBarSize=We(W.getAttribute(x+"sl-bar-size"),Z.slBarSize,[232,150])),W.hasAttribute(x+"hue-bar-size")&&(N.hueBarSize=We(W.getAttribute(x+"hue-bar-size"),Z.hueBarSize,[150,11]),N.alphaBarSize=N.hueBarSize),W.hasAttribute(x+"palette")){var A=W.getAttribute(x+"palette");switch(A){case"PALETTE_MATERIAL_500":N.palette=o.PALETTE_MATERIAL_500;break;case"PALETTE_MATERIAL_CHROME":case"":N.palette=o.PALETTE_MATERIAL_CHROME;break;default:N.palette=A.split(/[;|]/)}}W.hasAttribute(x+"color")&&(N.color=W.getAttribute(x+"color"))})(this.options,S),this.H=0,this.S=0,this.L=0,this.R=0,this.G=0,this.B=0,this.A=1,this.palette={},this.element=document.createElement("div"),this.options.id&&(this.element.id=this.options.id),this.element.className="a-color-picker",this.element.innerHTML=f.default,S.appendChild(this.element);var M=this.element.querySelector(".a-color-picker-h");this.setupHueCanvas(M),this.hueBarHelper=J(M),this.huePointer=this.element.querySelector(".a-color-picker-h+.a-color-picker-dot");var V=this.element.querySelector(".a-color-picker-sl");this.setupSlCanvas(V),this.slBarHelper=J(V),this.slPointer=this.element.querySelector(".a-color-picker-sl+.a-color-picker-dot"),this.preview=this.element.querySelector(".a-color-picker-preview"),this.setupClipboard(this.preview.querySelector(".a-color-picker-clipbaord")),this.options.showHSL?(this.setupInput(this.inputH=this.element.querySelector(".a-color-picker-hsl>input[nameref=H]")),this.setupInput(this.inputS=this.element.querySelector(".a-color-picker-hsl>input[nameref=S]")),this.setupInput(this.inputL=this.element.querySelector(".a-color-picker-hsl>input[nameref=L]"))):this.element.querySelector(".a-color-picker-hsl").remove(),this.options.showRGB?(this.setupInput(this.inputR=this.element.querySelector(".a-color-picker-rgb>input[nameref=R]")),this.setupInput(this.inputG=this.element.querySelector(".a-color-picker-rgb>input[nameref=G]")),this.setupInput(this.inputB=this.element.querySelector(".a-color-picker-rgb>input[nameref=B]"))):this.element.querySelector(".a-color-picker-rgb").remove(),this.options.showHEX?this.setupInput(this.inputRGBHEX=this.element.querySelector("input[nameref=RGBHEX]")):this.element.querySelector(".a-color-picker-rgbhex").remove(),this.options.paletteEditable||this.options.palette&&this.options.palette.length>0?this.setPalette(this.paletteRow=this.element.querySelector(".a-color-picker-palette")):(this.paletteRow=this.element.querySelector(".a-color-picker-palette"),this.paletteRow.remove()),this.options.showAlpha?(this.setupAlphaCanvas(this.element.querySelector(".a-color-picker-a")),this.alphaPointer=this.element.querySelector(".a-color-picker-a+.a-color-picker-dot")):this.element.querySelector(".a-color-picker-alpha").remove(),this.element.style.width=this.options.slBarSize[0]+"px",this.onValueChanged(U,this.options.color)}return n(P,[{key:"setupHueCanvas",value:function(S){var C=this;S.width=this.options.hueBarSize[0],S.height=this.options.hueBarSize[1];for(var M=S.getContext("2d"),V=M.createLinearGradient(0,0,this.options.hueBarSize[0],0),N=0;N<=1;N+=1/360)V.addColorStop(N,"hsl("+360*N+", 100%, 50%)");M.fillStyle=V,M.fillRect(0,0,this.options.hueBarSize[0],this.options.hueBarSize[1]);var W=function(A){var ee=(0,o.limit)(A.clientX-S.getBoundingClientRect().left,0,C.options.hueBarSize[0]),ue=Math.round(360*ee/C.options.hueBarSize[0]);C.huePointer.style.left=ee-7+"px",C.onValueChanged("H",ue)},x=function A(){document.removeEventListener("mousemove",W),document.removeEventListener("mouseup",A)};S.addEventListener("mousedown",function(A){W(A),document.addEventListener("mousemove",W),document.addEventListener("mouseup",x)})}},{key:"setupSlCanvas",value:function(S){var C=this;S.width=this.options.slBarSize[0],S.height=this.options.slBarSize[1];var M=function(N){var W=(0,o.limit)(N.clientX-S.getBoundingClientRect().left,0,C.options.slBarSize[0]-1),x=(0,o.limit)(N.clientY-S.getBoundingClientRect().top,0,C.options.slBarSize[1]-1),A=C.slBarHelper.grabColor(W,x);C.slPointer.style.left=W-7+"px",C.slPointer.style.top=x-7+"px",C.onValueChanged("RGB",A)},V=function N(){document.removeEventListener("mousemove",M),document.removeEventListener("mouseup",N)};S.addEventListener("mousedown",function(N){M(N),document.addEventListener("mousemove",M),document.addEventListener("mouseup",V)})}},{key:"setupAlphaCanvas",value:function(S){var C=this;S.width=this.options.alphaBarSize[0],S.height=this.options.alphaBarSize[1];var M=S.getContext("2d"),V=M.createLinearGradient(0,0,S.width-1,0);V.addColorStop(0,"hsla(0, 0%, 50%, 0)"),V.addColorStop(1,"hsla(0, 0%, 50%, 1)"),M.fillStyle=V,M.fillRect(0,0,this.options.alphaBarSize[0],this.options.alphaBarSize[1]);var N=function(x){var A=(0,o.limit)(x.clientX-S.getBoundingClientRect().left,0,C.options.alphaBarSize[0]),ee=+(A/C.options.alphaBarSize[0]).toFixed(2);C.alphaPointer.style.left=A-7+"px",C.onValueChanged("ALPHA",ee)},W=function x(){document.removeEventListener("mousemove",N),document.removeEventListener("mouseup",x)};S.addEventListener("mousedown",function(x){N(x),document.addEventListener("mousemove",N),document.addEventListener("mouseup",W)})}},{key:"setupInput",value:function(S){var C=this,M=+S.min,V=+S.max,N=S.getAttribute("nameref");S.hasAttribute("select-on-focus")&&S.addEventListener("focus",function(){S.select()}),S.type==="text"?S.addEventListener("change",function(){C.onValueChanged(N,S.value)}):((w||D)&&S.addEventListener("keydown",function(W){W.key==="Up"?(S.value=(0,o.limit)(+S.value+1,M,V),C.onValueChanged(N,S.value),W.returnValue=!1):W.key==="Down"&&(S.value=(0,o.limit)(+S.value-1,M,V),C.onValueChanged(N,S.value),W.returnValue=!1)}),S.addEventListener("change",function(){var W=+S.value;C.onValueChanged(N,(0,o.limit)(W,M,V))}))}},{key:"setupClipboard",value:function(S){var C=this;S.title="click to copy",S.addEventListener("click",function(){S.value=(0,o.parseColor)([C.R,C.G,C.B,C.A],"hexcss4"),S.select(),document.execCommand("copy")})}},{key:"setPalette",value:function(S){var C=this,M=this.options.useAlphaInPalette==="auto"?this.options.showAlpha:this.options.useAlphaInPalette,V=null;switch(this.options.palette){case"PALETTE_MATERIAL_500":V=o.PALETTE_MATERIAL_500;break;case"PALETTE_MATERIAL_CHROME":V=o.PALETTE_MATERIAL_CHROME;break;default:V=(0,o.ensureArray)(this.options.palette)}if(this.options.paletteEditable||V.length>0){var N=function(A,ee,ue){var ge=S.querySelector('.a-color-picker-palette-color[data-color="'+A+'"]')||document.createElement("div");ge.className="a-color-picker-palette-color",ge.style.backgroundColor=A,ge.setAttribute("data-color",A),ge.title=A,S.insertBefore(ge,ee),C.palette[A]=!0,ue&&C.onPaletteColorAdd(A)},W=function(A,ee){A?(S.removeChild(A),C.palette[A.getAttribute("data-color")]=!1,ee&&C.onPaletteColorRemove(A.getAttribute("data-color"))):(S.querySelectorAll(".a-color-picker-palette-color[data-color]").forEach(function(ue){S.removeChild(ue)}),Object.keys(C.palette).forEach(function(ue){C.palette[ue]=!1}),ee&&C.onPaletteColorRemove())};if(V.map(function(A){return(0,o.parseColor)(A,M?"rgbcss4":"hex")}).filter(function(A){return!!A}).forEach(function(A){return N(A)}),this.options.paletteEditable){var x=document.createElement("div");x.className="a-color-picker-palette-color a-color-picker-palette-add",x.innerHTML="+",S.appendChild(x),S.addEventListener("click",function(A){/a-color-picker-palette-add/.test(A.target.className)?A.shiftKey?W(null,!0):N(M?(0,o.parseColor)([C.R,C.G,C.B,C.A],"rgbcss4"):(0,o.rgbToHex)(C.R,C.G,C.B),A.target,!0):/a-color-picker-palette-color/.test(A.target.className)&&(A.shiftKey?W(A.target,!0):C.onValueChanged(U,A.target.getAttribute("data-color")))})}else S.addEventListener("click",function(A){/a-color-picker-palette-color/.test(A.target.className)&&C.onValueChanged(U,A.target.getAttribute("data-color"))})}else S.style.display="none"}},{key:"updatePalette",value:function(S){this.paletteRow.innerHTML="",this.palette={},this.paletteRow.parentElement||this.element.appendChild(this.paletteRow),this.options.palette=S,this.setPalette(this.paletteRow)}},{key:"onValueChanged",value:function(S,C){var M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{silent:!1};switch(S){case"H":this.H=C;var V=(0,o.hslToRgb)(this.H,this.S,this.L),N=s(V,3);this.R=N[0],this.G=N[1],this.B=N[2],this.slBarHelper.setHue(C),this.updatePointerH(this.H),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGB(this.R,this.G,this.B),this.updateInputRGBHEX(this.R,this.G,this.B);break;case"S":this.S=C;var W=(0,o.hslToRgb)(this.H,this.S,this.L),x=s(W,3);this.R=x[0],this.G=x[1],this.B=x[2],this.updatePointerSL(this.H,this.S,this.L),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGB(this.R,this.G,this.B),this.updateInputRGBHEX(this.R,this.G,this.B);break;case"L":this.L=C;var A=(0,o.hslToRgb)(this.H,this.S,this.L),ee=s(A,3);this.R=ee[0],this.G=ee[1],this.B=ee[2],this.updatePointerSL(this.H,this.S,this.L),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGB(this.R,this.G,this.B),this.updateInputRGBHEX(this.R,this.G,this.B);break;case"R":this.R=C;var ue=(0,o.rgbToHsl)(this.R,this.G,this.B),ge=s(ue,3);this.H=ge[0],this.S=ge[1],this.L=ge[2],this.slBarHelper.setHue(this.H),this.updatePointerH(this.H),this.updatePointerSL(this.H,this.S,this.L),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGBHEX(this.R,this.G,this.B);break;case"G":this.G=C;var be=(0,o.rgbToHsl)(this.R,this.G,this.B),$e=s(be,3);this.H=$e[0],this.S=$e[1],this.L=$e[2],this.slBarHelper.setHue(this.H),this.updatePointerH(this.H),this.updatePointerSL(this.H,this.S,this.L),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGBHEX(this.R,this.G,this.B);break;case"B":this.B=C;var mt=(0,o.rgbToHsl)(this.R,this.G,this.B),Ge=s(mt,3);this.H=Ge[0],this.S=Ge[1],this.L=Ge[2],this.slBarHelper.setHue(this.H),this.updatePointerH(this.H),this.updatePointerSL(this.H,this.S,this.L),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGBHEX(this.R,this.G,this.B);break;case"RGB":var Je=s(C,3);this.R=Je[0],this.G=Je[1],this.B=Je[2];var ca=(0,o.rgbToHsl)(this.R,this.G,this.B),dt=s(ca,3);this.H=dt[0],this.S=dt[1],this.L=dt[2],this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGB(this.R,this.G,this.B),this.updateInputRGBHEX(this.R,this.G,this.B);break;case ae:var ze=s(C,4);this.R=ze[0],this.G=ze[1],this.B=ze[2],this.A=ze[3];var Nt=(0,o.rgbToHsl)(this.R,this.G,this.B),vt=s(Nt,3);this.H=vt[0],this.S=vt[1],this.L=vt[2],this.slBarHelper.setHue(this.H),this.updatePointerH(this.H),this.updatePointerSL(this.H,this.S,this.L),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGB(this.R,this.G,this.B),this.updateInputRGBHEX(this.R,this.G,this.B),this.updatePointerA(this.A);break;case F:var it=s(C,4);this.H=it[0],this.S=it[1],this.L=it[2],this.A=it[3];var Bt=(0,o.hslToRgb)(this.H,this.S,this.L),pt=s(Bt,3);this.R=pt[0],this.G=pt[1],this.B=pt[2],this.slBarHelper.setHue(this.H),this.updatePointerH(this.H),this.updatePointerSL(this.H,this.S,this.L),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGB(this.R,this.G,this.B),this.updateInputRGBHEX(this.R,this.G,this.B),this.updatePointerA(this.A);break;case"RGBHEX":var Tt=(0,o.cssColorToRgb)(C)||[this.R,this.G,this.B],et=s(Tt,3);this.R=et[0],this.G=et[1],this.B=et[2];var Gt=(0,o.rgbToHsl)(this.R,this.G,this.B),jt=s(Gt,3);this.H=jt[0],this.S=jt[1],this.L=jt[2],this.slBarHelper.setHue(this.H),this.updatePointerH(this.H),this.updatePointerSL(this.H,this.S,this.L),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGB(this.R,this.G,this.B);break;case U:var qt=(0,o.parseColor)(C,"rgba")||[0,0,0,1],ot=s(qt,4);this.R=ot[0],this.G=ot[1],this.B=ot[2],this.A=ot[3];var Vt=(0,o.rgbToHsl)(this.R,this.G,this.B),lt=s(Vt,3);this.H=lt[0],this.S=lt[1],this.L=lt[2],this.slBarHelper.setHue(this.H),this.updatePointerH(this.H),this.updatePointerSL(this.H,this.S,this.L),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGB(this.R,this.G,this.B),this.updateInputRGBHEX(this.R,this.G,this.B),this.updatePointerA(this.A);break;case"ALPHA":this.A=C}this.A===1?this.preview.style.backgroundColor="rgb("+this.R+","+this.G+","+this.B+")":this.preview.style.backgroundColor="rgba("+this.R+","+this.G+","+this.B+","+this.A+")",M&&M.silent||this.onchange&&this.onchange(this.preview.style.backgroundColor)}},{key:"onPaletteColorAdd",value:function(S){this.oncoloradd&&this.oncoloradd(S)}},{key:"onPaletteColorRemove",value:function(S){this.oncolorremove&&this.oncolorremove(S)}},{key:"updateInputHSL",value:function(S,C,M){this.options.showHSL&&(this.inputH.value=S,this.inputS.value=C,this.inputL.value=M)}},{key:"updateInputRGB",value:function(S,C,M){this.options.showRGB&&(this.inputR.value=S,this.inputG.value=C,this.inputB.value=M)}},{key:"updateInputRGBHEX",value:function(S,C,M){this.options.showHEX&&(this.inputRGBHEX.value=(0,o.rgbToHex)(S,C,M))}},{key:"updatePointerH",value:function(S){var C=this.options.hueBarSize[0]*S/360;this.huePointer.style.left=C-7+"px"}},{key:"updatePointerSL",value:function(S,C,M){var V=(0,o.hslToRgb)(S,C,M),N=s(V,3),W=N[0],x=N[1],A=N[2],ee=this.slBarHelper.findColor(W,x,A),ue=s(ee,2),ge=ue[0],be=ue[1];ge>=0&&(this.slPointer.style.left=ge-7+"px",this.slPointer.style.top=be-7+"px")}},{key:"updatePointerA",value:function(S){if(this.options.showAlpha){var C=this.options.alphaBarSize[0]*S;this.alphaPointer.style.left=C-7+"px"}}}]),P}(),T=function(){function P(S){u(this,P),this.name=S,this.listeners=[]}return n(P,[{key:"on",value:function(S){S&&this.listeners.push(S)}},{key:"off",value:function(S){this.listeners=S?this.listeners.filter(function(C){return C!==S}):[]}},{key:"emit",value:function(S,C){for(var M=this.listeners.slice(0),V=0;V<M.length;V++)M[V].apply(C,S)}}]),P}();function G(P,S){var C=new Qe(P,S),M={change:new T("change"),coloradd:new T("coloradd"),colorremove:new T("colorremove")},V=!0,N={},W={get element(){return C.element},get rgb(){return[C.R,C.G,C.B]},set rgb(x){var A=s(x,3),ee=A[0],ue=A[1],ge=A[2],be=[(0,o.limit)(ee,0,255),(0,o.limit)(ue,0,255),(0,o.limit)(ge,0,255)];ee=be[0],ue=be[1],ge=be[2],C.onValueChanged(ae,[ee,ue,ge,1])},get hsl(){return[C.H,C.S,C.L]},set hsl(x){var A=s(x,3),ee=A[0],ue=A[1],ge=A[2],be=[(0,o.limit)(ee,0,360),(0,o.limit)(ue,0,100),(0,o.limit)(ge,0,100)];ee=be[0],ue=be[1],ge=be[2],C.onValueChanged(F,[ee,ue,ge,1])},get rgbhex(){return this.all.hex},get rgba(){return[C.R,C.G,C.B,C.A]},set rgba(x){var A=s(x,4),ee=A[0],ue=A[1],ge=A[2],be=A[3],$e=[(0,o.limit)(ee,0,255),(0,o.limit)(ue,0,255),(0,o.limit)(ge,0,255),(0,o.limit)(be,0,1)];ee=$e[0],ue=$e[1],ge=$e[2],be=$e[3],C.onValueChanged(ae,[ee,ue,ge,be])},get hsla(){return[C.H,C.S,C.L,C.A]},set hsla(x){var A=s(x,4),ee=A[0],ue=A[1],ge=A[2],be=A[3],$e=[(0,o.limit)(ee,0,360),(0,o.limit)(ue,0,100),(0,o.limit)(ge,0,100),(0,o.limit)(be,0,1)];ee=$e[0],ue=$e[1],ge=$e[2],be=$e[3],C.onValueChanged(F,[ee,ue,ge,be])},get color(){return this.all.toString()},set color(x){C.onValueChanged(U,x)},setColor:function(x){var A=arguments.length>1&&arguments[1]!==void 0&&arguments[1];C.onValueChanged(U,x,{silent:A})},get all(){if(V){var x=[C.R,C.G,C.B,C.A],A=C.A<1?"rgba("+C.R+","+C.G+","+C.B+","+C.A+")":o.rgbToHex.apply(void 0,x);(N=(0,o.parseColor)(x,N)).toString=function(){return A},V=!1}return Object.assign({},N)},get onchange(){return M.change&&M.change.listeners[0]},set onchange(x){this.off("change").on("change",x)},get oncoloradd(){return M.coloradd&&M.coloradd.listeners[0]},set oncoloradd(x){this.off("coloradd").on("coloradd",x)},get oncolorremove(){return M.colorremove&&M.colorremove.listeners[0]},set oncolorremove(x){this.off("colorremove").on("colorremove",x)},get palette(){return Object.keys(C.palette).filter(function(x){return C.palette[x]})},set palette(x){C.updatePalette(x)},show:function(){C.element.classList.remove("hidden")},hide:function(){C.element.classList.add("hidden")},toggle:function(){C.element.classList.toggle("hidden")},on:function(x,A){return x&&M[x]&&M[x].on(A),this},off:function(x,A){return x&&M[x]&&M[x].off(A),this},destroy:function(){M.change.off(),M.coloradd.off(),M.colorremove.off(),C.element.remove(),M=null,C=null}};return C.onchange=function(){for(var x=arguments.length,A=Array(x),ee=0;ee<x;ee++)A[ee]=arguments[ee];V=!0,M.change.emit([W].concat(A),W)},C.oncoloradd=function(){for(var x=arguments.length,A=Array(x),ee=0;ee<x;ee++)A[ee]=arguments[ee];M.coloradd.emit([W].concat(A),W)},C.oncolorremove=function(){for(var x=arguments.length,A=Array(x),ee=0;ee<x;ee++)A[ee]=arguments[ee];M.colorremove.emit([W].concat(A),W)},C.element.ctrl=W,W}if(typeof window!="undefined"&&!document.querySelector('head>style[data-source="a-color-picker"]')){var q=i(5).toString(),z=document.createElement("style");z.setAttribute("type","text/css"),z.setAttribute("data-source","a-color-picker"),z.innerHTML=q,document.querySelector("head").appendChild(z)}r.createPicker=G,r.from=function(P,S){var C=function(M){return M?Array.isArray(M)?M:M instanceof HTMLElement?[M]:M instanceof NodeList?[].concat(h(M)):typeof M=="string"?[].concat(h(document.querySelectorAll(M))):M.jquery?M.get():[]:[]}(P).map(function(M,V){var N=G(M,S);return N.index=V,N});return C.on=function(M,V){return C.forEach(function(N){return N.on(M,V)}),this},C.off=function(M){return C.forEach(function(V){return V.off(M)}),this},C},r.parseColorToRgb=o.parseColorToRgb,r.parseColorToRgba=o.parseColorToRgba,r.parseColorToHsl=o.parseColorToHsl,r.parseColorToHsla=o.parseColorToHsla,r.parseColor=o.parseColor,r.rgbToHex=o.rgbToHex,r.hslToRgb=o.hslToRgb,r.rgbToHsl=o.rgbToHsl,r.rgbToHsv=o.rgbToHsv,r.rgbToInt=o.rgbToInt,r.intToRgb=o.intToRgb,r.getLuminance=o.getLuminance,r.COLOR_NAMES=o.COLOR_NAMES,r.PALETTE_MATERIAL_500=o.PALETTE_MATERIAL_500,r.PALETTE_MATERIAL_CHROME=o.PALETTE_MATERIAL_CHROME,r.VERSION="1.2.1"},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.nvl=r.ensureArray=r.limit=r.getLuminance=r.parseColor=r.parseColorToHsla=r.parseColorToHsl=r.cssHslaToHsla=r.cssHslToHsl=r.parseColorToRgba=r.parseColorToRgb=r.cssRgbaToRgba=r.cssRgbToRgb=r.cssColorToRgba=r.cssColorToRgb=r.intToRgb=r.rgbToInt=r.rgbToHsv=r.rgbToHsl=r.hslToRgb=r.rgbToHex=r.PALETTE_MATERIAL_CHROME=r.PALETTE_MATERIAL_500=r.COLOR_NAMES=void 0;var n=function(T,G){if(Array.isArray(T))return T;if(Symbol.iterator in Object(T))return function(q,z){var P=[],S=!0,C=!1,M=void 0;try{for(var V,N=q[Symbol.iterator]();!(S=(V=N.next()).done)&&(P.push(V.value),!z||P.length!==z);S=!0);}catch(W){C=!0,M=W}finally{try{!S&&N.return&&N.return()}finally{if(C)throw M}}return P}(T,G);throw new TypeError("Invalid attempt to destructure non-iterable instance")},s=function(T){return T&&T.__esModule?T:{default:T}}(i(0));function o(T){if(Array.isArray(T)){for(var G=0,q=Array(T.length);G<T.length;G++)q[G]=T[G];return q}return Array.from(T)}var c={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4","indianred ":"#CD5C5C","indigo ":"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function f(T,G,q){return T=+T,isNaN(T)||T<G?G:T>q?q:T}function p(T,G){return T??G}function u(T,G,q){var z=[f(T,0,255),f(G,0,255),f(q,0,255)];return"#"+("000000"+((T=z[0])<<16|(G=z[1])<<8|(q=z[2])).toString(16)).slice(-6)}function h(T,G,q){var z=void 0,P=void 0,S=void 0,C=[f(T,0,360)/360,f(G,0,100)/100,f(q,0,100)/100];if(T=C[0],q=C[2],(G=C[1])==0)z=P=S=q;else{var M=function(W,x,A){return A<0&&(A+=1),A>1&&(A-=1),A<1/6?W+6*(x-W)*A:A<.5?x:A<2/3?W+(x-W)*(2/3-A)*6:W},V=q<.5?q*(1+G):q+G-q*G,N=2*q-V;z=M(N,V,T+1/3),P=M(N,V,T),S=M(N,V,T-1/3)}return[255*z,255*P,255*S].map(Math.round)}function w(T,G,q){var z=[f(T,0,255)/255,f(G,0,255)/255,f(q,0,255)/255];T=z[0],G=z[1],q=z[2];var P=Math.max(T,G,q),S=Math.min(T,G,q),C=void 0,M=void 0,V=(P+S)/2;if(P==S)C=M=0;else{var N=P-S;switch(M=V>.5?N/(2-P-S):N/(P+S),P){case T:C=(G-q)/N+(G<q?6:0);break;case G:C=(q-T)/N+2;break;case q:C=(T-G)/N+4}C/=6}return[360*C,100*M,100*V].map(Math.round)}function D(T,G,q){return T<<16|G<<8|q}function Z(T){if(T){var G=c[T.toString().toLowerCase()],q=/^\s*#?((([0-9A-F])([0-9A-F])([0-9A-F]))|(([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})))\s*$/i.exec(G||T)||[],z=n(q,10),P=z[3],S=z[4],C=z[5],M=z[7],V=z[8],N=z[9];if(P!==void 0)return[parseInt(P+P,16),parseInt(S+S,16),parseInt(C+C,16)];if(M!==void 0)return[parseInt(M,16),parseInt(V,16),parseInt(N,16)]}}function U(T){if(T){var G=c[T.toString().toLowerCase()],q=/^\s*#?((([0-9A-F])([0-9A-F])([0-9A-F])([0-9A-F])?)|(([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})?))\s*$/i.exec(G||T)||[],z=n(q,12),P=z[3],S=z[4],C=z[5],M=z[6],V=z[8],N=z[9],W=z[10],x=z[11];if(P!==void 0)return[parseInt(P+P,16),parseInt(S+S,16),parseInt(C+C,16),M?+(parseInt(M+M,16)/255).toFixed(2):1];if(V!==void 0)return[parseInt(V,16),parseInt(N,16),parseInt(W,16),x?+(parseInt(x,16)/255).toFixed(2):1]}}function ae(T){if(T){var G=/^rgb\((\d+)[\s,](\d+)[\s,](\d+)\)/i.exec(T)||[],q=n(G,4),z=q[0],P=q[1],S=q[2],C=q[3];return z?[f(P,0,255),f(S,0,255),f(C,0,255)]:void 0}}function F(T){if(T){var G=/^rgba?\((\d+)\s*[\s,]\s*(\d+)\s*[\s,]\s*(\d+)(\s*[\s,]\s*(\d*(.\d+)?))?\)/i.exec(T)||[],q=n(G,6),z=q[0],P=q[1],S=q[2],C=q[3],M=q[5];return z?[f(P,0,255),f(S,0,255),f(C,0,255),f(p(M,1),0,1)]:void 0}}function ie(T){if(Array.isArray(T))return[f(T[0],0,255),f(T[1],0,255),f(T[2],0,255),f(p(T[3],1),0,1)];var G=U(T)||F(T);return G&&G.length===3&&G.push(1),G}function J(T){if(T){var G=/^hsl\((\d+)[\s,](\d+)[\s,](\d+)\)/i.exec(T)||[],q=n(G,4),z=q[0],P=q[1],S=q[2],C=q[3];return z?[f(P,0,360),f(S,0,100),f(C,0,100)]:void 0}}function Te(T){if(T){var G=/^hsla?\((\d+)\s*[\s,]\s*(\d+)\s*[\s,]\s*(\d+)(\s*[\s,]\s*(\d*(.\d+)?))?\)/i.exec(T)||[],q=n(G,6),z=q[0],P=q[1],S=q[2],C=q[3],M=q[5];return z?[f(P,0,255),f(S,0,255),f(C,0,255),f(p(M,1),0,1)]:void 0}}function We(T){if(Array.isArray(T))return[f(T[0],0,360),f(T[1],0,100),f(T[2],0,100),f(p(T[3],1),0,1)];var G=Te(T);return G&&G.length===3&&G.push(1),G}function Qe(T,G){switch(G){case"rgb":default:return T.slice(0,3);case"rgbcss":return"rgb("+T[0]+", "+T[1]+", "+T[2]+")";case"rgbcss4":return"rgb("+T[0]+", "+T[1]+", "+T[2]+", "+T[3]+")";case"rgba":return T;case"rgbacss":return"rgba("+T[0]+", "+T[1]+", "+T[2]+", "+T[3]+")";case"hsl":return w.apply(void 0,o(T));case"hslcss":return"hsl("+(T=w.apply(void 0,o(T)))[0]+", "+T[1]+", "+T[2]+")";case"hslcss4":var q=w.apply(void 0,o(T));return"hsl("+q[0]+", "+q[1]+", "+q[2]+", "+T[3]+")";case"hsla":return[].concat(o(w.apply(void 0,o(T))),[T[3]]);case"hslacss":var z=w.apply(void 0,o(T));return"hsla("+z[0]+", "+z[1]+", "+z[2]+", "+T[3]+")";case"hex":return u.apply(void 0,o(T));case"hexcss4":return u.apply(void 0,o(T))+("00"+parseInt(255*T[3]).toString(16)).slice(-2);case"int":return D.apply(void 0,o(T))}}r.COLOR_NAMES=c,r.PALETTE_MATERIAL_500=["#F44336","#E91E63","#E91E63","#9C27B0","#9C27B0","#673AB7","#673AB7","#3F51B5","#3F51B5","#2196F3","#2196F3","#03A9F4","#03A9F4","#00BCD4","#00BCD4","#009688","#009688","#4CAF50","#4CAF50","#8BC34A","#8BC34A","#CDDC39","#CDDC39","#FFEB3B","#FFEB3B","#FFC107","#FFC107","#FF9800","#FF9800","#FF5722","#FF5722","#795548","#795548","#9E9E9E","#9E9E9E","#607D8B","#607D8B"],r.PALETTE_MATERIAL_CHROME=["#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],r.rgbToHex=u,r.hslToRgb=h,r.rgbToHsl=w,r.rgbToHsv=function(T,G,q){var z=[f(T,0,255)/255,f(G,0,255)/255,f(q,0,255)/255];T=z[0],G=z[1],q=z[2];var P,S=Math.max(T,G,q),C=Math.min(T,G,q),M=void 0,V=S,N=S-C;if(P=S===0?0:N/S,S==C)M=0;else{switch(S){case T:M=(G-q)/N+(G<q?6:0);break;case G:M=(q-T)/N+2;break;case q:M=(T-G)/N+4}M/=6}return[M,P,V]},r.rgbToInt=D,r.intToRgb=function(T){return[T>>16&255,T>>8&255,255&T]},r.cssColorToRgb=Z,r.cssColorToRgba=U,r.cssRgbToRgb=ae,r.cssRgbaToRgba=F,r.parseColorToRgb=function(T){return Array.isArray(T)?T=[f(T[0],0,255),f(T[1],0,255),f(T[2],0,255)]:Z(T)||ae(T)},r.parseColorToRgba=ie,r.cssHslToHsl=J,r.cssHslaToHsla=Te,r.parseColorToHsl=function(T){return Array.isArray(T)?T=[f(T[0],0,360),f(T[1],0,100),f(T[2],0,100)]:J(T)},r.parseColorToHsla=We,r.parseColor=function(T,G){if(G=G||"rgb",T!=null){var q=void 0;if((q=ie(T))||(q=We(T))&&(q=[].concat(o(h.apply(void 0,o(q))),[q[3]])))return(0,s.default)(G)?["rgb","rgbcss","rgbcss4","rgba","rgbacss","hsl","hslcss","hslcss4","hsla","hslacss","hex","hexcss4","int"].reduce(function(z,P){return z[P]=Qe(q,P),z},G||{}):Qe(q,G.toString().toLowerCase())}},r.getLuminance=function(T,G,q){return .2126*(T=(T/=255)<.03928?T/12.92:Math.pow((T+.055)/1.055,2.4))+.7152*(G=(G/=255)<.03928?G/12.92:Math.pow((G+.055)/1.055,2.4))+.0722*((q/=255)<.03928?q/12.92:Math.pow((q+.055)/1.055,2.4))},r.limit=f,r.ensureArray=function(T){return T?Array.from(T):[]},r.nvl=p},function(t,r,i){t.exports=function(n){return n!=null&&typeof n=="object"&&Array.isArray(n)===!1}},function(t,r){t.exports='<div class="a-color-picker-row a-color-picker-stack a-color-picker-row-top"> <canvas class="a-color-picker-sl a-color-picker-transparent"></canvas> <div class=a-color-picker-dot></div> </div> <div class=a-color-picker-row> <div class="a-color-picker-stack a-color-picker-transparent a-color-picker-circle"> <div class=a-color-picker-preview> <input class=a-color-picker-clipbaord type=text> </div> </div> <div class=a-color-picker-column> <div class="a-color-picker-cell a-color-picker-stack"> <canvas class=a-color-picker-h></canvas> <div class=a-color-picker-dot></div> </div> <div class="a-color-picker-cell a-color-picker-alpha a-color-picker-stack" show-on-alpha> <canvas class="a-color-picker-a a-color-picker-transparent"></canvas> <div class=a-color-picker-dot></div> </div> </div> </div> <div class="a-color-picker-row a-color-picker-hsl" show-on-hsl> <label>H</label> <input nameref=H type=number maxlength=3 min=0 max=360 value=0> <label>S</label> <input nameref=S type=number maxlength=3 min=0 max=100 value=0> <label>L</label> <input nameref=L type=number maxlength=3 min=0 max=100 value=0> </div> <div class="a-color-picker-row a-color-picker-rgb" show-on-rgb> <label>R</label> <input nameref=R type=number maxlength=3 min=0 max=255 value=0> <label>G</label> <input nameref=G type=number maxlength=3 min=0 max=255 value=0> <label>B</label> <input nameref=B type=number maxlength=3 min=0 max=255 value=0> </div> <div class="a-color-picker-row a-color-picker-rgbhex a-color-picker-single-input" show-on-single-input> <label>HEX</label> <input nameref=RGBHEX type=text select-on-focus> </div> <div class="a-color-picker-row a-color-picker-palette"></div>'},function(t,r,i){var n=i(6);t.exports=typeof n=="string"?n:n.toString()},function(t,r,i){(t.exports=i(7)(!1)).push([t.i,`/*!
 * a-color-picker
 * https://github.com/narsenico/a-color-picker
 *
 * Copyright (c) 2017-2018, Gianfranco Caldi.
 * Released under the MIT License.
 */.a-color-picker{background-color:#fff;padding:0;display:inline-flex;flex-direction:column;user-select:none;width:232px;font:400 10px Helvetica,Arial,sans-serif;border-radius:3px;box-shadow:0 0 0 1px rgba(0,0,0,.05),0 2px 4px rgba(0,0,0,.25)}.a-color-picker,.a-color-picker-row,.a-color-picker input{box-sizing:border-box}.a-color-picker-row{padding:15px;display:flex;flex-direction:row;align-items:center;justify-content:space-between;user-select:none}.a-color-picker-row-top{padding:0}.a-color-picker-row:not(:first-child){border-top:1px solid #f5f5f5}.a-color-picker-column{display:flex;flex-direction:column}.a-color-picker-cell{flex:1 1 auto;margin-bottom:4px}.a-color-picker-cell:last-child{margin-bottom:0}.a-color-picker-stack{position:relative}.a-color-picker-dot{position:absolute;width:14px;height:14px;top:0;left:0;background:#fff;pointer-events:none;border-radius:50px;z-index:1000;box-shadow:0 1px 2px rgba(0,0,0,.75)}.a-color-picker-a,.a-color-picker-h,.a-color-picker-sl{cursor:cell}.a-color-picker-a+.a-color-picker-dot,.a-color-picker-h+.a-color-picker-dot{top:-2px}.a-color-picker-a,.a-color-picker-h{border-radius:2px}.a-color-picker-preview{box-sizing:border-box;width:30px;height:30px;user-select:none;border-radius:15px}.a-color-picker-circle{border-radius:50px;border:1px solid #eee}.a-color-picker-hsl,.a-color-picker-rgb,.a-color-picker-single-input{justify-content:space-evenly}.a-color-picker-hsl>label,.a-color-picker-rgb>label,.a-color-picker-single-input>label{padding:0 8px;flex:0 0 auto;color:#969696}.a-color-picker-hsl>input,.a-color-picker-rgb>input,.a-color-picker-single-input>input{text-align:center;padding:2px 0;width:0;flex:1 1 auto;border:1px solid #e0e0e0;line-height:20px}.a-color-picker-hsl>input::-webkit-inner-spin-button,.a-color-picker-rgb>input::-webkit-inner-spin-button,.a-color-picker-single-input>input::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.a-color-picker-hsl>input:focus,.a-color-picker-rgb>input:focus,.a-color-picker-single-input>input:focus{border-color:#04a9f4;outline:none}.a-color-picker-transparent{background-image:linear-gradient(-45deg,#cdcdcd 25%,transparent 0),linear-gradient(45deg,#cdcdcd 25%,transparent 0),linear-gradient(-45deg,transparent 75%,#cdcdcd 0),linear-gradient(45deg,transparent 75%,#cdcdcd 0);background-size:11px 11px;background-position:0 0,0 -5.5px,-5.5px 5.5px,5.5px 0}.a-color-picker-sl{border-radius:3px 3px 0 0}.a-color-picker.hide-alpha [show-on-alpha],.a-color-picker.hide-hsl [show-on-hsl],.a-color-picker.hide-rgb [show-on-rgb],.a-color-picker.hide-single-input [show-on-single-input]{display:none}.a-color-picker-clipbaord{width:100%;height:100%;opacity:0;cursor:pointer}.a-color-picker-palette{flex-flow:wrap;flex-direction:row;justify-content:flex-start;padding:10px}.a-color-picker-palette-color{width:15px;height:15px;flex:0 1 15px;margin:3px;box-sizing:border-box;cursor:pointer;border-radius:3px;box-shadow:inset 0 0 0 1px rgba(0,0,0,.1)}.a-color-picker-palette-add{text-align:center;line-height:13px;color:#607d8b}.a-color-picker.hidden{display:none}`,""])},function(t,r){t.exports=function(i){var n=[];return n.toString=function(){return this.map(function(s){var o=function(c,f){var p=c[1]||"",u=c[3];if(!u)return p;if(f&&typeof btoa=="function"){var h=function(D){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(D))))+" */"}(u),w=u.sources.map(function(D){return"/*# sourceURL="+u.sourceRoot+D+" */"});return[p].concat(w).concat([h]).join(`
`)}return[p].join(`
`)}(s,i);return s[2]?"@media "+s[2]+"{"+o+"}":o}).join("")},n.i=function(s,o){typeof s=="string"&&(s=[[null,s,""]]);for(var c={},f=0;f<this.length;f++){var p=this[f][0];typeof p=="number"&&(c[p]=!0)}for(f=0;f<s.length;f++){var u=s[f];typeof u[0]=="number"&&c[u[0]]||(o&&!u[2]?u[2]=o:o&&(u[2]="("+u[2]+") and ("+o+")"),n.push(u))}},n}}])})}),cd=ea(sd),ki=cd;var Be=63710088e-1,Ci={centimeters:Be*100,centimetres:Be*100,degrees:Be/111325,feet:Be*3.28084,inches:Be*39.37,kilometers:Be/1e3,kilometres:Be/1e3,meters:Be,metres:Be,miles:Be/1609.344,millimeters:Be*1e3,millimetres:Be*1e3,nauticalmiles:Be/1852,radians:1,yards:Be/1.0936};function Dt(e,a,t){t===void 0&&(t={});var r={type:"Feature"};return(t.id===0||t.id)&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.properties=a||{},r.geometry=e,r}function ft(e,a,t){if(t===void 0&&(t={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Si(e[0])||!Si(e[1]))throw new Error("coordinates must contain numbers");var r={type:"Point",coordinates:e};return Dt(r,a,t)}function Ei(e,a,t){t===void 0&&(t={});for(var r=0,i=e;r<i.length;r++){var n=i[r];if(n.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<n[n.length-1].length;s++)if(n[n.length-1][s]!==n[0][s])throw new Error("First and last Position are not equivalent.")}var o={type:"Polygon",coordinates:e};return Dt(o,a,t)}function Ot(e,a){a===void 0&&(a={});var t={type:"FeatureCollection"};return a.id&&(t.id=a.id),a.bbox&&(t.bbox=a.bbox),t.features=e,t}function Ti(e,a){a===void 0&&(a="kilometers");var t=Ci[a];if(!t)throw new Error(a+" units is invalid");return e*t}function ji(e,a){a===void 0&&(a="kilometers");var t=Ci[a];if(!t)throw new Error(a+" units is invalid");return e/t}function Xr(e){var a=e%(2*Math.PI);return a*180/Math.PI}function gt(e){var a=e%360;return a*Math.PI/180}function Si(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function _a(e,a,t){if(e!==null)for(var r,i,n,s,o,c,f,p=0,u=0,h,w=e.type,D=w==="FeatureCollection",Z=w==="Feature",U=D?e.features.length:1,ae=0;ae<U;ae++){f=D?e.features[ae].geometry:Z?e.geometry:e,h=f?f.type==="GeometryCollection":!1,o=h?f.geometries.length:1;for(var F=0;F<o;F++){var ie=0,J=0;if(s=h?f.geometries[F]:f,s!==null){c=s.coordinates;var Te=s.type;switch(p=t&&(Te==="Polygon"||Te==="MultiPolygon")?1:0,Te){case null:break;case"Point":if(a(c,u,ae,ie,J)===!1)return!1;u++,ie++;break;case"LineString":case"MultiPoint":for(r=0;r<c.length;r++){if(a(c[r],u,ae,ie,J)===!1)return!1;u++,Te==="MultiPoint"&&ie++}Te==="LineString"&&ie++;break;case"Polygon":case"MultiLineString":for(r=0;r<c.length;r++){for(i=0;i<c[r].length-p;i++){if(a(c[r][i],u,ae,ie,J)===!1)return!1;u++}Te==="MultiLineString"&&ie++,Te==="Polygon"&&J++}Te==="Polygon"&&ie++;break;case"MultiPolygon":for(r=0;r<c.length;r++){for(J=0,i=0;i<c[r].length;i++){for(n=0;n<c[r][i].length-p;n++){if(a(c[r][i][n],u,ae,ie,J)===!1)return!1;u++}J++}ie++}break;case"GeometryCollection":for(r=0;r<s.geometries.length;r++)if(_a(s.geometries[r],a,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Kr(e,a){if(e.type==="Feature")a(e,0);else if(e.type==="FeatureCollection")for(var t=0;t<e.features.length&&a(e.features[t],t)!==!1;t++);}function ud(e,a){var t,r,i,n,s,o,c,f,p,u,h=0,w=e.type==="FeatureCollection",D=e.type==="Feature",Z=w?e.features.length:1;for(t=0;t<Z;t++){for(o=w?e.features[t].geometry:D?e.geometry:e,f=w?e.features[t].properties:D?e.properties:{},p=w?e.features[t].bbox:D?e.bbox:void 0,u=w?e.features[t].id:D?e.id:void 0,c=o?o.type==="GeometryCollection":!1,s=c?o.geometries.length:1,i=0;i<s;i++){if(n=c?o.geometries[i]:o,n===null){if(a(null,h,f,p,u)===!1)return!1;continue}switch(n.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(a(n,h,f,p,u)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<n.geometries.length;r++)if(a(n.geometries[r],h,f,p,u)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}h++}}function Li(e,a){ud(e,function(t,r,i,n,s){var o=t===null?null:t.type;switch(o){case null:case"Point":case"LineString":case"Polygon":return a(Dt(t,i,{bbox:n,id:s}),r,0)===!1?!1:void 0}var c;switch(o){case"MultiPoint":c="Point";break;case"MultiLineString":c="LineString";break;case"MultiPolygon":c="Polygon";break}for(var f=0;f<t.coordinates.length;f++){var p=t.coordinates[f],u={type:c,coordinates:p};if(a(Dt(u,i),r,f)===!1)return!1}})}function ta(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return e.geometry.coordinates;if(e.type==="Point")return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Mi(e){return e.type==="Feature"?e.geometry:e}function dd(e){var a=[];return e.type==="FeatureCollection"?Kr(e,function(t){_a(t,function(r){a.push(ft(r,t.properties))})}):_a(e,function(t){a.push(ft(t,e.properties))}),Ot(a)}function Qr(e){var a=[Infinity,Infinity,-Infinity,-Infinity];return _a(e,function(t){a[0]>t[0]&&(a[0]=t[0]),a[1]>t[1]&&(a[1]=t[1]),a[2]<t[0]&&(a[2]=t[0]),a[3]<t[1]&&(a[3]=t[1])}),a}Qr.default=Qr;function pd(e,a){a===void 0&&(a={});var t=Qr(e),r=(t[0]+t[2])/2,i=(t[1]+t[3])/2;return ft([r,i],a.properties,a)}function gd(e){if(!e)throw new Error("geojson is required");switch(e.type){case"Feature":return $i(e);case"FeatureCollection":return fd(e);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return zr(e);default:throw new Error("unknown GeoJSON type")}}function $i(e){var a={type:"Feature"};return Object.keys(e).forEach(function(t){switch(t){case"type":case"properties":case"geometry":return;default:a[t]=e[t]}}),a.properties=Fi(e.properties),a.geometry=zr(e.geometry),a}function Fi(e){var a={};return e&&Object.keys(e).forEach(function(t){var r=e[t];typeof r=="object"?r===null?a[t]=null:Array.isArray(r)?a[t]=r.map(function(i){return i}):a[t]=Fi(r):a[t]=r}),a}function fd(e){var a={type:"FeatureCollection"};return Object.keys(e).forEach(function(t){switch(t){case"type":case"features":return;default:a[t]=e[t]}}),a.features=e.features.map(function(t){return $i(t)}),a}function zr(e){var a={type:e.type};return e.bbox&&(a.bbox=e.bbox),e.type==="GeometryCollection"?(a.geometries=e.geometries.map(function(t){return zr(t)}),a):(a.coordinates=Di(e.coordinates),a)}function Di(e){var a=e;return typeof a[0]!="object"?a.slice():a.map(function(t){return Di(t)})}function hd(e,a,t){t===void 0&&(t={});var r=ta(e),i=ta(a),n=gt(i[1]-r[1]),s=gt(i[0]-r[0]),o=gt(r[1]),c=gt(i[1]),f=Math.pow(Math.sin(n/2),2)+Math.pow(Math.sin(s/2),2)*Math.cos(o)*Math.cos(c);return Ti(2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)),t.units)}function md(e,a){if(!e)throw new Error("targetPoint is required");if(!a)throw new Error("points is required");var t,r=Infinity,i=0;return Kr(a,function(n,s){var o=hd(e,n);o<r&&(i=s,r=o)}),t=gd(a.features[i]),t.properties.featureIndex=i,t.properties.distanceToPoint=r,t}function bd(e,a,t){if(t===void 0&&(t={}),!e)throw new Error("point is required");if(!a)throw new Error("polygon is required");var r=ta(e),i=Mi(a),n=i.type,s=a.bbox,o=i.coordinates;if(s&&vd(r,s)===!1)return!1;n==="Polygon"&&(o=[o]);for(var c=!1,f=0;f<o.length&&!c;f++)if(Oi(r,o[f][0],t.ignoreBoundary)){for(var p=!1,u=1;u<o[f].length&&!p;)Oi(r,o[f][u],!t.ignoreBoundary)&&(p=!0),u++;p||(c=!0)}return c}function Oi(e,a,t){var r=!1;a[0][0]===a[a.length-1][0]&&a[0][1]===a[a.length-1][1]&&(a=a.slice(0,a.length-1));for(var i=0,n=a.length-1;i<a.length;n=i++){var s=a[i][0],o=a[i][1],c=a[n][0],f=a[n][1],p=e[1]*(s-c)+o*(c-e[0])+f*(e[0]-s)==0&&(s-e[0])*(c-e[0])<=0&&(o-e[1])*(f-e[1])<=0;if(p)return!t;var u=o>e[1]!=f>e[1]&&e[0]<(c-s)*(e[1]-o)/(f-o)+s;u&&(r=!r)}return r}function vd(e,a){return a[0]<=e[0]&&a[1]<=e[1]&&a[2]>=e[0]&&a[3]>=e[1]}function _d(e){for(var a=wd(e),t=pd(a),r=!1,i=0;!r&&i<a.features.length;){var n=a.features[i].geometry,s,o,c,f,p,u,h,w=!1;if(n.type==="Point")t.geometry.coordinates[0]===n.coordinates[0]&&t.geometry.coordinates[1]===n.coordinates[1]&&(r=!0);else if(n.type==="MultiPoint"){var D=!1;for(h=0;!D&&h<n.coordinates.length;)t.geometry.coordinates[0]===n.coordinates[h][0]&&t.geometry.coordinates[1]===n.coordinates[h][1]&&(r=!0,D=!0),h++}else if(n.type==="LineString")for(h=0;!w&&h<n.coordinates.length-1;)s=t.geometry.coordinates[0],o=t.geometry.coordinates[1],c=n.coordinates[h][0],f=n.coordinates[h][1],p=n.coordinates[h+1][0],u=n.coordinates[h+1][1],Ai(s,o,c,f,p,u)&&(w=!0,r=!0),h++;else if(n.type==="MultiLineString")for(var Z=0;Z<n.coordinates.length;){w=!1,h=0;for(var U=n.coordinates[Z];!w&&h<U.length-1;)s=t.geometry.coordinates[0],o=t.geometry.coordinates[1],c=U[h][0],f=U[h][1],p=U[h+1][0],u=U[h+1][1],Ai(s,o,c,f,p,u)&&(w=!0,r=!0),h++;Z++}else(n.type==="Polygon"||n.type==="MultiPolygon")&&bd(t,n)&&(r=!0);i++}if(r)return t;var ae=Ot([]);for(i=0;i<a.features.length;i++)ae.features=ae.features.concat(dd(a.features[i]).features);return ft(md(t,ae).geometry.coordinates)}function wd(e){return e.type!=="FeatureCollection"?e.type!=="Feature"?Ot([Dt(e)]):Ot([e]):e}function Ai(e,a,t,r,i,n){var s=Math.sqrt((i-t)*(i-t)+(n-r)*(n-r)),o=Math.sqrt((e-t)*(e-t)+(a-r)*(a-r)),c=Math.sqrt((i-e)*(i-e)+(n-a)*(n-a));return s===o+c}var Pi=_d;function kd(e){var a,t,r={type:"FeatureCollection",features:[]};if(e.type==="Feature"?t=e.geometry:t=e,t.type==="LineString")a=[t.coordinates];else if(t.type==="MultiLineString")a=t.coordinates;else if(t.type==="MultiPolygon")a=[].concat.apply([],t.coordinates);else if(t.type==="Polygon")a=t.coordinates;else throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return a.forEach(function(i){a.forEach(function(n){for(var s=0;s<i.length-1;s++)for(var o=s;o<n.length-1;o++)if(!(i===n&&(Math.abs(s-o)===1||s===0&&o===i.length-2&&i[s][0]===i[i.length-1][0]&&i[s][1]===i[i.length-1][1]))){var c=yd(i[s][0],i[s][1],i[s+1][0],i[s+1][1],n[o][0],n[o][1],n[o+1][0],n[o+1][1]);c&&r.features.push(ft([c[0],c[1]]))}})}),r}function yd(e,a,t,r,i,n,s,o){var c,f,p,u,h,w={x:null,y:null,onLine1:!1,onLine2:!1};return c=(o-n)*(t-e)-(s-i)*(r-a),c===0?w.x!==null&&w.y!==null?w:!1:(f=a-n,p=e-i,u=(s-i)*f-(o-n)*p,h=(t-e)*f-(r-a)*p,f=u/c,p=h/c,w.x=e+f*(t-e),w.y=a+f*(r-a),f>=0&&f<=1&&(w.onLine1=!0),p>=0&&p<=1&&(w.onLine2=!0),w.onLine1&&w.onLine2?[w.x,w.y]:!1)}var Ii=kd;function Cd(e){if(!e)throw new Error("geojson is required");var a=[];return Li(e,function(t){a.push(t)}),Ot(a)}var xi=Cd;function Sd(e,a,t,r){r===void 0&&(r={});var i=ta(e),n=gt(i[0]),s=gt(i[1]),o=gt(t),c=ji(a,r.units),f=Math.asin(Math.sin(s)*Math.cos(c)+Math.cos(s)*Math.sin(c)*Math.cos(o)),p=n+Math.atan2(Math.sin(o)*Math.sin(c)*Math.cos(s),Math.cos(c)-Math.sin(s)*Math.sin(f)),u=Xr(p),h=Xr(f);return ft([u,h],r.properties)}function Ed(e,a,t){t===void 0&&(t={});for(var r=t.steps||64,i=t.properties?t.properties:!Array.isArray(e)&&e.type==="Feature"&&e.properties?e.properties:{},n=[],s=0;s<r;s++)n.push(Sd(e,a,s*-360/r,t).geometry.coordinates);return n.push(n[0]),Ei([n],i)}var Ri=Ed;function Td(){this.__data__=[],this.size=0}var jd=Td;function Ld(e,a){return e===a||e!==e&&a!==a}var ya=Ld;function Md(e,a){for(var t=e.length;t--;)if(ya(e[t][0],a))return t;return-1}var Ha=Md,$d=Array.prototype,Fd=$d.splice;function Dd(e){var a=this.__data__,t=Ha(a,e);if(t<0)return!1;var r=a.length-1;return t==r?a.pop():Fd.call(a,t,1),--this.size,!0}var Od=Dd;function Ad(e){var a=this.__data__,t=Ha(a,e);return t<0?void 0:a[t][1]}var Pd=Ad;function Id(e){return Ha(this.__data__,e)>-1}var xd=Id;function Rd(e,a){var t=this.__data__,r=Ha(t,e);return r<0?(++this.size,t.push([e,a])):t[r][1]=a,this}var Hd=Rd;function aa(e){var a=-1,t=e==null?0:e.length;for(this.clear();++a<t;){var r=e[a];this.set(r[0],r[1])}}aa.prototype.clear=jd;aa.prototype.delete=Od;aa.prototype.get=Pd;aa.prototype.has=xd;aa.prototype.set=Hd;var Na=aa;function Nd(){this.__data__=new Na,this.size=0}var Bd=Nd;function Gd(e){var a=this.__data__,t=a.delete(e);return this.size=a.size,t}var qd=Gd;function Vd(e){return this.__data__.get(e)}var Ud=Vd;function Yd(e){return this.__data__.has(e)}var Wd=Yd,Jd=typeof Ye=="object"&&Ye&&Ye.Object===Object&&Ye,Hi=Jd,Zd=typeof self=="object"&&self&&self.Object===Object&&self,Xd=Hi||Zd||Function("return this")(),nt=Xd,Kd=nt.Symbol,At=Kd,Ni=Object.prototype,Qd=Ni.hasOwnProperty,zd=Ni.toString,ka=At?At.toStringTag:void 0;function ep(e){var a=Qd.call(e,ka),t=e[ka];try{e[ka]=void 0;var r=!0}catch(n){}var i=zd.call(e);return r&&(a?e[ka]=t:delete e[ka]),i}var tp=ep,ap=Object.prototype,rp=ap.toString;function np(e){return rp.call(e)}var ip=np,op="[object Null]",lp="[object Undefined]",Bi=At?At.toStringTag:void 0;function sp(e){return e==null?e===void 0?lp:op:Bi&&Bi in Object(e)?tp(e):ip(e)}var Ct=sp;function cp(e){var a=typeof e;return e!=null&&(a=="object"||a=="function")}var ut=cp,up="[object AsyncFunction]",dp="[object Function]",pp="[object GeneratorFunction]",fp="[object Proxy]";function gp(e){if(!ut(e))return!1;var a=Ct(e);return a==dp||a==pp||a==up||a==fp}var Ba=gp,hp=nt["__core-js_shared__"],en=hp,Gi=function(){var e=/[^.]+$/.exec(en&&en.keys&&en.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function mp(e){return!!Gi&&Gi in e}var vp=mp,bp=Function.prototype,wp=bp.toString;function _p(e){if(e!=null){try{return wp.call(e)}catch(a){}try{return e+""}catch(a){}}return""}var St=_p,yp=/[\\^$.*+?()[\]{}|]/g,kp=/^\[object .+?Constructor\]$/,Cp=Function.prototype,Sp=Object.prototype,Ep=Cp.toString,Tp=Sp.hasOwnProperty,jp=RegExp("^"+Ep.call(Tp).replace(yp,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Lp(e){if(!ut(e)||vp(e))return!1;var a=Ba(e)?jp:kp;return a.test(St(e))}var Mp=Lp;function $p(e,a){return e==null?void 0:e[a]}var Fp=$p;function Dp(e,a){var t=Fp(e,a);return Mp(t)?t:void 0}var Et=Dp,Op=Et(nt,"Map"),ra=Op,Ap=Et(Object,"create"),Ca=Ap;function Pp(){this.__data__=Ca?Ca(null):{},this.size=0}var Ip=Pp;function xp(e){var a=this.has(e)&&delete this.__data__[e];return this.size-=a?1:0,a}var Rp=xp,Hp="__lodash_hash_undefined__",Np=Object.prototype,Bp=Np.hasOwnProperty;function Gp(e){var a=this.__data__;if(Ca){var t=a[e];return t===Hp?void 0:t}return Bp.call(a,e)?a[e]:void 0}var qp=Gp,Vp=Object.prototype,Up=Vp.hasOwnProperty;function Yp(e){var a=this.__data__;return Ca?a[e]!==void 0:Up.call(a,e)}var Wp=Yp,Jp="__lodash_hash_undefined__";function Zp(e,a){var t=this.__data__;return this.size+=this.has(e)?0:1,t[e]=Ca&&a===void 0?Jp:a,this}var Xp=Zp;function na(e){var a=-1,t=e==null?0:e.length;for(this.clear();++a<t;){var r=e[a];this.set(r[0],r[1])}}na.prototype.clear=Ip;na.prototype.delete=Rp;na.prototype.get=qp;na.prototype.has=Wp;na.prototype.set=Xp;var qi=na;function Kp(){this.size=0,this.__data__={hash:new qi,map:new(ra||Na),string:new qi}}var Qp=Kp;function zp(e){var a=typeof e;return a=="string"||a=="number"||a=="symbol"||a=="boolean"?e!=="__proto__":e===null}var ef=zp;function tf(e,a){var t=e.__data__;return ef(a)?t[typeof a=="string"?"string":"hash"]:t.map}var Ga=tf;function af(e){var a=Ga(this,e).delete(e);return this.size-=a?1:0,a}var rf=af;function nf(e){return Ga(this,e).get(e)}var of=nf;function lf(e){return Ga(this,e).has(e)}var sf=lf;function cf(e,a){var t=Ga(this,e),r=t.size;return t.set(e,a),this.size+=t.size==r?0:1,this}var uf=cf;function ia(e){var a=-1,t=e==null?0:e.length;for(this.clear();++a<t;){var r=e[a];this.set(r[0],r[1])}}ia.prototype.clear=Qp;ia.prototype.delete=rf;ia.prototype.get=of;ia.prototype.has=sf;ia.prototype.set=uf;var df=ia,pf=200;function ff(e,a){var t=this.__data__;if(t instanceof Na){var r=t.__data__;if(!ra||r.length<pf-1)return r.push([e,a]),this.size=++t.size,this;t=this.__data__=new df(r)}return t.set(e,a),this.size=t.size,this}var gf=ff;function oa(e){var a=this.__data__=new Na(e);this.size=a.size}oa.prototype.clear=Bd;oa.prototype.delete=qd;oa.prototype.get=Ud;oa.prototype.has=Wd;oa.prototype.set=gf;var qa=oa,hf=function(){try{var e=Et(Object,"defineProperty");return e({},"",{}),e}catch(a){}}(),Sa=hf;function mf(e,a,t){a=="__proto__"&&Sa?Sa(e,a,{configurable:!0,enumerable:!0,value:t,writable:!0}):e[a]=t}var Va=mf,vf=Object.prototype,bf=vf.hasOwnProperty;function wf(e,a,t){var r=e[a];(!(bf.call(e,a)&&ya(r,t))||t===void 0&&!(a in e))&&Va(e,a,t)}var tn=wf;function _f(e,a,t,r){var i=!t;t||(t={});for(var n=-1,s=a.length;++n<s;){var o=a[n],c=r?r(t[o],e[o],o,t,e):void 0;c===void 0&&(c=e[o]),i?Va(t,o,c):tn(t,o,c)}return t}var Pt=_f;function yf(e,a){for(var t=-1,r=Array(e);++t<e;)r[t]=a(t);return r}var kf=yf;function Cf(e){return e!=null&&typeof e=="object"}var ht=Cf,Sf="[object Arguments]";function Ef(e){return ht(e)&&Ct(e)==Sf}var Vi=Ef,Ui=Object.prototype,Tf=Ui.hasOwnProperty,jf=Ui.propertyIsEnumerable,Lf=Vi(function(){return arguments}())?Vi:function(e){return ht(e)&&Tf.call(e,"callee")&&!jf.call(e,"callee")},Ua=Lf,Mf=Array.isArray,It=Mf;function $f(){return!1}var Ff=$f,Ea=Ke(function(e,a){var t=a&&!a.nodeType&&a,r=t&&!0&&e&&!e.nodeType&&e,i=r&&r.exports===t,n=i?nt.Buffer:void 0,s=n?n.isBuffer:void 0,o=s||Ff;e.exports=o}),Df=9007199254740991,Of=/^(?:0|[1-9]\d*)$/;function Af(e,a){var t=typeof e;return a=a??Df,!!a&&(t=="number"||t!="symbol"&&Of.test(e))&&e>-1&&e%1==0&&e<a}var an=Af,Pf=9007199254740991;function If(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Pf}var Yi=If,xf="[object Arguments]",Rf="[object Array]",Hf="[object Boolean]",Nf="[object Date]",Bf="[object Error]",Gf="[object Function]",qf="[object Map]",Vf="[object Number]",Uf="[object Object]",Yf="[object RegExp]",Wf="[object Set]",Jf="[object String]",Zf="[object WeakMap]",Xf="[object ArrayBuffer]",Kf="[object DataView]",Qf="[object Float32Array]",zf="[object Float64Array]",eg="[object Int8Array]",tg="[object Int16Array]",ag="[object Int32Array]",rg="[object Uint8Array]",ng="[object Uint8ClampedArray]",ig="[object Uint16Array]",og="[object Uint32Array]",Ee={};Ee[Qf]=Ee[zf]=Ee[eg]=Ee[tg]=Ee[ag]=Ee[rg]=Ee[ng]=Ee[ig]=Ee[og]=!0;Ee[xf]=Ee[Rf]=Ee[Xf]=Ee[Hf]=Ee[Kf]=Ee[Nf]=Ee[Bf]=Ee[Gf]=Ee[qf]=Ee[Vf]=Ee[Uf]=Ee[Yf]=Ee[Wf]=Ee[Jf]=Ee[Zf]=!1;function lg(e){return ht(e)&&Yi(e.length)&&!!Ee[Ct(e)]}var sg=lg;function cg(e){return function(a){return e(a)}}var Ya=cg,xt=Ke(function(e,a){var t=a&&!a.nodeType&&a,r=t&&!0&&e&&!e.nodeType&&e,i=r&&r.exports===t,n=i&&Hi.process,s=function(){try{var o=r&&r.require&&r.require("util").types;return o||n&&n.binding&&n.binding("util")}catch(c){}}();e.exports=s}),Wi=xt&&xt.isTypedArray,ug=Wi?Ya(Wi):sg,rn=ug,dg=Object.prototype,pg=dg.hasOwnProperty;function fg(e,a){var t=It(e),r=!t&&Ua(e),i=!t&&!r&&Ea(e),n=!t&&!r&&!i&&rn(e),s=t||r||i||n,o=s?kf(e.length,String):[],c=o.length;for(var f in e)(a||pg.call(e,f))&&!(s&&(f=="length"||i&&(f=="offset"||f=="parent")||n&&(f=="buffer"||f=="byteLength"||f=="byteOffset")||an(f,c)))&&o.push(f);return o}var nn=fg,gg=Object.prototype;function hg(e){var a=e&&e.constructor,t=typeof a=="function"&&a.prototype||gg;return e===t}var Wa=hg;function mg(e,a){return function(t){return e(a(t))}}var on=mg;function vg(e){return e!=null&&Yi(e.length)&&!Ba(e)}var la=vg;function bg(e){var a=[];if(e!=null)for(var t in Object(e))a.push(t);return a}var wg=bg,_g=Object.prototype,yg=_g.hasOwnProperty;function kg(e){if(!ut(e))return wg(e);var a=Wa(e),t=[];for(var r in e)r=="constructor"&&(a||!yg.call(e,r))||t.push(r);return t}var Cg=kg;function Sg(e){return la(e)?nn(e,!0):Cg(e)}var Rt=Sg,Ja=Ke(function(e,a){var t=a&&!a.nodeType&&a,r=t&&!0&&e&&!e.nodeType&&e,i=r&&r.exports===t,n=i?nt.Buffer:void 0,s=n?n.allocUnsafe:void 0;function o(c,f){if(f)return c.slice();var p=c.length,u=s?s(p):new c.constructor(p);return c.copy(u),u}e.exports=o});function Eg(e,a){var t=-1,r=e.length;for(a||(a=Array(r));++t<r;)a[t]=e[t];return a}var Za=Eg,Tg=on(Object.getPrototypeOf,Object),Ta=Tg,jg=nt.Uint8Array,Ji=jg;function Lg(e){var a=new e.constructor(e.byteLength);return new Ji(a).set(new Ji(e)),a}var Xa=Lg;function Mg(e,a){var t=a?Xa(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.length)}var Ka=Mg,Zi=Object.create,$g=function(){function e(){}return function(a){if(!ut(a))return{};if(Zi)return Zi(a);e.prototype=a;var t=new e;return e.prototype=void 0,t}}(),Fg=$g;function Dg(e){return typeof e.constructor=="function"&&!Wa(e)?Fg(Ta(e)):{}}var Qa=Dg;function Og(e,a){for(var t=-1,r=e==null?0:e.length;++t<r&&a(e[t],t,e)!==!1;);return e}var Ag=Og,Pg=on(Object.keys,Object),Ig=Pg,xg=Object.prototype,Rg=xg.hasOwnProperty;function Hg(e){if(!Wa(e))return Ig(e);var a=[];for(var t in Object(e))Rg.call(e,t)&&t!="constructor"&&a.push(t);return a}var Ng=Hg;function Bg(e){return la(e)?nn(e):Ng(e)}var ln=Bg;function Gg(e,a){return e&&Pt(a,ln(a),e)}var qg=Gg;function Vg(e,a){return e&&Pt(a,Rt(a),e)}var Ug=Vg;function Yg(e,a){for(var t=-1,r=e==null?0:e.length,i=0,n=[];++t<r;){var s=e[t];a(s,t,e)&&(n[i++]=s)}return n}var Wg=Yg;function Jg(){return[]}var Xi=Jg,Zg=Object.prototype,Xg=Zg.propertyIsEnumerable,Ki=Object.getOwnPropertySymbols,Kg=Ki?function(e){return e==null?[]:(e=Object(e),Wg(Ki(e),function(a){return Xg.call(e,a)}))}:Xi,sn=Kg;function Qg(e,a){return Pt(e,sn(e),a)}var zg=Qg;function eh(e,a){for(var t=-1,r=a.length,i=e.length;++t<r;)e[i+t]=a[t];return e}var Qi=eh,th=Object.getOwnPropertySymbols,ah=th?function(e){for(var a=[];e;)Qi(a,sn(e)),e=Ta(e);return a}:Xi,zi=ah;function rh(e,a){return Pt(e,zi(e),a)}var nh=rh;function ih(e,a,t){var r=a(e);return It(e)?r:Qi(r,t(e))}var eo=ih;function oh(e){return eo(e,ln,sn)}var lh=oh;function sh(e){return eo(e,Rt,zi)}var ch=sh,uh=Et(nt,"DataView"),cn=uh,dh=Et(nt,"Promise"),un=dh,ph=Et(nt,"Set"),dn=ph,fh=Et(nt,"WeakMap"),pn=fh,to="[object Map]",gh="[object Object]",ao="[object Promise]",ro="[object Set]",no="[object WeakMap]",io="[object DataView]",hh=St(cn),mh=St(ra),vh=St(un),bh=St(dn),wh=St(pn),Ht=Ct;(cn&&Ht(new cn(new ArrayBuffer(1)))!=io||ra&&Ht(new ra)!=to||un&&Ht(un.resolve())!=ao||dn&&Ht(new dn)!=ro||pn&&Ht(new pn)!=no)&&(Ht=function(e){var a=Ct(e),t=a==gh?e.constructor:void 0,r=t?St(t):"";if(r)switch(r){case hh:return io;case mh:return to;case vh:return ao;case bh:return ro;case wh:return no}return a});var fn=Ht,_h=Object.prototype,yh=_h.hasOwnProperty;function kh(e){var a=e.length,t=new e.constructor(a);return a&&typeof e[0]=="string"&&yh.call(e,"index")&&(t.index=e.index,t.input=e.input),t}var Ch=kh;function Sh(e,a){var t=a?Xa(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.byteLength)}var Eh=Sh,Th=/\w*$/;function jh(e){var a=new e.constructor(e.source,Th.exec(e));return a.lastIndex=e.lastIndex,a}var Lh=jh,oo=At?At.prototype:void 0,lo=oo?oo.valueOf:void 0;function Mh(e){return lo?Object(lo.call(e)):{}}var $h=Mh,Fh="[object Boolean]",Dh="[object Date]",Oh="[object Map]",Ah="[object Number]",Ph="[object RegExp]",Ih="[object Set]",xh="[object String]",Rh="[object Symbol]",Hh="[object ArrayBuffer]",Nh="[object DataView]",Bh="[object Float32Array]",Gh="[object Float64Array]",qh="[object Int8Array]",Vh="[object Int16Array]",Uh="[object Int32Array]",Yh="[object Uint8Array]",Wh="[object Uint8ClampedArray]",Jh="[object Uint16Array]",Zh="[object Uint32Array]";function Xh(e,a,t){var r=e.constructor;switch(a){case Hh:return Xa(e);case Fh:case Dh:return new r(+e);case Nh:return Eh(e,t);case Bh:case Gh:case qh:case Vh:case Uh:case Yh:case Wh:case Jh:case Zh:return Ka(e,t);case Oh:return new r;case Ah:case xh:return new r(e);case Ph:return Lh(e);case Ih:return new r;case Rh:return $h(e)}}var Kh=Xh,Qh="[object Map]";function zh(e){return ht(e)&&fn(e)==Qh}var em=zh,so=xt&&xt.isMap,tm=so?Ya(so):em,am=tm,rm="[object Set]";function nm(e){return ht(e)&&fn(e)==rm}var im=nm,co=xt&&xt.isSet,om=co?Ya(co):im,lm=om,sm=1,cm=2,um=4,uo="[object Arguments]",dm="[object Array]",pm="[object Boolean]",fm="[object Date]",gm="[object Error]",po="[object Function]",hm="[object GeneratorFunction]",mm="[object Map]",vm="[object Number]",fo="[object Object]",bm="[object RegExp]",wm="[object Set]",_m="[object String]",ym="[object Symbol]",km="[object WeakMap]",Cm="[object ArrayBuffer]",Sm="[object DataView]",Em="[object Float32Array]",Tm="[object Float64Array]",jm="[object Int8Array]",Lm="[object Int16Array]",Mm="[object Int32Array]",$m="[object Uint8Array]",Fm="[object Uint8ClampedArray]",Dm="[object Uint16Array]",Om="[object Uint32Array]",Se={};Se[uo]=Se[dm]=Se[Cm]=Se[Sm]=Se[pm]=Se[fm]=Se[Em]=Se[Tm]=Se[jm]=Se[Lm]=Se[Mm]=Se[mm]=Se[vm]=Se[fo]=Se[bm]=Se[wm]=Se[_m]=Se[ym]=Se[$m]=Se[Fm]=Se[Dm]=Se[Om]=!0;Se[gm]=Se[po]=Se[km]=!1;function za(e,a,t,r,i,n){var s,o=a&sm,c=a&cm,f=a&um;if(t&&(s=i?t(e,r,i,n):t(e)),s!==void 0)return s;if(!ut(e))return e;var p=It(e);if(p){if(s=Ch(e),!o)return Za(e,s)}else{var u=fn(e),h=u==po||u==hm;if(Ea(e))return Ja(e,o);if(u==fo||u==uo||h&&!i){if(s=c||h?{}:Qa(e),!o)return c?nh(e,Ug(s,e)):zg(e,qg(s,e))}else{if(!Se[u])return i?e:{};s=Kh(e,u,o)}}n||(n=new qa);var w=n.get(e);if(w)return w;n.set(e,s),lm(e)?e.forEach(function(U){s.add(za(U,a,t,U,e,n))}):am(e)&&e.forEach(function(U,ae){s.set(ae,za(U,a,t,ae,e,n))});var D=f?c?ch:lh:c?Rt:ln,Z=p?void 0:D(e);return Ag(Z||e,function(U,ae){Z&&(ae=U,U=e[ae]),tn(s,ae,za(U,a,t,ae,e,n))}),s}var Am=za,Pm=1,Im=4;function xm(e){return Am(e,Pm|Im)}var Rm=xm,go=Rm;function Hm(e,a,t){(t!==void 0&&!ya(e[a],t)||t===void 0&&!(a in e))&&Va(e,a,t)}var gn=Hm;function Nm(e){return function(a,t,r){for(var i=-1,n=Object(a),s=r(a),o=s.length;o--;){var c=s[e?o:++i];if(t(n[c],c,n)===!1)break}return a}}var Bm=Nm,Gm=Bm(),qm=Gm;function Vm(e){return ht(e)&&la(e)}var Um=Vm,Ym="[object Object]",Wm=Function.prototype,Jm=Object.prototype,ho=Wm.toString,Zm=Jm.hasOwnProperty,Xm=ho.call(Object);function Km(e){if(!ht(e)||Ct(e)!=Ym)return!1;var a=Ta(e);if(a===null)return!0;var t=Zm.call(a,"constructor")&&a.constructor;return typeof t=="function"&&t instanceof t&&ho.call(t)==Xm}var Qm=Km;function zm(e,a){if(!(a==="constructor"&&typeof e[a]=="function")&&a!="__proto__")return e[a]}var hn=zm;function ev(e){return Pt(e,Rt(e))}var tv=ev;function av(e,a,t,r,i,n,s){var o=hn(e,t),c=hn(a,t),f=s.get(c);if(f){gn(e,t,f);return}var p=n?n(o,c,t+"",e,a,s):void 0,u=p===void 0;if(u){var h=It(c),w=!h&&Ea(c),D=!h&&!w&&rn(c);p=c,h||w||D?It(o)?p=o:Um(o)?p=Za(o):w?(u=!1,p=Ja(c,!0)):D?(u=!1,p=Ka(c,!0)):p=[]:Qm(c)||Ua(c)?(p=o,Ua(o)?p=tv(o):(!ut(o)||Ba(o))&&(p=Qa(c))):u=!1}u&&(s.set(c,p),i(p,c,r,n,s),s.delete(c)),gn(e,t,p)}var rv=av;function mo(e,a,t,r,i){e!==a&&qm(a,function(n,s){if(i||(i=new qa),ut(n))rv(e,a,s,t,mo,r,i);else{var o=r?r(hn(e,s),n,s+"",e,a,i):void 0;o===void 0&&(o=n),gn(e,s,o)}},Rt)}var nv=mo;function iv(e){return e}var vo=iv;function ov(e,a,t){switch(t.length){case 0:return e.call(a);case 1:return e.call(a,t[0]);case 2:return e.call(a,t[0],t[1]);case 3:return e.call(a,t[0],t[1],t[2])}return e.apply(a,t)}var lv=ov,bo=Math.max;function sv(e,a,t){return a=bo(a===void 0?e.length-1:a,0),function(){for(var r=arguments,i=-1,n=bo(r.length-a,0),s=Array(n);++i<n;)s[i]=r[a+i];i=-1;for(var o=Array(a+1);++i<a;)o[i]=r[i];return o[a]=t(s),lv(e,this,o)}}var cv=sv;function uv(e){return function(){return e}}var dv=uv,pv=Sa?function(e,a){return Sa(e,"toString",{configurable:!0,enumerable:!1,value:dv(a),writable:!0})}:vo,fv=pv,gv=800,hv=16,mv=Date.now;function vv(e){var a=0,t=0;return function(){var r=mv(),i=hv-(r-t);if(t=r,i>0){if(++a>=gv)return arguments[0]}else a=0;return e.apply(void 0,arguments)}}var bv=vv,wv=bv(fv),_v=wv;function yv(e,a){return _v(cv(e,a,vo),e+"")}var kv=yv;function Cv(e,a,t){if(!ut(t))return!1;var r=typeof a;return(r=="number"?la(t)&&an(a,t.length):r=="string"&&a in t)?ya(t[a],e):!1}var Sv=Cv;function Ev(e){return kv(function(a,t){var r=-1,i=t.length,n=i>1?t[i-1]:void 0,s=i>2?t[2]:void 0;for(n=e.length>3&&typeof n=="function"?(i--,n):void 0,s&&Sv(t[0],t[1],s)&&(n=i<3?void 0:n,i=1),a=Object(a);++r<i;){var o=t[r];o&&e(a,o,r,n)}return a})}var Tv=Ev,jv=Tv(function(e,a,t){nv(e,a,t)}),Lv=jv,wo=Lv;var _o=(e=21)=>{let a="",t=crypto.getRandomValues(new Uint8Array(e));for(;e--;){let r=t[e]&63;r<36?a+=r.toString(36):r<62?a+=(r-26).toString(36).toUpperCase():r<63?a+="_":a+="-"}return a};var Mv={pointOnFeature:Pi,kinks:Ii,flatten:xi,circle:Ri};var er={};Gn(er,{de:()=>yo,en:()=>vn,fr:()=>ko,ja:()=>So,ko:()=>Eo,pl:()=>Co,zh:()=>To});var vn={search_header:"Search",search_no_results:"No results for this search",locales_header:"Locales",show_layers_for_locale:"Show layers for the following locale",layers_header:"Layers",locations_header:"Locations",clear_all_locations:"Clear all locations",layer_group_hide_layers:"Hide layers from group",layer_group_toggle:"Toggle group panel",layer_default_icon:"Default icon",layer_zoom_to_extent:"Zoom to filtered layer extent",layer_visibility:"Toggle visibility",layer_toggle_dashboard:"Toggle layer dashboard",layer_style_header:"Style",layer_style_select_theme:"Select thematic style",layer_style_bring_to_front:"Bring layer to front",layer_style_display_labels:"Display labels",layer_style_switch_caption:"Click on labels to switch visibity or ",layer_style_switch_all:"switch all",layer_grid_legend_min:"min",layer_grid_legend_max:"max",layer_grid_legend_avg:"avg",layer_grid_legend_ratio:"Display colour as a ratio to the size",layer_style_other:"other",layer_style_cluster:"Multiple locations",layer_filter_header:"Filter",layer_filter_select:"Select filter from list",layer_filter_run:"Run Output",layer_filter_clear_all:"Clear all filters",layer_filter_date_after:"After",layer_filter_date_before:"Before",layer_filter_pick:"Pick from calendar",layer_filter_boolean:"True",layer_filter_greater:"Greater or equal",layer_filter_smaller:"Smaller or equal",layer_filter_text:"Search",layer_data:"Layer data",layer_data_viewport_only:"Features in viewport only",layer_data_geojson:"Download as GeoJSON",layer_download:"Download",layer_dataview_header:"Data Views",layer_add_new_location:"Add new locations",layer_draw_point:"Point",layer_draw_polygon:"Polygon",layer_draw_rectangle:"Rectangle",layer_draw_circle:"Circle",layer_draw_line:"Line",layer_draw_freehand:"Freehand",layer_draw_edit:"Edit",layer_draw_save:"Save",layer_draw_update:"Update",layer_draw_undo:"Undo",layer_draw_cancel:"Cancel",layer_draw_last:"Remove last vertex",layer_draw_error:"Invalid geometry. Right click to continue.",layer_draw_isoline_mapbox:"Isoline Mapbox",layer_draw_isoline_here:"Isoline Here",mapbox_isoline_settings:"Mapbox Isoline settings",mapbox_mode:"Mode",mapbox_travel_time:"Travel time in minutes ",mapbox_driving:"Driving",mapbox_walking:"Walking",mapbox_cycling:"Cycling",mapbox_minutes:"Minutes",mapbox_created:"Created",mapbox_error:"No route found. Try alternative set up.",here_isoline_settings:"Here Isoline settings",here_mode:"Mode",here_range:"Range",here_range_type:"Range type",here_routing_type_balanced:"balanced",here_destination:"Destination",here_departure:"Departure",here_enable_traffic:"Enable traffic",here_time:"Time (min)",here_distance:"Distance (km)",here_driving:"driving",here_walking:"walking",here_cargo:"truck",here_hov_lane:"HOV lane",here_created:"Created",here_travel_time:"Travel time in minutes ",here_travel_distance:"Travel distance in kilometres ",here_error:"No route found. Try a longer travel time or alternative setup.",location_drawer_toggle:"Toggle location view drawer",location_zoom:"Zoom map to feature bounds",location_hide_marker:"Hide marker",location_save:"Save changes to cloud",location_remove:"Remove feature from selection",location_edit_geometry:"Edit location geometry",location_no_geometry:"No geometry found for this location.",location_geometry_delete_msg:"Are you sure you want to delete this additional geometry?",location_delete:"Delete location",location_source_layer:"Source layer",location_json_edit_msg:"Invalid JSON.",toolbar_zoom_in:"Zoom in",toolbar_zoom_out:"Zoom out",toolbar_zoom_to_area:"Zoom to area",toolbar_current_location:"Current location",toolbar_measure:"Measure distance",toolbar_fullscreen:"Fullscreen mapview",toolbar_admin:"Open account admin view",toolbar_logout:"Logout",here_transport_mode:"Mode",here_depart:"Depart at",here_arrive:"Arrive at",here_use_as_destination:"Use as destination",here_routing_type_fastest:"fast",here_routing_type_shortest:"short",here_routing_type:"Routing type",here_optimize_for:"Optimize for",here_optimize_for_balanced:"balanced",here_optimize_for_quality:"quality",here_optimize_for_performance:"performance",dataview_no_data:"No data available here."};var yo={layers_header:"Ebenen",locations_header:"Orte",clear_all_locations:"Entferne Auswahl"};var ko={search_header:"Rechercher",search_no_results:"Aucun resultat pour cette recherche",locales_header:"Aires",show_layers_for_locale:"Afficher les couches pour l'aire",layers_header:"Couches",locations_header:"Lieux",clear_all_locations:"DesÃ©lectionner tous les lieux.",layer_group_hide_layers:"Cacher les couches du groupe",layer_group_toggle:"Basculer le panneau du groupe",layer_default_icon:"L'icÃ´ne par dÃ©faut",layer_zoom_to_extent:"Zoom sur l'Ã©tendue de la couche",layer_visibility:"Changer la visiblitÃ©",layer_toggle_dashboard:"Basculer le tableau de bord de la couche",layer_style_header:"Style",layer_style_select_theme:"Choisir un thÃ¨me dans la liste",layer_style_bring_to_front:"La mettre Ã  l'avant",layer_style_display_labels:"Afficher les Ã©tiquettes",layer_style_switch_caption:"Cliquer sur l'etiquette pour changer la visiblitÃ© ou ",layer_style_switch_all:"changer tout",layer_grid_legend_min:"min",layer_grid_legend_max:"max",layer_grid_legend_avg:"avg",layer_grid_legend_ratio:"Rapport de coleur et de taille",layer_style_other:"autre",layer_style_cluster:"Plusieurs lieux",layer_filter_header:"Filtres",layer_filter_select:"Choisir un filtre dans la liste",layer_filter_run:"Obtenir les resultats",layer_filter_clear_all:"Effacer tous les filtres",layer_filter_date_after:"AprÃ¨s",layer_filter_date_before:"Avant",layer_filter_pick:"Dans le calendrier",layer_filter_boolean:"Vrai",layer_filter_greater:"SupÃ©rieur ou Ã©gal",layer_filter_smaller:"InfÃ©rieur ou Ã©gal",layer_filter_text:"Rechercher",layer_data:"DonnÃ©es de la couche",layer_data_viewport_only:"Seulement caractÃ©ristiques en Ã©cran",layer_data_geojson:"TÃ©lÃ©charger GeoJSON",layer_dataview_header:"Vues des donnÃ©es",layer_add_new_location:"Ajouter des nouveaux lieux",layer_draw_point:"Point",layer_draw_polygon:"Polygone",layer_draw_rectangle:"Rectangle",layer_draw_circle:"Cercle",layer_draw_line:"Ligne",layer_draw_freehand:"Ã main levÃ©e",layer_draw_edit:"Modifier",layer_draw_save:"Enregister",layer_draw_update:"Actualiser",layer_draw_undo:"Revenir",layer_draw_cancel:"Annuler",layer_draw_last:"Effacer le dernier point",layer_draw_error:"Cette gÃ©omÃ©trie est invalide. Cliquer droit pour continuer.",layer_draw_isoline_mapbox:"Isoligne de Mapbox",layer_draw_isoline_here:"Isoligne de Here",mapbox_isoline_settings:"ParamÃ¨tres de Mapbox",mapbox_mode:"Mode",mapbox_travel_time:"Temps du trajet en minutes ",mapbox_driving:"En voiture",mapbox_walking:"Ã pied",mapbox_cycling:"Ã velo",mapbox_minutes:"Minutes",mapbox_created:"CrÃ©Ã©e",mapbox_error:"Aucune route n'est trouvÃ©e. Essayez d'autres paramÃ¨tres.",here_isoline_settings:"ParamÃ¨tres de Here",here_mode:"Mode",here_range:"Ampleur",here_range_type:"Type de l'ampleur",here_time:"Temps (min)",here_distance:"Distance (km)",here_driving:"en voiture",here_walking:"Ã  pied",here_cargo:"Le cargo",here_hov_lane:"Voie rÃ©servÃ©e au covoiturage (HOV)",here_created:"CrÃ©Ã©e",here_travel_time:"Temps du trajet en minutes ",here_travel_distance:"Distance du trajet en kilometres ",here_error:"Aucune route n'est trouvÃ©e. Essayez d'autres paramÃ¨tres.",location_drawer_toggle:"Basculer le panneau du lieu",location_zoom:"Zoom sur le lieu",location_hide_marker:"Cacher le marqueur",location_save:"Enregistrer les modifications",location_remove:"Le dÃ©sÃ©lectionner",location_edit_geometry:"Modifier la gÃ©omÃ©trie du lieu",location_no_geometry:"Les gÃ©omÃ©tries n'existent pas pour ce lieux.",location_geometry_delete_msg:"Voulez-vous supprimer la gÃ©omÃ©trie supplÃ©mentaire? Cela ne peut Ãªtre dÃ©fait.",location_delete:"Supprimer le lieu",location_json_edit_msg:"Objet JSON incorrect.",location_source_layer:"La couche de source",toolbar_zoom_in:"Zoomer",toolbar_zoom_out:"DÃ©-zoomer",toolbar_zoom_to_area:"Zoomer sur un encadrÃ©",toolbar_current_location:"Localisation actuelle",toolbar_measure:"Mesurer des distances",toolbar_fullscreen:"Carte en plein Ã©cran",toolbar_admin:"Afficher le compte administrateur",toolbar_logout:"Se dÃ©connecter du compte",here_transport_mode:"Type de transport",here_depart:"Partir Ã ",here_arrive:"Arriver Ã ",here_use_as_destination:"En tant que destination",here_routing_type_fastest:"vite",here_routing_type_shortest:"court",here_routing_type:"Type de trajet",here_optimize_for:"Optimiser",here_optimize_for_balanced:"l'Ã©quilibre",here_optimize_for_quality:"la qualitÃ©",here_optimize_for_performance:"les performances",dataview_no_data:"Aucune donnÃ©e disponible."};var Co={search_header:"Szukaj",search_no_results:"Nic nie znaleziono",locales_header:"Regiony",show_layers_for_locale:"PokaÅ¼ warstwy dle tego regionu",layers_header:"Warstwy",locations_header:"Miejsca",clear_all_locations:"WyczyÅÄ selekcje",layer_group_hide_layers:"Ukryj warstwy z tej grupy",layer_group_toggle:"WidocznoÅÄ panelu grupy",layer_default_icon:"DomyÅlny symbol",layer_zoom_to_extent:"PokaÅ¼ zasiÄg warstwy",layer_visibility:"WidocznoÅÄ",layer_toggle_dashboard:"WidocznoÅÄ panelu warstwy",layer_style_header:"Styl",layer_style_select_theme:"Wybierz styl tematyczny",layer_style_bring_to_front:"Warstwa na wierzch",layer_style_display_labels:"PokaÅ¼ etykiety",layer_style_switch_caption:"Kliknij etykiety aby zmieniÄ widocznoÅÄ albo ",layer_style_switch_all:"zmieÅ wszystkie",layer_grid_legend_min:"min.",layer_grid_legend_max:"maks.",layer_grid_legend_avg:"Åred.",layer_grid_legend_ratio:"PokaÅ¼ kolor w proporcji do rozmiaru",layer_style_other:"inne",layer_style_cluster:"WiÄcej miejsc",layer_filter_header:"Filtruj",layer_filter_select:"Wybierz filtr z listy",layer_filter_run:"Przelicz",layer_filter_clear_all:"WyczyÅÄ filtry",layer_filter_date_after:"Przed",layer_filter_date_before:"Po",layer_filter_pick:"Z kalendarza",layer_filter_boolean:"Tak",layer_filter_greater:"WiÄksze lub rÃ³wne",layer_filter_smaller:"Mniejsze lub rÃ³wne",layer_filter_text:"Szukaj",layer_data:"Dane warstwy",layer_data_viewport_only:"Tylko widoczne",layer_data_geojson:"Pobierz jako GeoJSON",layer_dataview_header:"Widoki danych",layer_add_new_location:"Dodaj nowe miejsca",layer_draw_point:"Punkt",layer_draw_polygon:"Poligon",layer_draw_rectangle:"ProstokÄt",layer_draw_circle:"Okrag",layer_draw_line:"Linia",layer_draw_freehand:"OdrÄcznie",layer_draw_edit:"Edytuj",layer_draw_save:"Zapisz",layer_draw_update:"ZmieÅ",layer_draw_undo:"Cofnij",layer_draw_cancel:"Anuluj",layer_draw_last:"UsuÅ ostatni wierzchoÅek",layer_draw_error:"Niepoprawna geometria. Kliknij prawym aby kontynuowaÄ.",layer_draw_isoline_mapbox:"Izolinia Mapbox",layer_draw_isoline_here:"Izolinia Here",mapbox_isoline_settings:"Ustawienia izolinii Mapbox",mapbox_mode:"Typ",mapbox_travel_time:"Czas podrÃ³Å¼y w minutach ",mapbox_driving:"Samochodem",mapbox_walking:"PiechotÄ",mapbox_cycling:"Rowerem",mapbox_minutes:"Minuty",mapbox_created:"Utworzono",mapbox_error:"Nie znaleziono trasy. WyprÃ³buj inne ustawienia.",here_isoline_settings:"Ustawienia izolinii Here",here_mode:"Typ",here_range:"ZasiÄg",here_range_type:"Typ zasiÄgu",here_time:"Czas (min)",here_distance:"OdlegÅoÅÄ (km)",here_driving:"samochodem",here_walking:"piechotÄ",here_cargo:"transport towarÃ³w",here_hov_lane:"transport osÃ³b",here_created:"Utworzono",here_travel_time:"Czas podrÃ³Å¼y w minutach ",here_travel_distance:"OdlegÅoÅÄ w kilometrach ",here_error:"Nie znaleziono trasy. WyprÃ³buj dÅuÅ¼szy czas podrÃ³Å¼y lub inne ustawienia.",location_drawer_toggle:"WidocznoÅÄ panelu miejsca",location_zoom:"PokaÅ¼ zasiÄg miejsca",location_hide_marker:"Ukryj ikonÄ",location_save:"Zapisz zmiany",location_remove:"Odznacz miejsce",location_edit_geometry:"Edytuj geometriÄ miejsca",location_no_geometry:"Nie znaleziono geometrii dla tego miejsca.",location_geometry_delete_msg:"Czy na pewno chcesz usunÄÄ geometriÄ towarzyszÄcÄ? Tego nie moÅ¼na cofnÄÄ.",location_delete:"UsuÅ miejsce",location_source_layer:"Warstaw ÅºrÃ³dÅowa",location_json_edit_msg:"Niepoprawny obiekt JSON.",toolbar_zoom_in:"PowiÄksz",toolbar_zoom_out:"Pomniejsz",toolbar_zoom_to_area:"PokaÅ¼ obszar",toolbar_current_location:"Obecna lokalizacja",toolbar_measure:"Pomiar odlegÅoÅci",toolbar_fullscreen:"Mapa na peÅnym ekranie",toolbar_admin:"PokaÅ¼ konto administratora",toolbar_logout:"Wyloguj siÄ",here_transport_mode:"Årodek transportu",here_depart:"Rozpocznij",here_arrive:"OsiÄgnij cel",here_use_as_destination:"Jako cel podrÃ³Å¼y",here_routing_type_fastest:"szybka",here_routing_type_shortest:"krÃ³tka",here_routing_type:"Trasa",here_optimize_for:"Optymalizacja",here_optimize_for_balanced:"zrÃ³wnowaÅ¼ona",here_optimize_for_quality:"jakoÅÄ",here_optimize_for_performance:"wydajnoÅÄ",dataview_no_data:"Brak danych do wyÅwietlenia."};var So={search_header:"æ¤ç´¢",search_no_results:"çµæãªã",locales_header:"ã­ã«ã¼ã«",show_layers_for_locale:"ä»¥ä¸ã®ã­ã«ã¼ã«ã«å¯¾ãã¬ã¤ã¤ã¼ãè¡¨ç¤º",layers_header:"ã¬ã¤ã¤ã¼",locations_header:"ã­ã±ã¼ã·ã§ã³",clear_all_locations:"å¨ã­ã±ã¼ã·ã§ã³ãã¯ãªã¢",layer_group_hide_layers:"ã°ã«ã¼ãããã¬ã¤ã¤ã¼ãé ã",layer_group_toggle:"ã°ã«ã¼ãããã«åæ¿ã",layer_default_icon:"ããã©ã«ãã¢ã¤ã³ã³",layer_zoom_to_extent:"ãã£ã«ã¿ã¼ãããã¬ã¤ã¤ã¼ç¯å²ããºã¼ã ã«",layer_visibility:"è¡¨ç¤ºåæ¿",layer_toggle_dashboard:"ã¬ã¤ã¤ã¼ããã·ã¥ãã¼ãåæ¿ã",layer_style_header:"ã¹ã¿ã¤ã«",layer_style_select_theme:"ãã¼ãã¹ã¿ã¤ã«ãé¸æ",layer_style_bring_to_front:"ã¬ã¤ã¤ã¼ãåã«",layer_style_display_labels:"ã©ãã«ãè¡¨ç¤º",layer_style_switch_caption:"è¡¨ç¤ºåæ¿ãã«ã¯åã©ãã«ãã¯ãªãã¯ããã ",layer_style_switch_all:"å¨è¡¨ç¤ºæãã¯å¨éè¡¨ç¤º",layer_grid_legend_min:"æå°",layer_grid_legend_max:"æå¤§",layer_grid_legend_avg:"å¹³å",layer_grid_legend_ratio:"è²ã¯ãµã¤ãºã®æ¯çã§è¡¨ç¤º",layer_style_other:"ãã®ä»",layer_style_cluster:"å¤æ°ã®ã­ã±ã¼ã·ã§ã³",layer_filter_header:"ãã£ã«ã¿ã¼",layer_filter_select:"ãªã¹ããããã£ã«ã¿ã¼ãé¸æ",layer_filter_run:"ã¢ã¦ãããããå®è¡",layer_filter_clear_all:"å¨ãã£ã«ã¿ã¼ãã¯ãªã¢",layer_filter_date_after:"å¾",layer_filter_date_before:"å",layer_filter_pick:"ã«ã¬ã³ãã¼ããé¸æ",layer_filter_boolean:"TRUE",layer_filter_greater:"ä»¥ä¸",layer_filter_smaller:"ä»¥ä¸",layer_filter_text:"æ¤ç´¢",layer_data:"Layer data",layer_data_viewport_only:"Features in viewport only",layer_data_geojson:"Download as GeoJSON",layer_dataview_header:"ãã¼ã¿ãã¥ã¼",layer_add_new_location:"æ°ããã­ã±ã¼ã·ã§ã³ãè¿½å ",layer_draw_point:"ãã¤ã³ã",layer_draw_polygon:"ããªã´ã³",layer_draw_rectangle:"é·æ¹å½¢",layer_draw_circle:"ä¸¸",layer_draw_line:"ç·",layer_draw_freehand:"ããªã¼ãã³ã",layer_draw_edit:"ç·¨é",layer_draw_save:"ä¿å­",layer_draw_update:"æ´æ°",layer_draw_undo:"ã¢ã³ãã¥",layer_draw_cancel:"ã­ã£ã³ã»ã«",layer_draw_last:"æå¾ã®ãã¼ããã¯ã¹ãåé¤",layer_draw_error:"ç¡å¹ãªã¸ãªã¡ããªã¼ å³ã¯ãªãã¯ã§ç¶ãã",layer_draw_isoline_mapbox:"ã¤ã½ãªã³ MAPBOX",layer_draw_isoline_here:"ã¤ã½ãªã³ HERE",mapbox_isoline_settings:"MAPBOXã®ã¤ã½ãªã³è¨­å®",mapbox_mode:"ã¢ã¼ã",mapbox_travel_time:"ç§»åæé (å) ",mapbox_driving:"ãã©ã¤ãã³ã°",mapbox_walking:"ã¦ã©ã¼ã­ã³ã°",mapbox_cycling:"ãµã¤ã¯ãªã³ã°",mapbox_recent:"æè¿ã®ã¤ã½ãªã³",mapbox_minutes:"ç§»åæé (å)",mapbox_created:"ä½ææ¸",mapbox_error:"ã«ã¼ããªããä»ã®è¨­å®ãé¸ãã§ãã ãã",here_isoline_settings:"HEREã®ã¤ã½ãªã³è¨­å®",here_mode:"ã¢ã¼ã",here_range:"ç¯å²",here_range_type:"ç¯å²ã¿ã¤ã",here_time:"ç§»åæé (å)",here_distance:"ç§»åè·é¢ (km)",here_driving:"ãã©ã¤ãã³ã°",here_walking:"ã¦ã©ã¼ã­ã³ã°",here_cargo:"è²¨ç©",here_hov_lane:"HOVï¼High Occupied Vehicleä¹è»çã®é«ãè»ç¨ï¼ã¬ã¼ã³",here_recent:"æè¿ã®ã¤ã½ãªã³",here_created:"ä½ææ¸",here_travel_time:"ç§»åæé (å) ",here_travel_distance:"ç§»åè·é¢ (km) ",here_error:"ã«ã¼ããªããããé·ãç§»åæéãæãã¯ä»ã®è¨­å®ãé¸ãã§ãã ãã",location_drawer_toggle:"ã­ã±ã¼ã·ã§ã³ãã¥ã¼ãã­ã¯ã¼ããã°ã«",location_zoom:"ãã£ã¼ãã£ç¯å²ã«ã¯ãããããºã¼ã ",location_hide_marker:"ãã¼ã«ã¼ãé ã",location_save:"ã¯ã©ã¦ãã«å¤æ´ãä¿å­",location_remove:"é¸æãããã£ã¼ãã£ã¼ï¼æ©è½ï¼ãåé¤",location_edit_geometry:"ã­ã±ã¼ã·ã§ã³ã¸ãªã¡ããªã¼ãç·¨é",location_no_geometry:"ãã®å ´æã®ã¸ãªã¡ããªãè¦ã¤ããã¾ããã",location_geometry_delete_msg:"è¿½å ã¸ãªã¡ããªã¼ãæ¬å½ã«åé¤ãã¾ãããåãæ¶ãä¸å¯",location_delete:"ã­ã±ã¼ã·ã§ã³ãåé¤",location_source_layer:"åã®ã¬ã¤ã¤ã¼",location_json_edit_msg:"ç¡å¹ãªJSON",toolbar_zoom_in:"ãºã¼ã ã¤ã³",toolbar_zoom_out:"ãºã¼ã ã¢ã¦ã",toolbar_zoom_to_area:"ã¨ãªã¢ããºã¼ã ã«",toolbar_current_location:"ç¾å¨å°",toolbar_measure:"è·é¢ãè¨æ¸¬",toolbar_fullscreen:"ãã«ã¹ã¯ãªã¼ã³ ããããã¥ã¼",toolbar_admin:"ã¢ã«ã¦ã³ãã¢ããã³ãã¥ã¼ãéã",toolbar_logout:"ã­ã°ã¢ã¦ã"};var Eo={search_header:"ê²ì",search_no_results:"ê²ìê²°ê³¼ ìì",locales_header:"íì¥",show_layers_for_locale:"ë¤ì íì¥ì ë ì´ì´(ì¸µ) ë³´ì¬ì£¼ê¸°",layers_header:"ë ì´ì´(ì¸µ)",locations_header:"ìì¹",clear_all_locations:"ëª¨ë  ìì¹ ì ê±°",layer_group_hide_layers:"ê·¸ë£¹ìì ë ì´ì´ ì¨ê¸°ê¸°",layer_group_toggle:"í ê¸ ê·¸ë£¹ í¨ë",layer_default_icon:"ê¸°ë³¸ ìì´ì½",layer_zoom_to_extent:"íí°ë ë ì´ì´í¬ê¸°ì ì¤(zoom)",layer_visibility:"í ê¸ ê°ìì±",layer_toggle_dashboard:"í ê¸ ë ì´ì´ ê³ê¸°í",layer_style_header:"ì¤íì¼",layer_style_select_theme:"ì£¼ì ë³ ì¤íì¼ ì í",layer_style_bring_to_front:"ë ì´ì´ ìì¼ë¡ ê°ì ¸ì¤ê¸°",layer_style_display_labels:"ë¼ë²¨ íì",layer_style_switch_caption:"ê°ìì± ë³ê²½ì ìí´ ë¼ë²¨ í´ë¦­ ëë ",layer_style_switch_all:"ëª¨ë ë³ê²½",layer_grid_legend_min:"ìµì",layer_grid_legend_max:"ìµë",layer_grid_legend_avg:"íê· ",layer_grid_legend_ratio:"í¬ê¸°ë¹ì¨ì ë°ë¥¸ ìì íì",layer_style_other:"ê¸°í",layer_style_cluster:"ë³µì ìì¹",layer_filter_header:"íí°",layer_filter_select:"ë¦¬ì¤í¸ë¡ ë¶í° íí° ì í",layer_filter_run:"ê²°ê³¼ íì",layer_filter_clear_all:"ì ì²´ íí° ì ê±°",layer_filter_date_after:"ì ",layer_filter_date_before:"í",layer_filter_pick:"ë¬ë ¥ìì ì í",layer_filter_boolean:"ì°¸",layer_filter_greater:"ì´ì",layer_filter_smaller:"ì´í",layer_filter_text:"ê²ì",layer_data:"Layer data",layer_data_viewport_only:"Features in viewport only",layer_data_geojson:"Download as GeoJSON",layer_dataview_header:"ë°ì´í° ë³´ê¸°",layer_add_new_location:"ìë¡ì´ ìì¹ ì¶ê°",layer_draw_point:"ì ",layer_draw_polygon:"ë¤ê°í",layer_draw_rectangle:"ì§ì¬ê°í",layer_draw_circle:"ì",layer_draw_line:"ì ",layer_draw_freehand:"ìì¼ë¡ ê·¸ë¦¼(ìì  ì¬ë)",layer_draw_edit:"í¸ì§",layer_draw_save:"ì ì¥",layer_draw_update:"ìë°ì´í¸",layer_draw_undo:"ëëë¦¬ê¸°",layer_draw_cancel:"ì·¨ì",layer_draw_last:"ë§ì§ë§ ì ì (ê¼­ì§ì ) ì ê±°",layer_draw_error:"íë¹íì§ ìë ì§ì¤ë©í¸ë¦¬. ê³ìíë ¤ë©´ ë§ì°ì¤ì¤ë¥¸ìª½ í´ë¦­",layer_draw_isoline_mapbox:"ë±ì¹ì  ë§µë°ì¤",layer_draw_isoline_here:"Here ë±ì¹ì ",mapbox_isoline_settings:"ë±ì¹ì  Mapbox",mapbox_mode:"ëª¨ë",mapbox_travel_time:"ì¬íìê°(ë¶) ",mapbox_driving:"ì´ì ",mapbox_walking:"ëë³´",mapbox_cycling:"ì¬ì´í´",mapbox_recent:"ìµê·¼ ë±ì¹ì ",mapbox_minutes:"ì¬íìê°(ë¶)",mapbox_created:"ìì±",mapbox_error:"ê²½ë¡ ìì. ë¤ë¥¸ ì¤ì  ìë",here_isoline_settings:"ë±ì¹ì  Here",here_mode:"ëª¨ë",here_range:"ë²ì",here_range_type:"ë²ì ì í",here_time:"ì¬íìê°(ë¶)",here_distance:"ì¬íê±°ë¦¬(km)",here_driving:"ì´ì ",here_walking:"ëë³´",here_cargo:"íë¬¼",here_hov_lane:"ë¤ì¸ì¹ ì ì©ì°¨ë¡",here_recent:"ìµê·¼ ë±ì¹ì ",here_created:"ìì±",here_travel_time:"ì¬íìê°(ë¶) ",here_travel_distance:"ì¬íê±°ë¦¬(km) ",here_error:"ê²½ë¡ ìì. ë ê¸´ ì¬íìê° ëë ë¤ë¥¸ ì¤ì  ìë",location_drawer_toggle:"í ê¸ ìì¹ ë·° í¨",location_zoom:"íê³ë¥¼ í¬í¨í ì¤ ì§ë",location_hide_marker:"ë§ì»¤ ì¨ê¸°ê¸°",location_save:"ë³ê²½ì¬í­ í¬ë¼ì°ë ì ì¥",location_remove:"ì íìì í¹ì§ ì ê±°",location_edit_geometry:"ìì¹ ì§ì¤ë©í¸ë¦¬ í¸ì§",location_no_geometry:"ì´ ìì¹ì ëí ì§ì¤ë©í¸ë¦¬ê° ììµëë¤.",location_geometry_delete_msg:"ì¶ê°ì ì¸ ì§ì¤ë©í¸ë¦¬ ì­ì ë¥¼ ìíì­ëê¹? ëëë¦¬ê¸° ë¶ê°",location_delete:"ìì¹ ì­ì ",location_source_layer:"ìë£ ì¶ì² ë ì´ì´",location_json_edit_msg:"íë¹íì§ìì JSON",toolbar_zoom_in:"ì¤ì¸",toolbar_zoom_out:"ì¤ìì",toolbar_zoom_to_area:"í´ë¹ì§ì­ ì¤(Zoom)",toolbar_current_location:"íì¬ ìì¹",toolbar_measure:"ê±°ë¦¬ì¸¡ì ",toolbar_fullscreen:"ì§ëë·° ì ì²´íë©´",toolbar_admin:"ê³ì ê´ë¦¬ë·° ì¤í",toolbar_logout:"ë¡ê·¸ìì"};var To={search_header:"æç´¢",search_no_results:"æªæ¾å°ç¸å³å°ç¹",locales_header:"å°åº",show_layers_for_locale:"æ¾ç¤ºä»¥ä¸å°åº",layers_header:"å¾å±",locations_header:"å°ç¹",clear_all_locations:"æ¸é¤ææå°ç¹",layer_group_hide_layers:"éèå¾å±",layer_group_toggle:"åæ¢ç»é¢æ¿",layer_default_icon:"é»è®¤å¾æ ",layer_zoom_to_extent:"ç¼©æ¾è³ç¸åºç­éèå´",layer_visibility:"åæ¢å¯è§æ§",layer_toggle_dashboard:"åæ¢å¾å±ä»ªè¡¨æ¿",layer_style_header:"é£æ ¼æ ·å¼",layer_style_select_theme:"éæ©ä¸»é¢é£æ ¼",layer_style_bring_to_front:"å¾å±ç½®é¡¶",layer_style_display_labels:"æ¾ç¤ºæ ç­¾",layer_style_switch_caption:"åå»å¾æ ä»¥åæ¢å¯è§æ§ ",layer_style_switch_all:"å¨é¨åæ¢",layer_grid_legend_min:"æä½",layer_grid_legend_max:"æé«",layer_grid_legend_avg:"å¹³å",layer_grid_legend_ratio:"æ¾ç¤ºé¢è²ä¸å°ºå¯¸æ¯ä¾",layer_style_other:"å¶å®",layer_style_cluster:"å¤ä¸ªå°ç¹",layer_filter_header:"ç­é",layer_filter_select:"ä»åè¡¨ç­é",layer_filter_run:"è¾åºç»æ",layer_filter_clear_all:"æ¸é¤ææç­éè®¾ç½®",layer_filter_date_after:"å",layer_filter_date_before:"å",layer_filter_pick:"ä»æ¥åä¸­éæ©",layer_filter_boolean:"TRUE",layer_filter_greater:"å¤§äºæç­äº",layer_filter_smaller:"å°äºæç­äº",layer_filter_text:"æç´¢",layer_data:"å¾å±æ°æ®",layer_data_viewport_only:"ä»å½åé¡µé¢è¦ç´ ",layer_data_geojson:"ä¸è½½ä¸ºGeoJSON",layer_dataview_header:"æ°æ®æ£è§",layer_add_new_location:"æ°æ®æ£è§",layer_draw_point:"ç¹",layer_draw_polygon:"å¤è¾¹å½¢",layer_draw_rectangle:"é¿æ¹å½¢",layer_draw_circle:"å",layer_draw_line:"çº¿",layer_draw_freehand:"ä»»æå¾å½¢",layer_draw_edit:"ç¼è¾",layer_draw_save:"ä¿å­",layer_draw_update:"æ´æ°",layer_draw_undo:"æ¤æ¶",layer_draw_cancel:"åæ¶",layer_draw_last:"å é¤æåä¸ä¸ªé¡¶ç¹",layer_draw_error:"æ æå¾å½¢ï¼åå»å³é®ä»¥ç»§ç»­",layer_draw_isoline_mapbox:"ç­å¼çº¿å¾æ¡",layer_draw_isoline_here:"æ­¤å¤ç­å¼çº¿",mapbox_isoline_settings:"Mapboxç­å¼çº¿è®¾ç½®",mapbox_mode:"æ¨¡å¼",mapbox_travel_time:"ä»¥åéè®¡äº¤éæ¶é´ ",mapbox_driving:"æºå¨è½¦è¡",mapbox_walking:"æ­¥è¡",mapbox_cycling:"éªè¡",mapbox_recent:"æè¿æçç­å¼çº¿",mapbox_minutes:"ä»¥åéè®¡äº¤éæ¶é´",mapbox_created:"å·²å»ºç«",mapbox_error:"æ¾ä¸å°è·¯çº¿ï¼å°è¯å¶ä»è®¾ç½®",here_isoline_settings:"Hereç­å¼çº¿è®¾ç½®",here_mode:"æ¨¡å¼",here_range:"èå´",here_range_type:"èå´ç±»å",here_time:"ä»¥åéè®¡äº¤éæ¶é´",here_distance:"è¡é©¶è·ç¦»ï¼å¬éï¼",here_driving:"æºå¨è½¦è¡",here_walking:"æ­¥è¡",here_cargo:"è´§ç©",here_hov_lane:"HOVï¼High Occupied Vehicle)è½¦é",here_recent:"æè¿æçç­å¼çº¿",here_created:"å·²å»ºç«",here_travel_time:"ä»¥åéè®¡äº¤éæ¶é´ ",here_travel_distance:"è¡é©¶è·ç¦»ï¼å¬éï¼",here_error:"æ¾ä¸å°è·¯çº¿ï¼è¯·å°è¯å¢é¿äº¤éæ¶é´æå¶ä»è®¾ç½®ã",location_drawer_toggle:"åæ¢å°ç¹ä½ç½®è§å¾",location_zoom:"ç¼©æ¾å°å¾è³ç®æ èå´",location_hide_marker:"éèæ è®°",location_save:"å°æ´æ¹ä¿å­è³äº",location_remove:"å é¤æéç®æ è¦ç´ ",location_edit_geometry:"ç¼è¾å°ç¹æä½ç½®è¾¹ç",location_no_geometry:"å¨æ­¤ä½ç½®æ¾ä¸å°å¹¾ä½ã",location_geometry_delete_msg:"æ¯å¦ç¡®å®å é¤æ°å¢çå ä½å¾å½¢ï¼å½ä»¤æ§è¡åå°æ æ³æ¤æ¶ã",location_delete:"å é¤å°ç¹",location_source_layer:"æ¥çæå¨å¾å±",location_json_edit_msg:"æ æçJSON",toolbar_zoom_in:"æ¾å¤§",toolbar_zoom_out:"ç¼©å°",toolbar_zoom_to_area:"ç¼©æ¾è³åºå",toolbar_current_location:"å½åä½ç½®",toolbar_measure:"æµéè·ç¦»",toolbar_fullscreen:"å¨å±æ¾ç¤ºå°å¾",toolbar_admin:"å¼å¯å¸æ·ç®¡çåè§å¾",toolbar_logout:"éåº"};var jo=e=>{return{get:{layer:t=>a("layer",t),locale:t=>a("locale",t),locales:t=>a("locales",t)},locale:{}};function a(t,r={}){return new Promise((i,n)=>{let s=new XMLHttpRequest;s.open("GET",`${e.host}/api/workspace/get/${t}?`+e.utils.paramString(r)),s.responseType="json",s.onload=o=>{if(o.target.status!==200)return n();i(o.target.response)},s.send()})}};var Lo=e=>{if(!e.hooks)return null;let a={layers:[],locations:[]};return window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,(c,f,p)=>{a[f]?a[f]=decodeURI(p).split(","):a[f]=decodeURI(p)}),a.token&&(window.history.replaceState({},document.title,window.location.href.replace(new RegExp(`token=${a.token}`),"")),delete a.token),{current:a,set:t,remove:r,removeAll:i,push:n,filter:s};function t(c){Object.assign(e.hooks.current,c),o()}function r(c){Array.isArray(e.hooks.current[c])?e.hooks.current[c].length=0:delete e.hooks.current[c],o()}function i(){Object.keys(e.hooks.current).forEach(c=>r(c)),o()}function n(c,f){e.hooks.current[c]?e.hooks.current[c].indexOf(f)<0&&e.hooks.current[c].push(f):e.hooks.current[c]=[f],o()}function s(c,f){e.hooks.current[c]=e.hooks.current[c].filter(p=>p!==f),o()}function o(){try{window.history.pushState({},document.title,`?${e.utils.paramString(e.hooks.current)}`)}catch(c){console.log(c)}}};var Mo=e=>(a={})=>{let t=Object.assign(e.locale,a);if(!t.target)return console.log("No target for mapview!");e.mapview.node=t.target,e.mapview.srid=t.srid||"3857";let r=e.hooks&&e.hooks.current.z||t.view&&t.view.z||t.minZoom||0,i=ol.proj.fromLonLat([parseFloat(e.hooks&&e.hooks.current.lng||t.view&&t.view.lng||0),parseFloat(e.hooks&&e.hooks.current.lat||t.view&&t.view.lat||0)]),n=t.bounds&&ol.proj.transformExtent([parseFloat(t.bounds.west||-180),parseFloat(t.bounds.south||-90),parseFloat(t.bounds.east||180),parseFloat(t.bounds.north||90)],"EPSG:4326","EPSG:"+e.mapview.srid);if(e.map=new ol.Map({target:e.mapview.node,interactions:ol.interaction.defaults({mouseWheelZoom:t.scrollWheelZoom||!1,PinchRotate:{threshold:3}}),controls:[],view:new ol.View({projection:"EPSG:"+e.mapview.srid,zoom:r,minZoom:t.minZoom,maxZoom:t.maxZoom,center:i,extent:n})}),e.map.on("pointermove",c=>{e.mapview.position=c.coordinate}),e.map.on("movestart",()=>e.mapview.interaction.break=!0),e.mapview.node.addEventListener("changeEnd",()=>{if(Object.values(e.layers.list).forEach(c=>{c.view&&c.tables&&(c.tableCurrent()===null?c.view.classList.add("disabled"):c.view.classList.remove("disabled"))}),e.hooks){let c=ol.proj.transform(e.map.getView().getCenter(),"EPSG:"+e.mapview.srid,"EPSG:4326");e.hooks.set({lat:c[1],lng:c[0],z:e.map.getView().getZoom()})}setTimeout(()=>delete e.mapview.interaction.break,500)}),e.mapview.interaction.highlight.begin(),t.zoomControl&&e.map.addControl(new ol.control.Zoom),t.attribution&&e.mapview.attribution.create(),t.showScaleBar&&e.map.addControl(new ol.control.ScaleLine({target:"ol-scale",units:t.showScaleBar.units?t.showScaleBar.units:"metric"})),t.maskBounds){let c=[[180,90],[180,-90],[-180,-90],[-180,90],[180,90]],f=[[t.bounds.east,t.bounds.north],[t.bounds.east,t.bounds.south],[t.bounds.west,t.bounds.south],[t.bounds.west,t.bounds.north],[t.bounds.east,t.bounds.north]],p=new ol.Feature({geometry:new ol.geom.Polygon([c,f]).transform("EPSG:4326","EPSG:"+e.mapview.srid)}),u=new ol.layer.Vector({source:new ol.source.Vector({features:[p]}),style:new ol.style.Style({fill:new ol.style.Fill({color:e.utils.Chroma("#000").alpha(.2).rgba()})}),zIndex:999});e.map.addLayer(u)}e.map.on("moveend",o);let s;function o(){clearTimeout(s),s=setTimeout(()=>{e.mapview.node.dispatchEvent(e.mapview.changeEndEvent)},500)}Object.values(e.layers.list).forEach(c=>c.display&&c.show())};var $o=e=>{let a={create:t,check:r,links:e.utils.html.node`<div>`};return a;function t(){!e.locale.attribution.target||(a.node=e.locale.attribution.target,e.locale.attribution.target.appendChild(a.links))}function r(){let i=Object.assign({},e.locale.attribution&&e.locale.attribution.links||{});Object.values(e.layers.list).forEach(n=>{n.display&&n.attribution&&Object.assign(i,n.attribution)}),e.utils.render(a.links,e.utils.html`
    ${Object.entries(i).map(n=>e.utils.html`
      <a target="_blank" href="${n[1]}">${n[0]}`)}`)}};var Fo=e=>{let a={toggle:t,active:!1,icon:{type:"geo",scale:.05},marker:new ol.Feature({geometry:new ol.geom.Point([0,0])})};return a;function t(){a.active=!a.active;let r=!0;if(a.L||(a.L=new ol.layer.Vector({source:new ol.source.Vector({features:[a.marker]}),zIndex:40,style:new ol.style.Style({image:e.mapview.icon(e.mapview.locate.icon)})})),!a.active)return e.map.removeLayer(a.L);e.map.addLayer(a.L),a.watcher||(a.watcher=navigator.geolocation.watchPosition(i=>{if(a.active){let n=ol.proj.fromLonLat([parseFloat(i.coords.longitude),parseFloat(i.coords.latitude)]);a.marker.getGeometry().setCoordinates(n),r&&e.map.getView().animate({center:n},{zoom:e.locale.maxZoom}),r=!1}},i=>{console.error(i)},{}))}};var Do=e=>function(a){let r=new ol.format.GeoJSON().readFeature({type:"Feature",geometry:a.geometry},{dataProjection:"EPSG:"+(a.dataProjection||e.mapview.srid),featureProjection:"EPSG:"+(a.featureProjection||e.mapview.srid)}),i=new ol.source.Vector({features:[r]}),n=new ol.layer.Vector({source:i,zIndex:isNaN(a.zIndex)?2e3:a.zIndex,style:a.style});return e.map.addLayer(n),n};var Oo=e=>{return{create:a};function a(t){this.node&&this.node.remove(),this.node=e.utils.html.node`<div class="popup">`,this.node.appendChild(t.content),this.overlay&&e.map.removeOverlay(this.overlay),this.overlay=new ol.Overlay({element:this.node,position:t.coords||e.mapview.position,positioning:"bottom-center",autoPan:t.autoPan,insertFirst:!0,autoPanAnimation:{duration:250}}),e.map.addOverlay(this.overlay)}};var Ao=e=>{let a={begin:t,finish:f};return a;function t(){e.mapview.interaction.current&&e.mapview.interaction.current.finish&&e.mapview.interaction.current.finish(),e.mapview.interaction.current=a,e.mapview.node.style.cursor="auto",a.featureSet=new Set,e.map.on("pointermove",n),e.mapview.node.addEventListener("mouseout",i),e.map.on("singleclick",o),e.mapview.node.addEventListener("mousedown",r)}function r(){clearTimeout(a.timeout),a.timeout=setTimeout(()=>{a.longClick=!0,e.mapview.node.style.cursor="url('data:image/svg+xml,%3Csvg%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%2212%22%20cy%3D%2212%22%20r%3D%2210%22%20stroke%3D%22%23fff%22%20stroke-width%3D%223%22%20fill%3D%22none%22%2F%3E%0A%20%20%20%20%3Ccircle%20cx%3D%2212%22%20cy%3D%2212%22%20r%3D%2210%22%20stroke%3D%22%23333%22%20stroke-width%3D%222%22%20fill%3D%22none%22%2F%3E%3C%2Fsvg%3E') 12 12, auto"},600)}function i(){e.mapview.pointerLocation={x:null,y:null},s()}function n(p){a.longClick&&(delete a.longClick,e.mapview.node.style.cursor="auto"),clearTimeout(a.timeout),e.mapview.pointerLocation={x:p.originalEvent.clientX,y:p.originalEvent.clientY},e.mapview.infotip.node&&e.mapview.infotip.position();let u=new Set;e.map.forEachFeatureAtPixel(p.pixel,(h,w)=>{u.add(h),!a.featureSet.has(h)&&(a.feature=h,a.layer=w.get("layer"),a.layer.highlight=h.get("id"),a.layer.infoj&&(e.mapview.node.style.cursor="pointer"),p.originalEvent.pointerType!=="touch"&&a.layer.L.setStyle(a.layer.L.getStyle()),p.originalEvent.pointerType!=="touch"&&a.layer.hover&&a.layer.infotip())},{layerFilter:h=>Object.values(e.layers.list).some(w=>w.qID&&w.style&&w.style.highlight&&w.L===h),hitTolerance:5}),a.featureSet=u,(!u.size||!u.has(a.feature))&&s()}function s(){a.featureSet=new Set,e.mapview.infotip.node&&e.mapview.infotip.node.remove(),!!a.layer&&(a.layer.highlight=!0,e.mapview.node.style.cursor="auto",a.layer.L.setStyle(a.layer.L.getStyle()),delete a.layer,delete a.feature)}function o(p){if(a.longClick)return delete a.longClick,e.mapview.node.style.cursor="auto",c(p);if(clearTimeout(a.timeout),p.originalEvent.pointerType==="touch"&&n(p),e.mapview.popup.overlay&&e.map.removeOverlay(e.mapview.popup.overlay),!a.layer||!a.feature)return;let u=p.pixel;a.layer.select(a.feature,u)}function c(p){s(),e.map.forEachFeatureAtPixel(p.pixel,(u,h)=>{h.get("layer").select(u)},{layerFilter:u=>Object.values(e.layers.list).some(h=>h.qID&&h.infoj&&h.style&&h.style.highlight&&h.L===u),hitTolerance:5})}function f(){e.map.un("pointermove",n),e.map.un("singleclick",o),e.mapview.node.removeEventListener("mouseout",i),e.mapview.node.removeEventListener("mousedown",r)}};var Po=e=>{let a={begin:t,finish:s,cancel:n,update:c,feature:o,polygonKinks:i,format:new ol.format.GeoJSON,Layer:new ol.layer.Vector({source:new ol.source.Vector})};return a;function t(p){e.mapview.interaction.current&&e.mapview.interaction.current.finish&&e.mapview.interaction.current.finish(),e.mapview.interaction.current=a,delete a.kinks,a.finish=p.finish||s,a.callback=p.callback,a.select_callback=p.select_callback,a.update=p.update||c,a.layer=p.layer,a.layer&&!a.layer.display&&a.layer.show(),e.mapview.node.style.cursor="crosshair",a.vertices=[],e.map.addLayer(a.Layer),p.style=p.style||{};let u=new ol.style.Stroke({color:p.style.strokeColor||"#3399CC",width:p.style.strokeWidth||1.25}),h=new ol.style.Fill({color:p.style.fillColor||"rgba(255,255,255,0.4)"}),w=new ol.style.Style({image:p.style.image&&e.mapview.icon(p.style.image)||new ol.style.Circle({fill:h,stroke:u,radius:5}),stroke:u,fill:h});a.interaction=new ol.interaction.Draw({source:a.Layer.getSource(),geometryFunction:p.geometryFunction,freehand:p.freehand,type:p.type,style:()=>w,condition:D=>{if(a.kinks)return!1;if(D.originalEvent.buttons===1)return a.vertices.push(D.coordinate),e.mapview.popup.node&&e.mapview.popup.node.remove(),!0}}),a.interaction.on("drawstart",D=>{p.tooltip&&r(D.feature.getGeometry(),p.tooltip),D.feature.setStyle(w),a.Layer.getSource().clear(),e.mapview.popup.node&&e.mapview.popup.node.remove()}),a.interaction.on("drawend",D=>{if(p.freehand&&a.vertices.push(D.target.sketchCoords_.pop()),p.drawend)return p.drawend(D);a.layer&&setTimeout(f,400)}),e.map.addInteraction(a.interaction),a.layer&&e.mapview.node.addEventListener("contextmenu",f)}function r(p,u){let h={distance:()=>ol.sphere.getLength(new ol.geom.LineString([p.getInteriorPoint().getCoordinates(),e.mapview.position])),area:()=>ol.sphere.getArea(p),length:()=>ol.sphere.getLength(p)};!h[u]||p.on("change",()=>{e.mapview.popup.create({content:e.utils.html.node`
          <div style="padding: 5px">${parseInt(h[u]()).toLocaleString("en-GB")+(u==="area"?"sqm":"m")}`})})}function i(p,u){u||(u=new ol.geom[a.interaction.type_](p));let h=e.utils.turf.kinks({type:a.interaction.type_,coordinates:u.getCoordinates()}).features;return a.interaction.type_==="Polygon"&&p[0].length&&u.setCoordinates([p[0].concat([p[0][0]])]),a.kinks=h.length>0&&h[0].geometry.coordinates.join()!==p[0][0].join(),e.mapview.node.style.cursor=a.kinks?"not-allowed":"crosshair",u}function n(){s(),e.mapview.interaction.highlight.begin()}function s(){a.callback&&(a.callback(),delete a.callback),e.mapview.popup.node&&e.mapview.popup.node.remove(),a.layer&&e.mapview.node.removeEventListener("contextmenu",f),e.map.removeInteraction(a.interaction),e.map.removeLayer(a.Layer),a.Layer.getSource().clear(),e.mapview.node.style.cursor="default"}function o(p){let u=a.format.readFeature({type:"Feature",geometry:p.geometry},{dataProjection:p.dataProjection||"EPSG:4326",featureProjection:"EPSG:"+e.mapview.srid});a.Layer.getSource().clear(),a.Layer.getSource().addFeature(u)}function c(){let p=a.Layer.getSource().getFeatures(),u=JSON.parse(a.format.writeFeature(p[0],{dataProjection:"EPSG:"+a.layer.srid,featureProjection:"EPSG:"+e.mapview.srid})),h=new XMLHttpRequest;h.open("POST",e.host+"/api/location/new?"+e.utils.paramString({locale:e.locale.key,layer:a.layer.key,table:a.layer.table})),h.setRequestHeader("Content-Type","application/json"),h.onload=w=>{w.target.status===200&&(a.layer.reload(),e.locations.select({layer:a.layer,table:a.layer.table,id:w.target.response}),a.select_callback&&a.select_callback(w.target.response))},h.send(JSON.stringify({geometry:u.geometry})),n()}function f(p){if(a.vertices.length===0)return;p&&p.preventDefault();let u=a.Layer.getSource().getFeatures(),h=e.utils.html.node`<ul>`;u.length&&h.appendChild(e.utils.html.node`
      <li style="padding: 5px;" class="off-white-hover" onclick=${a.update}>${e.language.layer_draw_save}</li>`),u.length||h.appendChild(e.utils.html.node`
      <li style="padding: 5px;" class="off-white-hover" onclick=${w=>{w.preventDefault(),a.interaction.removeLastPoint(),a.vertices.pop(),e.mapview.popup.node&&e.mapview.popup.node.remove()}}>${e.language.layer_draw_last}</li>`),h.appendChild(e.utils.html.node`
      <li style="padding: 5px;" class="off-white-hover" onclick=${s}>${e.language.layer_draw_cancel}</li>`),e.mapview.popup.create({coords:a.vertices[a.vertices.length-1],content:h,autoPan:!0})}};var Io=e=>{return{begin:a,finish:t,update:r,Style:new ol.style.Style({image:new ol.style.Circle({radius:6,stroke:new ol.style.Stroke({color:"#ff69b4",width:2})})}),style:[new ol.style.Style({stroke:new ol.style.Stroke({color:"#FFA500",width:3})}),new ol.style.Style({image:new ol.style.Circle({radius:10,fill:new ol.style.Fill({color:"#FFA500"}),stroke:new ol.style.Stroke({color:"#FFA500",width:2})}),geometry:o=>{let c=o.getGeometry();if(c.getType()==="Point")return new ol.geom.Point(c.getCoordinates());if(c.getType()==="LineString")return new ol.geom.MultiPoint(c.getCoordinates());var f=c.getCoordinates()[0],p=new ol.geom.MultiPoint(f[0]);return p}})]};function a(o){e.mapview.interaction.current.finish&&e.mapview.interaction.current.finish(),e.mapview.interaction.current=e.mapview.interaction.edit,e.mapview.interaction.edit.finish=o.finish||t,e.mapview.interaction.edit.update=o.update||r,e.mapview.interaction.edit.callback=o.callback,e.mapview.interaction.edit.location=o.location,e.mapview.node.style.cursor="crosshair",e.mapview.interaction.edit.vertices=[o.location.marker],e.mapview.interaction.edit.feature=[],e.mapview.interaction.edit.Source=o.source||new ol.source.Vector({features:[e.mapview.interaction.edit.location.Layer.getSource().getFeatures()[0].clone()]}),e.mapview.interaction.edit.Layer=new ol.layer.Vector({source:e.mapview.interaction.edit.Source,zIndex:9999,style:e.mapview.interaction.edit.style}),e.map.addLayer(e.mapview.interaction.edit.Layer),e.mapview.interaction.edit.interaction=new ol.interaction.Modify({source:e.mapview.interaction.edit.Source,style:e.mapview.interaction.edit.Style,condition:c=>o.type!=="Polygon"&&o.type==="LineString"?!0:!(e.mapview.interaction.edit.trail&&e.utils.turf.kinks(e.utils.turf.flatten(e.mapview.interaction.edit.trail).features[0]).features.length>0)}),e.mapview.interaction.edit.interaction.on("modifystart",c=>{e.mapview.popup.node&&e.mapview.popup.node.remove(),e.mapview.interaction.edit.feature.push(e.mapview.interaction.edit.Source.getFeatures()[0].clone())}),e.mapview.interaction.edit.interaction.on("modifyend",c=>{e.mapview.interaction.edit.vertices.push(c.mapBrowserEvent.coordinate),(o.type==="Polygon"||o.type==="LineString")&&s(c)}),e.map.addInteraction(e.mapview.interaction.edit.interaction),e.mapview.node.addEventListener("contextmenu",n)}function t(){delete e.mapview.interaction.edit.finish,e.mapview.interaction.edit.Source&&e.mapview.interaction.edit.Source.clear(),e.mapview.popup.node&&e.mapview.popup.node.remove(),e.mapview.node.removeEventListener("contextmenu",n),e.map.removeLayer(e.mapview.interaction.edit.Layer),e.map.removeInteraction(e.mapview.interaction.edit.interaction),e.mapview.interaction.edit.callback&&e.mapview.interaction.edit.callback(),e.mapview.interaction.highlight.begin(),e.mapview.interaction.edit.info&&e.mapview.interaction.edit.info.remove(),e.mapview.interaction.edit.info=null,e.mapview.interaction.edit.trail=null}function r(){let o=e.mapview.interaction.edit.Source.getFeatures(),c=e.mapview.interaction.edit.location,f=c.layer,p=new ol.format.GeoJSON,u=JSON.parse(p.writeFeature(o[0],{dataProjection:"EPSG:"+f.srid,featureProjection:"EPSG:"+e.mapview.srid})),h=new XMLHttpRequest;h.open("POST",e.host+"/api/location/update?"+e.utils.paramString({locale:e.locale.key,layer:f.key,table:c.table,id:c.id})),h.setRequestHeader("Content-Type","application/json"),h.responseType="json",h.onload=w=>{if(w.target.status!==200)return;c.Layer.getSource().getFeatures()[0].setGeometry(o[0].getGeometry()),e.map.removeLayer(c.Marker),c.geometry=u.geometry,c.marker=ol.proj.transform(e.utils.turf.pointOnFeature(u.geometry).geometry.coordinates,"EPSG:"+c.layer.srid,"EPSG:"+e.mapview.srid),c.Marker=e.mapview.geoJSON({geometry:{type:"Point",coordinates:c.marker},zIndex:2e3,style:new ol.style.Style({image:e.mapview.icon({type:"markerLetter",letter:String.fromCharCode(65+e.locations.list.indexOf(c.record)),color:c.style.strokeColor,scale:2,anchor:[.4,.9]})})}),f.reload()},h.send(JSON.stringify({[f.geom]:u.geometry})),t()}function i(o){e.mapview.popup.node&&e.mapview.popup.node.remove(),e.mapview.interaction.edit.Source.clear(),e.mapview.interaction.edit.Source.addFeature(e.mapview.interaction.edit.feature.pop()),e.mapview.interaction.edit.vertices.pop(),s(o)}function n(o){o.preventDefault();let c=e.utils.html.node`<ul>`;!e.mapview.interaction.edit.info&&e.mapview.interaction.edit.feature.length&&c.appendChild(e.utils.html.node`
        <li style="padding: 5px;" class="off-white-hover" onclick=${e.mapview.interaction.edit.update}>${e.language.layer_draw_update}</li>`),e.mapview.interaction.edit.feature.length&&c.appendChild(e.utils.html.node`
        <li style="padding: 5px;" class="off-white-hover" onclick=${i}>${e.language.layer_draw_undo}</li>`),c.appendChild(e.utils.html.node`
      <li style="padding: 5px;" class="off-white-hover" onclick=${t}>${e.language.layer_draw_cancel}</li>`),e.mapview.popup.create({coords:e.mapview.interaction.edit.vertices[e.mapview.interaction.edit.vertices.length-1],content:c,autoPan:!0})}function s(o){let c=new ol.format.GeoJSON;e.mapview.interaction.edit.trail=null,e.mapview.interaction.edit.trail=c.writeFeatureObject(e.mapview.interaction.edit.Source.getFeatures()[0].clone(),{dataProjection:"EPSG:4326",featureProjection:"EPSG:"+e.mapview.srid}),e.mapview.interaction.edit.trail.geometry.type!=="Point"&&(e.mapview.interaction.edit.info&&e.mapview.interaction.edit.info.remove(),e.mapview.interaction.edit.info=null,e.utils.turf.kinks(e.mapview.interaction.edit.trail).features.length>0&&(e.mapview.interaction.edit.info=e.utils.html.node`
        <div class="infotip" style="color:#d32f2f;">${e.language.layer_draw_error}`,e.mapview.node.appendChild(e.mapview.interaction.edit.info),e.mapview.interaction.edit.info.style.left=`${o.mapBrowserEvent.originalEvent.clientX}px`,e.mapview.interaction.edit.info.style.top=`${o.mapBrowserEvent.originalEvent.clientY}px`,e.mapview.interaction.edit.info.style.opacity=1))}};var xo=e=>{let a={begin:t,Source:new ol.source.Vector,Style:new ol.style.Style({image:new ol.style.Circle({radius:6,stroke:new ol.style.Stroke({color:"#3399CC",width:2})})})};return a.Layer=new ol.layer.Vector({source:a.Source,zIndex:20,style:[new ol.style.Style({stroke:new ol.style.Stroke({color:"#3399CC",width:1})}),new ol.style.Style({image:new ol.style.Circle({radius:6,stroke:new ol.style.Stroke({color:"#3399CC",width:2})}),geometry:i=>{let n=i.getGeometry();return n.getType()==="Point"?new ol.geom.Point(n.getCoordinates()):n.getType()==="LineString"?new ol.geom.MultiPoint(n.getCoordinates()):new ol.geom.MultiPoint(n.getCoordinates()[0])}})]}),a;function t(i){!i.feature||(e.mapview.interaction.current.finish&&e.mapview.interaction.current.finish(),e.mapview.interaction.current=a,a.finish=r,a.callback=i.callback,e.mapview.node.style.cursor="crosshair",a.Source.addFeatures([i.feature]),e.map.addLayer(a.Layer),a.interaction=new ol.interaction.Modify({source:a.Source,style:a.Style}),e.map.addInteraction(a.interaction))}function r(){delete a.finish,a.Source.clear(),e.map.removeLayer(a.Layer),e.map.removeInteraction(a.interaction),a.callback&&a.callback(),e.mapview.interaction.highlight.begin()}};var Ro=e=>{let a={begin:t,finish:i,cancel:r,Layer:new ol.layer.Vector({source:new ol.source.Vector})};return a;function t(n={}){e.mapview.interaction.current&&e.mapview.interaction.current.finish&&e.mapview.interaction.current.finish(),e.mapview.interaction.current=a,a.callback=n.callback,a.Layer.getSource().clear(),e.map.addLayer(a.Layer),e.mapview.node.style.cursor="zoom-in",a.interaction=new ol.interaction.Draw({source:a.Layer.getSource(),type:"Circle",geometryFunction:ol.interaction.Draw.createBox(),style:new ol.style.Style({stroke:new ol.style.Stroke({color:"#ddd",width:1}),fill:new ol.style.Stroke({color:e.utils.Chroma("#fff").alpha(.3).rgba()})})}),a.interaction.on("drawend",s=>{e.mapview.flyToBounds(s.feature.getGeometry().getExtent()),r()}),e.map.addInteraction(a.interaction)}function r(){i(),e.mapview.interaction.highlight.begin()}function i(){a.callback&&(a.callback(),delete a.callback),e.mapview.node.style.cursor="auto",e.map.removeInteraction(a.interaction),e.map.removeLayer(a.Layer),a.Layer.getSource().clear()}};var Ho=e=>({current:{},highlight:Ao(e),draw:Po(e),edit:Io(e),modify:xo(e),zoom:Ro(e)});var No=e=>function(a){let t=e.map.getView().calculateExtent();if(!a)return{south:t[1],west:t[0],north:t[3],east:t[2]};let r=ol.proj.transformExtent(t,"EPSG:"+e.mapview.srid,"EPSG:"+a);return{south:r[1],west:r[0],north:r[3],east:r[2]}};var bn=new Map,Bo=e=>function(a){let t=a.scale||1;delete a.scale;let r=JSON.stringify(a);return bn.has(r)?a.url=bn.get(r):(a.url=e.utils.svg_symbols(a),bn.set(r,a.url)),new ol.style.Icon({src:a.url,scale:t,anchor:a.anchor||[.5,.5]})};var Go=e=>{return{create:a,position:t};function a(r){this.node&&this.node.remove(),this.node=e.utils.html.node`<div class="infotip">`,this.node.innerHTML=r,e.mapview.node.appendChild(this.node),this.position()}function t(){this.node.style.opacity=1,this.node.style.left=e.mapview.pointerLocation.x-this.node.offsetWidth/2+"px",this.node.style.top=e.mapview.pointerLocation.y-15-this.node.offsetHeight+"px"}};var tr=e=>function(a,t){let r=this;e.locations.select({locale:e.locale.key,layer:r,table:r.tableCurrent(),id:a.get("id"),pixel:t})};var sa=e=>function(){let a=this;e.query({locale:e.locale.key,layer:a.key,queryparams:{template:a.hover.query||"infotip",qID:a.qID,id:a.highlight,table:a.tableCurrent(),geom:a.geom,field:a.hover.field,coords:a.format==="cluster"&&ol.proj.transform(e.mapview.interaction.highlight.feature.getGeometry().getCoordinates(),"EPSG:"+e.mapview.srid,"EPSG:"+a.srid)}}).then(t=>{!t||t.label!=""&&e.mapview.infotip.create(t.label)})};var qo=e=>a=>{a.highlight=!0,a.select=tr(e),a.infotip=sa(e),a.reload=()=>{n.refresh()};let t=!1,r=performance.now();function i(u){if(!t)return;let h=performance.now();console.log(`${h-r} | ${u}`),r=h}let n=new ol.source.VectorTile({format:new ol.format.MVT({}),transition:0,cacheSize:0,tileUrlFunction:u=>{i(`tileUrlFunction - ${a.key}:${u[0]}/${u[1]}/${u[2]}`);let h=a.tableCurrent();return h?`${e.host}/api/layer/mvt/${u[0]}/${u[1]}/${u[2]}?`+e.utils.paramString({locale:e.locale.key,layer:a.key,srid:e.mapview.srid,table:h,filter:a.filter&&a.filter.current}):n.clear()}});a.L=new ol.layer.VectorTile({source:n,renderBuffer:200,zIndex:a.style.zIndex||1,style:null}),a.L.set("layer",a,!0),e.map.on("movestart",u=>{!a.display||(i("movestart"),e.map.removeLayer(a.L),n.clear())});let s;e.map.on("moveend",u=>{!a.display||!a.tableCurrent()||(i("moveend"),a.L.setStyle(null),e.map.addLayer(a.L),s=setTimeout(()=>{a.L.setStyle(p)},400))});let o=new Set;n.on("tileloaderror",u=>{console.log(u)}),n.on("tileloadstart",u=>{s&&clearTimeout(s);let h=u.tile.tileCoord.join("-");i(h),o.add(h)}),n.on("tileloadend",u=>{let h=u.tile.tileCoord.join("-");i(`tileloadend - ${h}`),o.delete(h),o.size===0&&c()});function c(){if(i("tilesloaded"),a.style.theme&&a.style.theme.dynamic){let u=function(Z){let U=D.map(ie=>ie.get(Z.field)),F=new geostats(U).getQuantile(Z.cat_arr.length);Z.cat_arr.forEach((ie,J)=>{ie.value=F[J]}),Z.theme&&u(Z.theme)},w=e.map.getView().calculateExtent(),D=n.getFeaturesInExtent(w);if(i(`${D.length||0} Features loaded`),!D.length)return;u(a.style.theme)}a.L.setStyle(p)}let f=new Map;function p(u){let h=Object.assign({},a.style.default);a.style.theme&&a.style.theme.type&&w(a.style.theme);function w(U){if(U&&U.type==="categorized"){let F=u.get(U.field);F&&e.utils.merge(h,U.cat[F]&&U.cat[F].style||U.cat[F])}if(U&&U.type==="graduated"){let F=parseFloat(u.get(U.field));if(F||F===0){for(let ie=0;ie<U.cat_arr.length&&!(F<U.cat_arr[ie].value);ie++)var ae=U.cat_arr[ie].style||U.cat_arr[ie];e.utils.merge(h,ae)}}U.theme&&w(U.theme)}Object.assign(h,a.highlight===u.get("id")?a.style.highlight:{},a.highlight===u.get("id")?{zIndex:30}:{zIndex:10});let D=JSON.stringify(h);if(f.has(D))return f.get(D);let Z=new ol.style.Style({zIndex:h.zIndex,stroke:h.strokeColor&&new ol.style.Stroke({color:e.utils.Chroma(h.strokeColor).alpha(h.strokeOpacity===void 0?1:parseFloat(h.strokeOpacity)||0).rgba(),width:parseFloat(h.strokeWidth)||1}),fill:h.fillColor&&new ol.style.Fill({color:e.utils.Chroma(h.fillColor).alpha(h.fillOpacity===void 0?1:parseFloat(h.fillOpacity)||0).rgba()}),image:h.marker&&e.mapview.icon(h.marker)});return f.set(D,Z),Z}a.label=e.mapview.layer.mvtLabel(a)};var Vo=e=>a=>{if(!a.style.label)return;let t=new ol.source.Vector({loader:function(r,i,n){a.xhr&&a.xhr.abort(),this.resolution=i,t.clear();let s=a.tableCurrent();if(!s)return;let o=e.map.getView().getZoom();o<=a.style.label.minZoom||o>=a.style.label.maxZoom||(a.xhr=new XMLHttpRequest,a.xhr.open("GET",e.host+"/api/query?"+e.utils.paramString({template:"labels",locale:e.locale.key,layer:a.key,table:s,label:a.style.label&&a.style.label.field,filter:a.filter&&a.filter.current,west:r[0],south:r[1],east:r[2],north:r[3]})),a.xhr.setRequestHeader("Content-Type","application/json"),a.xhr.responseType="json",a.xhr.onload=c=>{if(c.target.status!==200)return;let f=c.target.response.map(p=>new ol.Feature({geometry:new ol.geom.Point([p.x,p.y]),properties:{label:p.label&&String(p.label)}}));t.addFeatures(f)},a.xhr.send())},strategy:function(r,i){return this.resolution&&this.resolution!=i&&this.loadedExtentsRtree_.clear(),[ol.proj.transformExtent(r,"EPSG:"+e.mapview.srid,"EPSG:"+a.srid)]}});return new ol.layer.Vector({source:t,declutter:a.style.label?!!a.style.label.declutter:!1,zIndex:a.style.zIndex||1,style:r=>{let i=r.getProperties().properties;return new ol.style.Style({text:new ol.style.Text({font:a.style.label.font||"12px sans-serif",text:i.label,stroke:a.style.label.strokeColor&&new ol.style.Stroke({color:a.style.label.strokeColor,width:a.style.label.strokeWidth||1}),fill:new ol.style.Fill({color:a.style.label.fillColor||"#000"})})})}})};var Uo=e=>a=>{a.highlight=!0,a.select=tr(e),a.infotip=sa(e),a.reload=()=>{t.refresh()};let t=new ol.source.Vector({loader:function(){a.xhr&&a.xhr.abort(),t.clear();let r=a.tableCurrent();!r||(a.xhr=new XMLHttpRequest,a.xhr.open("GET",e.host+"/api/layer/geojson?"+e.utils.paramString({locale:e.locale.key,layer:a.key,table:r,cat:a.style.theme&&a.style.theme.field,filter:a.filter&&a.filter.current})),a.xhr.setRequestHeader("Content-Type","application/json"),a.xhr.responseType="json",a.xhr.onload=i=>{if(i.target.status!==200)return;let n=new ol.format.GeoJSON,s=i.target.response.map(o=>n.readFeature({type:"Feature",geometry:o.geometry,properties:{id:o.properties.id,cat:o.properties.cat}},{dataProjection:"EPSG:"+a.srid,featureProjection:"EPSG:"+e.mapview.srid}));t.addFeatures(s)},a.xhr.send())},strategy:function(r,i){return this.resolution&&this.resolution!=i&&this.loadedExtentsRtree_.clear(),[ol.proj.transformExtent(r,"EPSG:"+e.mapview.srid,"EPSG:"+a.srid)]}});a.L=new ol.layer.Vector({source:t,zIndex:a.style.zIndex||1,style:r=>{let i=Object.assign({},a.style.default),n=a.style.theme;if(n&&n.type==="categorized"&&Object.assign(i,n.cat[r.get("cat")]||{}),n&&n.type==="graduated"&&n.cat_arr){let o=parseFloat(r.get(n.field));if(o){for(let c=0;c<n.cat_arr.length&&!(o<n.cat_arr[c].value);c++)var s=n.cat_arr[c].style;Object.assign(i,s)}}if(a.highlight===r.get("id")){let o=e.utils.cloneDeep(a.style.highlight);i.marker&&i.marker.scale&&o.marker&&o.marker.scale&&(o.marker.scale*=i.marker.scale),Object.assign(i,o||{})}return new ol.style.Style({zIndex:i.zIndex,stroke:i.strokeColor&&new ol.style.Stroke({color:e.utils.Chroma(i.strokeColor).alpha(i.strokeOpacity===void 0?1:parseFloat(i.strokeOpacity)||0).rgba(),width:parseInt(i.strokeWidth)||1}),fill:i.fillColor&&new ol.style.Fill({color:e.utils.Chroma(i.fillColor).alpha(i.fillOpacity===void 0?1:parseFloat(i.fillOpacity)||0).rgba()}),image:i.marker&&e.mapview.icon(i.marker)})}}),a.L.set("layer",a,!0)};var Yo=e=>function(a){let t=this,r=a.get("properties").count,i=a.getGeometry(),n=i.getCoordinates(),s=ol.proj.transform(n,"EPSG:"+e.mapview.srid,"EPSG:"+t.srid),o=new XMLHttpRequest;o.open("GET",e.host+"/api/query/get_nnearest?"+e.utils.paramString({locale:e.locale.key,layer:t.key,geom:t.geom,qID:t.qID,cluster_label:t.cluster_label||t.qID,table:t.tableCurrent(),filter:t.filter&&t.filter.current,n:r>99?99:r,x:s[0],y:s[1],coords:s})),o.setRequestHeader("Content-Type","application/json"),o.responseType="json",o.onload=c=>{if(c.target.status>=300)return;let f=c.target.response;if(f&&f.length>1){let p=e.utils.html.node`
      <div style="
        width: 400px;
        max-width: 75vw;
        max-height: 300px;
        overflow-x: hidden;">
      <ul>
      ${f.map(u=>e.utils.html.node`
        <li
          style="padding: 5px 0 5px 10px; white-space: nowrap; line-height: 1.5;"
          class="secondary-colour-hover"
          onclick=${h=>{h.preventDefault(),e.locations.select({locale:e.locale.key,layer:t,table:t.tableCurrent(),id:u.id,marker:u.coords})}}>${u.label||'"'+t.cluster_label+'"'}`)}`;e.mapview.popup.create({coords:ol.proj.transform(s,"EPSG:"+t.srid,"EPSG:"+e.mapview.srid),content:p,autoPan:!0});return}return e.locations.select({locale:e.locale.key,layer:t,table:t.tableCurrent(),id:f.id})},o.send()};var Wo=e=>a=>{a.highlight=!0,a.select=Yo(e),a.infotip=sa(e),a.reload=()=>{t.clear(),t.refresh({force:!0})};let t=new ol.source.Vector({loader:function(r,i,n){a.xhr&&a.xhr.abort(),this.resolution=i,t.clear();let s=a.tableCurrent();!s||(a.xhr=new XMLHttpRequest,a.xhr.open("GET",e.host+`/api/layer/cluster/${e.mapview.getZoom()}?`+e.utils.paramString({locale:e.locale.key,layer:a.key,table:s,kmeans:a.cluster_kmeans,dbscan:a.cluster_dbscan,pixelRatio:window.devicePixelRatio,aggregate:a.style.theme&&a.style.theme.aggregate,theme:a.style.theme&&a.style.themes&&encodeURIComponent(Object.keys(a.style.themes).find(o=>a.style.themes[o]===a.style.theme)),label:a.style.label&&a.style.label.field,count:a.style.label&&a.style.label.count,filter:a.filter&&a.filter.current,viewport:[r[0],r[1],r[2],r[3]]})),a.xhr.setRequestHeader("Content-Type","application/json"),a.xhr.responseType="json",a.xhr.onload=o=>{if(o.target.status!==200)return;let c=o.target.response;a.max_size=c.reduce((u,h)=>Math.max(u,h.properties.size),0);let f=1,p=c.map(u=>new ol.Feature({id:f++,geometry:new ol.geom.Point(a.srid==4326&&ol.proj.fromLonLat([u.geometry.x,u.geometry.y])||[u.geometry.x,u.geometry.y]),properties:u.properties}));t.addFeatures(p)},a.xhr.send())},strategy:function(r,i){return this.resolution&&this.resolution!=i&&this.loadedExtentsRtree_.clear(),[ol.proj.transformExtent(r,"EPSG:"+e.mapview.srid,"EPSG:"+a.srid)]}});a.L=new ol.layer.Vector({layer:a,source:t,zIndex:a.style.zIndex||10,style:r=>{let i=r.getProperties().properties,n=i.size>1?Object.assign({},a.style.default,a.style.cluster):Object.assign({},a.style.default),s=Object.assign({},a.style.theme);if(s&&s.type==="categorized"&&Object.assign(n,s.cat[i.cat]&&s.cat[i.cat].style||s.cat[i.cat]),s&&s.type==="graduated"){let f=parseFloat(i.cat);if(f||f===0){for(let p=0;p<s.cat_arr.length&&!(f<s.cat_arr[p].value);p++)var o=s.cat_arr[p].style||s.cat_arr[p];Object.assign(n,o)}}if(s&&s.type==="competition"){let f=i.size,p={layers:{}};Object.entries(i.cat).sort((u,h)=>u[1]-h[1]).forEach(u=>{s.cat[u[0]]&&(p.layers[f/i.size]=s.cat[u[0]].style.fillColor),f-=u[1]}),Object.assign({},n,p)}let c=a.cluster_logscale?i.count===1?n.size||a.style.size:(n.size||a.style.size)+(n.size||a.style.size)/Math.log(a.max_size)*Math.log(i.size):i.count===1?n.size||a.style.size:(n.size||a.style.size)+(n.size||a.style.size)/a.max_size*i.size;if(a.highlight===r.get("id")){let f=e.utils.cloneDeep(a.style.highlight);delete f.scale,n.scale&&a.style.highlight.scale&&(n.scale*=a.style.highlight.scale),Object.assign(n,f)}return n.layers&&Array.isArray(n.layers)?n.layers.map(f=>new ol.style.Style({zIndex:parseInt(a.max_size-i.size),image:e.mapview.icon(Object.assign({},f,{scale:c/(f.size||a.style.size)*(f.scale||1)*(f.relative?e.mapview.getZoom()/(e.locale.maxZoom-e.locale.minZoom):1)}))})):new ol.style.Style({zIndex:a.style.zIndex,image:e.mapview.icon(Object.assign({},n,{scale:c/(n.size||a.style.size)*(n.scale||1)*(n.relative?e.mapview.getZoom()/(e.locale.maxZoom-e.locale.minZoom):1)}))})}}),a.label=e.mapview.layer.clusterLabel(a)};var Jo=e=>a=>{if(!!a.style.label)return new ol.layer.Vector({source:a.L.getSource(),declutter:a.style.label?!!a.style.label.declutter:!1,zIndex:a.style.zIndex+1||11,style:t=>{let r=t.getProperties().properties;return new ol.style.Style({text:new ol.style.Text({font:a.style.label.font||"12px sans-serif",text:r.label||`${r.count>1?r.count:""}`,stroke:a.style.label.strokeColor&&new ol.style.Stroke({color:a.style.label.strokeColor,width:a.style.label.strokeWidth||1}),fill:new ol.style.Fill({color:a.style.label.fillColor||"#000"})})})}})};var Zo=e=>a=>{let t=a.proxy&&`${e.host}/api/proxy?url=${a.URI}`||a.URI,r=new ol.source.OSM({url:decodeURIComponent(t),opaque:!1,transition:0});a.L=new ol.layer.Tile({source:r,layer:a,zIndex:a.style.zIndex||0})};var Xo=e=>a=>{a.grid_size=Object.values(a.grid_fields)[0],a.grid_color=Object.values(a.grid_fields)[1],a.grid_ratio=!1,a.reload=()=>t.refresh();let t=new ol.source.Vector({loader:function(r,i,n){a.xhr&&a.xhr.abort(),this.resolution=i,t.clear();let s=a.tableCurrent();!s||(a.xhr=new XMLHttpRequest,a.xhr.open("GET",e.host+"/api/layer/grid?"+e.utils.paramString({locale:e.locale.key,layer:a.key,table:s,size:a.grid_size,color:a.grid_color,viewport:[r[0],r[1],r[2],r[3]]})),a.xhr.setRequestHeader("Content-Type","application/json"),a.xhr.responseType="json",a.xhr.onload=o=>{if(o.target.status!==200)return;let c=o.target.response;a.sizeAvg=0,a.colorAvg=0;let f=c.map(w=>{if(parseFloat(w[2])>0)return w[2]=isNaN(w[2])?w[2]:parseFloat(w[2]),w[3]=isNaN(w[3])?w[3]:parseFloat(w[3]),a.grid_ratio&&w[3]>0&&(w[3]/=w[2]),a.sizeAvg+=parseFloat(w[2]),a.colorAvg+=isNaN(w[3])?0:parseFloat(w[3]),new ol.Feature({geometry:new ol.geom.Point(ol.proj.fromLonLat([w[0],w[1]])),properties:{size:parseFloat(w[2]),color:isNaN(w[3])?w[3]:parseFloat(w[3])}})});function p(w,D,Z){let U=w.filter(ae=>isFinite(ae[D]));return Math[Z].apply(null,U.map(ae=>ae[D]))}a.sizeMin=p(c,2,"min"),a.sizeAvg/=f.length,a.sizeMax=p(c,2,"max"),a.colorMin=p(c,3,"min"),a.colorAvg/=f.length,a.colorMax=p(c,3,"max"),a.colorBins=[];let u=a.style.range.length;for(var h=1;h<u;h++)h<u/2&&a.colorBins.push(a.colorMin+(a.colorAvg-a.colorMin)/(u/2)*h),h===u/2&&a.colorBins.push(a.colorAvg),h>u/2&&a.colorBins.push(a.colorAvg+(a.colorMax-a.colorAvg)/(u/2)*(h-u/2));t.addFeatures(f),a.style.legend.size_min&&(a.style.legend.size_min.textContent=a.sizeMin.toLocaleString("en-GB",{maximumFractionDigits:0})),a.style.legend.size_avg&&(a.style.legend.size_avg.textContent=a.sizeAvg.toLocaleString("en-GB",{maximumFractionDigits:0})),a.style.legend.size_max&&(a.style.legend.size_max.textContent=a.sizeMax.toLocaleString("en-GB",{maximumFractionDigits:0})),a.grid_ratio?(a.style.legend.color_min&&(a.style.legend.color_min.textContent=a.colorMin.toLocaleString("en-GB",{maximumFractionDigits:0,style:"percent"})),a.style.legend.color_avg&&(a.style.legend.color_avg.textContent=a.colorAvg.toLocaleString("en-GB",{maximumFractionDigits:0,style:"percent"})),a.style.legend.color_max&&(a.style.legend.color_max.textContent=a.colorMax.toLocaleString("en-GB",{maximumFractionDigits:0,style:"percent"}))):(a.style.legend.color_min&&(a.style.legend.color_min.textContent=a.colorMin.toLocaleString("en-GB",{maximumFractionDigits:0})),a.style.legend.color_avg&&(a.style.legend.color_avg.textContent=a.colorAvg.toLocaleString("en-GB",{maximumFractionDigits:0})),a.style.legend.color_max&&(a.style.legend.color_max.textContent=a.colorMax.toLocaleString("en-GB",{maximumFractionDigits:0})))},a.xhr.send())},strategy:function(r,i){return this.resolution&&this.resolution!=i&&this.loadedExtentsRtree_.clear(),[ol.proj.transformExtent(r,"EPSG:"+e.mapview.srid,"EPSG:"+a.srid)]}});a.L=new ol.layer.Vector({source:t,zIndex:a.style.zIndex||1,style:r=>{let i=r.getProperties().properties,n=i.size<=a.sizeAvg?7+7/a.sizeAvg*i.size:14+7/(a.sizeMax-a.sizeAvg)*(i.size-a.sizeAvg);if(i.hxcolor=a.style.hxcolor||"#C0C0C0",parseFloat(i.color)){i.hxcolor=a.style.range[0];for(let s=0;s<a.colorBins.length&&!(i.color<a.colorBins[s]);s++)i.hxcolor=a.style.range[s+1]}return new ol.style.Style({image:e.mapview.icon({type:"dot",fillColor:i.hxcolor,scale:n/30})})}}),a.L.set("layer",a,!0)};var Ko=e=>a=>{a.L=new ol.layer.Layer({render:t=>{if(!!a.display)return a.mbMap||(a.mbMap=new maplibregl.Map({container:e.mapview.node,style:a.mbStyle,accessToken:a.accessToken,attributionControl:!1,boxZoom:!1,doubleClickZoom:!1,dragPan:!1,dragRotate:!1,interactive:!1,keyboard:!1,pitchWithRotate:!1,scrollZoom:!1,touchZoomRotate:!1})),a.canvas=a.mbMap.getCanvas(),a.zIndex&&(a.canvas.style.zIndex=a.zIndex),a.canvas.style.position="absolute",a.canvas.style.display=a.display&&"block"||"none",a.mbMap.jumpTo({center:ol.proj.toLonLat(t.viewState.center),zoom:t.viewState.zoom-1,bearing:-t.viewState.rotation*180/Math.PI,animate:!1}),a.mbMap._frame&&(a.mbMap._frame.cancel(),a.mbMap._frame=null),a.mbMap._render(),a.resized||(a.resized=!0,window.setTimeout(()=>a.mbMap.resize(),500)),a.canvas}})};var Qo=e=>({mvt:qo(e),mvtLabel:Vo(e),geojson:Uo(e),cluster:Wo(e),clusterLabel:Jo(e),tiles:Zo(e),grid:Xo(e),mbtiles:Ko(e)});var zo=e=>({create:Mo(e),changeEndEvent:new CustomEvent("changeEnd"),attribution:$o(e),locate:Fo(e),interaction:Ho(e),popup:Oo(e),infotip:Go(e),geoJSON:Do(e),icon:Bo(e),layer:Qo(e),getBounds:No(e),flyToBounds:(a,t={})=>{e.map.getView().fit(a,Object.assign({padding:[50,50,50,50],duration:1e3},t))},getZoom:()=>e.map.getView().getZoom()});var el=e=>{let a={init:t,add:r,plugins:{}};return a;function t(i){!i.node||(a.node=i.node,a.tabs=a.node.appendChild(e.utils.html.node`<div class="tabs">`),Object.values(a.plugins).forEach(n=>n(e)))}function r(i){!a.node||i.tab||(i.show=()=>{a.tabs.childNodes.forEach(n=>n.classList.remove("active")),!i.tab.parentElement&&a.tabs.appendChild(i.tab),i.tab.classList.add("active"),a.timer&&window.clearTimeout(a.timer),a.timer=window.setTimeout(()=>i.tab.dispatchEvent(new CustomEvent("activate")),500),a.node.classList.contains("desktop-display-none")&&(a.node.classList.remove("desktop-display-none"),document.body.style.gridTemplateRows="auto 10px 50px")},i.tab=e.utils.html.node`<div class="tab">`,i.header=i.tab.appendChild(e.utils.html.node`
      <div
        style="${i.tab_style||""}"
        class="header"
        onclick=${i.show}>${i.title||i.key||"Tab"}`),i.panel=i.tab.appendChild(e.utils.html.node`
      <div
        class="${`panel ${i.class||""}`}"
        style="${i.style||""}">`),i.target&&i.target instanceof HTMLElement&&i.panel.appendChild(i.target),i.layer&&i.layer.tabs.add(i),i.location&&i.location.tabs.add(i),i.remove=()=>{if(!i.tab.parentElement)return;let n=i.tab.nextElementSibling||i.tab.previousElementSibling;if(i.tab.remove(),n)return n.querySelector(".header").click();a.node.classList.add("desktop-display-none"),document.body.style.gridTemplateRows="auto 0 0",e.mapview.node.style.marginTop=0})}};var tl=e=>(a,t)=>{if(t.el&&t.el.parentNode)return e.layers.view.filter.reset(a,t);let r=e.layers.view.filter.block(a,t);r.dataset.field=t.field,t.el=r,r.appendChild(e.utils.html.node`
  <input type="text" placeholder=${e.language.layer_filter_text} onkeyup=${i=>{a.filter.current[t.field]={},a.filter.current[t.field][t.filter]=encodeURIComponent(i.target.value),a.reload(),a.show(),a.count(n=>{t.filterZoom&&n>1&&a.zoomToExtent()})}}>`)};var al=e=>(a,t)=>{if(t.el&&t.el.parentNode)return e.layers.view.filter.reset(a,t);let r=new XMLHttpRequest;r.open("GET",e.host+"/api/query?"+e.utils.paramString({template:"field_stats",locale:e.locale.key,layer:a.key,table:a.tableCurrent(),field:t.field,filter:a.filter&&a.filter.current})),r.setRequestHeader("Content-Type","application/json"),r.responseType="json",r.onload=i=>{let n=i.target.response,s=e.layers.view.filter.block(a,t);s.dataset.field=t.field,t.el=s;let o=t.type==="integer"?1:.01;var c=e.utils.html.node`
    <div class="input-flex">
      <span>${e.language.layer_filter_greater}`;let f=e.utils.html.node`
    <input
      type="number"
      min=${n.min}
      value=${n.min}
      max=${n.max}
      step=${o}
      onkeyup=${ae=>{u.value=ae.target.value,U()}}>`;c.appendChild(f),s.appendChild(c);let p=e.utils.html.node`<div class="input-range">`;s.appendChild(p);let u=e.utils.html.node`
    <input
      type="range"
      class="secondary-colour-bg"
      min=${n.min}
      value=${n.min}
      max=${n.max}
      step=${o}
      oninput=${ae=>{f.value=ae.target.value,U()}}>`;p.appendChild(u);var c=e.utils.html.node`
    <div class="input-flex">
      <span>${e.language.layer_filter_smaller}`;let h=e.utils.html.node`
    <input
      type="number"
      min=${n.min}
      value=${n.max}
      max=${n.max}
      step=${o}
      onkeyup=${ae=>{D.value=ae.target.value,U()}}>`;c.appendChild(h),s.appendChild(c);var w=e.utils.html.node`<div class="input-range">`;s.appendChild(w);let D=e.utils.html.node`
    <input
      type="range"
      class="secondary-colour-bg"
      min=${n.min}
      value=${n.max}
      max=${n.max}
      step=${o}
      oninput=${ae=>{h.value=ae.target.value,U()}}>`;w.appendChild(D);let Z;function U(){clearTimeout(Z),Z=setTimeout(()=>{Z=null,a.filter.current[t.field]={},a.filter.current[t.field].gte=parseFloat(f.value),a.filter.current[t.field].lte=parseFloat(h.value),a.reload(),a.show(),a.count(ae=>{t.filterZoom&&ae>1&&a.zoomToExtent()})},500)}},r.send()};var rl=e=>(a,t)=>{if(t.el&&t.el.parentNode)return e.layers.view.filter.reset(a,t);let r=e.layers.view.filter.block(a,t);r.dataset.field=t.field,t.el=r,a.filter.current[a.style.theme&&a.style.theme.field||t.field]||(a.filter.current[a.style.theme&&a.style.theme.field||t.field]={}),t.filter.in.forEach(i=>{r.appendChild(e.utils.html.node`
    <label class="input-checkbox">
    <input
      type="checkbox"
      onchange=${n=>{if(n.target.checked)a.filter.current[t.field]||(a.filter.current[t.field]={}),a.filter.current[t.field].in||(a.filter.current[t.field].in=[]),a.filter.current[t.field].in.push(encodeURIComponent(n.target.parentNode.innerText));else{let s=a.filter.current[t.field].in.indexOf(encodeURIComponent(n.target.parentNode.innerText));a.filter.current[t.field].in.splice(s,1),a.filter.current[t.field].in.length||delete a.filter.current[t.field].in}a.reload(),a.show(),a.count(s=>{t.filterZoom&&s>1&&a.zoomToExtent()})}}>
    </input>
    <div></div><span>${i}`)})};var nl=e=>(a,t)=>{if(t.el&&t.el.parentNode)return e.layers.view.filter.reset(a,t);let r=e.layers.view.filter.block(a,t);r.dataset.field=t.field,t.el=r;var i=e.utils.html.node`
  <div class="input-flex">
    <span>${e.language.layer_filter_date_after}`;let n=e.utils.html.node`
  <input type="text" readonly placeholder=${e.language.layer_filter_pick} style="width: 60%;">`;i.appendChild(n),r.appendChild(i);var i=e.utils.html.node`
  <div class="input-flex">
    <span>Before`;let s=e.utils.html.node`
  <input type="text" readonly placeholder=${e.language.layer_filter_pick} style="width: 60%;">`;i.appendChild(s),r.appendChild(i),e.utils.flatpickr({element:n,enableTime:t.type==="datetime",callback:f=>{n.value=f,c()}}),e.utils.flatpickr({element:s,enableTime:t.type==="datetime",callback:f=>{s.value=f,c()}});let o;function c(){clearTimeout(o),o=setTimeout(()=>{o=null,a.filter.current[t.field]={},a.filter.current[t.field].gt=e.utils.meltDateStr(n.value)||null,a.filter.current[t.field].lt=e.utils.meltDateStr(s.value)||null,a.reload(),a.show(),a.count(f=>{t.filterZoom&&f>1&&a.zoomToExtent()})},500)}};var il=e=>(a,t)=>{if(t.el&&t.el.parentNode)return e.layers.view.filter.reset(a,t);let r=e.layers.view.filter.block(a,t);r.dataset.field=t.field,t.el=r,a.filter.current[t.field.field]||(a.filter.current[t.field]={}),a.filter.current[t.field].boolean=!0,r.appendChild(e.utils.html.node`
  <label class="input-checkbox">
  <input type="checkbox"
    checked=true 
    onchange=${i=>{i.target.checked?a.filter.current[t.field].boolean=!0:a.filter.current[t.field].boolean=!1,a.reload(),a.count(n=>{t.filterZoom&&n>1&&a.zoomToExtent()})}}>
  </input>
  <div></div><span>${t.name||e.language.layer_filter_boolean}`),a.reload(),a.show(),a.count(i=>{t.filterZoom&&i>1&&a.zoomToExtent()})};var ll=e=>{let a={panel:i,block:t,reset:r,filter_text:tl(e),filter_numeric:al(e),filter_in:rl(e),filter_date:nl(e),filter_boolean:il(e)};return a;function t(n,s){let o=e.utils.html.node`
    <div class="drawer">
    <div class="header bold">
    <span>${s.title}</span>
    <button
      class="btn-header xyz-icon icon-close primary-colour-filter"
      onclick=${c=>{n.filter.current[s.field]={},n.reload(),n.show(),o.remove(),n.filter.list.children.length||(n.filter.clear_all.style.display="none")}}>`;return n.filter.list.appendChild(o),o}function r(n,s){s.el.parentNode.removeChild(s.el),s.el=null,n.filter.list.children.length||(n.filter.clear_all.style.display="none")}function i(n){if(!n.infoj||!n.infoj.some(f=>f.filter))return;let s=n.infoj.filter(f=>f.filter);s.unshift(e.language.layer_filter_select);let o=e.utils.html.node`
    <div class="drawer panel expandable">`;o.appendChild(e.utils.html.node`
    <div
      class="header primary-colour"
      onclick=${f=>{f.stopPropagation(),e.utils.toggleExpanderParent(f.target,!0)}}><span>${e.language.layer_filter_header}</span><button
      class="btn-header xyz-icon icon-expander primary-colour-filter">`);let c={};return Object.values(s).forEach(f=>{f.field&&(c[f.field]=f.title||f.field)}),n.filter.select=e.utils.html.node`
      <button class="btn-drop">
        <div
          class="head"
          onclick=${f=>{f.preventDefault(),f.target.parentElement.classList.toggle("active")}}>
          <span>${e.language.layer_filter_select}</span>
          <div class="icon"></div>
        </div>
        <ul>${Object.entries(c).map(f=>e.utils.html.node`
          <li onclick=${p=>{p.target.closest(".btn-drop").classList.toggle("active");let h=s.find(w=>w.field===f[0]);if(n.filter.clear_all.style.display="block",h.filter=="date")return a.filter_date(n,h);if(h.filter==="numeric")return a.filter_numeric(n,h);if(h.filter==="like"||h.filter==="match")return a.filter_text(n,h);if(h.filter.in)return a.filter_in(n,h);if(h.filter==="boolean")return a.filter_boolean(n,h)}}>${f[1]}`)}`,o.appendChild(n.filter.select),n.filter.clear_all=e.utils.html.node`
    <button
      class="primary-colour"
      style="display: none; margin-bottom: 5px;"
      onclick=${f=>{f.target.style.display="none",n.filter.list.innerHTML=null,Object.keys(n.filter.current).forEach(p=>n.filter.current[p]={}),n.reload(),n.show()}}>${e.language.layer_filter_clear_all}`,o.appendChild(n.filter.clear_all),n.filter.list=e.utils.html.node`<div>`,o.appendChild(n.filter.list),o}};var sl=e=>a=>e.utils.html.node`
    <button
      class="btn-wide primary-colour"
      onclick=${t=>{t.stopPropagation();let r=t.target;if(r.classList.contains("active"))return e.mapview.interaction.draw.cancel();r.classList.add("active"),a.show(),a.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),e.mapview.interaction.draw.begin({layer:a,type:"Point",callback:()=>{a.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),r.classList.remove("active")}})}}>${e.language.layer_draw_point}`;var cl=e=>a=>e.utils.html.node`
<button
  class="btn-wide primary-colour"
  onclick=${t=>{t.stopPropagation();let r=t.target;if(r.classList.contains("active"))return e.mapview.interaction.draw.cancel();r.classList.add("active"),a.show(),a.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),e.mapview.interaction.draw.begin({layer:a,type:"Polygon",geometryFunction:e.mapview.interaction.draw.polygonKinks,tooltip:a.edit.polygon.tooltip,callback:()=>{a.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),r.classList.remove("active")}})}}>${e.language.layer_draw_polygon}`;var ul=e=>a=>e.utils.html.node`
  <button
    class="btn-wide primary-colour"
    onclick=${t=>{t.stopPropagation();let r=t.target;if(r.classList.contains("active"))return e.mapview.interaction.draw.cancel();r.classList.add("active"),a.show(),a.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),e.mapview.interaction.draw.begin({layer:a,type:"Circle",geometryFunction:ol.interaction.Draw.createBox(),tooltip:a.edit.rectangle.tooltip,callback:()=>{a.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),r.classList.remove("active")}})}}>${e.language.layer_draw_rectangle}`;var dl=e=>a=>e.utils.html.node`
  <button
    class="btn-wide primary-colour"
    onclick=${t=>{t.stopPropagation();let r=t.target;if(r.classList.contains("active"))return e.mapview.interaction.draw.cancel();r.classList.add("active"),a.show(),a.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),e.mapview.interaction.draw.begin({layer:a,type:"Circle",geometryFunction:ol.interaction.Draw.createRegularPolygon(33),tooltip:a.edit.circle.tooltip,callback:()=>{a.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),r.classList.remove("active")}})}}>${e.language.layer_draw_circle}`;var pl=e=>a=>e.utils.html.node`
    <button
      class="btn-wide primary-colour"
      onclick=${t=>{t.stopPropagation();let r=t.target;if(r.classList.contains("active"))return e.mapview.interaction.draw.cancel();r.classList.add("active"),a.show(),a.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),e.mapview.interaction.draw.begin({layer:a,type:"LineString",tooltip:a.edit.line.tooltip,callback:()=>{a.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),r.classList.remove("active")}})}}>${e.language.layer_draw_line}`;var fl=e=>a=>e.utils.html.node`
  <button
    class="btn-wide primary-colour"
    onclick=${t=>{t.stopPropagation();let r=t.target;if(r.classList.contains("active"))return e.mapview.interaction.draw.cancel();r.classList.add("active"),a.show(),a.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),e.mapview.interaction.draw.begin({layer:a,type:"LineString",freehand:!0,callback:()=>{a.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),r.classList.remove("active")}})}}>${e.language.layer_draw_freehand}`;var gl=e=>a=>{typeof a.edit.isoline_mapbox!="object"&&(a.edit.isoline_mapbox={});let t=e.utils.html.node`<div>`,r=e.utils.html.node`
    <div
      class="drawer group panel expandable">
      <div
        class="header primary-colour"
        style="text-align: left;"
        onclick=${s=>{e.utils.toggleExpanderParent(s.target)}}>
        <span>${e.language.mapbox_isoline_settings}</span>
        <span class="xyz-icon btn-header icon-expander primary-colour-filter">`;a.edit.isoline_mapbox.profile=a.edit.isoline_mapbox.profile||"driving",a.edit.isoline_mapbox.minutes=a.edit.isoline_mapbox.minutes||10;let i=[{[e.language.mapbox_driving]:"driving"},{[e.language.mapbox_walking]:"walking"},{[e.language.mapbox_cycling]:"cycling"}];return a.edit.isoline_mapbox.profile="driving",r.appendChild(e.utils.html.node`
    <div
      class="display-grid"
      style="margin-top: 8px; grid-template-columns: 50px 1fr; align-items: center;">
      <span style="grid-column: 1;">${e.language.mapbox_mode}</span>
      <div style="grid-column: 2;">
        <button class="btn-drop">
          <div class="head"
            onclick=${s=>{s.preventDefault(),s.target.parentElement.classList.toggle("active")}}>
            <span>${e.language.mapbox_driving}</span>
            <div class="icon"></div>
          </div>
          <ul>${i.map(s=>e.utils.html.node`
            <li onclick=${o=>{let c=o.target.closest(".btn-drop");c.classList.toggle("active"),c.querySelector(":first-child").textContent=Object.keys(s)[0],a.edit.isoline_mapbox.profile=Object.values(s)[0]}}>${Object.keys(s)[0]}`)}`),r.appendChild(e.utils.html.node`
    <div style="margin-top: 12px;">
      <span>${e.language.mapbox_travel_time}</span>
      <span class="bold">${a.edit.isoline_mapbox.minutes}</span>
      <div class="input-range">
        <input
          class="secondary-colour-bg"
          type="range" min=5 max=${a.edit.isoline_mapbox.maxMinutes||30} step=1
          value=${a.edit.isoline_mapbox.minutes}
          oninput=${s=>{a.edit.isoline_mapbox.minutes=parseInt(s.target.value),s.target.parentNode.previousElementSibling.textContent=a.edit.isoline_mapbox.minutes}}>`),t.appendChild(r),t.appendChild(e.utils.html.node`
    <button
      class="btn-wide primary-colour"
      onclick=${n}>${e.language.layer_draw_isoline_mapbox}`),t;function n(s){s.stopPropagation();let o=s.target;if(o.classList.contains("active"))return e.mapview.interaction.draw.cancel();o.classList.add("active"),a.show(),a.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),e.mapview.interaction.draw.begin({layer:a,type:"Point",geometryFunction:function(c,f){f=new ol.geom.Circle(c,a.edit.isoline_mapbox.minutes*1e3);let p=ol.proj.transform(c,`EPSG:${e.mapview.srid}`,"EPSG:4326"),u=new XMLHttpRequest;return u.open("GET",`https://api.mapbox.com/isochrone/v1/mapbox/${a.edit.isoline_mapbox.profile||"driving"}/${p.join(",")}?`+e.utils.paramString({contours_minutes:a.edit.isoline_mapbox.minutes,generalize:a.edit.isoline_mapbox.minutes,polygons:!0,access_token:a.edit.isoline_mapbox.access_token})),u.setRequestHeader("Content-Type","application/json"),u.responseType="json",u.onload=h=>{if(h.target.status!==200||!h.target.response.features)return alert("No route found. Try a longer travel time or alternative setup.");e.mapview.interaction.draw.feature({geometry:h.target.response.features[0].geometry,dataProjection:"EPSG:4326"})},u.send(),f},callback:()=>{a.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),o.classList.remove("active")}})}};var hl=e=>a=>{typeof a.edit.isoline_here!="object"&&(a.edit.isoline_here={}),a.edit.defaults={};let t=e.utils.html.node`<div>`,r=e.utils.html.node`
    <div
      class="drawer group panel expandable">
      <div
        class="header primary-colour"
        style="text-align: left;"
        onclick=${c=>{e.utils.toggleExpanderParent(c.target)}}>
        <span>${e.language.here_isoline_settings}</span>
        <span class="xyz-icon btn-header icon-expander primary-colour-filter">`;return n(r),t.appendChild(r),t.appendChild(e.utils.html.node`
    <button
      class="btn-wide primary-colour"
      onclick=${i}>${e.language.layer_draw_isoline_here}`),t;function i(c){c.stopPropagation();let f=c.target;if(f.classList.contains("active"))return e.mapview.interaction.draw.cancel();f.classList.add("active"),a.show(),a.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),e.mapview.interaction.draw.begin({layer:a,type:"Point",geometryFunction:function(p,u){u=new ol.geom.Circle(p,a.edit.isoline_here.minutes*1e3);let h=ol.proj.transform(p,`EPSG:${e.mapview.srid}`,"EPSG:4326"),w=a.edit.isoline_here.range*60,D=`${h[1]},${h[0]}`,Z=a.edit.isoline_here.destination||a.edit.defaults.destination,U=a.edit.isoline_here.dateISO?new Date(a.edit.isoline_here.dateISO).toISOString():a.edit.defaults.dateISO?new Date(a.edit.defaults.dateISO).toISOString():null,ae={transportMode:a.edit.isoline_here.transportMode||"car",[Z?"destination":"origin"]:D,"range[values]":w||10*60,"range[type]":a.edit.isoline_here.rangetype||"time",optimizeFor:a.edit.isoline_here.optimizeFor||"balanced"};return U&&Object.assign(ae,{[Z?"arrivalTime":"departureTime"]:U}),e.proxy(`https://isoline.router.hereapi.com/v8/isolines?${e.utils.paramString(ae)}${a.edit.isoline_here.maxPoints?`&shape[${a.edit.isoline_here.maxPoints}]`:""}&{HERE}`).then(F=>{if(!F.isolines)return console.log(F),alert(e.language.here_error);let ie=e.utils.isoline_here_decode(F.isolines[0].polygons[0].outer);ie.polyline.map(J=>J.reverse()),ie.polyline.push(ie.polyline[0]),e.mapview.interaction.draw.feature({geometry:{type:"Polygon",coordinates:[ie.polyline]}})}),u},callback:()=>{a.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),f.classList.remove("active")}})}function n(c){let f=e.utils.html.node`<span>${e.language.here_depart}`;c.appendChild(e.utils.html.node`
            <div style="padding-top: 5px; grid-column: 1 / 3;">
            <label class="input-checkbox">
            <input type="checkbox" "checked"=false
            onchange=${Z=>{f.textContent=Z.target.checked?`${e.language.here_arrive}`:`${e.language.here_depart}`,a.edit.isoline_here.destination=Z.target.checked}}></input><div></div><span>${e.language.here_use_as_destination}`);let p=[{[e.language.here_driving]:"car"},{[e.language.here_walking]:"pedestrian"}];c.appendChild(s({title:e.language.here_transport_mode,options:p,callback:(Z,U)=>{a.edit.isoline_here.transportMode=U}}));let u=[{[e.language.here_time]:"time"}],h=[{[e.language.here_routing_type_fastest]:"fast"},{[e.language.here_routing_type_shortest]:"short"}];c.appendChild(s({title:e.language.here_routing_type,options:h,callback:(Z,U)=>{a.edit.isoline_here.routingType=U}}));let w=[{[e.language.here_optimize_for_balanced]:"balanced"},{[e.language.here_optimize_for_quality]:"quality"},{[e.language.here_optimize_for_performance]:"performance"}];c.appendChild(s({title:e.language.here_optimize_for,options:w,callback:(Z,U)=>{a.edit.isoline_here.optimizeFor=U}}));let D=e.utils.html.node`<input type="text" placeholder=${e.language.layer_filter_pick} style="text-align: end;">`;c.appendChild(e.utils.html.node`
                <div style="margin-top: 12px; grid-column: 1 / 3; margin-bottom: 8px;">
                <div style="display: grid; grid-template-columns: 100px 1fr; align-items: center;">
                <div style="grid-column: 1;">${f}</div>
                <div style="grid-column: 2;">${D}</div>`),e.utils.flatpickr({locale:e.hooks.current.language||null,element:D,enableTime:!0,callback:Z=>{!Z||(D.value=Z,a.edit.isoline_here.dateISO=new Date(Z).toISOString())}}),c.appendChild(o({title:e.language.here_travel_time,max:a.edit.isoline_here.maxMinutes,range:10,callback:Z=>{a.edit.isoline_here.range=parseInt(Z.target.value)}}))}function s(c){return e.utils.html.node`<div style="margin-top: 8px; grid-column: 1 / 3; align-items: center;">
            <div style="display: grid; grid-template-columns: 100px 1fr; align-items: center;">
            <div style="grid-column: 1;">${c.title}</div>
            <div style="grid-column: 2;">
            <button class="btn-drop">
            <div
                class="head"
                onclick=${f=>{f.preventDefault(),f.target.parentElement.classList.toggle("active")}}>
                <span>${Object.keys(c.options[0])}</span>
                <div class="icon"></div>
            </div>
            <ul>
                ${c.options.map(f=>e.utils.html.node`
                <li onclick=${p=>{let u=p.target.closest(".btn-drop");u.classList.toggle("active"),u.querySelector(":first-child").textContent=Object.keys(f)[0],c.callback&&c.callback(p,Object.values(f)[0])}}>${Object.keys(f)[0]}`)}`}function o(c){return e.utils.html.node`
        <div style="margin-top: 12px; grid-column: 1 / 3;">
        <span>${c.title}</span>
        <span class="bold">${c.range}</span>
        <div class="input-range">
        <input
          class="secondary-colour-bg"
          type="range"
          min=5
          value=${c.range}
          max=${c.max||30}
          step=1
          oninput=${f=>{f.target.parentNode.previousElementSibling.textContent=parseInt(f.target.value),c.callback&&c.callback(f)}}>`}};var ml=e=>{let a={panel:t,polygon:cl(e),point:sl(e),rectangle:ul(e),circle:dl(e),line:pl(e),freehand:fl(e),isoline_mapbox:gl(e),isoline_here:hl(e)};return a;function t(r){if(!r.edit)return;let i=e.utils.html.node`
    <div class="drawer panel expandable">`;if(i.appendChild(e.utils.html.node`
    <div
      class="header primary-colour"
      onclick=${n=>{n.stopPropagation(),e.utils.toggleExpanderParent(n.target,!0)}}><span>${e.language.layer_add_new_location}</span><button
      class="btn-header xyz-icon icon-expander primary-colour-filter">`),r.edit.point&&i.appendChild(a.point(r)),r.edit.polygon&&i.appendChild(a.polygon(r)),r.edit.rectangle&&i.appendChild(a.rectangle(r)),r.edit.circle&&i.appendChild(a.circle(r)),r.edit.line&&i.appendChild(a.line(r)),r.edit.freehand&&i.appendChild(a.freehand(r)),r.edit.isoline_mapbox&&i.appendChild(a.isoline_mapbox(r)),r.edit.isoline_here&&i.appendChild(a.isoline_here(r)),!(i.children.length<2))return i}};var vl=e=>{return{panel:a};function a(t){if(!t.dataviews||!e.tabview.node)return;let r=e.utils.html.node`<div class="drawer panel expandable">`;return r.appendChild(e.utils.html.node`
      <div
        class="header primary-colour"
        onclick=${i=>{i.stopPropagation(),e.utils.toggleExpanderParent(i.target,!0)}}>
        <span>${e.language.layer_dataview_header}</span>
        <button class="btn-header xyz-icon icon-expander primary-colour-filter">`),Object.entries(t.dataviews).forEach(i=>{let n=i[1];n.key=i[0],n.layer=t,e.tabview.add(n),e.dataviews.create(n),t.display&&n.display&&n.show(),r.appendChild(e.utils.html.node`
        <label class="input-checkbox inline">
          <input
            type="checkbox"
            .checked=${!!n.display}
            onchange=${s=>{n.display=s.target.checked,n.display?n.show():n.remove()}}></input>
          <div></div>
        </label>
        <span>${n.title||n.key}`)}),r}};var bl=e=>{return{panel:t};function t(r){if(!r.reports)return;let i=e.utils.html.node`
    <div class="drawer panel expandable">`;return i.appendChild(e.utils.html.node`
    <div
      class="header primary-colour"
      onclick=${n=>{n.stopPropagation(),e.utils.toggleExpanderParent(n.target,!0)}}><span>Reports</span><button
      class="btn-header xyz-icon icon-expander primary-colour-filter">`),Object.entries(r.reports).forEach(n=>{let s=e.host+"/view?"+e.utils.paramString(Object.assign(n[1],{template:n[0],locale:e.locale.key,layer:r.key,lat:e.hooks.current.lat,lng:e.hooks.current.lng,z:e.hooks.current.z}));i.appendChild(e.utils.html.node`
      <a
        target="_blank"
        href="${s}"
        class="link-with-img">
        <div class="xyz-icon icon-event-note"></div><span>${n[0]}`)}),i}};var wl=e=>{return{panel:t};function t(s){if(!s.download)return;let o=e.utils.html.node`<div class="drawer panel expandable">`;return o.appendChild(e.utils.html.node`
      <div
        class="header primary-colour"
        onclick=${c=>{e.utils.toggleExpanderParent(c.target,!0)}}>
        <span>${e.language.layer_data}</span>
        <button class="btn-header xyz-icon icon-expander primary-colour-filter">`),o.appendChild(e.utils.html.node`
      <label class="input-checkbox">
        <input type="checkbox"
          onchange=${c=>{s.download.viewport=c.target.checked}}>
        </input>
        <div></div>
        <span>${e.language.layer_data_viewport_only}`),o.appendChild(e.utils.html.node`
      <button
        class="btn-wide primary-colour"
        onclick=${c=>{r(s)}}>${e.language.layer_download}`),o}function r(s){s.download.layer=s,e.query(s.download).then(o=>{let c=s.download.format==="json"&&i(o)||n(o);e.utils.html.node`<a
        href=${URL.createObjectURL(c)}
        download=${`${s.key}.${s.download.format||"csv"}`}>`.click()})}function i(s){let o=s.map(f=>{let p={type:"Feature",properties:f};return p.geometry=JSON.parse(f.geometry),delete p.properties.geometry,p}),c=JSON.stringify({type:"FeatureCollection",features:o});return new Blob([c],{type:"application/json"})}function n(s){let c=s.map(f=>Object.values(f).map(p=>isNaN(p)&&`"${p}"`||p).join(",")).join(`\r
`);return new Blob([c],{type:"text/csv;charset=utf-8;"})}};var _l=e=>{let a={create:t,filter:ll(e),draw:ml(e),report:bl(e),data:vl(e),download:wl(e)};return a;function t(r){r.view=e.utils.html.node`<div class="drawer layer-view">`;let i=e.utils.html.node`
    <div class="header enabled"><span>${r.name||r.key}`;r.style.default&&r.style.default.showInHeader&&i.appendChild(e.utils.html.node`
      <img
        class="btn-header"
        title=${e.language.layer_default_icon}
        style="float: right; cursor: help;"
        src="${e.utils.svg_symbols(r.style.default)}">`),i.appendChild(e.utils.html.node`
    <button
      title=${e.language.layer_zoom_to_extent}
      class="btn-header xyz-icon icon-fullscreen"
      onclick=${h=>{h.stopPropagation(),r.zoomToExtent()}}>`);let n=e.utils.html.node`
    <button
      title=${e.language.layer_visibility}
      class="${`btn-header xyz-icon icon-toggle ${r.display&&"on"||"off"}`}"
      onclick=${h=>{h.stopPropagation(),r.display?r.remove():r.show()}}>`;if(i.appendChild(n),r.view.addEventListener("display-on",()=>{n.classList.add("on")}),r.view.addEventListener("display-off",()=>{n.classList.remove("on")}),r.view.appendChild(i),r.meta){let h=r.view.appendChild(e.utils.html.node`<p class="meta">`);h.innerHTML=r.meta}let s=a.style.panel(r);s&&r.view.appendChild(s);let o=a.filter.panel(r);o&&r.view.appendChild(o);let c=a.data.panel(r);c&&r.view.appendChild(c);let f=a.draw.panel(r);f&&r.view.appendChild(f);let p=a.report.panel(r);p&&r.view.appendChild(p);let u=a.download.panel(r);u&&r.view.appendChild(u),r.plugins&&r.plugins.forEach(h=>e.layers.plugins[h]&&e.layers.plugins[h](r)),!(r.view.children.length<=1)&&(r.view.classList.add("expandable"),i.onclick=h=>{h.stopPropagation(),e.utils.toggleExpanderParent(h.target,!0)},i.appendChild(e.utils.html.node`
    <button
      title=${e.language.layer_toggle_dashboard}
      class="btn-header xyz-icon icon-expander"
      onclick=${h=>{h.stopPropagation(),e.utils.toggleExpanderParent(h.target)}}>`))}};var yl=e=>function(){let a=this;if(!a.tables)return a.table;let t,r=parseInt(e.mapview.getZoom()),i=Object.keys(a.tables),n=parseInt(i[0]),s=parseInt(i[i.length-1]);return t=a.tables[r],t=r<n?a.tables[n]:t,t=r>s?a.tables[s]:t,t};var kl=e=>function(){let a=this;if(!a.tables)return a.table;let t=Object.keys(a.tables);return a.tables[t[0]]||a.tables[t[1]]};var Cl=e=>function(){let a=this;if(!a.tables)return a.table;let t=Object.keys(a.tables);return a.tables[t[t.length-1]]||a.tables[t[t.length-2]]};var Sl=e=>function(a){let t=this,r=new XMLHttpRequest;r.open("GET",e.host+"/api/query/layer_extent?"+e.utils.paramString({locale:e.locale.key,layer:t.key,table:t.table||Object.values(t.tables)[0]||Object.values(t.tables)[1],geom:t.geom,proj:t.srid,srid:e.mapview.srid,filter:t.filter&&t.filter.current})),r.setRequestHeader("Content-Type","application/json"),r.responseType="json",r.onload=i=>{if(i.target.status!==200)return;let n=/\((.*?)\)/.exec(i.target.response.box2d)[1].replace(/ /g,",");e.mapview.flyToBounds(n.split(",").map(s=>parseFloat(s)),a)},r.send()};var El=e=>function(){if(!e.map)return;let a=this;a.display=!0,a.view&&a.view.dispatchEvent(new CustomEvent("display-on")),a.L&&e.map.removeLayer(a.L),e.map.addLayer(a.L),a.style&&a.style.label&&(e.map.getLayers().forEach(t=>{t===a.label&&e.map.removeLayer(a.label)}),a.style.label.display&&e.map.addLayer(a.label)),e.mapview.attribution.check(),e.hooks&&e.hooks.push("layers",a.key),a.tabs.forEach(t=>{t.display&&t.show()})};var Tl=e=>function(){let a=this;a.display=!1,a.view&&a.view.dispatchEvent(new CustomEvent("display-off")),a.L&&e.map.removeLayer(a.L),a.style&&a.style.label&&a.label&&e.map.removeLayer(a.label),e.mapview.attribution.check(),e.hooks&&e.hooks.filter("layers",a.key),a.tabs.forEach(t=>t.remove())};var jl=e=>async function(a){let t=this,r=await e.query({query:"count_locations",locale:e.locale.key,layer:t,filter:t.filter&&t.filter.current,queryparams:{table:t.tableMin()}});return a?a(parseInt(r.count)):parseInt(r.count)};var Ll=e=>function(){let a=this;a.L.getZIndex()!==1e3&&(Object.values(e.layers.list).map(t=>{t.format!=="tiles"&&t.L.setZIndex(t.style.zIndex||1)&&t.display&&t.reload()}),a.L.setZIndex(1e3),a.reload())};var Ml=e=>{return{decorate:t,list:{},plugins:{},view:_l(e),load:r};function t(i){let n=Object.assign({tableCurrent:yl(e),tableMin:kl(e),tableMax:Cl(e),zoomToExtent:Sl(e),show:El(e),remove:Tl(e),count:jl(e),bringToFront:Ll(e),tabs:new Set,filter:{}},i);return n.filter.current=n.filter.current||{},n.style&&n.style.themes&&(n.style.theme=n.style.theme||n.style.themes[Object.keys(n.style.themes)[0]]),n.format&&e.mapview.layer[n.format]&&e.mapview.layer[n.format](n),n}function r(i){return new Promise((n,s)=>{e.locale.layers||n();let o=e.locale.layers.filter(c=>!i||!i.length||i.includes(c)).map(c=>e.workspace.get.layer({locale:e.locale.key,layer:c}));Promise.all(o).then(c=>{e.hooks&&e.hooks.current.layers.length&&c.forEach(f=>{f.display=!!~e.hooks.current.layers.indexOf(f.key)}),c.forEach((f,p)=>{!f.format||(f=e.layers.decorate(f),e.layers.list[f.key]=f,f.display&&f.show(),c[p]=f)}),n(c)}).catch(c=>{console.error(c),s(c)})})}};var $l=e=>a=>{if(typeof a.layer=="string"&&(a.layer=e.layers.list[a.layer]),!a.layer||!a.layer.infoj)return;e.mapview.popup.node&&e.mapview.popup.node.remove(),a.hook=`${a.layer.key}!${a.table}!${a.id}`;let t={stamp:parseInt(Date.now())};if(e.locations.list.some(i=>{if(i.location?.hook===a.hook)return i.location.remove(),i.stamp=0,!0}))return;for(let i of e.locations.list)if(i.location)i.stamp<t.stamp&&(t=i);else{t=i;break}if(t.stamp=parseInt(Date.now()),t.location&&t.location.remove(),t.location=a,a.style=t.style,a.colorFilter=t.colorFilter,a._new)return e.locations.decorate(a),a.marker=ol.proj.transform(e.utils.turf.pointOnFeature(a.geometry).geometry.coordinates,"EPSG:"+a.layer.srid,"EPSG:"+e.mapview.srid),typeof a.callback=="function"?a.callback(a):e.locations.selectCallback(a);let r=new XMLHttpRequest;t.location.xhr=r,r.open("GET",e.host+"/api/location/get?"+e.utils.paramString({locale:e.locale.key,layer:a.layer.key,table:a.table,id:a.id})),r.setRequestHeader("Content-Type","application/json"),r.responseType="json",r.onload=i=>{if(i.target.status>200){delete t.stamp,e.hooks&&e.hooks.filter("locations",a.hook);return}e.hooks&&e.hooks.push("locations",a.hook);let n=a.layer.infoj.map(s=>{let o=e.utils.cloneDeep(s);return o.title=i.target.response.properties[o.field+"_label"]||o.title,o.value=i.target.response.properties[o.field],o});if(e.locations.decorate(a,{infoj:n,geometry:i.target.response.geometry,editable:a.layer.edit,record:t}),a.marker=ol.proj.transform(e.utils.turf.pointOnFeature(i.target.response.geometry).geometry.coordinates,"EPSG:"+a.layer.srid,"EPSG:"+e.mapview.srid),typeof a.callback=="function")return a.callback(a);e.locations.selectCallback(a)},r.send(),t.location.remove=()=>{t.location.xhr.abort(),t.location=null}};var Fl=e=>a=>{if(e.locations.view.create(a),a.draw(),!e.mapview.popup)return alert(JSON.stringify(a.infoj,e.utils.getCircularReplacer()," "));if(!e.locations.listview.node){a.view.style.width="300px",e.mapview.popup.create({coords:a.marker,content:a.view,autoPan:!0});return}return a.Marker=e.mapview.geoJSON({geometry:{type:"Point",coordinates:a.marker},zIndex:2e3,style:new ol.style.Style({image:e.mapview.icon({type:"markerLetter",letter:String.fromCharCode(65+e.locations.list.indexOf(a.record)),color:a.style.strokeColor,scale:3,anchor:[.5,1]})})}),a._flyTo&&a.flyTo(),e.locations.listview.add(a)};var Dl=e=>a=>{if(!a.infoj||a.infoj.length<1)return;a.geometries=a.geometries.filter(i=>{e.map.removeLayer(i)}),a.geometryCollection=a.geometryCollection.filter(i=>{e.map.removeLayer(i)}),a.tabs.forEach(i=>i.remove&&i.remove());let t=e.utils.html.node`<div class="location-view-grid">`,r={};for(let i of a.infoj){if(a.view&&a.view.classList.contains("disabled"))break;if(i.listview=t,i.location=a,i.type=i.type||"text",i.inline=i.inline||i.type==="integer"||i.type==="numeric",i.class=`${i.class||""} ${i.type} ${i.inline&&"inline"||""}`,i.type==="key"){i.listview.appendChild(e.utils.html.node`
        <div
          class="${i.class}">
          <span
            title=${e.language.location_source_layer}
            style="${`background-color: ${e.utils.Chroma(a.style.strokeColor||"#090").alpha(.3)}`}"
            >${a.layer.name||a.layer.key}`);continue}if(i.displayValue=i.type==="numeric"?parseFloat(i.value).toLocaleString("en-GB",{maximumFractionDigits:2}):i.type==="integer"?parseInt(i.value).toLocaleString("en-GB",{maximumFractionDigits:0}):i.type==="date"?e.utils.formatDate(i.value):i.type==="datetime"?e.utils.formatDateTime(i.value):i.value,i.displayValue=`${i.prefix||""}${i.displayValue}${i.suffix||""}`,i.group&&(r[i.group]||(r[i.group]=e.utils.html.node`
        <div
          class="${`drawer group panel expandable ${i.class||""}`}"
          style="${i.group_css||""}">
          <div
            class="header primary-colour"
            onclick=${n=>{e.utils.toggleExpanderParent(n.target)}}>
            <span>${i.group}</span>
            <span class="xyz-icon btn-header icon-expander primary-colour-filter">`,i.listview.appendChild(r[i.group])),i.expanded&&r[i.group].classList.add("expanded"),i.listview=r[i.group]),i.plugin){e.locations.plugins[i.plugin]&&e.locations.plugins[i.plugin](i);continue}if(!(typeof i.value!="undefined"&&i.value===null&&!i.edit)&&!(i.title&&!i.query&&!i.dataviews&&(!i.edit&&typeof i.value=="undefined"&&i.type!=="title"||(i.listview.appendChild(e.utils.html.node`
        <div
          class="${`label ${i.class}`}"
          style="${`${i.css_title||""}`}"
          title="${i.tooltip||null}">${i.title}`),i.type==="title")))){if(i.type==="dataview"){let n=e.locations.view.dataview(i);n&&i.listview.appendChild(n);continue}if(e.locations.view[i.type]){e.locations.view[i.type](i);continue}if(!(!i.query&&!i.edit&&typeof i.value=="undefined")){if(i.val=i.listview.appendChild(e.utils.html.node`
      <div
        class="${`val ${i.class}`}"
        style="${`${i.css_val||""}`}">`),i.query){i.layer=i.layer||i.location.layer,e.query(i).then(n=>{!n||(i.val.textContent=Object.values(n)[0])});continue}if(i.edit&&!i.fieldfx){e.locations.view.edit.input(i);continue}if(i.type==="html"){i.val.innerHTML=i.value;continue}if(i.displayValue=="null"){i.val.remove();continue}i.val.textContent=i.displayValue}}}return t};var Ol=e=>a=>{let t=ol.proj.transform(a.location.marker,"EPSG:"+e.mapview.srid,"EPSG:4326"),r=`${e.host}/api/proxy?url=${encodeURIComponent(`https://maps.googleapis.com/maps/api/streetview?location=${t[1]},${t[0]}&source=outdoor&size=300x230&{GOOGLE}`)}`;a.listview.appendChild(e.utils.html.node`
    <div
      class="${a.class}">
      <a
        target="_blank"
        href="${"https://www.google.com/maps?cbll="+t[1]+","+t[0]+"&layer=c"}">
        <img src="${r}">`)};var Al=e=>a=>{let t=e.utils.html.node`<div class="images-grid">`;a.listview.appendChild(t);for(let i of a.value)t.appendChild(e.utils.html.node`
      <div
        class="${a.class||""}"
        style="position: relative; width: 90px; height: 90px; flex-grow: 1;">
        <img src=${i}
          style="width: 100%; height: 100%; object-fit: cover; padding: 2px; border-radius: 2px;"
          onclick=${n=>{!document.getElementById("modalOverlay")||(document.getElementById("modalOverlay").style.display="block",document.getElementById("modalOverlay").childNodes[a.value.indexOf(n.target.src)+1].scrollIntoView())}}>
          ${a.edit&&e.utils.html.node`
            <button
              class="xyz-icon icon-trash img-remove"
              data-name=${i.replace(/.*\//,"").replace(/\.([\w-]{3})/,"")}
              data-src=${i}
              onclick=${n=>r(n)}>
            </button>`}`);if(!a.edit)return;if(document.getElementById("modalOverlay")){document.getElementById("modalOverlay").appendChild(e.utils.html.node`
      <span onclick=${i=>{document.getElementById("modalOverlay").style.display="none"}}>&times;`);for(let i of a.value)document.getElementById("modalOverlay").appendChild(e.utils.html.node`<div><img style="padding-top: 40px;" src=${i}>`)}a.listview.appendChild(e.utils.html.node`
    <div class="list" style="grid-column: 1 / 3;">
    <div class="add xyz-icon icon-add-photo off-black-filter">
    <input
      type="file"
      accept="image/*;capture=camera"
      onchange=${i=>{let n=new FileReader,s=i.target.files[0];if(!s)return;let o=e.utils.html.node`
          <div
            class="${a.class||""}" 
            style="position: relative; width: 90px; height: 90px; flex-grow: 1;"
            onclick=${c=>{!document.getElementById("modalOverlay")||(document.getElementById("modalOverlay").style.display="block",Array.from(document.querySelectorAll("#modalOverlay img")).some(f=>{f.src===c.target.src&&f.scrollIntoView()}))}}>`;t.appendChild(o),n.onload=c=>{let f=new Image;f.onload=async()=>{let p=e.utils.html.node`<canvas>`,u=1024,h=f.width,w=f.height;h>w&&h>u?(w*=u/h,h=u):w>u&&(h*=u/w,w=u),p.width=h,p.height=w,p.getContext("2d").drawImage(f,0,0,h,w);let D=p.toDataURL("image/jpeg",.5),Z=await e.xhr({method:"POST",content_type:"application/octet-stream",url:`${e.host}/api/provider/cloudinary?${e.utils.paramString({public_id:s.name.replace(/.*\//,"").replace(/\.([\w-]{3})/,""),resource_type:"image"})}`,body:e.utils.dataURLtoBlob(D)});await e.xhr({url:`${e.host}/api/query?${e.utils.paramString({template:"set_field_array",locale:e.locale.key,layer:a.location.layer.key,table:a.location.table,action:"append",field:a.field,secure_url:Z.secure_url,id:a.location.id})}`}),e.utils.render(o,e.utils.html`
              <img src=${Z.secure_url}
                style="width: 100%; height: 100%; object-fit: cover; padding: 2px; border-radius: 2px;">
                ${a.edit&&e.utils.html.node`
                  <button
                    class="xyz-icon icon-trash img-remove"
                    data-name=${Z.public_id}
                    data-src=${Z.secure_url}
                    onclick=${U=>r(U)}>
                  </button>`}`),document.getElementById("modalOverlay")&&document.getElementById("modalOverlay").appendChild(e.utils.html.node`
                <div><img style="padding-top: 40px;" src=${Z.secure_url}>`)},f.src=c.target.result},n.readAsDataURL(s),i.target.value=""}}>`);async function r(i){if(!confirm("Remove image?"))return;let n=i.target;e.xhr({url:`${e.host}/api/provider/cloudinary?${e.utils.paramString({destroy:!0,public_id:n.dataset.name})}`}),await e.xhr({url:`${e.host}/api/query?${e.utils.paramString({template:"set_field_array",locale:e.locale.key,layer:a.location.layer.key,table:a.location.table,action:"remove",field:a.field,secure_url:n.dataset.src,id:a.location.id})}`}),n.parentNode.remove()}};var Pl=e=>a=>{a.documents=e.utils.html.node`<div style="grid-column: 1 / 3;"">`,a.listview.appendChild(a.documents);for(let r of a.value)a.documents.appendChild(e.utils.html.node`
		<div class="item">
		${a.edit&&e.utils.html.node`
		<button
			class="xyz-icon icon-trash link-remove"
			data-name=${r.replace(/.*\//,"").replace(/\.([\w-]{3})/,"")}
			data-href=${r}
			onclick=${i=>t(i)}>
		</button>`}		
		<a href=${r}>${r.replace(/.*\//,"").replace(/\.([\w-]{3})/,"")}`);if(!a.edit)return;a.listview.appendChild(e.utils.html.node`
    <div class="list" style="grid-column: 1 / 3;">
      <div class="add xyz-icon icon-cloud-upload off-black-filter">
      <input
      type="file"
      accept=".txt,.pdf,.doc,.docx,.xls,.xlsx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document;"
      onchange=${r=>{let i=new FileReader,n=r.target.files[0];if(!n)return;let s=e.utils.html.node`<div class="item"><div class="xyz-icon loader">`;a.documents.appendChild(s),i.onload=o=>{let c=new XMLHttpRequest;c.open("POST",e.host+"/api/provider/cloudinary?"+e.utils.paramString({resource_type:"raw",public_id:n.name})),c.setRequestHeader("Content-Type","application/octet-stream"),c.responseType="json",c.onload=f=>{if(f.target.status>202)return console.log("document_upload failed");let p=f.target.response.secure_url,u=f.target.response.public_id.replace(/.*\//,"").replace(/\.([\w-]{3})/,""),h=new XMLHttpRequest;h.open("GET",e.host+"/api/query?"+e.utils.paramString({template:"set_field_array",locale:e.locale.key,layer:a.location.layer.key,table:a.location.table,action:"append",field:a.field,secure_url:p,id:a.location.id})),h.setRequestHeader("Content-Type","application/json"),h.responseType="json",h.onload=w=>{w.target.status>202||e.utils.render(s,e.utils.html`
              <div class="item">
              ${a.edit&&e.utils.html.node`
              <button
                class="xyz-icon icon-trash link-remove"
                data-name=${u}
                data-href=${p}
                onclick=${D=>t(D)}>
              </button>`}
              <a href=${p} target="_blank">${u}`)},h.send()},c.send(o.target.result)},i.readAsDataURL(n),r.target.value=""}}>`);function t(r){if(!confirm("Remove document link?"))return;let i=r.target,n=new XMLHttpRequest;n.open("GET",e.host+"/api/provider/cloudinary?"+e.utils.paramString({destroy:!0,public_id:i.dataset.name})),n.onload=s=>{if(s.target.status>202)return;let o=new XMLHttpRequest;o.open("GET",e.host+"/api/query?"+e.utils.paramString({template:"set_field_array",locale:e.locale.key,layer:a.location.layer.key,table:a.location.table,action:"remove",field:a.field,secure_url:i.dataset.href,id:a.location.id})),o.setRequestHeader("Content-Type","application/json"),o.responseType="json",o.onload=c=>{c.target.status>202||i.parentNode.remove()},o.send()},n.send()}};var Il=e=>a=>{if(!a.report.template)return;let t=`${e.host}/view?${e.utils.paramString(Object.assign(a.report,{locale:e.locale.key,layer:a.location.layer.key,table:a.location.table,id:a.location.id,host:e.host}))}`;a.listview.appendChild(e.utils.html.node`
    <div
      class="${`label ${a.class}`}">
      <a
        class="primary-colour"
        target="_blank"
        href="${t}">
          ${a.report.title||a.report.name||"Location Report"}`)};var xl=e=>a=>{a.listview.appendChild(e.utils.html.node`
    <div style="padding-top: 5px; grid-column: 1 / 3">
      <label class="input-checkbox">
        <input type="checkbox"
          .disabled=${!a.edit}
          .checked=${!!a.value}
          onchange=${t=>{a.location.view.dispatchEvent(new CustomEvent("valChange",{detail:{input:t.target,entry:a,newValue:!!t.target.checked}}))}}>
        </input>
        <div></div><span>${a.title||a.name||a.field}`)};var Rl=e=>{return{create:t,settings:a};function a(o){o.edit.defaults===void 0&&(o.edit.defaults=Object.assign({},o.edit.isoline_here)),!(o.edit.isoline_here&&!o.edit.isoline_here.geometry&&(o.edit.isoline_here.minutes||o.value))&&(o.edit.isoline_here&&o.edit.isoline_here.geometry&&o.edit.isoline_here.minutes&&!o.value||(r(o),o.container&&o.container.parentNode.insertBefore(o.edit.panel,o.container.nextSibling)))}function t(o){o.edit.defaults===void 0&&(o.edit.defaults=Object.assign({},o.edit.isoline_here));let c=(o.edit.isoline_here.minutes||o.edit.isoline_here.range)*60,f=ol.proj.toLonLat(o.location.geometry.coordinates,`EPSG:${o.location.layer.srid}`),p=o.edit.isoline_here.destination||o.edit.defaults.destination,u=o.edit.isoline_here.dateISO?new Date(o.edit.isoline_here.dateISO).toISOString():o.edit.defaults.dateISO?new Date(o.edit.defaults.dateISO).toISOString():null,h={transportMode:o.edit.isoline_here.transportMode||"car",[p?"destination":"origin"]:`${f[1]},${f[0]}`,"range[values]":c||10*60,"range[type]":o.edit.isoline_here.rangetype||"time",optimizeFor:o.edit.isoline_here.optimizeFor||"balanced"};u&&Object.assign(h,{[p?"arrivalTime":"departureTime"]:u}),e.proxy(`https://isoline.router.hereapi.com/v8/isolines?${e.utils.paramString(h)}${o.edit.isoline_here.maxPoints?`&shape[${o.edit.isoline_here.maxPoints}]`:""}&{HERE}`).then(w=>{if(!w.isolines)return console.log(w),alert(e.language.here_error);if(w.isolines[0].polygons.length){let D=e.utils.isoline_here_decode(w.isolines[0].polygons[0].outer);if(D.polyline.map(Z=>Z.reverse()),D.polyline.push(D.polyline[0]),o.newValue={type:"Polygon",coordinates:[D.polyline]},o.edit.meta){let Z=new Date;o.location.infoj.filter(U=>U.type==="json"&&U.field===o.edit.meta).forEach(U=>U.newValue=Object.assign({provider:"Here"},h))}o.edit.panel&&(o.edit.panel.remove(),o.edit.panel=null,r(o)),o.location.update(),o.edit.defaults.dateISO||(o.edit.isoline_here.dateISO=null),o.edit.defaults.destination||(o.edit.isoline_here.destination=null)}else{o.location.view&&o.location.view.classList.remove("disabled");return}o.location.view&&o.location.view.classList.add("disabled")})}function r(o){o.edit.panel||o.edit.isoline_here.minutes||(o.edit.panel=e.utils.html.node`
        <div
        class="${`drawer group panel expandable ${o.class||""}`}"
        style="display: grid; grid-column: 1 / 3; border-bottom: solid 1px grey;">
        <div
        class="header primary-colour"
        style="text-align: left; grid-column: 1 / 3;"
        onclick=${c=>{e.utils.toggleExpanderParent(c.target)}}
        ><span>${e.language.here_isoline_settings}</span>
        <span class="xyz-icon btn-header icon-expander primary-colour-filter">`,i(o))}function i(o){let c=e.utils.html.node`<span>${e.language.here_depart}`;o.edit.panel.appendChild(e.utils.html.node`
            <div style="padding-top: 5px; grid-column: 1 / 3;">
            <label class="input-checkbox">
            <input type="checkbox" "checked"=false
            onchange=${w=>{c.textContent=w.target.checked?`${e.language.here_arrive}`:`${e.language.here_depart}`,o.edit.isoline_here.destination=w.target.checked}}></input><div></div><span>${e.language.here_use_as_destination}`);let f=[{[e.language.here_driving]:"car"},{[e.language.here_walking]:"pedestrian"}];o.edit.defaults.transportMode===void 0&&o.edit.panel.appendChild(n({title:e.language.here_transport_mode,options:f,callback:(w,D)=>{o.edit.isoline_here.transportMode=D}}));let p=[{[e.language.here_time]:"time"}],u=[{[e.language.here_routing_type_fastest]:"fast"},{[e.language.here_routing_type_shortest]:"short"}];o.edit.defaults.routingType===void 0&&o.edit.panel.appendChild(n({title:e.language.here_routing_type,options:u,callback:(w,D)=>{o.edit.isoline_here.routingType=D}}));let h=[{[e.language.here_optimize_for_balanced]:"balanced"},{[e.language.here_optimize_for_quality]:"quality"},{[e.language.here_optimize_for_performance]:"performance"}];if(o.edit.defaults.optimizeFor===void 0&&o.edit.panel.appendChild(n({title:e.language.here_optimize_for,options:h,callback:(w,D)=>{o.edit.isoline_here.optimizeFor=D}})),o.edit.defaults.departureTime===void 0&&o.edit.defaults.arrivalTime===void 0){let w=e.utils.html.node`<input type="text" placeholder=${e.language.layer_filter_pick} style="text-align: end;">`;o.edit.panel.appendChild(e.utils.html.node`
                <div style="margin-top: 12px; grid-column: 1 / 3; margin-bottom: 8px;">
                <div style="display: grid; grid-template-columns: 100px 1fr; align-items: center;">
                <div style="grid-column: 1;">${c}</div>
                <div style="grid-column: 2;">${w}</div>`),e.utils.flatpickr({locale:e.hooks.current.language||null,element:w,enableTime:!0,callback:D=>{!D||(w.value=D,o.edit.isoline_here.dateISO=new Date(D).toISOString())}})}o.edit.defaults.range===void 0&&o.edit.panel.appendChild(s({title:e.language.here_travel_time,max:o.edit.isoline_here.maxMinutes,range:10,callback:w=>{o.edit.isoline_here.range=parseInt(w.target.value)}}))}function n(o){return e.utils.html.node`<div style="margin-top: 8px; grid-column: 1 / 3; align-items: center;">
            <div style="display: grid; grid-template-columns: 100px 1fr; align-items: center;">
            <div style="grid-column: 1;">${o.title}</div>
            <div style="grid-column: 2;">
            <button class="btn-drop">
            <div
                class="head"
                onclick=${c=>{c.preventDefault(),c.target.parentElement.classList.toggle("active")}}>
                <span>${Object.keys(o.options[0])}</span>
                <div class="icon"></div>
            </div>
            <ul>
                ${o.options.map(c=>e.utils.html.node`
                <li onclick=${f=>{let p=f.target.closest(".btn-drop");p.classList.toggle("active"),p.querySelector(":first-child").textContent=Object.keys(c)[0],o.callback&&o.callback(f,Object.values(c)[0])}}>${Object.keys(c)[0]}`)}`}function s(o){return e.utils.html.node`
        <div style="margin-top: 12px; grid-column: 1 / 3;">
        <span>${o.title}</span>
        <span class="bold">${o.range}</span>
        <div class="input-range">
        <input
          class="secondary-colour-bg"
          type="range"
          min=5
          value=${o.range}
          max=${o.max||30}
          step=1
          oninput=${c=>{c.target.parentNode.previousElementSibling.textContent=parseInt(c.target.value),o.callback&&o.callback(c)}}>`}};var Hl=e=>{return{create:t,settings:a};function a(s){if(s.edit.isoline_mapbox&&!s.edit.isoline_mapbox.geometry&&(s.edit.isoline_mapbox.minutes||!s.edit.isoline_mapbox.minutes&&s.value)||s.edit.isoline_mapbox&&s.edit.isoline_mapbox.geometry&&s.edit.isoline_mapbox.minutes&&!s.value)return;if(i(s),s.edit.isoline_mapbox&&s.edit.isoline_mapbox.geometry&&(s.edit.isoline_mapbox.minutes||!s.edit.isoline_mapbox.minutes&&s.value))return r(s),s.edit.panel;s.edit.isoline_mapbox.profile=s.edit.isoline_mapbox.profile||"driving",s.edit.isoline_mapbox._minutes=s.edit.isoline_mapbox.minutes||10;let o=[{[e.language.mapbox_driving]:"driving"},{[e.language.mapbox_walking]:"walking"},{[e.language.mapbox_cycling]:"cycling"}];s.edit.isoline_mapbox.profile="driving",s.edit.panel.appendChild(e.utils.html.node`
    <div
      style="margin-top: 8px; grid-column: 1 / 3; align-items: center;">
        <span style="grid-column: 1;">${e.language.mapbox_mode}</span>
        <div style="grid-column: 2;">
        <button class="btn-drop">
            <div
                class="head"
                onclick=${c=>{c.preventDefault(),c.target.parentElement.classList.toggle("active")}}>
                <span>${e.language.mapbox_driving}</span>
                <div class="icon"></div>
            </div>
            <ul>
                ${o.map(c=>e.utils.html.node`
                <li onclick=${f=>{let p=f.target.closest(".btn-drop");p.classList.toggle("active"),p.querySelector(":first-child").textContent=Object.keys(c)[0],s.edit.isoline_mapbox.profile=Object.values(c)[0]}}>${Object.keys(c)[0]}`)}`),s.edit.panel.appendChild(e.utils.html.node`
    <div style="margin-top: 12px; grid-column: 1 / 3;">
      <span>${e.language.mapbox_travel_time} </span>
      <span class="bold">${s.edit.isoline_mapbox._minutes}</span>
      <div class="input-range">
      <input
        class="secondary-colour-bg"
        type="range"
        min=5
        value=${s.edit.isoline_mapbox._minutes}
        max=${s.edit.isoline_mapbox.maxMinutes||30}
        step=1
        oninput=${c=>{s.edit.isoline_mapbox._minutes=parseInt(c.target.value),c.target.parentNode.previousElementSibling.textContent=s.edit.isoline_mapbox._minutes}}>`),s.container&&s.container.parentNode.insertBefore(s.edit.panel,s.container.nextSibling)}function t(s){let o=ol.proj.toLonLat(s.location.geometry.coordinates,`EPSG:${s.location.layer.srid}`),c=new XMLHttpRequest;c.open("GET",`https://api.mapbox.com/isochrone/v1/mapbox/${s.edit.isoline_mapbox.profile||"driving"}/${o.join(",")}?`+e.utils.paramString({contours_minutes:s.edit.isoline_mapbox._minutes||s.edit.isoline_mapbox.minutes,generalize:s.edit.isoline_mapbox._minutes||s.edit.isoline_mapbox.minutes,polygons:!0,access_token:s.edit.isoline_mapbox.access_token})),c.setRequestHeader("Content-Type","application/json"),c.responseType="json",c.onload=f=>{if(f.target.status!==200||!f.target.response.features)return s.location.view&&s.location.view.classList.remove("disabled"),console.log(f.target.response),alert(e.language.mapbox_error);if(s.newValue=f.target.response.features[0].geometry,s.edit.isoline_mapbox.meta){let p=new Date;s.location.infoj.filter(u=>u.type==="meta"&&u.field===s.edit.isoline_mapbox.meta).forEach(u=>u.newValue={provider:"Mapbox",[e.language.mapbox_mode]:s.edit.isoline_mapbox.profile,[e.language.mapbox_minutes]:s.edit.isoline_mapbox._minutes,[e.language.mapbox_created]:`${p.getFullYear()}/${p.getMonth()+1}/${p.getDate()} ${p.getHours()}:${p.getMinutes()>8?p.getMinutes()+1:`0${p.getMinutes()+1}`}`})}s.edit.panel&&(s.edit.panel.remove(),s.edit.panel=null,i(s)),s.location.update()},c.send(),s.location.view&&s.location.view.classList.add("disabled")}function r(s){i(s),!s.edit.edit&&(s.edit.edit=e.utils.html.node`
      <div style="
      margin-top: 8px;
      grid-column: 1 / 3;
      display: grid;
      grid-template-columns: 50px 1fr;
      align-items: center;
      ">
      <div style="grid-column: 1 / span 3;">
      <button class="btn-wide primary-colour" style="font-size: x-small;"
      onclick=${o=>{o.stopPropagation();let c=o.target;if(c.classList.contains("active"))return c.classList.remove("active"),e.mapview.interaction.edit.finish(),e.map.removeLayer(s.edit.feature);c.classList.add("active"),s.edit.feature=e.mapview.geoJSON({geometry:typeof s.value=="object"?s.value:JSON.parse(s.value),dataProjection:"4326"}),e.mapview.interaction.edit.begin({location:s.location,type:"Polygon",source:new ol.source.Vector({features:[s.edit.feature.getSource().getFeatures()[0].clone()]}),callback:()=>{c.classList.remove("active"),e.map.removeLayer(s.edit.feature)},update:()=>n(s)})}}>${e.language.layer_draw_edit}`,s.edit.panel.appendChild(s.edit.edit))}function i(s){s.edit.panel||(s.edit.panel=e.utils.html.node`
    <div
      class="${`drawer group panel expandable ${s.class||""}`}"
      style="display: grid; grid-column: 1 / 3;">
      <div
        class="header primary-colour"
        style="text-align: left; grid-column: 1 / 3;"
          onclick=${o=>{e.utils.toggleExpanderParent(o.target)}}
          ><span>${e.language.mapbox_isoline_settings}</span>
          <span class="xyz-icon btn-header icon-expander primary-colour-filter">`)}function n(s){let o=e.mapview.interaction.edit.Source.getFeatures(),c=new ol.format.GeoJSON;s.newValue=JSON.parse(c.writeFeature(o[0],{dataProjection:"EPSG:"+s.location.layer.srid,featureProjection:"EPSG:"+e.mapview.srid})).geometry,s.location.update(),e.map.removeLayer(s.edit.feature),e.mapview.interaction.edit.finish()}};var Nl=e=>{return{create:r,settings:a};function a(c){c.edit.defaults=Object.assign({},c.edit.isoline_tomtom),!(c.edit.isoline_tomtom&&!c.edit.isoline_tomtom.geometry&&(c.edit.isoline_tomtom.timeBudgetInSec||!c.edit.isoline_tomtom.timeBudgetInSec&&c.value))&&(c.edit.isoline_tomtom&&c.edit.isoline_tomtom.geometry&&c.edit.isoline_tomtom.timeBudgetInSec&&!c.value||(i(c),c.edit.isoline_tomtom&&c.edit.isoline_tomtom.geometry&&(c.edit.isoline_tomtom.timeBudgetInSec||!c.edit.isoline_tomtom.timeBudgetInSec&&c.value)&&n(c),c.container&&c.container.parentNode.insertBefore(c.edit.panel,c.container.nextSibling)))}function t(c){if(c.edit.defaults.departAt===void 0){let u=e.utils.html.node`<input type="text" placeholder=${e.language.layer_filter_pick} style="text-align: end;">`;c.edit.panel.appendChild(e.utils.html.node`
				<div style="margin-top: 12px; grid-column: 1 / 3;">
				<div style="display: grid; grid-template-columns: 100px 1fr; align-items: center;">
				<div style="grid-column: 1;"><span>Depart at </span></div>
				<div style="grid-column: 2;">${u}</div>`),e.utils.flatpickr({element:u,enableTime:!0,callback:h=>{u.value=h,c.edit.isoline_tomtom.departAt=new Date(h).toISOString()}})}c.edit.defaults.timeBudgetInSec===void 0&&c.edit.panel.appendChild(e.utils.html.node`
        	<div style="margin-top: 12px; grid-column: 1 / 3;">
        	<span>Time budget in minutes: </span>
        	<span class="bold">${c.edit.isoline_tomtom.timeBudgetInSec||10}</span>
        	<div class="input-range">
        	<input class="secondary-colour-bg"
        	type="range"
            min=5
            value=10
            max=${c.edit.isoline_tomtom.maxMinutes||30}
            step=1
            oninput=${u=>{c.edit.isoline_tomtom.timeBudgetInSec=60*parseInt(u.target.value),u.target.parentNode.previousElementSibling.textContent=u.target.value}}>`);let f=[{car:"car"},{truck:"truck"},{taxi:"taxi"},{bus:"bus"},{van:"van"},{motorcycle:"motorcycle"},{bicycle:"bicycle"},{pedestrian:"pedestrian"}],p=[{fastest:"fastest"},{shortest:"shortest"},{eco:"eco"},{thrilling:"thrilling"}];c.edit.defaults.traffic===void 0&&c.edit.panel.appendChild(e.utils.html.node`
        <div style="padding-top: 5px; grid-column: 1 / 3">
        <label class="input-checkbox">
        <input type="checkbox"
          .checked=${!!c.edit.isoline_tomtom.traffic}
          onchange=${u=>{c.edit.isoline_tomtom.traffic=u.target.checked}}>
        </input>
        <div></div><span>Include current traffic`),c.edit.defaults.travelMode===void 0&&c.edit.panel.appendChild(o({title:"Travel mode",options:f,callback:u=>{c.edit.isoline_tomtom.travelMode=u.target.value}})),c.edit.defaults.routeType===void 0&&c.edit.panel.appendChild(o({title:"Route type",options:p,callback:u=>{c.edit.isoline_tomtom.routeType=u.target.value}})),c.edit.defaults.vehicleMaxSpeed===void 0&&c.edit.panel.appendChild(e.utils.html.node`
        <div style="padding-top: 5px; grid-column: 1 / 3">
        <div style="display: grid; grid-template-columns: 150px 1fr; align-items: center;">
        <div style="grid-column: 1;"><span>Max Vehicle Speed </span></div>
        <div style="grid-column: 2;"><input type="number" value="${c.value||c.displayValue||""}"
        placeholder="km/h"
        onkeyup=${u=>{c.edit.isoline_tomtom.vehicleMaxSpeed=parseInt(u.target.value)}}>`)}function r(c){c.edit.isoline_tomtom.timeBudgetInSec||(c.edit.isoline_tomtom.timeBudgetInSec=60*10),c.edit.isoline_tomtom.routeType||(c.edit.isoline_tomtom.routeType="fastest"),c.edit.isoline_tomtom.travelMode||(c.edit.isoline_tomtom.travelMode="car");let f=ol.proj.toLonLat(c.location.geometry.coordinates,`EPSG:${c.location.layer.srid}`);e.proxy(`https://api.tomtom.com/routing/1/calculateReachableRange/${f[1]},${f[0]}/json?${e.utils.paramString(c.edit.isoline_tomtom)}&key={TOMTOM}`).then(p=>{if(!p.reachableRange)return console.log(p),alert("Wrong");if(c.newValue={type:"Polygon",coordinates:[p.reachableRange.boundary.map(u=>[u.longitude,u.latitude])]},c.edit.meta){let u=new Date;c.location.infoj.filter(h=>h.type==="json"&&h.field===c.edit.meta).forEach(h=>h.newValue=Object.assign({"Recent range":"TomTom",Created:`${u.getFullYear()}/${u.getMonth()+1}/${u.getDate()} ${u.getHours()}:${u.getMinutes()>8?u.getMinutes()+1:`0${u.getMinutes()+1}`}`},c.edit.isoline_tomtom))}c.edit.panel&&(c.edit.panel.remove(),c.edit.panel=null,c.edit.isoline_tomtom=Object.assign({},c.edit.defaults),i(c)),c.location.update()}),c.location.view&&c.location.view.classList.add("disabled")}function i(c){c.edit.panel||(c.edit.panel=e.utils.html.node`
		<div
		class="${`drawer group panel expandable ${c.class||""}`}"
		style="display: grid; grid-column: 1 / 3;">
		<div
		class="header primary-colour"
		style="text-align: left; grid-column: 1 / 3;"
        onclick=${f=>{e.utils.toggleExpanderParent(f.target)}}
        ><span>TomTom Settings</span>
        <span class="xyz-icon btn-header icon-expander primary-colour-filter">`,t(c))}function n(c){i(c),!c.edit.edit&&(c.edit.edit=e.utils.html.node`
    	<div style="
    	margin-top: 8px;
        grid-column: 1 / 3;
        display: grid;
        grid-template-columns: 50px 1fr;
        align-items: center;
        ">
        <div style="grid-column: 1 / span 3;">
        <button class="btn-wide primary-colour" style="font-size: x-small;"
        onclick=${f=>{f.stopPropagation();let p=f.target;if(p.classList.contains("active"))return p.classList.remove("active"),e.mapview.interaction.edit.finish(),e.map.removeLayer(c.edit.feature);p.classList.add("active"),c.edit.feature=e.mapview.geoJSON({geometry:typeof c.value=="object"?c.value:JSON.parse(c.value),dataProjection:"4326"}),e.mapview.interaction.edit.begin({location:c.location,type:"Polygon",source:new ol.source.Vector({features:[c.edit.feature.getSource().getFeatures()[0].clone()]}),callback:()=>{p.classList.remove("active"),e.map.removeLayer(c.edit.feature)},update:()=>s(c)})}}>Edit`,c.edit.panel.appendChild(c.edit.edit))}function s(c){let f=e.mapview.interaction.edit.Source.getFeatures(),p=new ol.format.GeoJSON;c.newValue=JSON.parse(p.writeFeature(f[0],{dataProjection:"EPSG:"+c.location.layer.srid,featureProjection:"EPSG:"+e.mapview.srid})).geometry,c.location.update(),e.map.removeLayer(c.edit.feature),e.mapview.interaction.edit.finish()}function o(c){return e.utils.html.node`<div style="margin-top: 8px; grid-column: 1 / 3; align-items: center;">
            <div style="display: grid; grid-template-columns: 100px 1fr; align-items: center;">
          	<div style="grid-column: 1;">${c.title}</div>
          	<div style="grid-column: 2;">
          	<button class="btn-drop">
          	<div
                class="head"
                onclick=${f=>{f.preventDefault(),f.target.parentElement.classList.toggle("active")}}>
                <span>${Object.keys(c.options[0])}</span>
                <div class="icon"></div>
            </div>
            <ul>
                ${c.options.map(f=>e.utils.html.node`
                <li onclick=${p=>{let u=p.target.closest(".btn-drop");u.classList.toggle("active"),u.querySelector(":first-child").textContent=Object.keys(f)[0],c.callback&&c.callback(p)}}>${Object.keys(f)[0]}`)}`}};var Bl=e=>a=>{!a.value.features||(a.value.features.map(t=>{let r;if(a.style||(r=a.location.style),a.style.theme||(r=a.style),a.style.theme&&a.style.theme.type==="categorized"&&(r=a.style.theme&&a.style.theme.cat[t.properties[a.style.theme.field]].style),a.style.theme&&a.style.theme.type==="graduated")for(let n=0;n<a.style.theme.cat_arr.length&&!(t.properties[a.style.theme.field]<a.style.theme.cat_arr[n].value);n++)r=a.style.theme.cat_arr[n].style;let i=e.mapview.geoJSON({geometry:t.geometry,dataProjection:"4326",zIndex:a.location.layer.L.getZIndex()-1,style:new ol.style.Style({stroke:r.strokeColor&&new ol.style.Stroke({color:e.utils.Chroma(r.color||r.strokeColor).alpha(1),width:a.style.strokeWidth||1}),fill:new ol.style.Fill({color:e.utils.Chroma(r.fillColor||r.strokeColor).alpha(r.fillOpacity===void 0?1:parseFloat(r.fillOpacity)||0).rgba()})})});a.location.geometryCollection.push(i)}),a.location.geometries.push(a.location.geometryCollection),a.display=!0,!(!a.style||!a.style.theme)&&(!a.style.theme.legend||(a.legend=e.utils.html.node`
      <div class="${`${a.class} legend`}">`,Object.entries(a.style.theme.cat).forEach(t=>{a.legend.appendChild(e.utils.svg.node`
        <svg height=20 width=20>
          <rect
            width=20 height=20
            fill=${t[1].style.fillColor||"#FFF"}
            fill-opacity=${t[1].style.fillOpacity}
            stroke=${t[1].style.strokeColor}
            stroke-width=${t[1].style.strokeWidth||1}>`),a.legend.appendChild(e.utils.html.node`
        <div
          class="label switch">${t[1].label||t[0]}`)}),a.container.style.display="block",a.container.appendChild(a.legend))))};var Gl=e=>{return{polygon:t,circle:r,rectangle:i,freehand:n,line:s,edit:o};function a(p){if(!p.edit.panel)return p.edit.panel=e.utils.html.node`
		<div
		class="drawer group panel expandable ${p.class||""}"
		style="display: grid; grid-column: 1 / 3;">
		<div
		class="header primary-colour"
        style="text-align: left; grid-column: 1 / 3;"
        onclick=${u=>{e.utils.toggleExpanderParent(u.target)}}
        ><span>${p.name?`${e.language.layer_draw_edit} ${p.name}`:e.language.layer_draw_edit}</span>
        <span class="xyz-icon btn-header icon-expander primary-colour-filter">`,p.edit.group={},p.value?o(p):p.edit.panel}function t(p){return p.value?o(p):(a(p),p.edit.group.edit&&(p.edit.group.edit.remove(),p.edit.group.edit=null),p.edit.group.polygon=e.utils.html.node`
    		<div style="
          margin-top: 8px;
          grid-column: 1 / 3;
          display: grid;
          grid-template-columns: 50px 1fr;
          align-items: center;">
    		<div style="grid-column: 1 / span 3;">
    		<button class="btn-wide primary-colour" style="font-size: x-small;"
    		onclick=${u=>{u.stopPropagation();let h=u.target;if(h.classList.contains("active"))return e.mapview.interaction.draw.cancel();h.classList.add("active"),e.mapview.interaction.draw.begin({layer:p.location.layer,type:"Polygon",callback:()=>{h.classList.remove("active"),Object.values(p.edit.group).map(w=>{!w||(w.remove(),w=null)})},update:()=>c(p)})}}>${e.language.layer_draw_polygon}`,p.edit.panel.appendChild(p.edit.group.polygon),p.edit.panel)}function r(p){return p.value?e.utils.html.node`<div>`:(a(p),p.edit.group.edit&&(p.edit.group.edit.remove(),p.edit.group.edit=null),p.edit.group.circle=e.utils.html.node`
    	<div style="
        margin-top: 8px;
        grid-column: 1 / 3;
        display: grid;
        grid-template-columns: 50px 1fr;
        align-items: center;">
    	<div style="grid-column: 1 / span 3;">
    	<button class="btn-wide primary-colour" style="font-size: x-small;"
    	onclick=${u=>{u.stopPropagation();let h=u.target;if(h.classList.contains("active"))return e.mapview.interaction.draw.cancel();h.classList.add("active"),e.mapview.interaction.draw.begin({layer:p.location.layer,type:"Circle",geometryFunction:ol.interaction.Draw.createRegularPolygon(33),callback:()=>{h.classList.remove("active"),Object.values(p.edit.group).map(w=>{!w||(w.remove(),w=null)})},update:()=>c(p)})}}>${e.language.layer_draw_circle}`,p.edit.panel.appendChild(p.edit.group.circle),p.edit.panel)}function i(p){return p.value?o(p):(a(p),p.edit.group.edit&&(p.edit.group.edit.remove(),p.edit.group.edit=null),p.edit.group.rectangle=e.utils.html.node`
    	<div style="
        margin-top: 8px;
        grid-column: 1 / 3;
        display: grid;
        grid-template-columns: 50px 1fr;
        align-items: center;">
    	<div style="grid-column: 1 / span 3;">
    	<button class="btn-wide primary-colour" style="font-size: x-small;"
    	onclick=${u=>{u.stopPropagation();let h=u.target;if(h.classList.contains("active"))return e.mapview.interaction.draw.cancel();h.classList.add("active"),e.mapview.interaction.draw.begin({layer:p.location.layer,type:"Circle",geometryFunction:ol.interaction.Draw.createBox(),callback:()=>{h.classList.remove("active"),Object.values(p.edit.group).map(w=>{!w||(w.remove(),w=null)})},update:()=>c(p)})}}>${e.language.layer_draw_rectangle}`,p.edit.panel.appendChild(p.edit.group.rectangle),p.edit.panel)}function n(p){return p.value?e.utils.html.node`<div>`:(a(p),p.edit.group.edit&&(p.edit.group.edit.remove(),p.edit.group.edit=null),p.edit.group.freehand=e.utils.html.node`
    	<div style="
        margin-top: 8px;
        grid-column: 1 / 3;
        display: grid;
        grid-template-columns: 50px 1fr;
        align-items: center;">
    	<div style="grid-column: 1 / span 3;">
    	<button class="btn-wide primary-colour" style="font-size: x-small;"
    	onclick=${u=>{u.stopPropagation();let h=u.target;if(h.classList.contains("active"))return e.mapview.interaction.draw.cancel();h.classList.add("active"),e.mapview.interaction.draw.begin({layer:p.location.layer,type:"LineString",freehand:!0,callback:()=>{h.classList.remove("active"),Object.values(p.edit.group).map(w=>{!w||(w.remove(),w=null)})},update:()=>c(p)})}}>${e.language.layer_draw_freehand}`,p.edit.panel.appendChild(p.edit.group.freehand),p.edit.panel)}function s(p){return p.value?o(p):(a(p),p.edit.group.edit&&(p.edit.group.edit.remove(),p.edit.group.edit=null),p.edit.group.line=e.utils.html.node`
    	<div style="
        margin-top: 8px;
        grid-column: 1 / 3;
        display: grid;
        grid-template-columns: 50px 1fr;
        align-items: center;">
    	<div style="grid-column: 1 / span 3;">
    	<button class="btn-wide primary-colour" style="font-size: x-small;"
    	onclick=${u=>{u.stopPropagation();let h=u.target;if(h.classList.contains("active"))return e.mapview.interaction.draw.cancel();h.classList.add("active"),e.mapview.interaction.draw.begin({layer:p.location.layer,type:"LineString",callback:()=>{h.classList.remove("active"),Object.values(p.edit.group).map(w=>{!w||(w.remove(),w=null)})},update:()=>c(p)})}}>${e.language.layer_draw_line}`,p.edit.panel.appendChild(p.edit.group.line),p.edit.panel)}function o(p){return a(p),p.edit.group.edit||(p.edit.group.edit=e.utils.html.node`
    	    <div style="
            margin-top: 8px;
            grid-column: 1 / 3;
            display: grid;
            grid-template-columns: 50px 1fr;
            align-items: center;">
    	    <div style="grid-column: 1 / span 3;">
    	    <button class="btn-wide primary-colour" style="font-size: x-small;"
    	    onclick=${u=>{u.stopPropagation();let h=u.target;if(h.classList.contains("active"))return h.classList.remove("active"),e.mapview.interaction.edit.finish(),e.map.removeLayer(p.edit.feature);h.classList.add("active"),p.edit.feature=e.mapview.geoJSON({geometry:typeof p.value=="object"?p.value:JSON.parse(p.value),dataProjection:"4326"}),e.mapview.interaction.edit.begin({location:p.location,type:typeof p.value=="object"?p.value.type:JSON.parse(p.value).type,source:new ol.source.Vector({features:[p.edit.feature.getSource().getFeatures()[0].clone()]}),callback:()=>{h.classList.remove("active"),e.map.removeLayer(p.edit.feature)},update:()=>f(p)})}}>${e.language.layer_draw_edit}`,p.edit.panel.appendChild(p.edit.group.edit)),p.edit.panel}function c(p){let u=e.mapview.interaction.draw.Layer.getSource().getFeatures();p.newValue=JSON.parse(e.mapview.interaction.draw.format.writeFeature(u[0],{dataProjection:"EPSG:"+e.mapview.interaction.draw.layer.srid,featureProjection:"EPSG:"+e.mapview.srid})).geometry,p.location.update(),e.mapview.interaction.draw.finish()}function f(p){let u=e.mapview.interaction.edit.Source.getFeatures(),h=new ol.format.GeoJSON;p.newValue=JSON.parse(h.writeFeature(u[0],{dataProjection:"EPSG:"+p.location.layer.srid,featureProjection:"EPSG:"+e.mapview.srid})).geometry,p.location.update(),e.map.removeLayer(p.edit.feature),e.mapview.interaction.edit.finish()}};var ql=e=>{let a=Gl(e),t=Rl(e),r=Hl(e),i=Nl(e),n=Bl(e);return s;function s(u){if(u.query&&u.display)return e.query(Object.assign({layer:u.location.layer,id:u.location.id},u)).then(h=>{!h||(u.value=h[u.field],!!u.value&&(o(u),c(u)))});if(o(u),u.edit&&u.edit.isoline_mapbox&&r.settings(u),u.edit&&u.edit.isoline_here&&t.settings(u),u.edit&&u.edit.isoline_tomtom&&i.settings(u),u.edit&&u.edit.polygon&&u.container.parentNode.appendChild(a.polygon(u)),u.edit&&u.edit.rectangle&&u.container.parentNode.appendChild(a.rectangle(u)),u.edit&&u.edit.circle&&u.container.parentNode.appendChild(a.circle(u)),u.edit&&u.edit.line&&u.container.parentNode.appendChild(a.line(u)),u.edit&&u.edit.freehand&&u.container.parentNode.appendChild(a.freehand(u)),u.value&&(u.display||u.edit))return c(u);!u.value&&u.display&&p(u)}function o(u){u.style=Object.assign({},u.location?.style,u.style),u.container=u.listview.appendChild(e.utils.html.node`
      <div class="${`${u.type} ${u.class}`}">`),u.container.appendChild(e.utils.html.node`
      <label class="input-checkbox">
        <input type="checkbox"
          .checked=${u.edit&&u.value||!!u.display}
          onchange=${h=>{if(u.display=h.target.checked,u.display&&u.query)return e.query(Object.assign({layer:u.location.layer,id:u.location.id},u)).then(w=>{if(u.value=typeof w[u.field]=="string"?JSON.parse(w[u.field]):w[u.field],!u.value){alert(e.language.location_no_geometry),h.target.checked=!1;return}c(u)});if(u.display&&u.edit)return p(u,h);if(u.display&&!u.edit)return c(u);if(!u.display&&u.edit){if(u.value&&!u.edit.skipConfirm&&!confirm(e.language.location_geometry_delete_msg))return h.target.checked=!0;u.newValue=null,u.edit.edit&&(u.edit.edit.remove(),u.edit.edit=null),u.edit&&u.edit.meta&&u.location.infoj.filter(w=>w.type==="json"&&w.field===u.edit.meta).forEach(w=>w.newValue=null),u.location.update();return}if(!u.display&&!u.edit)return f(u)}}>
          </input>
          <div></div>
          <span>${u.name||"Geometry"}<span>`),!u.style.theme&&u.container.appendChild(e.utils.html.node`
      <div
        class="sample-circle"
        style="${`
          background-color: ${e.utils.Chroma(u.style.fillColor||u.style.strokeColor).alpha(u.style.fillOpacity===void 0?1:parseFloat(u.style.fillOpacity)||0)};
          border-color: ${e.utils.Chroma(u.style.color||u.style.strokeColor).alpha(1)};
          border-style: solid;
          border-width: ${u.style.strokeWidth||1}px;
          margin-left: auto;`}">`)}function c(u){u.value&&u.value.type==="FeatureCollection"?n(u):(u.geometry=u.value&&e.mapview.geoJSON({geometry:typeof u.value=="object"&&u.value||JSON.parse(u.value),dataProjection:"4326",zIndex:u.style.zIndex||u.location?.layer.L.getZIndex()-1,style:new ol.style.Style({stroke:u.style.strokeColor&&new ol.style.Stroke({color:e.utils.Chroma(u.style.color||u.style.strokeColor).alpha(1),width:u.style.strokeWidth||1,lineDash:u.style.lineDash}),fill:new ol.style.Fill({color:e.utils.Chroma(u.style.fillColor||u.style.strokeColor).alpha(u.style.fillOpacity===void 0?1:parseFloat(u.style.fillOpacity)||0).rgba()})})}),u.geometry&&u.location.geometries.push(u.geometry),u.display=!0)}function f(u){u.display=!1,u.legend&&u.legend.remove(),u.value.type==="FeatureCollection"?u.location.geometries.splice(u.location.geometries.indexOf(u.geometryCollection),1)&&u.location.geometryCollection.map(h=>e.map.removeLayer(h)):u.geometry&&u.location.geometries.splice(u.location.geometries.indexOf(u.geometry),1)&&e.map.removeLayer(u.geometry)}function p(u,h){if(!!u.edit){if(u.edit.isoline_mapbox)return r.create(u);if(u.edit.isoline_here)return t.create(u);if(u.edit.isoline_tomtom)return i.create(u);if(h)return h.target.checked=!1,u.display=h.target.checked,alert("This geometry doesn't exist. Create it first.")}}};var Vl=e=>a=>{a.val.appendChild(e.utils.html.node`
  <div>
  <span>${a.edit.range.label}</span>
  <span class="bold">${a.value}</span>
  <div class="input-range">
  <input
    class="secondary-colour-bg"
    type="range"
    min=${a.edit.range.min}
    value=${a.value}
    max=${a.edit.range.max}
    oninput=${t=>{t.target.parentNode.previousElementSibling.textContent=t.target.value}}>`)};var Ul=e=>a=>{let t=a.edit.options.find(r=>typeof r=="object"&&Object.values(r)[0]===a.value||r===a.value)||a.value;a.displayValue=t&&typeof t=="object"&&Object.keys(t)[0]||t||a.value,a.val.appendChild(e.utils.html.node`
      <button class="btn-drop">
      <div
      class="head"
      onclick=${r=>{r.preventDefault(),r.target.parentElement.classList.toggle("active")}}>
      <span>${a.displayValue}</span>
      <div class="icon"></div>
      </div>
      <ul>
      ${a.edit.options.map(r=>{let i=r,n=r;return typeof r=="object"&&(i=Object.keys(r)[0],n=Object.values(r)[0]),e.utils.html.node`<li onclick=${s=>{let o=s.target.closest(".btn-drop");o.classList.toggle("active"),o.querySelector(":first-child").textContent=i,o.querySelector(":first-child").value=n,a.location.view.dispatchEvent(new CustomEvent("valChange",{detail:{input:o.querySelector(":first-child"),entry:a}}))}}>${i}`})}`)};var Yl=e=>a=>{let r=e.utils.html.node`<input type="text" placeholder=${e.language.layer_filter_pick} style="text-align: end;">${a.type==="datetime"&&e.utils.formatDateTime(a.value)||e.utils.formatDate(a.value)||""}`.childNodes[0];r.value=a.type==="datetime"&&e.utils.formatDateTime(a.value)||e.utils.formatDate(a.value)||"",a.val.appendChild(r),e.utils.flatpickr({value:a.value?new Date(a.value*1e3).toISOString():"",element:r,enableTime:a.type==="datetime",callback:i=>{r.value=i;let n=e.utils.meltDateStr(i);a.location.view.dispatchEvent(new CustomEvent("valChange",{detail:{input:r,entry:a,newValue:n}}))}})};var Wl=e=>a=>a.val.appendChild(e.utils.html.node`
    <textarea
      style="auto; min-height: 50px;"
      onfocus=${t=>{t.target.style.height=t.target.scrollHeight+"px"}}
      onfocusout=${t=>{t.target.style.height="auto"}}
      onkeyup=${t=>{a.location.view.dispatchEvent(new CustomEvent("valChange",{detail:{input:t.target,entry:a}}))}}
      onkeydown=${t=>setTimeout(()=>{t.target.style.height="auto",t.target.style.height=t.target.scrollHeight+"px"},100)}>
      ${a.value||""}`);var Jl=e=>{let a={input:t,range:Vl(e),date:Yl(e),options:Ul(e),textarea:Wl(e)};return a;function t(r){if(!!r.edit){if(r.type==="date"||r.type==="datetime")return a.date(r);if(r.edit.range)return a.range(r);if(r.edit.options)return a.options(r);if(r.type==="textarea"||r.type==="html")return a.textarea(r);r.val.appendChild(e.utils.html.node`
    <input
      type="${(r.type==="numeric"||r.type==="integer")&&"number"||"text"}"
      value="${r.value||r.displayValue||""}"
      onkeyup=${i=>{r.location.view.dispatchEvent(new CustomEvent("valChange",{detail:{input:i.target,entry:r}}))}}>`)}}};var Zl=e=>a=>{if(a.dependents&&a.dependents.some(t=>a.location.infoj.some(r=>!r.value&&r.field===t))&&delete a.display,a.layer=typeof a.layer=="object"&&a.layer||typeof a.layer=="string"&&e.layers.list[a.layer]||a.location.layer,a.target==="location"||a.dataview&&a.dataview.classList.contains("location"))return a.dataview?(a.update(),a.dataview):(a.target=e.utils.html.node`
      <div
        class="${`location ${a.class}`}"
        style="${`${a.style||""}`}">`,e.dataviews.create(a),a.dataview);if(typeof a.target=="string"&&document.getElementById(a.target)){a.target=document.getElementById(a.target),e.dataviews.create(a);return}if(e.tabview.node)return a.tab_style=`border-bottom: 2px solid ${a.location.style.strokeColor}`,e.tabview.add(a),e.dataviews.create(a),a.display&&a.show(),e.utils.html.node`
      <label
        class="${`input-checkbox mobile-disabled ${a.class}`}">
        <input
          type="checkbox"
          .checked=${!!a.display}
          onchange=${t=>{a.display=t.target.checked,a.display?a.show():a.remove()}}></input>
        <div></div>
        <span>${a.title||"Dataview"}`};var Xl=e=>a=>{if(!a.value)return;a.value=typeof a.value=="object"?a.value:JSON.parse(a.value);let t=e.utils.html.node`
	<div 
    style="grid-column: 1 / 3;
      width: 100%;
      padding: 4px;
      margin-top: 2px;
      color: #666;
      border-radius: 4px;
      background-color: linen;
      max-height: 200px;
      overflow-y: scroll;
      font-size: small;">`,r=e.utils.html.node`
      <span
        style="display: none; font-size: smaller; color: red;">${e.language.location_json_edit_msg}`,i=JSON.stringify(a.value,null,2),n=a.edit?e.utils.html.node`<pre><code><textarea 
    style="background-color:linen; color: rgb(102, 102, 102); font-size: small;"
    rows=10
    oninput=${s=>{a._valid=(()=>{if(!s.target.value)return!0;try{return JSON.parse(s.target.value),!0}catch(o){return!1}})(),a._valid?r.style.display="none":r.style.display="block"}}
    onkeyup=${s=>{!a._valid||a.location.view.dispatchEvent(new CustomEvent("valChange",{detail:{input:s.target,entry:a}}))}}>${i}`:e.utils.html.node`<pre><code>${i}`;t.appendChild(n),a.edit&&t.appendChild(r),a.listview.appendChild(t)};var Kl=e=>{return{create:a,infoj:Dl(e),streetview:Ol(e),images:Al(e),documents:Pl(e),geometry:ql(e),edit:Jl(e),boolean:xl(e),report:Il(e),dataview:Zl(e),json:Xl(e)};function a(t){t.view&&t.view.remove(),t.view=e.utils.html.node`<div class="drawer location-view expandable expanded">`;let r=t.view.appendChild(e.utils.html.node`
      <div
        class = "header"
        style = "${"border-bottom: 2px solid "+t.style.strokeColor}"
        onclick = ${o=>{o.preventDefault(),e.utils.toggleExpanderParent(o.target,!0)}}>
        <div>${String.fromCharCode(65+e.locations.list.indexOf(t.record))}`);t.infoj&&r.appendChild(e.utils.html.node`
      <button
        style = "${"filter: "+t.colorFilter+"; -webkit-filter: "+t.colorFilter}"
        title = ${e.language.location_drawer_toggle}
        class = "btn-header xyz-icon icon-expander "
        onclick = ${o=>{o.stopPropagation(),e.utils.toggleExpanderParent(o.target)}}>`),r.appendChild(e.utils.html.node`
      <button
        style = "${"filter: "+t.colorFilter+"; -webkit-filter: "+t.colorFilter}"
        title = ${e.language.location_zoom}
        class = "btn-header xyz-icon icon-search"
        onclick = ${o=>{o.stopPropagation(),t.flyTo()}}>`);let i=r.appendChild(e.utils.html.node`
      <button
        style = "${"display: none; filter: "+t.colorFilter+"; -webkit-filter: "+t.colorFilter}"
        title = ${e.language.location_save}
        class = "btn-header xyz-icon icon-cloud-upload"
        onclick = ${o=>{o.stopPropagation(),t.update()}}>`);if(t.layer.edit&&t.layer.edit.geometry&&r.appendChild(e.utils.html.node`
      <button
        style = "${"filter: "+t.colorFilter+"; -webkit-filter: "+t.colorFilter}"
        title = ${e.language.location_edit_geometry}
        class = "btn-header xyz-icon icon-build"
        onclick = ${o=>{if(o.stopPropagation(),r.classList.contains("edited"))return e.mapview.interaction.edit.finish();r.classList.add("edited","secondary-colour-bg"),e.mapview.interaction.edit.begin({location:t,type:"LineString",callback:()=>{r.classList.remove("edited","secondary-colour-bg")}})}}>`),t.layer.edit&&t.layer.edit.delete&&r.appendChild(e.utils.html.node`
      <button
        style = "${"filter: "+t.colorFilter+"; -webkit-filter: "+t.colorFilter}"
        title = ${e.language.location_delete}
        class = "btn-header xyz-icon icon-trash"
        onclick = ${o=>{o.stopPropagation(),t.trash()}}>`),r.appendChild(e.utils.html.node`
    <button
      style = "${"filter: "+t.colorFilter+"; -webkit-filter: "+t.colorFilter}"
      title = ${e.language.location_hide_marker}
      class = "btn-header xyz-icon icon-location-tick" 
      onclick = ${o=>{o.stopPropagation(),o.target.classList.toggle("icon-location"),o.target.classList.toggle("icon-location-tick"),o.target.classList.contains("icon-location")?e.map.removeLayer(t.Marker):e.map.addLayer(t.Marker)}}>`),r.appendChild(e.utils.html.node`
    <button
      style = "${"filter: "+t.colorFilter+"; -webkit-filter: "+t.colorFilter}"
      title = ${e.language.location_remove}
      class = "btn-header xyz-icon icon-close"
      onclick = ${o=>{o.stopPropagation(),t.remove(),e.map.updateSize()}}>`),t.view.addEventListener("valChange",o=>{let c=typeof o.detail.newValue=="undefined"&&o.detail.input.value||o.detail.newValue;o.detail.entry.value!=c?(o.detail.entry.newValue=c,o.detail.input.classList.add("primary-colour")):(delete o.detail.entry.newValue,o.detail.input.classList.remove("primary-colour")),i.style.display=o.detail.entry.location.infoj.some(f=>typeof f.newValue!="undefined")&&"inline-block"||"none"}),!t.infoj)return;let n;t.view.addEventListener("updateInfo",s),s();function s(){n&&n.remove(),t.view.classList.remove("disabled"),n=e.locations.view.infoj(t),t.view.appendChild(n)}}};var Ql=e=>{return{init:a};function a(t){e.locations.listview.node=t.target,e.locations.listview.node.addEventListener("passover",()=>{setTimeout(()=>{if(e.locations.listview.node.children.length>1)return;let r=e.locations.listview.node.closest(".tab");r.style.display="none",r.previousElementSibling.click()},300)}),e.locations.listview.add=r=>{!e.locations.listview.node||(Object.values(e.locations.listview.node.children).forEach(i=>i.classList.remove("expanded")),e.locations.listview.node.insertBefore(r.view,e.locations.listview.node.firstChild),e.locations.listview.node.appendChild(r.view),e.locations.listview.node.closest(".tab").style.display="block",e.locations.listview.node.closest(".tab").click())},e.locations.list=[["#4227b0","invert(19%) sepia(57%) saturate(4245%) hue-rotate(247deg) brightness(76%) contrast(101%)"],["#2196f3","invert(60%) sepia(94%) saturate(3876%) hue-rotate(184deg) brightness(98%) contrast(94%)"],["#009688","invert(37%) sepia(46%) saturate(1993%) hue-rotate(144deg) brightness(96%) contrast(101%)"],["#cddc39","invert(84%) sepia(82%) saturate(420%) hue-rotate(6deg) brightness(88%) contrast(94%)"],["#ff9800","invert(59%) sepia(90%) saturate(1526%) hue-rotate(358deg) brightness(99%) contrast(106%)"],["#673ab7","invert(23%) sepia(26%) saturate(6371%) hue-rotate(251deg) brightness(87%) contrast(87%)"],["#03a9f4","invert(65%) sepia(61%) saturate(5963%) hue-rotate(168deg) brightness(101%) contrast(103%)"],["#4caf50","invert(65%) sepia(8%) saturate(3683%) hue-rotate(73deg) brightness(92%) contrast(69%)"],["#ffeb3b","invert(75%) sepia(76%) saturate(391%) hue-rotate(2deg) brightness(104%) contrast(109%)"],["#ff5722","invert(47%) sepia(96%) saturate(3254%) hue-rotate(346deg) brightness(100%) contrast(102%)"],["#0d47a1","invert(15%) sepia(99%) saturate(2827%) hue-rotate(213deg) brightness(87%) contrast(90%)"],["#00bcd4","invert(60%) sepia(39%) saturate(2788%) hue-rotate(144deg) brightness(93%) contrast(102%)"],["#8bc34a","invert(87%) sepia(8%) saturate(3064%) hue-rotate(35deg) brightness(85%) contrast(85%)"],["#ffc107","invert(79%) sepia(86%) saturate(3969%) hue-rotate(346deg) brightness(98%) contrast(111%)"],["#d32f2f","invert(28%) sepia(94%) saturate(3492%) hue-rotate(345deg) brightness(85%) contrast(92%)"]].map(r=>({style:{strokeColor:r[0]},colorFilter:r[1]}))}};var zl=e=>function(){let a=this;a.Layer=e.mapview.geoJSON({geometry:a.geometry,zIndex:1999,style:[new ol.style.Style({stroke:new ol.style.Stroke({color:"rgba(255, 255, 255, 0.2)",width:8})}),new ol.style.Style({stroke:new ol.style.Stroke({color:"rgba(255, 255, 255, 0.2)",width:6})}),new ol.style.Style({stroke:new ol.style.Stroke({color:"rgba(255, 255, 255, 0.2)",width:4})}),new ol.style.Style({stroke:a.style.strokeColor&&new ol.style.Stroke({color:a.style.strokeColor,width:a.style.strokeWidth||1}),fill:a.style.fillColor&&new ol.style.Fill({color:e.utils.Chroma(a.style.fillColor).alpha(a.style.fillOpacity===void 0?1:parseFloat(a.style.fillOpacity)||0).rgba()})})],dataProjection:a.layer.srid,featureProjection:e.mapview.srid})};var es=e=>function(){let a=this;e.hooks&&e.hooks.filter("locations",a.hook),e.mapview.interaction.edit.finish&&e.mapview.interaction.edit.finish(),a.view&&(a.view.parentElement&&a.view.parentElement.dispatchEvent(new Event("passover")),a.view.remove()),a.tabs&&a.tabs.forEach(t=>t.remove()),a.geometries.forEach(t=>e.map.removeLayer(t)),a.geometryCollection.forEach(t=>e.map.removeLayer(t)),a.Layer&&e.map.removeLayer(a.Layer),a.Marker&&e.map.removeLayer(a.Marker),typeof a.removeCallback=="function"&&a.removeCallback(),a.removeCallbacks.forEach(t=>typeof t=="function"&&t()),a.record.location=null};var ts=e=>function(){if(!e.map)return;let a=this,t=new ol.source.Vector;a.Layer&&t.addFeatures(a.Layer.getSource().getFeatures()),a.Marker&&t.addFeatures(a.Marker.getSource().getFeatures()),a.geometries.forEach(r=>{r.length?r.forEach(i=>t.addFeatures(i.getSource().getFeatures())):t.addFeatures(r.getSource().getFeatures())}),e.mapview.flyToBounds(t.getExtent())};var as=e=>function(a){let t=this,r={};if(t.infoj.filter(n=>typeof n.newValue!="undefined").forEach(n=>{n.type==="integer"&&(n.newValue=isNaN(parseInt(n.newValue))?null:n.newValue),n.type==="numeric"&&(n.newValue=isNaN(parseFloat(n.newValue))?null:n.newValue),n.type==="json"&&(n.newValue=n.newValue||null),Object.assign(r,{[n.field]:n.newValue})}),!Object.keys(r).length)return;t.view&&t.view.classList.add("disabled");let i=new XMLHttpRequest;i.open("POST",e.host+"/api/location/update?"+e.utils.paramString({locale:e.locale.key,layer:t.layer.key,table:t.table,id:t.id})),i.setRequestHeader("Content-Type","application/json"),i.responseType="json",i.onload=n=>{if(n.target.status!==200)return console.error(n.target.response);let s=t.infoj.filter(o=>typeof o.newValue!="undefined").filter(o=>o.dependents&&o.dependents.length).map(o=>o.dependents).flat();if(t.infoj.filter(o=>typeof o.newValue!="undefined").forEach(o=>{o.value=o.newValue,delete o.newValue}),s.length){let o=[...new Set(s)],c=new XMLHttpRequest;c.open("GET",e.host+"/api/location/get?"+e.utils.paramString({locale:e.locale.key,layer:t.layer.key,table:t.table,id:t.id,fields:o.join()})),c.setRequestHeader("Content-Type","application/json"),c.responseType="json",c.onload=f=>{t.infoj.filter(p=>typeof f.target.response[p.field]!="undefined").forEach(p=>{p.value=f.target.response[p.field]}),t.view&&t.view.dispatchEvent(new Event("updateInfo")),t.layer.reload(),a&&a()},c.send();return}t.view&&t.view.dispatchEvent(new Event("updateInfo")),t.layer.reload(),a&&a()},i.send(JSON.stringify(r))};var rs=e=>function(){let a=this,t=new XMLHttpRequest;t.open("GET",e.host+"/api/location/delete?"+e.utils.paramString({locale:e.locale.key,layer:a.layer.key,table:a.table,id:a.id})),t.onload=r=>{r.target.status===200&&(a.layer.reload(),a.remove())},confirm("Are you sure you want to delete this feature? This cannot be undone.")&&t.send()};var ns=e=>{return{decorate:t,plugins:{},list:[{style:{strokeColor:"#9c27b0"},colorFilter:"invert(22%) sepia(80%) saturate(1933%) hue-rotate(272deg) brightness(97%) contrast(104%)"}],listview:Ql(e),view:Kl(e),select:$l(e),selectCallback:Fl(e)};function t(r,i={}){Object.assign(r,{remove:es(e),trash:rs(e),flyTo:ts(e),update:as(e),draw:zl(e),geometries:[],tables:[],tabs:new Set,geometryCollection:[],removeCallbacks:[],style:Object.assign({strokeColor:"#1F964D"},r.style||{})},i)}};var is=e=>a=>new Promise((t,r)=>{let i=new XMLHttpRequest,n=a.viewport&&e.map&&e.mapview.getBounds(),s=a.center&&e.map&&ol.proj.transform(e.map.getView().getCenter(),`EPSG:${e.mapview.srid}`,"EPSG:4326");i.open("GET",e.host+"/api/query?"+e.utils.paramString(Object.assign({template:encodeURIComponent(a.query),dbs:a.dbs,layer:typeof a.layer=="string"&&a.layer||a.layer&&a.layer.key,filter:a.filter??a?.layer?.filter?.current,locale:a.layer&&e.locale.key,id:a.location&&a.location.id,lat:a.lat||s&&s[1],lng:a.lng||s&&s[0],z:a.z&&e.map&&e.map.getView().getZoom(),viewport:n&&[n.west,n.south,n.east,n.north,e.mapview.srid]},a.queryparams||{}))),i.setRequestHeader("Content-Type","application/json"),i.responseType="json",i.onload=o=>{if(o.target.status>=300)return r({err:o.target.status});t(o.target.response)},i.send()});var os=e=>a=>new Promise((t,r)=>{let i=new XMLHttpRequest;i.open(a.method||"GET",a.url),i.setRequestHeader("Content-Type",a.content_type||"application/json"),i.responseType=a.responseType||"json",i.onload=n=>{if(n.target.status>=300)return r({err:n.target.status});t(n.target.response)},i.send(a.body)});var ls=e=>a=>new Promise((t,r)=>{let i=new XMLHttpRequest;i.open("GET",`${e.host}/api/proxy?url=${encodeURIComponent(a)}`),i.setRequestHeader("Content-Type","application/json"),i.responseType="json",i.onload=n=>{if(n.target.status>=300)return r({err:n.target.status});t(n.target.response)},i.send()});var ss=e=>()=>new Promise(a=>{let t=Object.entries(e.locale.plugins||{}).map(r=>new Promise((i,n)=>{let s=document.createElement("script");s.type="application/javascript",s.src=r[1];let o;s.onload=()=>{setTimeout(()=>{!o&&console.error(`${r[1]} event not triggered`),document.removeEventListener(r[0],c,!0),s.remove(),i()},400)},s.onerror=()=>{document.removeEventListener(r[0],c,!0),s.remove(),n()},document.addEventListener(r[0],c,!0),document.head.append(s);function c(f){o=!0,f.detail(e)}}));Promise.all(t).then(a).catch(a)});var cs=e=>{return{create:a,plugins:{}};function a(n){if(!n.dataview){if(n.dataview=typeof n.target=="string"&&document.getElementById(n.target),n.dataview=n.target instanceof HTMLElement&&n.target||e.utils.html.node`<div class="${`${n.class||""}`}" style="${n.style||""}">`,n.panel instanceof HTMLElement&&n.panel.appendChild(n.dataview),n.dataviews){n.dataview.classList.add("dataview-container");for(let s of n.dataviews)s.tab=n.tab,s.layer=s.layer||n.layer,s.location=s.location||n.location,s.panel=n.dataview,a(s);return}if(n.dataview.classList.add("dataview"),t(n),n.target=n.dataview.appendChild(e.utils.html.node`
      <div class="target">`),n.target.style.height=n.toolbar&&"calc(100% - 25px)",n.update=()=>{!n.query||e.query(n).then(s=>{n.setData(s)})},n.tab&&n.tab.addEventListener("activate",n.update),n.mapChange&&e.mapview.node.addEventListener("changeEnd",()=>{n.layer&&!n.layer.display||n.tab&&!n.tab.classList.contains("active")||n.update()}),n.chart&&r(n),n.columns&&i(n),!!n.setData){if(n.data)return n.setData(n.data);!n.tab&&n.update()}}}function t(n){typeof n.toolbar=="object"&&(n.toolbar.node=n.dataview.appendChild(e.utils.html.node`
      <div class="toolbar">`),n.toolbar.viewport&&n.toolbar.node.appendChild(e.utils.html.node`
        <button
          class="off-white-hover primary-colour"
          onclick=${s=>{s.target.classList.toggle("primary-colour"),n.viewport=!n.viewport,n.update()}}>Viewport`),n.toolbar.download_csv&&n.toolbar.node.appendChild(e.utils.html.node`
        <button
          class="off-white-hover primary-colour"
          onclick=${()=>{n.Tabulator.download("csv",`${n.title||"table"}.csv`)}}>CSV`),n.toolbar.download_json&&n.toolbar.node.appendChild(e.utils.html.node`
        <button
          class="off-white-hover primary-colour"
          onclick=${()=>{n.Tabulator.download("json",`${n.title||"table"}.json`)}}>JSON`))}function r(n){n.target.style.position="relative";let s=n.target.appendChild(e.utils.html.node`<canvas>`);n.chart.height&&s.setAttribute("height",n.chart.height),n.chart.width&&s.setAttribute("width",n.chart.width),!!window.Chart&&(n.chart.ChartJS=new Chart(s,{type:n.chart.type||"bar",options:n.chart.options}),n.setData=o=>{if(!o){if(n.dataview.classList.contains("location")){n.target.innerHTML="";return}n.target.innerHTML=`<div style="text-align:center;"><small>${e.language.dataview_no_data}</small></div>`;return}if(n.data=o,n.chart.responseFunction&&n.chart.responseFunction(o),!(o.datasets&&o.datasets.length&&o.datasets.some(f=>!f.data||f.data.some(p=>p!==null))))return n.target.style.display="none";n.chart.datasets&&n.chart.datasets.length&&o.datasets.forEach((f,p)=>Object.assign(f,n.chart.datasets[p])),n.chart.ChartJS.data={labels:typeof n.chart.labels=="function"&&n.chart.labels(o)||o.labels||n.chart.labels,datasets:o.datasets},n.target.style.display="block",n.chart.ChartJS.update()})}function i(n){n.fixed_header&&(n.target.style.display="grid",n.target.style.position="absolute"),n.target=n.target.appendChild(e.utils.html.node`<div>`),function s(o){o.forEach(c=>{c.plugin&&(c.formatter=e.dataviews.plugins[c.plugin]),c.columns&&s(c.columns)})}(n.columns),n.target.style.visibility="hidden",n.Tabulator=new Tabulator(n.target,Object.assign({invalidOptionWarnings:!1,tooltipsHeader:!0,columnHeaderVertAlign:"center",layout:n.layout||"fitDataFill",autoColumns:n.autoColumns||!1,height:"auto",rowFormatter:s=>{if(s.getData().backgroundcolour){let o=s.getElement();o.style.backgroundColor=s.getData().backgroundcolour}},selectable:!1,rowClick:(s,o)=>{let c=o.getData();!n.layer||!c[n.qID||"id"]||(e.locations.select({locale:e.locale.key,layer:c.layer||n.layer,table:c.table||n.table,id:c[n.qID||"id"]}),o.deselect())}},n)),n.setData=s=>{!s||(n.data=s,n.responseFunction&&n.responseFunction(s),n.Tabulator.setData(s.length&&s||[s]),n.target.style.visibility="visible")}}};var us=e=>{let a={init:t,search:r,sources:{glx:s,mapbox:o,google:c,opencage:f},select:n,createFeature:i,icon:{type:"markerColor",colorMarker:"#64dd17",colorDot:"#33691e",anchor:[.5,1],scale:2}};return a;function t(p){!p||(Object.assign(a,p),a.result=a.group.querySelector("ul"),a.input=a.group.querySelector("input"),a.input.placeholder=e.locale.gazetteer.placeholder||"",a.input.addEventListener("keyup",u=>{!new Set([37,38,39,40,13]).has(u.keyCode||u.charCode)&&u.target.value.length>0&&a.search(u.target.value)}),a.input.addEventListener("keydown",u=>{let h=u.keyCode||u.charCode;if(h===46||h===8){a.xhr&&a.xhr.abort(),a.clear(),a.layer&&e.map.removeLayer(a.layer);return}if(h===13){let w=u.target.value.split(",").map(parseFloat);w[1]>-90&&w[1]<90&&w[0]>-180&&w[0]<180&&(a.xhr&&a.xhr.abort(),a.clear(),a.createFeature({type:"Point",coordinates:[w[1],w[0]]})),a.result.querySelector("li").click()}}),a.input.addEventListener("focusout",()=>{a.xhr&&a.xhr.abort(),setTimeout(a.clear,400)}),a.clear=()=>{a.group.classList.remove("active"),a.result.innerHTML=""})}function r(p,u={}){a.clear&&a.clear(),a.xhr&&a.xhr.abort(),a.xhr=new XMLHttpRequest,a.xhr.open("GET",e.host+"/api/gazetteer?"+e.utils.paramString({locale:e.locale.key,q:encodeURIComponent(p),source:u.source})),a.xhr.setRequestHeader("Content-Type","application/json"),a.xhr.responseType="json",a.xhr.onload=h=>{if(h.target.status===200){if(u.callback)return u.callback(h.target.response);if(h.target.response.length===0)return a.result.appendChild(e.utils.html.node`
        <li>${e.language.search_no_results}`),a.group.classList.add("active");Object.values(h.target.response).forEach(w=>{a.result.appendChild(e.utils.html.node`
        <li style="cursor:pointer;" onclick=${D=>{if(D.preventDefault(),!w.source||!w.id){if(a.callback)return a.callback(w);w.marker&&a.createFeature({type:"Point",coordinates:w.marker.split(",")});return}a.select({label:w.label,id:w.id,source:w.source,layer:w.layer,table:w.table,marker:w.marker,callback:u.callback})}}>
        ${e.locale.gazetteer.label?e.utils.html.node`
          <span class="secondary-colour-bg" 
          style="font-size: smaller; padding: 0 2px 0 2px; cursor: help; border-radius: 2px;"
          >${e.layers.list[w.layer]&&e.layers.list[w.layer].name||w.layer||w.source}</span>`:""}
          <span>${w.label}</span>
        `),a.group.classList.add("active")})}},a.xhr.send()}function i(p){p=typeof p=="string"?JSON.parse(p):p,a.layer&&e.map.removeLayer(a.layer),a.layer=e.mapview.geoJSON({geometry:p,dataProjection:"4326",style:new ol.style.Style({image:e.mapview.icon(a.icon)})}),e.mapview.flyToBounds(a.layer.getSource().getExtent())}function n(p){a.clear&&a.clear(),a.input&&(a.input.value=p.label),a.sources[p.source](p)}function s(p){if(a.callback)return a.callback(p);e.locations.select({locale:e.locale.key,layer:e.layers.list[p.layer],table:p.table,id:p.id,_flyTo:!0}),p.callback&&p.callback()}function o(p){a.createFeature({type:"Point",coordinates:p.marker}),p.callback&&p.callback()}function c(p){e.proxy(`https://maps.googleapis.com/maps/api/place/details/json?placeid=${p.id}&{GOOGLE}`).then(u=>{let h={type:"Point",coordinates:[u.result.geometry.location.lng,u.result.geometry.location.lat]};if(a.createFeature(h),a.callback)return a.callback(h);p.callback&&p.callback(h)})}function f(p){a.createFeature({type:"Point",coordinates:p.marker}),p.callback&&p.callback()}};function ds(e={}){let a=Object.assign({version:"3.5.2",defaults:{colours:[{hex:"#c62828",name:"Fire Engine Red"},{hex:"#f50057",name:"Folly"},{hex:"#9c27b0",name:"Dark Orchid"},{hex:"#673ab7",name:"Plump Purple"},{hex:"#3f51b5",name:"Violet Blue"},{hex:"#2196f3",name:"Dodger Blue"},{hex:"#03a9f4",name:"Vivid Cerulean"},{hex:"#00bcd4",name:"Turquoise Surf"},{hex:"#009688",name:"Dark Cyan"},{hex:"#4caf50",name:"Middle Green"},{hex:"#8bc34a",name:"Dollar Bill"},{hex:"#cddc39",name:"Pear"},{hex:"#ffeb3b",name:"Banana Yellow"},{hex:"#ffb300",name:"UCLA Gold"},{hex:"#fb8c00",name:"Dark Orange"},{hex:"#f4511e",name:"Orioles Orange"},{hex:"#8d6e63",name:"Dark Chestnut"},{hex:"#777777",name:"Sonic Silver"},{hex:"#bdbdbd",name:"X11 Gray"},{hex:"#aaaaaa",name:"Dark Medium Gray"},{hex:"#78909c",name:"Light Slate Gray"}]},locale:{},utils:mn},e);return a.workspace=jo(a),a.hooks=Lo(a),a.language=Object.assign(vn,a.hooks&&a.hooks.current&&a.hooks.current.language&&er[a.hooks.current.language]||e.language&&er[e.language]||{}),window.mapp_dictionary=a.language,a.mapview=typeof ol!="undefined"&&zo(a),a.tabview=el(a),a.layers=Ml(a),a.locations=ns(a),a.gazetteer=us(a),a.query=is(a),a.xhr=os(a),a.proxy=ls(a),a.dataviews=cs(a),a.plugins=ss(a),e.callback&&$v(a),a}window._xyz=ds;var Fv=ds;function $v(e){if(!e.locale)return console.log("No locale defined for callback");e.workspace.get.locale({locale:e.locale}).then(a=>{e.locale=a,e.callback(e)})}export{Fv as default};
/*!
 * a-color-picker
 * https://github.com/narsenico/a-color-picker
 *
 * Copyright (c) 2017-2019, Gianfranco Caldi.
 * Released under the MIT License.
 */
/*!
 * a-color-picker (https://github.com/narsenico/a-color-picker)
 * 
 * Copyright (c) 2017-2018, Gianfranco Caldi.
 * Released under the MIT License.
 */
/*!
* is-plain-object <https://github.com/jonschlinkert/is-plain-object>
*
* Copyright (c) 2014-2017, Jon Schlinkert.
* Released under the MIT License.
*/
/*!
* isobject <https://github.com/jonschlinkert/isobject>
*
* Copyright (c) 2014-2017, Jon Schlinkert.
* Released under the MIT License.
*/
/*! (c) Andrea Giammarchi - ISC */
/**
 * chroma.js - JavaScript library for color conversions
 *
 * Copyright (c) 2011-2019, Gregor Aisch
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice, this
 * list of conditions and the following disclaimer.
 *
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 * this list of conditions and the following disclaimer in the documentation
 * and/or other materials provided with the distribution.
 *
 * 3. The name Gregor Aisch may not be used to endorse or promote products
 * derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL GREGOR AISCH OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * -------------------------------------------------------
 *
 * chroma.js includes colors from colorbrewer2.org, which are released under
 * the following license:
 *
 * Copyright (c) 2002 Cynthia Brewer, Mark Harrower,
 * and The Pennsylvania State University.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
 * either express or implied. See the License for the specific
 * language governing permissions and limitations under the License.
 *
 * ------------------------------------------------------
 *
 * Named colors are taken from X11 Color Names.
 * http://www.w3.org/TR/css3-color/#svg-color
 *
 * @preserve
 */
//# sourceMappingURL=mapp.js.map
