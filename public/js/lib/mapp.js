var ku=Object.defineProperty;var Va=(e,r)=>{for(var t in r)ku(e,t,{get:r[t],enumerable:!0})};var ba={};Va(ba,{Chroma:()=>ki,acolorpicker:()=>Ei,cloneDeep:()=>So,copyToClipboard:()=>oi,dataURLtoBlob:()=>li,flatpickr:()=>wi,formatDate:()=>Jn,formatDateTime:()=>yi,getCircularReplacer:()=>pi,html:()=>ct,idle:()=>si,isoline_here_decode:()=>Ci,meltDateStr:()=>_i,merge:()=>Mo,nanoid:()=>Fo,paramString:()=>ai,render:()=>ri,svg:()=>Fe,svg_symbols:()=>ni,toggleExpanderParent:()=>ii,turf:()=>bb});var An=e=>({get:r=>e.get(r),set:(r,t)=>(e.set(r,t),t)}),Ua=/([^\s\\>"'=]+)\s*=\s*(['"]?)$/,Cu=/^(?:area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)$/i,Eu=/<[a-z][^>]+$/i,Su=/>[^<>]*$/,$u=/<([a-z]+[a-z0-9:._-]*)([^>]*?)(\/>)/ig,ju=/\s+$/,Ya=(e,r)=>0<r--&&(Eu.test(e[r])||!Su.test(e[r])&&Ya(e,r)),Tu=(e,r,t)=>Cu.test(r)?e:`<${r}${t.replace(ju,"")}></${r}>`,Lu=(e,r,t)=>{let n=[],{length:a}=e;for(let s=1;s<a;s++){let o=e[s-1];n.push(Ua.test(o)&&Ya(e,s)?o.replace(Ua,(l,f,p)=>`${r}${s-1}=${p||'"'}${f}${p?"":'"'}`):`${o}<!--${r}${s-1}-->`)}n.push(e[a-1]);let i=n.join("").trim();return t?i:i.replace($u,Tu)},{isArray:Pn}=Array,{indexOf:Mu,slice:Wa}=[],Fu=1,Ja=111,Du=({firstChild:e,lastChild:r})=>{let t=document.createRange();return t.setStartAfter(e),t.setEndAfter(r),t.deleteContents(),e},Ou=(e,r)=>e.nodeType===Ja?1/r<0?r?Du(e):e.lastChild:r?e.valueOf():e.firstChild:e,Au=e=>{let{childNodes:r}=e,{length:t}=r;if(t<2)return t?r[0]:e;let n=Wa.call(r,0),a=n[0],i=n[t-1];return{ELEMENT_NODE:Fu,nodeType:Ja,firstChild:a,lastChild:i,valueOf(){if(r.length!==t){let s=0;for(;s<t;)e.appendChild(n[s++])}return e}}},Pu=(e,r,t,n,a)=>{let i=t.length,s=r.length,o=i,l=0,f=0,p=null;for(;l<s||f<o;)if(s===l){let u=o<i?f?n(t[f-1],-0).nextSibling:n(t[o-f],0):a;for(;f<o;)e.insertBefore(n(t[f++],1),u)}else if(o===f)for(;l<s;)(!p||!p.has(r[l]))&&e.removeChild(n(r[l],-1)),l++;else if(r[l]===t[f])l++,f++;else if(r[s-1]===t[o-1])s--,o--;else if(r[l]===t[o-1]&&t[f]===r[s-1]){let u=n(r[--s],-1).nextSibling;e.insertBefore(n(t[f++],1),n(r[l++],-1).nextSibling),e.insertBefore(n(t[--o],1),u),r[s]=t[o]}else{if(!p){p=new Map;let u=f;for(;u<o;)p.set(t[u],u++)}if(p.has(r[l])){let u=p.get(r[l]);if(f<u&&u<o){let h=l,w=1;for(;++h<s&&h<o&&p.get(r[h])===u+w;)w++;if(w>u-f){let D=n(r[l],0);for(;f<u;)e.insertBefore(n(t[f++],1),D)}else e.replaceChild(n(t[f++],1),n(r[l++],-1))}else l++}else e.removeChild(n(r[l++],-1))}return t},Iu=e=>r=>{for(let t in r){let n=t==="role"?t:`aria-${t}`,a=r[t];a==null?e.removeAttribute(n):e.setAttribute(n,a)}},xu=(e,r)=>{let t,n=!0,a=document.createAttributeNS(null,r);return i=>{t!==i&&(t=i,t==null?n||(e.removeAttributeNode(a),n=!0):(a.value=i,n&&(e.setAttributeNodeNS(a),n=!1)))}},Ru=(e,r,t)=>n=>{t!==!!n&&((t=!!n)?e.setAttribute(r,""):e.removeAttribute(r))},Hu=({dataset:e})=>r=>{for(let t in r){let n=r[t];n==null?delete e[t]:e[t]=n}},Nu=(e,r)=>{let t,n=r.slice(2);return!(r in e)&&r.toLowerCase()in e&&(n=n.toLowerCase()),a=>{let i=Pn(a)?a:[a,!1];t!==i[0]&&(t&&e.removeEventListener(n,t,i[1]),(t=i[0])&&e.addEventListener(n,t,i[1]))}},Bu=e=>r=>{typeof r=="function"?r(e):r.current=e},Gu=(e,r)=>r==="dataset"?Hu(e):t=>{e[r]=t},qu=e=>{let r;return t=>{r!=t&&(r=t,e.textContent=t??"")}};var Za=function(e){var r="fragment",t="template",n="content"in s(t),a=n?function(l){var f=s(t);return f.innerHTML=l,f.content}:function(l){var f=s(r),p=s(t),u=null;if(/^[^\S]*?<(col(?:group)?|t(?:head|body|foot|r|d|h))/i.test(l)){var h=RegExp.$1;p.innerHTML="<table>"+l+"</table>",u=p.querySelectorAll(h)}else p.innerHTML=l,u=p.childNodes;return i(f,u),f};return function(f,p){return(p==="svg"?o:a)(f)};function i(l,f){for(var p=f.length;p--;)l.appendChild(f[0])}function s(l){return l===r?e.createDocumentFragment():e.createElementNS("http://www.w3.org/1999/xhtml",l)}function o(l){var f=s(r),p=s("div");return p.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+l+"</svg>",i(f,p.firstChild.childNodes),f}}(document),Vu=({childNodes:e},r)=>e[r],In=e=>{let r=[],{parentNode:t}=e;for(;t;)r.push(Mu.call(t.childNodes,e)),e=t,t=e.parentNode;return r},{createTreeWalker:Xa,importNode:xn}=document,Ka=xn.length!=1,Uu=Ka?(e,r,t)=>xn.call(document,Za(e,r,t),!0):Za,Yu=Ka?e=>Xa.call(document,e,1|128,null,!1):e=>Xa.call(document,e,1|128),dr=(e,r,t)=>Pu(e.parentNode,r,t,Ou,e),Wu=e=>{let r,t,n=[],a=i=>{switch(typeof i){case"string":case"number":case"boolean":r!==i&&(r=i,t||(t=document.createTextNode("")),t.nodeValue=i,n=dr(e,n,[t]));break;case"object":case"undefined":if(i==null){r!=i&&(r=i,n=dr(e,n,[]));break}if(Pn(i)){r=i,i.length===0?n=dr(e,n,[]):typeof i[0]=="object"?n=dr(e,n,i):a(String(i));break}"ELEMENT_NODE"in i&&r!==i&&(r=i,n=dr(e,n,i.nodeType===11?Wa.call(i.childNodes):[i]));break;case"function":a(i(e));break}};return a},Ju=(e,r)=>{switch(r[0]){case"?":return Ru(e,r.slice(1),!1);case".":return Gu(e,r.slice(1));case"o":if(r[1]==="n")return Nu(e,r)}switch(r){case"ref":return Bu(e);case"aria":return Iu(e)}return xu(e,r)};function Zu(e){let{type:r,path:t}=e,n=t.reduceRight(Vu,this);return r==="node"?Wu(n):r==="attr"?Ju(n,e.name):qu(n)}var pr="isÂµ",Qa=An(new WeakMap),Xu=/^(?:plaintext|script|style|textarea|title|xmp)$/i,fr=()=>({stack:[],entry:null,wire:null}),Qu=(e,r)=>{let{content:t,updates:n}=Ku(e,r);return{type:e,template:r,content:t,updates:n,wire:null}},zu=(e,r)=>{let t=Lu(r,pr,e==="svg"),n=Uu(t,e),a=Yu(n),i=[],s=r.length-1,o=0,l=`${pr}${o}`;for(;o<s;){let f=a.nextNode();if(!f)throw`bad template: ${t}`;if(f.nodeType===8)f.nodeValue===l&&(i.push({type:"node",path:In(f)}),l=`${pr}${++o}`);else{for(;f.hasAttribute(l);)i.push({type:"attr",path:In(f),name:f.getAttribute(l)}),f.removeAttribute(l),l=`${pr}${++o}`;Xu.test(f.tagName)&&f.textContent.trim()===`<!--${l}-->`&&(f.textContent="",i.push({type:"text",path:In(f)}),l=`${pr}${++o}`)}}return{content:n,nodes:i}},Ku=(e,r)=>{let{content:t,nodes:n}=Qa.get(r)||Qa.set(r,zu(e,r)),a=xn.call(document,t,!0),i=n.map(Zu,a);return{content:a,updates:i}},Fr=(e,{type:r,template:t,values:n})=>{let{length:a}=n;za(e,n,a);let{entry:i}=e;(!i||i.template!==t||i.type!==r)&&(e.entry=i=Qu(r,t));let{content:s,updates:o,wire:l}=i;for(let f=0;f<a;f++)o[f](n[f]);return l||(i.wire=Au(s))},za=({stack:e},r,t)=>{for(let n=0;n<t;n++){let a=r[n];a instanceof Rn?r[n]=Fr(e[n]||(e[n]=fr()),a):Pn(a)?za(e[n]||(e[n]=fr()),a,a.length):e[n]=null}t<e.length&&e.splice(t)};function Rn(e,r,t){this.type=e,this.template=r,this.values=t}var{create:ed,defineProperties:td}=Object,ei=e=>{let r=An(new WeakMap),t=n=>(a,...i)=>Fr(n,{type:e,template:a,values:i});return td((n,...a)=>new Rn(e,n,a),{for:{value(n,a){let i=r.get(n)||r.set(n,ed(null));return i[a]||(i[a]=t(fr()))}},node:{value:(n,...a)=>Fr(fr(),{type:e,template:n,values:a}).valueOf()}})},ti=An(new WeakMap),ri=(e,r)=>{let t=typeof r=="function"?r():r,n=ti.get(e)||ti.set(e,fr()),a=t instanceof Rn?Fr(n,t):t;return a!==n.wire&&(n.wire=a,e.textContent="",e.appendChild(a.valueOf())),e},ct=ei("html"),Fe=ei("svg");var ni=e=>{if(e.svg&&!e.legend)return e.svg;let r={dot:Hn(e),target:rd(e),triangle:nd(e),square:ad(e),semiCircle:od(e),markerLetter:ld(e),markerColor:sd(e),geo:cd(),circle:ud(e),diamond:id(e)};function t(n){let a=`height: ${n.cluster?40:24}px; width: ${n.cluster?40:24}px; position: relative;`,i=ct.node`<div style="${a}">`;function s(o){let l=`position:absolute; height:${o.cluster?40:20}px; width:${o.cluster?40:20}px;`;return o.svg?i.appendChild(ct.node`<img style="${l}" src="${o.svg}"/>`):o.type?i.appendChild(ct.node`<img style="${l}" src="${r[o.type]}"/>`):i.appendChild(ct.node`<img style="${l}" src="${Hn({color:"#666"})}"/>`)}return n.layers&&Array.isArray(n.layers)?n.layers.map(o=>s(o)):s(n),i}return e.legend?t(e):e.type?r[e.type]:Hn({color:"#666"})},ut=new XMLSerializer;function Hn(e){let r=Fe.node`
    <svg width=24 height=24 viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'>
      <circle cx=13 cy=13 r=10 fill='#333'></circle>
      <circle cx=12 cy=12 r=10 fill=${e.fillColor||"#fff"}></circle>`;return`data:image/svg+xml,${encodeURIComponent(ut.serializeToString(r))}`}function rd(e){let r=Fe.node`
  <svg width=24 height=24 viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'>
    <circle cx=13 cy=13 fill='#333' r=10 opacity=0.4></circle>
    <circle cx=12 cy=12 r=10 fill=${e.fillColor||"#FFF"}>`;return e.layers&&Object.entries(e.layers).forEach(t=>{r.appendChild(Fe.node`<circle cx=12 cy=12 r=${parseFloat(t[0])*10} fill=${t[1]}>`)}),`data:image/svg+xml,${encodeURIComponent(ut.serializeToString(r))}`}function nd(e){let r=Fe.node`
  <svg width=24 height=24 viewBox='${"0 0 24 24"}' xmlns='http://www.w3.org/2000/svg'>
  <polygon points="12,4.68 2,22 22,22" 
  fill="#333" stroke="#333" opacity=0.4 stroke-opacity=0.4 stroke-width=3
  stroke-linejoin="round"/>`;return r.appendChild(Fe.node`<polygon
    fill=${e.fillColor||"#FFF"} stroke=${e.fillColor||"#FFF"} stroke-width=2
    points="12,4.68 2,22 22,22"  stroke-linejoin="round"/>`),e.layers&&Object.entries(e.layers).forEach(t=>{function n(s,o){return 12+(s-12)*o}function a(s,o){return 16+(s-16)*o}let i=`${n(12,t[0])},${a(4.68,t[0])} ${n(2,t[0])}, ${a(22,t[0])} ${n(22,t[0])}, ${a(22,t[0])}`;r.appendChild(Fe.node`<polygon
    fill=${t[1]} stroke=${t[1]||"#FFF"} stroke-width=1
    points="${i}" stroke-linejoin="round"/>`)}),`data:image/svg+xml,${encodeURIComponent(ut.serializeToString(r))}`}function ad(e){let r=Fe.node`
  <svg width=24 height=24 viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'>
    <rect fill='#333' opacity=0.3 width=20 height=20 x=2 y=2 rx=1></rect>
    <rect fill=${e.fillColor||"#FFF"} width=20 height=20 x=0 y=0 rx=1></rect>`;return e.layers&&Object.entries(e.layers).forEach(t=>{r.appendChild(Fe.node`<rect fill=${t[1]}
      width=${parseFloat(t[0])*20}
      height=${parseFloat(t[0])*20}
      x=${10*(1-parseFloat(t[0]))}
      y=${10*(1-parseFloat(t[0]))} rx=${parseFloat(t[0])}></rect>`)}),`data:image/svg+xml,${encodeURIComponent(ut.serializeToString(r))}`}function id(e){let r=Fe.node`
  <svg width=24 height=24 viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'>
  <polygon fill='#333' opacity=0.3
    points="12 0, 24 12, 12 24, 0 12"
    ></polygon>
    <polygon fill=${e.fillColor||"#FFF"}
    points="12 0, 24 12, 12 24, 0 12"
    ></polygon>`;function t(n,a){return 12+(n-12)*a}return e.layers&&Object.entries(e.layers).forEach(n=>{let a=`${t(12,n[0])} ${t(0,n[0])},${t(24,n[0])} ${t(12,n[0])},${t(12,n[0])} ${t(24,n[0])}, ${t(0,n[0])} ${t(12,n[0])}`;r.appendChild(Fe.node`
      <polygon fill=${n[1]||"#FFF"}
      points="${a}"
      ></polygon>`)}),`data:image/svg+xml,${encodeURIComponent(ut.serializeToString(r))}`}function od(e){let r=Fe.node`
  <svg width=30 height=30 viewBox='0 0 20 24' xmlns='http://www.w3.org/2000/svg'>
    <defs>
      <clipPath id="cut-off-shade">
        <rect x="0" y="0" width="24" height="11"/>
      </clipPath>
      <clipPath id="cut-off">
        <rect x="0" y="0" width="24" height="10"/>
      </clipPath>
    </defs>
    <circle cx="11" cy="10" r="10" clip-path="url(#cut-off-shade)" fill="#333" opacity=0.4></circle>
    <circle cx=10 cy=10 r=10 fill=${e.fillColor||"#FFF"} clip-path="url(#cut-off-shade)">`;return e.layers&&Object.entries(e.layers).forEach(t=>{r.appendChild(Fe.node`
    <circle cx=10 cy=10 r=${parseFloat(t[0])*10} fill=${t[1]} clip-path="url(#cut-off-shade)">`)}),`data:image/svg+xml,${encodeURIComponent(ut.serializeToString(r))}`}function ld(e){let r=Fe.node`
  <svg width=24 height=24 viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'>
    <path style="opacity: 0.5;" fill=${e.colorMarker}
      d=" M 12.692 1.969 C 8.605 1.969 5.334 5.239 5.334 9.328 C 5.334 10.963 5.743 12.189 6.764 14.028 C 8.808 17.504 11.922 21.996 11.922 21.996 C 11.922 21.996 16.576 17.504 18.62 14.028 C 19.642 12.189 20.051 10.963 20.051 9.328 C 20.051 5.239 16.78 1.969 12.692 1.969 Z "/>
    <path fill=${e.color}
      d=" M 12 1.969 C 7.878 1.969 4.813 5.239 4.813 9.328 C 4.813 10.554 5.222 12.189 6.244 14.028 C 8.289 17.504 12 22 12 22 C 12 22 16.055 17.504 18.099 14.028 C 19.122 12.189 19.341 10.963 19.341 9.328 C 19.341 5.239 16.054 1.969 12 1.969 Z "/>
    <circle cx="12.17192400568182" cy="8.918683238636365" r="5.109789772727275" opacity=0.8 fill="rgb(255, 255, 255)"/>
    <text x=12 y=12 style="text-anchor: middle; font-weight: 600; font-size: 10px; font-family: sans-serif; fill: rgb(85, 85, 85);">
    ${e.letter}`;return`data:image/svg+xml,${encodeURIComponent(ut.serializeToString(r))}`}function sd(e){let r=Fe.node`
  <svg width=18 height=24 viewBox='0 0 24 18' xmlns='http://www.w3.org/2000/svg'>
    <path style="opacity: 0.5;" fill=${e.colorMarker}
      d="M 10.797 1.238 C 6.308 1.238 2.716 4.83 2.716 9.32 C 2.716 11.116 3.165 12.463 4.287 14.483 C 6.532 18.3 9.952 23.234 9.952 23.234 C 9.952 23.234 15.063 18.3 17.308 14.483 C 18.43 12.463 18.879 11.116 18.879 9.32 C 18.879 4.83 15.287 1.238 10.797 1.238 Z"/>
    <path fill=${e.colorMarker}
      d="M 10 1.238 C 5.51 1.238 2.144 4.83 2.144 9.32 C 2.144 10.667 2.593 12.463 3.716 14.483 C 5.961 18.3 10 23.238 10 23.238 C 10 23.238 14.491 18.3 16.736 14.483 C 17.859 12.463 18.1 11.116 18.1 9.32 C 18.1 4.83 14.49 1.238 10 1.238 Z"/>
    <circle cx=10.226 cy=8.871 r=5.612 opacity=0.8 fill="rgb(255, 255, 255)"/>
    <circle cx=10.226 cy=8.871 r=2.806 opacity=0.8 fill=${e.colorDot}/>`;return`data:image/svg+xml,${encodeURIComponent(ut.serializeToString(r))}`}function cd(){let e=Fe.node`
  <svg width=1000 height=1000 viewBox='0 0 1000 1000' xmlns='http://www.w3.org/2000/svg'>
    <circle cx=500 cy=500 r=350 stroke='#1F964D' opacity=0.8 stroke-width=75 fill=none></circle>
    <circle cx=500 cy=500 r=200 fill='#1F964D' opacity=0.8></circle>
    <path stroke='#1F964D' opacity=0.8 stroke-width=75 d="M500,150L500,0M500,850L500,1000M0,500L150,500M850,500L1000,500" />`;return`data:image/svg+xml,${encodeURIComponent(ut.serializeToString(e))}`}function ud(e){let r=Fe.node`
  <svg width=24 height=24 viewBox='0 0 30 30' xmlns='http://www.w3.org/2000/svg'>
    <circle cx=16 cy=16 r=10
      stroke="#333"
      stroke-width="${e.strokeWidth||1}"
      fill="none"></circle>
    <circle cx=15 cy=15 r=10
      stroke="${e.strokeColor||"#333"}"
      stroke-width="${e.strokeWidth||1}"
      fill="${e.fillColor||"none"}"></circle>`;return`data:image/svg+xml,${encodeURIComponent(ut.serializeToString(r))}`}var ai=e=>Object.entries(e).filter(r=>r[1]===0||!!r[1]).filter(r=>r[1]!=="{}").filter(r=>typeof r[1]!="object"||r[1].length||Object.values(r[1]).some(t=>typeof t=="object"&&Object.keys(t).length)).map(r=>(typeof r[1]=="object"&&!r[1].length&&(r[1]=JSON.stringify(r[1])),encodeURI(`${r[0]}=${r[1]}`))).join("&");function ii(e,r){let t=e.closest(".expandable");if(!!t){if(t.classList.contains("expanded"))return t.classList.remove("expanded");r&&[...t.parentElement.children].forEach(n=>{n.classList.remove("expanded")}),t.classList.add("expanded")}}function oi(e){let r=_xyz.utils.html.node`<textarea style="visibility=none;">`;r.value=e,document.body.appendChild(r),r.select(),document.execCommand("copy"),r.remove()}function li(e){if(e.indexOf(";base64,")==-1){let i=e.split(","),s=i[0].split(":")[1],o=i[1];return new Blob([o],{type:s})}let r=e.split(";base64,"),t=r[0].split(":")[1],n=window.atob(r[1]),a=new Uint8Array(n.length);for(let i=0;i<n.length;++i)a[i]=n.charCodeAt(i);return new Blob([a],{type:t})}var _t={renew:540,idle:600,host:""};function si(e){Object.assign(_t,e),_t.idle!==0&&(window.onload=yt,window.onmousemove=yt,window.onmousedown=yt,window.ontouchstart=yt,window.onclick=yt,window.onkeypress=yt,yt(),Nn())}var ci,ui,Bn;function yt(){Bn||(clearTimeout(ci),ci=setTimeout(di,_t.idle*1e3))}function di(){Bn=!0,clearTimeout(ui);let e=new XMLHttpRequest;e.open("GET",`${_t.host}/api/user/cookie?destroy=true`),e.send();let r=document.body.appendChild(ct.node`<div id="InputMask">`),t=r.appendChild(ct.node`
    <form id="loginForm" action="${_t.host+"/api/user/login"}" method="post" autocomplete="off">
     
      <input style="display: none;" name="login" value=true>
  
      <input style="display:none;" name="language" required value="en">
  
      <div class="input-group">
        <input id="auth_user_email" name="email" type="email" required maxlength="50">
        <span class="bar"></span>
        <label for="auth_user_email">E-mail</label>
      </div>
  
      <div class="input-group">
        <input id="auth_user_password" name="password" type="password" required minlength="8">
        <span class="bar"></span>
        <label for="auth_user_password">Password</label>
      </div>
     
      <button id="btnLogin" type="submit">Log In</button>

      <div id="loginMessage" style="color: red"></div>
        
    </form>`);t.onsubmit=n=>{n.preventDefault();let a=new XMLHttpRequest;a.open("POST",`${_t.host}/api/user/login`),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.onload=i=>{i.target.status===401&&(document.getElementById("loginMessage").textContent=i.target.response),i.target.status===200&&(Bn=!1,r.remove(),yt(),Nn())},a.send(`login=true&email=${document.getElementById("auth_user_email").value}&password=${document.getElementById("auth_user_password").value}`)}}function Nn(){ui=setTimeout(e,_t.renew*1e3);function e(){let r=new XMLHttpRequest;r.open("GET",`${_t.host}/api/user/cookie?renew=true`),r.onload=t=>{if(t.target.status===401)return di();Nn()},r.send()}}var pi=()=>{let e=new WeakSet;return(r,t)=>{if(typeof t=="object"&&t!==null){if(e.has(t))return;e.add(t)}return t}};var Gn=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],Zt={_disable:[],allowInput:!1,allowInvalidPreload:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:typeof window=="object"&&window.navigator.userAgent.indexOf("MSIE")===-1,ariaDateFormat:"F j, Y",autoFillDefaultTime:!0,clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enableSeconds:!1,enableTime:!1,errorHandler:e=>typeof console!="undefined"&&console.warn(e),getWeek:e=>{let r=new Date(e.getTime());r.setHours(0,0,0,0),r.setDate(r.getDate()+3-(r.getDay()+6)%7);var t=new Date(r.getFullYear(),0,4);return 1+Math.round(((r.getTime()-t.getTime())/864e5-3+(t.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1},gr={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:e=>{let r=e%100;if(r>3&&r<21)return"th";switch(r%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",monthAriaLabel:"Month",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},Ne=(e,r=2)=>`000${e}`.slice(r*-1),Ke=e=>e===!0?1:0;function fi(e,r){let t;return function(){clearTimeout(t),t=setTimeout(()=>e.apply(this,arguments),r)}}var qn=e=>e instanceof Array?e:[e];function Pe(e,r,t){if(t===!0)return e.classList.add(r);e.classList.remove(r)}function ve(e,r,t){let n=window.document.createElement(e);return r=r||"",t=t||"",n.className=r,t!==void 0&&(n.textContent=t),n}function Dr(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function gi(e,r){if(r(e))return e;if(e.parentNode)return gi(e.parentNode,r)}function Or(e,r){let t=ve("div","numInputWrapper"),n=ve("input","numInput "+e),a=ve("span","arrowUp"),i=ve("span","arrowDown");if(navigator.userAgent.indexOf("MSIE 9.0")===-1?n.type="number":(n.type="text",n.pattern="\\d*"),r!==void 0)for(let s in r)n.setAttribute(s,r[s]);return t.appendChild(n),t.appendChild(a),t.appendChild(i),t}function Ue(e){try{return typeof e.composedPath=="function"?e.composedPath()[0]:e.target}catch(r){return e.target}}var Vn=()=>{},Ar=(e,r,t)=>t.months[r?"shorthand":"longhand"][e],dd={D:Vn,F:function(e,r,t){e.setMonth(t.months.longhand.indexOf(r))},G:(e,r)=>{e.setHours(parseFloat(r))},H:(e,r)=>{e.setHours(parseFloat(r))},J:(e,r)=>{e.setDate(parseFloat(r))},K:(e,r,t)=>{e.setHours(e.getHours()%12+12*Ke(new RegExp(t.amPM[1],"i").test(r)))},M:function(e,r,t){e.setMonth(t.months.shorthand.indexOf(r))},S:(e,r)=>{e.setSeconds(parseFloat(r))},U:(e,r)=>new Date(parseFloat(r)*1e3),W:function(e,r,t){let n=parseInt(r),a=new Date(e.getFullYear(),0,2+(n-1)*7,0,0,0,0);return a.setDate(a.getDate()-a.getDay()+t.firstDayOfWeek),a},Y:(e,r)=>{e.setFullYear(parseFloat(r))},Z:(e,r)=>new Date(r),d:(e,r)=>{e.setDate(parseFloat(r))},h:(e,r)=>{e.setHours(parseFloat(r))},i:(e,r)=>{e.setMinutes(parseFloat(r))},j:(e,r)=>{e.setDate(parseFloat(r))},l:Vn,m:(e,r)=>{e.setMonth(parseFloat(r)-1)},n:(e,r)=>{e.setMonth(parseFloat(r)-1)},s:(e,r)=>{e.setSeconds(parseFloat(r))},u:(e,r)=>new Date(parseFloat(r)),w:Vn,y:(e,r)=>{e.setFullYear(2e3+parseFloat(r))}},Un={D:"(\\w+)",F:"(\\w+)",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"(\\w+)",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"(\\w+)",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},hr={Z:e=>e.toISOString(),D:function(e,r,t){return r.weekdays.shorthand[hr.w(e,r,t)]},F:function(e,r,t){return Ar(hr.n(e,r,t)-1,!1,r)},G:function(e,r,t){return Ne(hr.h(e,r,t))},H:e=>Ne(e.getHours()),J:function(e,r){return r.ordinal!==void 0?e.getDate()+r.ordinal(e.getDate()):e.getDate()},K:(e,r)=>r.amPM[Ke(e.getHours()>11)],M:function(e,r){return Ar(e.getMonth(),!0,r)},S:e=>Ne(e.getSeconds()),U:e=>e.getTime()/1e3,W:function(e,r,t){return t.getWeek(e)},Y:e=>Ne(e.getFullYear(),4),d:e=>Ne(e.getDate()),h:e=>e.getHours()%12?e.getHours()%12:12,i:e=>Ne(e.getMinutes()),j:e=>e.getDate(),l:function(e,r){return r.weekdays.longhand[e.getDay()]},m:e=>Ne(e.getMonth()+1),n:e=>e.getMonth()+1,s:e=>e.getSeconds(),u:e=>e.getTime(),w:e=>e.getDay(),y:e=>String(e.getFullYear()).substring(2)},hi=({config:e=Zt,l10n:r=gr,isMobile:t=!1})=>(n,a,i)=>{let s=i||r;return e.formatDate!==void 0&&!t?e.formatDate(n,a,s):a.split("").map((o,l,f)=>hr[o]&&f[l-1]!=="\\"?hr[o](n,s,e):o!=="\\"?o:"").join("")},Yn=({config:e=Zt,l10n:r=gr})=>(t,n,a,i)=>{if(t!==0&&!t)return;let s=i||r,o,l=t;if(t instanceof Date)o=new Date(t.getTime());else if(typeof t!="string"&&t.toFixed!==void 0)o=new Date(t);else if(typeof t=="string"){let f=n||(e||Zt).dateFormat,p=String(t).trim();if(p==="today")o=new Date,a=!0;else if(/Z$/.test(p)||/GMT$/.test(p))o=new Date(t);else if(e&&e.parseDate)o=e.parseDate(t,f);else{o=!e||!e.noCalendar?new Date(new Date().getFullYear(),0,1,0,0,0,0):new Date(new Date().setHours(0,0,0,0));let u,h=[];for(let w=0,D=0,Z="";w<f.length;w++){let U=f[w],re=U==="\\",F=f[w-1]==="\\"||re;if(Un[U]&&!F){Z+=Un[U];let ie=new RegExp(Z).exec(t);ie&&(u=!0)&&h[U!=="Y"?"push":"unshift"]({fn:dd[U],val:ie[++D]})}else re||(Z+=".");h.forEach(({fn:ie,val:J})=>o=ie(o,J,s)||o)}o=u?o:void 0}}if(!(o instanceof Date&&!isNaN(o.getTime()))){e.errorHandler(new Error(`Invalid date provided: ${l}`));return}return a===!0&&o.setHours(0,0,0,0),o};function Ye(e,r,t=!0){return t!==!1?new Date(e.getTime()).setHours(0,0,0,0)-new Date(r.getTime()).setHours(0,0,0,0):e.getTime()-r.getTime()}var pd=(e,r,t)=>e>Math.min(r,t)&&e<Math.max(r,t),fd={DAY:864e5};function Wn(e){let r=e.defaultHour,t=e.defaultMinute,n=e.defaultSeconds;if(e.minDate!==void 0){let a=e.minDate.getHours(),i=e.minDate.getMinutes(),s=e.minDate.getSeconds();r<a&&(r=a),r===a&&t<i&&(t=i),r===a&&t===i&&n<s&&(n=e.minDate.getSeconds())}if(e.maxDate!==void 0){let a=e.maxDate.getHours(),i=e.maxDate.getMinutes();r=Math.min(r,a),r===a&&(t=Math.min(i,t)),r===a&&t===i&&(n=e.maxDate.getSeconds())}return{hours:r,minutes:t,seconds:n}}typeof Object.assign!="function"&&(Object.assign=function(e,...r){if(!e)throw TypeError("Cannot convert undefined or null to object");for(let t of r)t&&Object.keys(t).forEach(n=>e[n]=t[n]);return e});var gd=300;function hd(e,r){let t={config:Object.assign(Object.assign({},Zt),Le.defaultConfig),l10n:gr};t.parseDate=Yn({config:t.config,l10n:t.l10n}),t._handlers=[],t.pluginElements=[],t.loadedPlugins=[],t._bind=D,t._setHoursFromDate=u,t._positionCalendar=tt,t.changeMonth=A,t.changeYear=ht,t.clear=ee,t.close=ue,t._createElement=ve,t.destroy=ge,t.isEnabled=qe,t.jumpToDate=re,t.open=mt,t.redraw=Nt,t.set=tn,t.setDate=rn,t.toggle=ln;function n(){t.utils={getDaysInMonth(m=t.currentMonth,v=t.currentYear){return m===1&&(v%4==0&&v%100!=0||v%400==0)?29:t.l10n.daysInMonth[m]}}}function a(){t.element=t.input=e,t.isOpen=!1,Rt(),St(),an(),nn(),n(),t.isMobile||J(),U(),(t.selectedDates.length||t.config.noCalendar)&&(t.config.enableTime&&u(t.config.noCalendar?t.latestSelectedDateObj:void 0),rt(!1)),s();let m=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!t.isMobile&&m&&tt(),we("onReady")}function i(m){return m.bind(t)}function s(){let m=t.config;m.weekNumbers===!1&&m.showMonths===1||m.noCalendar!==!0&&window.requestAnimationFrame(function(){if(t.calendarContainer!==void 0&&(t.calendarContainer.style.visibility="hidden",t.calendarContainer.style.display="block"),t.daysContainer!==void 0){let v=(t.days.offsetWidth+1)*m.showMonths;t.daysContainer.style.width=v+"px",t.calendarContainer.style.width=v+(t.weekWrapper!==void 0?t.weekWrapper.offsetWidth:0)+"px",t.calendarContainer.style.removeProperty("visibility"),t.calendarContainer.style.removeProperty("display")}})}function o(m){if(t.selectedDates.length===0){let S=t.config.minDate===void 0||Ye(new Date,t.config.minDate)>=0?new Date:new Date(t.config.minDate.getTime()),M=Wn(t.config);S.setHours(M.hours,M.minutes,M.seconds,S.getMilliseconds()),t.selectedDates=[S],t.latestSelectedDateObj=S}m!==void 0&&m.type!=="blur"&&un(m);let v=t._input.value;p(),rt(),t._input.value!==v&&t._debouncedChange()}function l(m,v){return m%12+12*Ke(v===t.l10n.amPM[1])}function f(m){switch(m%24){case 0:case 12:return 12;default:return m%12}}function p(){if(t.hourElement===void 0||t.minuteElement===void 0)return;let m=(parseInt(t.hourElement.value.slice(-2),10)||0)%24,v=(parseInt(t.minuteElement.value,10)||0)%60,S=t.secondElement!==void 0?(parseInt(t.secondElement.value,10)||0)%60:0;t.amPM!==void 0&&(m=l(m,t.amPM.textContent));let M=t.config.minTime!==void 0||t.config.minDate&&t.minDateHasTime&&t.latestSelectedDateObj&&Ye(t.latestSelectedDateObj,t.config.minDate,!0)===0;if(t.config.maxTime!==void 0||t.config.maxDate&&t.maxDateHasTime&&t.latestSelectedDateObj&&Ye(t.latestSelectedDateObj,t.config.maxDate,!0)===0){let I=t.config.maxTime!==void 0?t.config.maxTime:t.config.maxDate;m=Math.min(m,I.getHours()),m===I.getHours()&&(v=Math.min(v,I.getMinutes())),v===I.getMinutes()&&(S=Math.min(S,I.getSeconds()))}if(M){let I=t.config.minTime!==void 0?t.config.minTime:t.config.minDate;m=Math.max(m,I.getHours()),m===I.getHours()&&v<I.getMinutes()&&(v=I.getMinutes()),v===I.getMinutes()&&(S=Math.max(S,I.getSeconds()))}h(m,v,S)}function u(m){let v=m||t.latestSelectedDateObj;v&&h(v.getHours(),v.getMinutes(),v.getSeconds())}function h(m,v,S){t.latestSelectedDateObj!==void 0&&t.latestSelectedDateObj.setHours(m%24,v,S||0,0),!(!t.hourElement||!t.minuteElement||t.isMobile)&&(t.hourElement.value=Ne(t.config.time_24hr?m:(12+m)%12+12*Ke(m%12==0)),t.minuteElement.value=Ne(v),t.amPM!==void 0&&(t.amPM.textContent=t.l10n.amPM[Ke(m>=12)]),t.secondElement!==void 0&&(t.secondElement.value=Ne(S)))}function w(m){let v=Ue(m),S=parseInt(v.value)+(m.delta||0);(S/1e3>1||m.key==="Enter"&&!/[^\d]/.test(S.toString()))&&ht(S)}function D(m,v,S,M){if(v instanceof Array)return v.forEach(Y=>D(m,Y,S,M));if(m instanceof Array)return m.forEach(Y=>D(Y,v,S,M));m.addEventListener(v,S,M),t._handlers.push({remove:()=>m.removeEventListener(v,S)})}function Z(){we("onChange")}function U(){if(t.config.wrap&&["open","close","toggle","clear"].forEach(v=>{Array.prototype.forEach.call(t.element.querySelectorAll(`[data-${v}]`),S=>D(S,"click",t[v]))}),t.isMobile){on();return}let m=fi(xt,50);if(t._debouncedChange=fi(Z,gd),t.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&D(t.daysContainer,"mouseover",v=>{t.config.mode==="range"&&et(Ue(v))}),D(window.document.body,"keydown",pt),!t.config.inline&&!t.config.static&&D(window,"resize",m),window.ontouchstart!==void 0?D(window.document,"touchstart",Me):D(window.document,"mousedown",Me),D(window.document,"focus",Me,{capture:!0}),t.config.clickOpens===!0&&(D(t._input,"focus",t.open),D(t._input,"click",t.open)),t.daysContainer!==void 0&&(D(t.monthNav,"click",cn),D(t.monthNav,["keyup","increment"],w),D(t.daysContainer,"click",Bt)),t.timeContainer!==void 0&&t.minuteElement!==void 0&&t.hourElement!==void 0){let v=S=>Ue(S).select();D(t.timeContainer,["increment"],o),D(t.timeContainer,"blur",o,{capture:!0}),D(t.timeContainer,"click",F),D([t.hourElement,t.minuteElement],["focus","click"],v),t.secondElement!==void 0&&D(t.secondElement,"focus",()=>t.secondElement&&t.secondElement.select()),t.amPM!==void 0&&D(t.amPM,"click",S=>{o(S),Z()})}t.config.allowInput&&D(t._input,"blur",ir)}function re(m,v){let S=m!==void 0?t.parseDate(m):t.latestSelectedDateObj||(t.config.minDate&&t.config.minDate>t.now?t.config.minDate:t.config.maxDate&&t.config.maxDate<t.now?t.config.maxDate:t.now),M=t.currentYear,Y=t.currentMonth;try{S!==void 0&&(t.currentYear=S.getFullYear(),t.currentMonth=S.getMonth())}catch(I){I.message="Invalid date supplied: "+S,t.config.errorHandler(I)}v&&t.currentYear!==M&&(we("onYearChange"),P()),v&&(t.currentYear!==M||t.currentMonth!==Y)&&we("onMonthChange"),t.redraw()}function F(m){let v=Ue(m);~v.className.indexOf("arrow")&&ie(m,v.classList.contains("arrowUp")?1:-1)}function ie(m,v,S){let M=m&&Ue(m),Y=S||M&&M.parentNode&&M.parentNode.firstChild,I=or("increment");I.delta=v,Y&&Y.dispatchEvent(I)}function J(){let m=window.document.createDocumentFragment();if(t.calendarContainer=ve("div","flatpickr-calendar"),t.calendarContainer.tabIndex=-1,!t.config.noCalendar){if(m.appendChild(L()),t.innerContainer=ve("div","flatpickr-innerContainer"),t.config.weekNumbers){let{weekWrapper:S,weekNumbers:M}=x();t.innerContainer.appendChild(S),t.weekNumbers=M,t.weekWrapper=S}t.rContainer=ve("div","flatpickr-rContainer"),t.rContainer.appendChild(N()),t.daysContainer||(t.daysContainer=ve("div","flatpickr-days"),t.daysContainer.tabIndex=-1),z(),t.rContainer.appendChild(t.daysContainer),t.innerContainer.appendChild(t.rContainer),m.appendChild(t.innerContainer)}t.config.enableTime&&m.appendChild(V()),Pe(t.calendarContainer,"rangeMode",t.config.mode==="range"),Pe(t.calendarContainer,"animate",t.config.animate===!0),Pe(t.calendarContainer,"multiMonth",t.config.showMonths>1),t.calendarContainer.appendChild(m);let v=t.config.appendTo!==void 0&&t.config.appendTo.nodeType!==void 0;if((t.config.inline||t.config.static)&&(t.calendarContainer.classList.add(t.config.inline?"inline":"static"),t.config.inline&&(!v&&t.element.parentNode?t.element.parentNode.insertBefore(t.calendarContainer,t._input.nextSibling):t.config.appendTo!==void 0&&t.config.appendTo.appendChild(t.calendarContainer)),t.config.static)){let S=ve("div","flatpickr-wrapper");t.element.parentNode&&t.element.parentNode.insertBefore(S,t.element),S.appendChild(t.element),t.altInput&&S.appendChild(t.altInput),S.appendChild(t.calendarContainer)}!t.config.static&&!t.config.inline&&(t.config.appendTo!==void 0?t.config.appendTo:window.document.body).appendChild(t.calendarContainer)}function $e(m,v,S,M){let Y=qe(v,!0),I=ve("span","flatpickr-day "+m,v.getDate().toString());return I.dateObj=v,I.$i=M,I.setAttribute("aria-label",t.formatDate(v,t.config.ariaDateFormat)),m.indexOf("hidden")===-1&&Ye(v,t.now)===0&&(t.todayDateElem=I,I.classList.add("today"),I.setAttribute("aria-current","date")),Y?(I.tabIndex=-1,Gt(v)&&(I.classList.add("selected"),t.selectedDateElem=I,t.config.mode==="range"&&(Pe(I,"startRange",t.selectedDates[0]&&Ye(v,t.selectedDates[0],!0)===0),Pe(I,"endRange",t.selectedDates[1]&&Ye(v,t.selectedDates[1],!0)===0),m==="nextMonthDay"&&I.classList.add("inRange")))):I.classList.add("flatpickr-disabled"),t.config.mode==="range"&&sn(v)&&!Gt(v)&&I.classList.add("inRange"),t.weekNumbers&&t.config.showMonths===1&&m!=="prevMonthDay"&&S%7==1&&t.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+t.config.getWeek(v)+"</span>"),we("onDayCreate",I),I}function Je(m){m.focus(),t.config.mode==="range"&&et(m)}function ze(m){let v=m>0?0:t.config.showMonths-1,S=m>0?t.config.showMonths:-1;for(let M=v;M!=S;M+=m){let Y=t.daysContainer.children[M],I=m>0?0:Y.children.length-1,te=m>0?Y.children.length:-1;for(let Q=I;Q!=te;Q+=m){let oe=Y.children[Q];if(oe.className.indexOf("hidden")===-1&&qe(oe.dateObj))return oe}}}function $(m,v){let S=m.className.indexOf("Month")===-1?m.dateObj.getMonth():t.currentMonth,M=v>0?t.config.showMonths:-1,Y=v>0?1:-1;for(let I=S-t.currentMonth;I!=M;I+=Y){let te=t.daysContainer.children[I],Q=S-t.currentMonth===I?m.$i+v:v<0?te.children.length-1:0,oe=te.children.length;for(let se=Q;se>=0&&se<oe&&se!=(v>0?oe:-1);se+=Y){let he=te.children[se];if(he.className.indexOf("hidden")===-1&&qe(he.dateObj)&&Math.abs(m.$i-se)>=Math.abs(v))return Je(he)}}t.changeMonth(Y),G(ze(Y),0)}function G(m,v){let S=Ze(document.activeElement||document.body),M=m!==void 0?m:S?document.activeElement:t.selectedDateElem!==void 0&&Ze(t.selectedDateElem)?t.selectedDateElem:t.todayDateElem!==void 0&&Ze(t.todayDateElem)?t.todayDateElem:ze(v>0?1:-1);M===void 0?t._input.focus():S?$(M,v):Je(M)}function q(m,v){let S=(new Date(m,v,1).getDay()-t.l10n.firstDayOfWeek+7)%7,M=t.utils.getDaysInMonth((v-1+12)%12,m),Y=t.utils.getDaysInMonth(v,m),I=window.document.createDocumentFragment(),te=t.config.showMonths>1,Q=te?"prevMonthDay hidden":"prevMonthDay",oe=te?"nextMonthDay hidden":"nextMonthDay",se=M+1-S,he=0;for(;se<=M;se++,he++)I.appendChild($e(Q,new Date(m,v-1,se),se,he));for(se=1;se<=Y;se++,he++)I.appendChild($e("",new Date(m,v,se),se,he));for(let De=Y+1;De<=42-S&&(t.config.showMonths===1||he%7!=0);De++,he++)I.appendChild($e(oe,new Date(m,v+1,De%Y),De,he));let Ie=ve("div","dayContainer");return Ie.appendChild(I),Ie}function z(){if(t.daysContainer===void 0)return;Dr(t.daysContainer),t.weekNumbers&&Dr(t.weekNumbers);let m=document.createDocumentFragment();for(let v=0;v<t.config.showMonths;v++){let S=new Date(t.currentYear,t.currentMonth,1);S.setMonth(t.currentMonth+v),m.appendChild(q(S.getFullYear(),S.getMonth()))}t.daysContainer.appendChild(m),t.days=t.daysContainer.firstChild,t.config.mode==="range"&&t.selectedDates.length===1&&et()}function P(){if(t.config.showMonths>1||t.config.monthSelectorType!=="dropdown")return;let m=function(v){return t.config.minDate!==void 0&&t.currentYear===t.config.minDate.getFullYear()&&v<t.config.minDate.getMonth()?!1:!(t.config.maxDate!==void 0&&t.currentYear===t.config.maxDate.getFullYear()&&v>t.config.maxDate.getMonth())};t.monthsDropdownContainer.tabIndex=-1,t.monthsDropdownContainer.innerHTML="";for(let v=0;v<12;v++){if(!m(v))continue;let S=ve("option","flatpickr-monthDropdown-month");S.value=new Date(t.currentYear,v).getMonth().toString(),S.textContent=Ar(v,t.config.shorthandCurrentMonth,t.l10n),S.tabIndex=-1,t.currentMonth===v&&(S.selected=!0),t.monthsDropdownContainer.appendChild(S)}}function E(){let m=ve("div","flatpickr-month"),v=window.document.createDocumentFragment(),S;t.config.showMonths>1||t.config.monthSelectorType==="static"?S=ve("span","cur-month"):(t.monthsDropdownContainer=ve("select","flatpickr-monthDropdown-months"),t.monthsDropdownContainer.setAttribute("aria-label",t.l10n.monthAriaLabel),D(t.monthsDropdownContainer,"change",te=>{let Q=Ue(te),oe=parseInt(Q.value,10);t.changeMonth(oe-t.currentMonth),we("onMonthChange")}),P(),S=t.monthsDropdownContainer);let M=Or("cur-year",{tabindex:"-1"}),Y=M.getElementsByTagName("input")[0];Y.setAttribute("aria-label",t.l10n.yearAriaLabel),t.config.minDate&&Y.setAttribute("min",t.config.minDate.getFullYear().toString()),t.config.maxDate&&(Y.setAttribute("max",t.config.maxDate.getFullYear().toString()),Y.disabled=!!t.config.minDate&&t.config.minDate.getFullYear()===t.config.maxDate.getFullYear());let I=ve("div","flatpickr-current-month");return I.appendChild(S),I.appendChild(M),v.appendChild(I),m.appendChild(v),{container:m,yearElement:Y,monthElement:S}}function C(){Dr(t.monthNav),t.monthNav.appendChild(t.prevMonthNav),t.config.showMonths&&(t.yearElements=[],t.monthElements=[]);for(let m=t.config.showMonths;m--;){let v=E();t.yearElements.push(v.yearElement),t.monthElements.push(v.monthElement),t.monthNav.appendChild(v.container)}t.monthNav.appendChild(t.nextMonthNav)}function L(){return t.monthNav=ve("div","flatpickr-months"),t.yearElements=[],t.monthElements=[],t.prevMonthNav=ve("span","flatpickr-prev-month"),t.prevMonthNav.innerHTML=t.config.prevArrow,t.nextMonthNav=ve("span","flatpickr-next-month"),t.nextMonthNav.innerHTML=t.config.nextArrow,C(),Object.defineProperty(t,"_hidePrevMonthArrow",{get:()=>t.__hidePrevMonthArrow,set(m){t.__hidePrevMonthArrow!==m&&(Pe(t.prevMonthNav,"flatpickr-disabled",m),t.__hidePrevMonthArrow=m)}}),Object.defineProperty(t,"_hideNextMonthArrow",{get:()=>t.__hideNextMonthArrow,set(m){t.__hideNextMonthArrow!==m&&(Pe(t.nextMonthNav,"flatpickr-disabled",m),t.__hideNextMonthArrow=m)}}),t.currentYearElement=t.yearElements[0],qt(),t.monthNav}function V(){t.calendarContainer.classList.add("hasTime"),t.config.noCalendar&&t.calendarContainer.classList.add("noCalendar");let m=Wn(t.config);t.timeContainer=ve("div","flatpickr-time"),t.timeContainer.tabIndex=-1;let v=ve("span","flatpickr-time-separator",":"),S=Or("flatpickr-hour",{"aria-label":t.l10n.hourAriaLabel});t.hourElement=S.getElementsByTagName("input")[0];let M=Or("flatpickr-minute",{"aria-label":t.l10n.minuteAriaLabel});if(t.minuteElement=M.getElementsByTagName("input")[0],t.hourElement.tabIndex=t.minuteElement.tabIndex=-1,t.hourElement.value=Ne(t.latestSelectedDateObj?t.latestSelectedDateObj.getHours():t.config.time_24hr?m.hours:f(m.hours)),t.minuteElement.value=Ne(t.latestSelectedDateObj?t.latestSelectedDateObj.getMinutes():m.minutes),t.hourElement.setAttribute("step",t.config.hourIncrement.toString()),t.minuteElement.setAttribute("step",t.config.minuteIncrement.toString()),t.hourElement.setAttribute("min",t.config.time_24hr?"0":"1"),t.hourElement.setAttribute("max",t.config.time_24hr?"23":"12"),t.hourElement.setAttribute("maxlength","2"),t.minuteElement.setAttribute("min","0"),t.minuteElement.setAttribute("max","59"),t.minuteElement.setAttribute("maxlength","2"),t.timeContainer.appendChild(S),t.timeContainer.appendChild(v),t.timeContainer.appendChild(M),t.config.time_24hr&&t.timeContainer.classList.add("time24hr"),t.config.enableSeconds){t.timeContainer.classList.add("hasSeconds");let Y=Or("flatpickr-second");t.secondElement=Y.getElementsByTagName("input")[0],t.secondElement.value=Ne(t.latestSelectedDateObj?t.latestSelectedDateObj.getSeconds():m.seconds),t.secondElement.setAttribute("step",t.minuteElement.getAttribute("step")),t.secondElement.setAttribute("min","0"),t.secondElement.setAttribute("max","59"),t.secondElement.setAttribute("maxlength","2"),t.timeContainer.appendChild(ve("span","flatpickr-time-separator",":")),t.timeContainer.appendChild(Y)}return t.config.time_24hr||(t.amPM=ve("span","flatpickr-am-pm",t.l10n.amPM[Ke((t.latestSelectedDateObj?t.hourElement.value:t.config.defaultHour)>11)]),t.amPM.title=t.l10n.toggleTitle,t.amPM.tabIndex=-1,t.timeContainer.appendChild(t.amPM)),t.timeContainer}function N(){t.weekdayContainer?Dr(t.weekdayContainer):t.weekdayContainer=ve("div","flatpickr-weekdays");for(let m=t.config.showMonths;m--;){let v=ve("div","flatpickr-weekdaycontainer");t.weekdayContainer.appendChild(v)}return W(),t.weekdayContainer}function W(){if(!t.weekdayContainer)return;let m=t.l10n.firstDayOfWeek,v=[...t.l10n.weekdays.shorthand];m>0&&m<v.length&&(v=[...v.splice(m,v.length),...v.splice(0,m)]);for(let S=t.config.showMonths;S--;)t.weekdayContainer.children[S].innerHTML=`
      <span class='flatpickr-weekday'>
        ${v.join("</span><span class='flatpickr-weekday'>")}
      </span>
      `}function x(){t.calendarContainer.classList.add("hasWeeks");let m=ve("div","flatpickr-weekwrapper");m.appendChild(ve("span","flatpickr-weekday",t.l10n.weekAbbreviation));let v=ve("div","flatpickr-weeks");return m.appendChild(v),{weekWrapper:m,weekNumbers:v}}function A(m,v=!0){let S=v?m:m-t.currentMonth;S<0&&t._hidePrevMonthArrow===!0||S>0&&t._hideNextMonthArrow===!0||(t.currentMonth+=S,(t.currentMonth<0||t.currentMonth>11)&&(t.currentYear+=t.currentMonth>11?1:-1,t.currentMonth=(t.currentMonth+12)%12,we("onYearChange"),P()),z(),we("onMonthChange"),qt())}function ee(m=!0,v=!0){if(t.input.value="",t.altInput!==void 0&&(t.altInput.value=""),t.mobileInput!==void 0&&(t.mobileInput.value=""),t.selectedDates=[],t.latestSelectedDateObj=void 0,v===!0&&(t.currentYear=t._initialDate.getFullYear(),t.currentMonth=t._initialDate.getMonth()),t.config.enableTime===!0){let{hours:S,minutes:M,seconds:Y}=Wn(t.config);h(S,M,Y)}t.redraw(),m&&we("onChange")}function ue(){t.isOpen=!1,t.isMobile||(t.calendarContainer!==void 0&&t.calendarContainer.classList.remove("open"),t._input!==void 0&&t._input.classList.remove("active")),we("onClose")}function ge(){t.config!==void 0&&we("onDestroy");for(let m=t._handlers.length;m--;)t._handlers[m].remove();if(t._handlers=[],t.mobileInput)t.mobileInput.parentNode&&t.mobileInput.parentNode.removeChild(t.mobileInput),t.mobileInput=void 0;else if(t.calendarContainer&&t.calendarContainer.parentNode)if(t.config.static&&t.calendarContainer.parentNode){let m=t.calendarContainer.parentNode;if(m.lastChild&&m.removeChild(m.lastChild),m.parentNode){for(;m.firstChild;)m.parentNode.insertBefore(m.firstChild,m);m.parentNode.removeChild(m)}}else t.calendarContainer.parentNode.removeChild(t.calendarContainer);t.altInput&&(t.input.type="text",t.altInput.parentNode&&t.altInput.parentNode.removeChild(t.altInput),delete t.altInput),t.input&&(t.input.type=t.input._type,t.input.classList.remove("flatpickr-input"),t.input.removeAttribute("readonly")),["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach(m=>{try{delete t[m]}catch(v){}})}function be(m){return t.config.appendTo&&t.config.appendTo.contains(m)?!0:t.calendarContainer.contains(m)}function Me(m){if(t.isOpen&&!t.config.inline){let v=Ue(m),S=be(v),M=v===t.input||v===t.altInput||t.element.contains(v)||m.path&&m.path.indexOf&&(~m.path.indexOf(t.input)||~m.path.indexOf(t.altInput)),Y=m.type==="blur"?M&&m.relatedTarget&&!be(m.relatedTarget):!M&&!S&&!be(m.relatedTarget),I=!t.config.ignoredFocusElements.some(te=>te.contains(v));Y&&I&&(t.timeContainer!==void 0&&t.minuteElement!==void 0&&t.hourElement!==void 0&&t.input.value!==""&&t.input.value!==void 0&&o(),t.close(),t.config&&t.config.mode==="range"&&t.selectedDates.length===1&&(t.clear(!1),t.redraw()))}}function ht(m){if(!m||t.config.minDate&&m<t.config.minDate.getFullYear()||t.config.maxDate&&m>t.config.maxDate.getFullYear())return;let v=m,S=t.currentYear!==v;t.currentYear=v||t.currentYear,t.config.maxDate&&t.currentYear===t.config.maxDate.getFullYear()?t.currentMonth=Math.min(t.config.maxDate.getMonth(),t.currentMonth):t.config.minDate&&t.currentYear===t.config.minDate.getFullYear()&&(t.currentMonth=Math.max(t.config.minDate.getMonth(),t.currentMonth)),S&&(t.redraw(),we("onYearChange"),P())}function qe(m,v=!0){var S;let M=t.parseDate(m,void 0,v);if(t.config.minDate&&M&&Ye(M,t.config.minDate,v!==void 0?v:!t.minDateHasTime)<0||t.config.maxDate&&M&&Ye(M,t.config.maxDate,v!==void 0?v:!t.maxDateHasTime)>0)return!1;if(!t.config.enable&&t.config.disable.length===0)return!0;if(M===void 0)return!1;let Y=!!t.config.enable,I=(S=t.config.enable)!==null&&S!==void 0?S:t.config.disable;for(let te=0,Q;te<I.length;te++){if(Q=I[te],typeof Q=="function"&&Q(M))return Y;if(Q instanceof Date&&M!==void 0&&Q.getTime()===M.getTime())return Y;if(typeof Q=="string"){let oe=t.parseDate(Q,void 0,!0);return oe&&oe.getTime()===M.getTime()?Y:!Y}else if(typeof Q=="object"&&M!==void 0&&Q.from&&Q.to&&M.getTime()>=Q.from.getTime()&&M.getTime()<=Q.to.getTime())return Y}return!Y}function Ze(m){return t.daysContainer!==void 0?m.className.indexOf("hidden")===-1&&m.className.indexOf("flatpickr-disabled")===-1&&t.daysContainer.contains(m):!1}function ir(m){m.target===t._input&&(t.selectedDates.length>0||t._input.value.length>0)&&!(m.relatedTarget&&be(m.relatedTarget))&&t.setDate(t._input.value,!0,m.target===t.altInput?t.config.altFormat:t.config.dateFormat)}function pt(m){let v=Ue(m),S=t.config.wrap?e.contains(v):v===t._input,M=t.config.allowInput,Y=t.isOpen&&(!M||!S),I=t.config.inline&&S&&!M;if(m.keyCode===13&&S){if(M)return t.setDate(t._input.value,!0,v===t.altInput?t.config.altFormat:t.config.dateFormat),v.blur();t.open()}else if(be(v)||Y||I){let te=!!t.timeContainer&&t.timeContainer.contains(v);switch(m.keyCode){case 13:te?(m.preventDefault(),o(),lt()):Bt(m);break;case 27:m.preventDefault(),lt();break;case 8:case 46:S&&!t.config.allowInput&&(m.preventDefault(),t.clear());break;case 37:case 39:if(!te&&!S){if(m.preventDefault(),t.daysContainer!==void 0&&(M===!1||document.activeElement&&Ze(document.activeElement))){let oe=m.keyCode===39?1:-1;m.ctrlKey?(m.stopPropagation(),A(oe),G(ze(1),0)):G(void 0,oe)}}else t.hourElement&&t.hourElement.focus();break;case 38:case 40:m.preventDefault();let Q=m.keyCode===40?1:-1;t.daysContainer&&v.$i!==void 0||v===t.input||v===t.altInput?m.ctrlKey?(m.stopPropagation(),ht(t.currentYear-Q),G(ze(1),0)):te||G(void 0,Q*7):v===t.currentYearElement?ht(t.currentYear-Q):t.config.enableTime&&(!te&&t.hourElement&&t.hourElement.focus(),o(m),t._debouncedChange());break;case 9:if(te){let oe=[t.hourElement,t.minuteElement,t.secondElement,t.amPM].concat(t.pluginElements).filter(he=>he),se=oe.indexOf(v);if(se!==-1){let he=oe[se+(m.shiftKey?-1:1)];m.preventDefault(),(he||t._input).focus()}}else!t.config.noCalendar&&t.daysContainer&&t.daysContainer.contains(v)&&m.shiftKey&&(m.preventDefault(),t._input.focus());break}}if(t.amPM!==void 0&&v===t.amPM)switch(m.key){case t.l10n.amPM[0].charAt(0):case t.l10n.amPM[0].charAt(0).toLowerCase():t.amPM.textContent=t.l10n.amPM[0],p(),rt();break;case t.l10n.amPM[1].charAt(0):case t.l10n.amPM[1].charAt(0).toLowerCase():t.amPM.textContent=t.l10n.amPM[1],p(),rt();break}(S||be(v))&&we("onKeyDown",m)}function et(m){if(t.selectedDates.length!==1||m&&(!m.classList.contains("flatpickr-day")||m.classList.contains("flatpickr-disabled")))return;let v=m?m.dateObj.getTime():t.days.firstElementChild.dateObj.getTime(),S=t.parseDate(t.selectedDates[0],void 0,!0).getTime(),M=Math.min(v,t.selectedDates[0].getTime()),Y=Math.max(v,t.selectedDates[0].getTime()),I=!1,te=0,Q=0;for(let oe=M;oe<Y;oe+=fd.DAY)qe(new Date(oe),!0)||(I=I||oe>M&&oe<Y,oe<S&&(!te||oe>te)?te=oe:oe>S&&(!Q||oe<Q)&&(Q=oe));for(let oe=0;oe<t.config.showMonths;oe++){let se=t.daysContainer.children[oe];for(let he=0,Ie=se.children.length;he<Ie;he++){let De=se.children[he],Xe=De.dateObj.getTime(),jt=te>0&&Xe<te||Q>0&&Xe>Q;if(jt){De.classList.add("notAllowed"),["inRange","startRange","endRange"].forEach(Tt=>{De.classList.remove(Tt)});continue}else if(I&&!jt)continue;["startRange","inRange","endRange","notAllowed"].forEach(Tt=>{De.classList.remove(Tt)}),m!==void 0&&(m.classList.add(v<=t.selectedDates[0].getTime()?"startRange":"endRange"),S<v&&Xe===S?De.classList.add("startRange"):S>v&&Xe===S&&De.classList.add("endRange"),Xe>=te&&(Q===0||Xe<=Q)&&pd(Xe,S,v)&&De.classList.add("inRange"))}}}function xt(){t.isOpen&&!t.config.static&&!t.config.inline&&tt()}function mt(m,v=t._positionElement){if(t.isMobile===!0){if(m){m.preventDefault();let M=Ue(m);M&&M.blur()}t.mobileInput!==void 0&&(t.mobileInput.focus(),t.mobileInput.click()),we("onOpen");return}else if(t._input.disabled||t.config.inline)return;let S=t.isOpen;t.isOpen=!0,S||(t.calendarContainer.classList.add("open"),t._input.classList.add("active"),we("onOpen"),tt(v)),t.config.enableTime===!0&&t.config.noCalendar===!0&&t.config.allowInput===!1&&(m===void 0||!t.timeContainer.contains(m.relatedTarget))&&setTimeout(()=>t.hourElement.select(),50)}function ot(m){return v=>{let S=t.config[`_${m}Date`]=t.parseDate(v,t.config.dateFormat),M=t.config[`_${m==="min"?"max":"min"}Date`];S!==void 0&&(t[m==="min"?"minDateHasTime":"maxDateHasTime"]=S.getHours()>0||S.getMinutes()>0||S.getSeconds()>0),t.selectedDates&&(t.selectedDates=t.selectedDates.filter(Y=>qe(Y)),!t.selectedDates.length&&m==="min"&&u(S),rt()),t.daysContainer&&(Nt(),S!==void 0?t.currentYearElement[m]=S.getFullYear().toString():t.currentYearElement.removeAttribute(m),t.currentYearElement.disabled=!!M&&S!==void 0&&M.getFullYear()===S.getFullYear())}}function Rt(){let m=["wrap","weekNumbers","allowInput","allowInvalidPreload","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],v=Object.assign(Object.assign({},JSON.parse(JSON.stringify(e.dataset||{}))),r),S={};t.config.parseDate=v.parseDate,t.config.formatDate=v.formatDate,Object.defineProperty(t.config,"enable",{get:()=>t.config._enable,set:I=>{t.config._enable=Er(I)}}),Object.defineProperty(t.config,"disable",{get:()=>t.config._disable,set:I=>{t.config._disable=Er(I)}});let M=v.mode==="time";if(!v.dateFormat&&(v.enableTime||M)){let I=Le.defaultConfig.dateFormat||Zt.dateFormat;S.dateFormat=v.noCalendar||M?"H:i"+(v.enableSeconds?":S":""):I+" H:i"+(v.enableSeconds?":S":"")}if(v.altInput&&(v.enableTime||M)&&!v.altFormat){let I=Le.defaultConfig.altFormat||Zt.altFormat;S.altFormat=v.noCalendar||M?"h:i"+(v.enableSeconds?":S K":" K"):I+` h:i${v.enableSeconds?":S":""} K`}Object.defineProperty(t.config,"minDate",{get:()=>t.config._minDate,set:ot("min")}),Object.defineProperty(t.config,"maxDate",{get:()=>t.config._maxDate,set:ot("max")});let Y=I=>te=>{t.config[I==="min"?"_minTime":"_maxTime"]=t.parseDate(te,"H:i:S")};Object.defineProperty(t.config,"minTime",{get:()=>t.config._minTime,set:Y("min")}),Object.defineProperty(t.config,"maxTime",{get:()=>t.config._maxTime,set:Y("max")}),v.mode==="time"&&(t.config.noCalendar=!0,t.config.enableTime=!0),Object.assign(t.config,S,v);for(let I=0;I<m.length;I++)t.config[m[I]]=t.config[m[I]]===!0||t.config[m[I]]==="true";Gn.filter(I=>t.config[I]!==void 0).forEach(I=>{t.config[I]=qn(t.config[I]||[]).map(i)}),t.isMobile=!t.config.disableMobile&&!t.config.inline&&t.config.mode==="single"&&!t.config.disable.length&&!t.config.enable&&!t.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);for(let I=0;I<t.config.plugins.length;I++){let te=t.config.plugins[I](t)||{};for(let Q in te)Gn.indexOf(Q)>-1?t.config[Q]=qn(te[Q]).map(i).concat(t.config[Q]):typeof v[Q]=="undefined"&&(t.config[Q]=te[Q])}v.altInputClass||(t.config.altInputClass=ft().className+" "+t.config.altInputClass),we("onParseConfig")}function ft(){return t.config.wrap?e.querySelector("[data-input]"):e}function St(){typeof t.config.locale!="object"&&typeof Le.l10ns[t.config.locale]=="undefined"&&t.config.errorHandler(new Error(`flatpickr: invalid locale ${t.config.locale}`)),t.l10n=Object.assign(Object.assign({},Le.l10ns.default),typeof t.config.locale=="object"?t.config.locale:t.config.locale!=="default"?Le.l10ns[t.config.locale]:void 0),Un.K=`(${t.l10n.amPM[0]}|${t.l10n.amPM[1]}|${t.l10n.amPM[0].toLowerCase()}|${t.l10n.amPM[1].toLowerCase()})`,Object.assign(Object.assign({},r),JSON.parse(JSON.stringify(e.dataset||{}))).time_24hr===void 0&&Le.defaultConfig.time_24hr===void 0&&(t.config.time_24hr=t.l10n.time_24hr),t.formatDate=hi(t),t.parseDate=Yn({config:t.config,l10n:t.l10n})}function tt(m){if(typeof t.config.position=="function")return void t.config.position(t,m);if(t.calendarContainer===void 0)return;we("onPreCalendarPosition");let v=m||t._positionElement,S=Array.prototype.reduce.call(t.calendarContainer.children,(Lt,lr)=>Lt+lr.offsetHeight,0),M=t.calendarContainer.offsetWidth,Y=t.config.position.split(" "),I=Y[0],te=Y.length>1?Y[1]:null,Q=v.getBoundingClientRect(),oe=window.innerHeight-Q.bottom,se=I==="above"||I!=="below"&&oe<S&&Q.top>S,he=window.pageYOffset+Q.top+(se?-S-2:v.offsetHeight+2);if(Pe(t.calendarContainer,"arrowTop",!se),Pe(t.calendarContainer,"arrowBottom",se),t.config.inline)return;let Ie=window.pageXOffset+Q.left,De=!1,Vt=!1;te==="center"?(Ie-=(M-Q.width)/2,De=!0):te==="right"&&(Ie-=M-Q.width,Vt=!0),Pe(t.calendarContainer,"arrowLeft",!De&&!Vt),Pe(t.calendarContainer,"arrowCenter",De),Pe(t.calendarContainer,"arrowRight",Vt);let Xe=window.document.body.offsetWidth-(window.pageXOffset+Q.right),jt=Ie+M>window.document.body.offsetWidth,Tt=Xe+M>window.document.body.offsetWidth;if(Pe(t.calendarContainer,"rightMost",jt),!t.config.static)if(t.calendarContainer.style.top=`${he}px`,!jt)t.calendarContainer.style.left=`${Ie}px`,t.calendarContainer.style.right="auto";else if(!Tt)t.calendarContainer.style.left="auto",t.calendarContainer.style.right=`${Xe}px`;else{let Lt=Ht();if(Lt===void 0)return;let lr=window.document.body.offsetWidth,dn=Math.max(0,lr/2-M/2),pn=".flatpickr-calendar.centerMost:before",fn=".flatpickr-calendar.centerMost:after",gn=Lt.cssRules.length,hn=`{left:${Q.left}px;right:auto;}`;Pe(t.calendarContainer,"rightMost",!1),Pe(t.calendarContainer,"centerMost",!0),Lt.insertRule(`${pn},${fn}${hn}`,gn),t.calendarContainer.style.left=`${dn}px`,t.calendarContainer.style.right="auto"}}function Ht(){let m=null;for(let v=0;v<document.styleSheets.length;v++){let S=document.styleSheets[v];try{S.cssRules}catch(M){continue}m=S;break}return m??$t()}function $t(){let m=document.createElement("style");return document.head.appendChild(m),m.sheet}function Nt(){t.config.noCalendar||t.isMobile||(P(),qt(),z())}function lt(){t._input.focus(),window.navigator.userAgent.indexOf("MSIE")!==-1||navigator.msMaxTouchPoints!==void 0?setTimeout(t.close,0):t.close()}function Bt(m){m.preventDefault(),m.stopPropagation();let v=te=>te.classList&&te.classList.contains("flatpickr-day")&&!te.classList.contains("flatpickr-disabled")&&!te.classList.contains("notAllowed"),S=gi(Ue(m),v);if(S===void 0)return;let M=S,Y=t.latestSelectedDateObj=new Date(M.dateObj.getTime()),I=(Y.getMonth()<t.currentMonth||Y.getMonth()>t.currentMonth+t.config.showMonths-1)&&t.config.mode!=="range";if(t.selectedDateElem=M,t.config.mode==="single")t.selectedDates=[Y];else if(t.config.mode==="multiple"){let te=Gt(Y);te?t.selectedDates.splice(parseInt(te),1):t.selectedDates.push(Y)}else t.config.mode==="range"&&(t.selectedDates.length===2&&t.clear(!1,!1),t.latestSelectedDateObj=Y,t.selectedDates.push(Y),Ye(Y,t.selectedDates[0],!0)!==0&&t.selectedDates.sort((te,Q)=>te.getTime()-Q.getTime()));if(p(),I){let te=t.currentYear!==Y.getFullYear();t.currentYear=Y.getFullYear(),t.currentMonth=Y.getMonth(),te&&(we("onYearChange"),P()),we("onMonthChange")}if(qt(),z(),rt(),!I&&t.config.mode!=="range"&&t.config.showMonths===1?Je(M):t.selectedDateElem!==void 0&&t.hourElement===void 0&&t.selectedDateElem&&t.selectedDateElem.focus(),t.hourElement!==void 0&&t.hourElement!==void 0&&t.hourElement.focus(),t.config.closeOnSelect){let te=t.config.mode==="single"&&!t.config.enableTime,Q=t.config.mode==="range"&&t.selectedDates.length===2&&!t.config.enableTime;(te||Q)&&lt()}Z()}let st={locale:[St,W],showMonths:[C,s,N],minDate:[re],maxDate:[re],clickOpens:[()=>{t.config.clickOpens===!0?(D(t._input,"focus",t.open),D(t._input,"click",t.open)):(t._input.removeEventListener("focus",t.open),t._input.removeEventListener("click",t.open))}]};function tn(m,v){if(m!==null&&typeof m=="object"){Object.assign(t.config,m);for(let S in m)st[S]!==void 0&&st[S].forEach(M=>M())}else t.config[m]=v,st[m]!==void 0?st[m].forEach(S=>S()):Gn.indexOf(m)>-1&&(t.config[m]=qn(v));t.redraw(),rt(!0)}function Cr(m,v){let S=[];if(m instanceof Array)S=m.map(M=>t.parseDate(M,v));else if(m instanceof Date||typeof m=="number")S=[t.parseDate(m,v)];else if(typeof m=="string")switch(t.config.mode){case"single":case"time":S=[t.parseDate(m,v)];break;case"multiple":S=m.split(t.config.conjunction).map(M=>t.parseDate(M,v));break;case"range":S=m.split(t.l10n.rangeSeparator).map(M=>t.parseDate(M,v));break}else t.config.errorHandler(new Error(`Invalid date supplied: ${JSON.stringify(m)}`));t.selectedDates=t.config.allowInvalidPreload?S:S.filter(M=>M instanceof Date&&qe(M,!1)),t.config.mode==="range"&&t.selectedDates.sort((M,Y)=>M.getTime()-Y.getTime())}function rn(m,v=!1,S=t.config.dateFormat){if(m!==0&&!m||m instanceof Array&&m.length===0)return t.clear(v);Cr(m,S),t.latestSelectedDateObj=t.selectedDates[t.selectedDates.length-1],t.redraw(),re(void 0,v),u(),t.selectedDates.length===0&&t.clear(!1),rt(v),v&&we("onChange")}function Er(m){return m.slice().map(v=>typeof v=="string"||typeof v=="number"||v instanceof Date?t.parseDate(v,void 0,!0):v&&typeof v=="object"&&v.from&&v.to?{from:t.parseDate(v.from,void 0),to:t.parseDate(v.to,void 0)}:v).filter(v=>v)}function nn(){t.selectedDates=[],t.now=t.parseDate(t.config.now)||new Date;let m=t.config.defaultDate||((t.input.nodeName==="INPUT"||t.input.nodeName==="TEXTAREA")&&t.input.placeholder&&t.input.value===t.input.placeholder?null:t.input.value);m&&Cr(m,t.config.dateFormat),t._initialDate=t.selectedDates.length>0?t.selectedDates[0]:t.config.minDate&&t.config.minDate.getTime()>t.now.getTime()?t.config.minDate:t.config.maxDate&&t.config.maxDate.getTime()<t.now.getTime()?t.config.maxDate:t.now,t.currentYear=t._initialDate.getFullYear(),t.currentMonth=t._initialDate.getMonth(),t.selectedDates.length>0&&(t.latestSelectedDateObj=t.selectedDates[0]),t.config.minTime!==void 0&&(t.config.minTime=t.parseDate(t.config.minTime,"H:i")),t.config.maxTime!==void 0&&(t.config.maxTime=t.parseDate(t.config.maxTime,"H:i")),t.minDateHasTime=!!t.config.minDate&&(t.config.minDate.getHours()>0||t.config.minDate.getMinutes()>0||t.config.minDate.getSeconds()>0),t.maxDateHasTime=!!t.config.maxDate&&(t.config.maxDate.getHours()>0||t.config.maxDate.getMinutes()>0||t.config.maxDate.getSeconds()>0)}function an(){if(t.input=ft(),!t.input){t.config.errorHandler(new Error("Invalid input element specified"));return}t.input._type=t.input.type,t.input.type="text",t.input.classList.add("flatpickr-input"),t._input=t.input,t.config.altInput&&(t.altInput=ve(t.input.nodeName,t.config.altInputClass),t._input=t.altInput,t.altInput.placeholder=t.input.placeholder,t.altInput.disabled=t.input.disabled,t.altInput.required=t.input.required,t.altInput.tabIndex=t.input.tabIndex,t.altInput.type="text",t.input.setAttribute("type","hidden"),!t.config.static&&t.input.parentNode&&t.input.parentNode.insertBefore(t.altInput,t.input.nextSibling)),t.config.allowInput||t._input.setAttribute("readonly","readonly"),t._positionElement=t.config.positionElement||t._input}function on(){let m=t.config.enableTime?t.config.noCalendar?"time":"datetime-local":"date";t.mobileInput=ve("input",t.input.className+" flatpickr-mobile"),t.mobileInput.tabIndex=1,t.mobileInput.type=m,t.mobileInput.disabled=t.input.disabled,t.mobileInput.required=t.input.required,t.mobileInput.placeholder=t.input.placeholder,t.mobileFormatStr=m==="datetime-local"?"Y-m-d\\TH:i:S":m==="date"?"Y-m-d":"H:i:S",t.selectedDates.length>0&&(t.mobileInput.defaultValue=t.mobileInput.value=t.formatDate(t.selectedDates[0],t.mobileFormatStr)),t.config.minDate&&(t.mobileInput.min=t.formatDate(t.config.minDate,"Y-m-d")),t.config.maxDate&&(t.mobileInput.max=t.formatDate(t.config.maxDate,"Y-m-d")),t.input.getAttribute("step")&&(t.mobileInput.step=String(t.input.getAttribute("step"))),t.input.type="hidden",t.altInput!==void 0&&(t.altInput.type="hidden");try{t.input.parentNode&&t.input.parentNode.insertBefore(t.mobileInput,t.input.nextSibling)}catch(v){}D(t.mobileInput,"change",v=>{t.setDate(Ue(v).value,!1,t.mobileFormatStr),we("onChange"),we("onClose")})}function ln(m){if(t.isOpen===!0)return t.close();t.open(m)}function we(m,v){if(t.config===void 0)return;let S=t.config[m];if(S!==void 0&&S.length>0)for(let M=0;S[M]&&M<S.length;M++)S[M](t.selectedDates,t.input.value,t,v);m==="onChange"&&(t.input.dispatchEvent(or("change")),t.input.dispatchEvent(or("input")))}function or(m){let v=document.createEvent("Event");return v.initEvent(m,!0,!0),v}function Gt(m){for(let v=0;v<t.selectedDates.length;v++)if(Ye(t.selectedDates[v],m)===0)return""+v;return!1}function sn(m){return t.config.mode!=="range"||t.selectedDates.length<2?!1:Ye(m,t.selectedDates[0])>=0&&Ye(m,t.selectedDates[1])<=0}function qt(){t.config.noCalendar||t.isMobile||!t.monthNav||(t.yearElements.forEach((m,v)=>{let S=new Date(t.currentYear,t.currentMonth,1);S.setMonth(t.currentMonth+v),t.config.showMonths>1||t.config.monthSelectorType==="static"?t.monthElements[v].textContent=Ar(S.getMonth(),t.config.shorthandCurrentMonth,t.l10n)+" ":t.monthsDropdownContainer.value=S.getMonth().toString(),m.value=S.getFullYear().toString()}),t._hidePrevMonthArrow=t.config.minDate!==void 0&&(t.currentYear===t.config.minDate.getFullYear()?t.currentMonth<=t.config.minDate.getMonth():t.currentYear<t.config.minDate.getFullYear()),t._hideNextMonthArrow=t.config.maxDate!==void 0&&(t.currentYear===t.config.maxDate.getFullYear()?t.currentMonth+1>t.config.maxDate.getMonth():t.currentYear>t.config.maxDate.getFullYear()))}function Sr(m){return t.selectedDates.map(v=>t.formatDate(v,m)).filter((v,S,M)=>t.config.mode!=="range"||t.config.enableTime||M.indexOf(v)===S).join(t.config.mode!=="range"?t.config.conjunction:t.l10n.rangeSeparator)}function rt(m=!0){t.mobileInput!==void 0&&t.mobileFormatStr&&(t.mobileInput.value=t.latestSelectedDateObj!==void 0?t.formatDate(t.latestSelectedDateObj,t.mobileFormatStr):""),t.input.value=Sr(t.config.dateFormat),t.altInput!==void 0&&(t.altInput.value=Sr(t.config.altFormat)),m!==!1&&we("onValueUpdate")}function cn(m){let v=Ue(m),S=t.prevMonthNav.contains(v),M=t.nextMonthNav.contains(v);S||M?A(S?-1:1):t.yearElements.indexOf(v)>=0?v.select():v.classList.contains("arrowUp")?t.changeYear(t.currentYear+1):v.classList.contains("arrowDown")&&t.changeYear(t.currentYear-1)}function un(m){m.preventDefault();let v=m.type==="keydown",S=Ue(m),M=S;t.amPM!==void 0&&S===t.amPM&&(t.amPM.textContent=t.l10n.amPM[Ke(t.amPM.textContent===t.l10n.amPM[0])]);let Y=parseFloat(M.getAttribute("min")),I=parseFloat(M.getAttribute("max")),te=parseFloat(M.getAttribute("step")),Q=parseInt(M.value,10),oe=m.delta||(v?m.which===38?1:-1:0),se=Q+te*oe;if(typeof M.value!="undefined"&&M.value.length===2){let he=M===t.hourElement,Ie=M===t.minuteElement;se<Y?(se=I+se+Ke(!he)+(Ke(he)&&Ke(!t.amPM)),Ie&&ie(void 0,-1,t.hourElement)):se>I&&(se=M===t.hourElement?se-I-Ke(!t.amPM):Y,Ie&&ie(void 0,1,t.hourElement)),t.amPM&&he&&(te===1?se+Q===23:Math.abs(se-Q)>te)&&(t.amPM.textContent=t.l10n.amPM[Ke(t.amPM.textContent===t.l10n.amPM[0])]),M.value=Ne(se)}}return a(),t}function Xt(e,r){let t=Array.prototype.slice.call(e).filter(a=>a instanceof HTMLElement),n=[];for(let a=0;a<t.length;a++){let i=t[a];try{if(i.getAttribute("data-fp-omit")!==null)continue;i._flatpickr!==void 0&&(i._flatpickr.destroy(),i._flatpickr=void 0),i._flatpickr=hd(i,r||{}),n.push(i._flatpickr)}catch(s){console.error(s)}}return n.length===1?n[0]:n}typeof HTMLElement!="undefined"&&typeof HTMLCollection!="undefined"&&typeof NodeList!="undefined"&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(e){return Xt(this,e)},HTMLElement.prototype.flatpickr=function(e){return Xt([this],e)});var Le=function(e,r){return typeof e=="string"?Xt(window.document.querySelectorAll(e),r):e instanceof Node?Xt([e],r):Xt(e,r)};Le.defaultConfig={};Le.l10ns={en:Object.assign({},gr),default:Object.assign({},gr)};Le.localize=e=>{Le.l10ns.default=Object.assign(Object.assign({},Le.l10ns.default),e)};Le.setDefaults=e=>{Le.defaultConfig=Object.assign(Object.assign({},Le.defaultConfig),e)};Le.parseDate=Yn({});Le.formatDate=hi({});Le.compareDates=Ye;typeof jQuery!="undefined"&&typeof jQuery.fn!="undefined"&&(jQuery.fn.flatpickr=function(e){return Xt(this,e)});Date.prototype.fp_incr=function(e){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+(typeof e=="string"?parseInt(e,10):e))};typeof window!="undefined"&&(window.flatpickr=Le);var mi=Le;var We=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Kt(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Qe(e,r,t){return t={path:r,exports:{},require:function(n,a){return md(n,a??t.path)}},e(t,t.exports),t.exports}function md(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var vd=Qe(function(e,r){(function(t,n){n(r)})(We,function(t){var n=typeof window!="undefined"&&window.flatpickr!==void 0?window.flatpickr:{l10ns:{}},a={firstDayOfWeek:1,weekdays:{shorthand:["dim","lun","mar","mer","jeu","ven","sam"],longhand:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},months:{shorthand:["janv","fÃ©vr","mars","avr","mai","juin","juil","aoÃ»t","sept","oct","nov","dÃ©c"],longhand:["janvier","fÃ©vrier","mars","avril","mai","juin","juillet","aoÃ»t","septembre","octobre","novembre","dÃ©cembre"]},ordinal:function(s){return s>1?"":"er"},rangeSeparator:" au ",weekAbbreviation:"Sem",scrollTitle:"DÃ©filer pour augmenter la valeur",toggleTitle:"Cliquer pour basculer",time_24hr:!0};n.l10ns.fr=a;var i=n.l10ns;t.French=a,t.default=i,Object.defineProperty(t,"__esModule",{value:!0})})}),bd=Kt(vd),vi=bd;var wd=Qe(function(e,r){(function(t,n){n(r)})(We,function(t){var n=typeof window!="undefined"&&window.flatpickr!==void 0?window.flatpickr:{l10ns:{}},a={weekdays:{shorthand:["Nd","Pn","Wt","År","Cz","Pt","So"],longhand:["Niedziela","PoniedziaÅek","Wtorek","Åroda","Czwartek","PiÄtek","Sobota"]},months:{shorthand:["Sty","Lut","Mar","Kwi","Maj","Cze","Lip","Sie","Wrz","PaÅº","Lis","Gru"],longhand:["StyczeÅ","Luty","Marzec","KwiecieÅ","Maj","Czerwiec","Lipiec","SierpieÅ","WrzesieÅ","PaÅºdziernik","Listopad","GrudzieÅ"]},rangeSeparator:" do ",weekAbbreviation:"tydz.",scrollTitle:"PrzewiÅ, aby zwiÄkszyÄ",toggleTitle:"Kliknij, aby przeÅÄczyÄ",firstDayOfWeek:1,time_24hr:!0,ordinal:function(){return"."}};n.l10ns.pl=a;var i=n.l10ns;t.Polish=a,t.default=i,Object.defineProperty(t,"__esModule",{value:!0})})}),_d=Kt(wd),bi=_d;function wi(e){let r={pl:bi.default.pl,fr:vi.default.fr};return mi(e.element,{locale:e.locale&&r[e.locale]||null,defaultDate:e.value,enableTime:e.enableTime||!1,time_24hr:!0,dateFormat:e.enableTime?"Y/m/j H:i":"Y/m/j",onClose:(t,n,a)=>{e.callback(n)}})}function _i(e){return Math.round(new Date(e).getTime()/1e3)}function Jn(e){if(!e)return;if(e=parseInt(e)?e:e.getValue(),isNaN(parseInt(e)))return" ";let r=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],t=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],n=new Date(e*1e3),a=n.getFullYear(),i=r[n.getMonth()],s=n.getDate(),o=t[n.getDay()];return`${s} ${i} ${a}`}function yi(e){if(!e)return;if(e=parseInt(e)?e:e.getValue(),isNaN(parseInt(e)))return" ";let r=Jn(e),t=new Date(e*1e3),n="0"+t.getHours(),a="0"+t.getMinutes(),i="0"+t.getSeconds();return`${r}, ${n.substr(-2)}:${a.substr(-2)}`}var yd=Qe(function(e,r){(function(t,n){e.exports=n()})(We,function(){for(var t=function(c,d,g){return d===void 0&&(d=0),g===void 0&&(g=1),c<d?d:c>g?g:c},n=function(c){c._clipped=!1,c._unclipped=c.slice(0);for(var d=0;d<=3;d++)d<3?((c[d]<0||c[d]>255)&&(c._clipped=!0),c[d]=t(c[d],0,255)):d===3&&(c[d]=t(c[d],0,1));return c},a={},i=0,s=["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"];i<s.length;i+=1){var o=s[i];a["[object "+o+"]"]=o.toLowerCase()}var l=function(c){return a[Object.prototype.toString.call(c)]||"object"},f=function(c,d){return d===void 0&&(d=null),c.length>=3?Array.prototype.slice.call(c):l(c[0])=="object"&&d?d.split("").filter(function(g){return c[0][g]!==void 0}).map(function(g){return c[0][g]}):c[0]},p=function(c){if(c.length<2)return null;var d=c.length-1;return l(c[d])=="string"?c[d].toLowerCase():null},u=Math.PI,h={clip_rgb:n,limit:t,type:l,unpack:f,last:p,PI:u,TWOPI:u*2,PITHIRD:u/3,DEG2RAD:u/180,RAD2DEG:180/u},w={format:{},autodetect:[]},D=h.last,Z=h.clip_rgb,U=h.type,re=function(){for(var d=[],g=arguments.length;g--;)d[g]=arguments[g];var b=this;if(U(d[0])==="object"&&d[0].constructor&&d[0].constructor===this.constructor)return d[0];var y=D(d),k=!1;if(!y){k=!0,w.sorted||(w.autodetect=w.autodetect.sort(function(H,R){return R.p-H.p}),w.sorted=!0);for(var _=0,j=w.autodetect;_<j.length;_+=1){var T=j[_];if(y=T.test.apply(T,d),y)break}}if(w.format[y]){var O=w.format[y].apply(null,k?d:d.slice(0,-1));b._rgb=Z(O)}else throw new Error("unknown format: "+d);b._rgb.length===3&&b._rgb.push(1)};re.prototype.toString=function(){return U(this.hex)=="function"?this.hex():"["+this._rgb.join(",")+"]"};var F=re,ie=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];return new(Function.prototype.bind.apply(ie.Color,[null].concat(c)))};ie.Color=F,ie.version="2.1.0";var J=ie,$e=h.unpack,Je=Math.max,ze=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];var g=$e(c,"rgb"),b=g[0],y=g[1],k=g[2];b=b/255,y=y/255,k=k/255;var _=1-Je(b,Je(y,k)),j=_<1?1/(1-_):0,T=(1-b-_)*j,O=(1-y-_)*j,H=(1-k-_)*j;return[T,O,H,_]},$=ze,G=h.unpack,q=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];c=G(c,"cmyk");var g=c[0],b=c[1],y=c[2],k=c[3],_=c.length>4?c[4]:1;return k===1?[0,0,0,_]:[g>=1?0:255*(1-g)*(1-k),b>=1?0:255*(1-b)*(1-k),y>=1?0:255*(1-y)*(1-k),_]},z=q,P=h.unpack,E=h.type;F.prototype.cmyk=function(){return $(this._rgb)},J.cmyk=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];return new(Function.prototype.bind.apply(F,[null].concat(c,["cmyk"])))},w.format.cmyk=z,w.autodetect.push({p:2,test:function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];if(c=P(c,"cmyk"),E(c)==="array"&&c.length===4)return"cmyk"}});var C=h.unpack,L=h.last,V=function(c){return Math.round(c*100)/100},N=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];var g=C(c,"hsla"),b=L(c)||"lsa";return g[0]=V(g[0]||0),g[1]=V(g[1]*100)+"%",g[2]=V(g[2]*100)+"%",b==="hsla"||g.length>3&&g[3]<1?(g[3]=g.length>3?g[3]:1,b="hsla"):g.length=3,b+"("+g.join(",")+")"},W=N,x=h.unpack,A=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];c=x(c,"rgba");var g=c[0],b=c[1],y=c[2];g/=255,b/=255,y/=255;var k=Math.min(g,b,y),_=Math.max(g,b,y),j=(_+k)/2,T,O;return _===k?(T=0,O=Number.NaN):T=j<.5?(_-k)/(_+k):(_-k)/(2-_-k),g==_?O=(b-y)/(_-k):b==_?O=2+(y-g)/(_-k):y==_&&(O=4+(g-b)/(_-k)),O*=60,O<0&&(O+=360),c.length>3&&c[3]!==void 0?[O,T,j,c[3]]:[O,T,j]},ee=A,ue=h.unpack,ge=h.last,be=Math.round,Me=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];var g=ue(c,"rgba"),b=ge(c)||"rgb";return b.substr(0,3)=="hsl"?W(ee(g),b):(g[0]=be(g[0]),g[1]=be(g[1]),g[2]=be(g[2]),(b==="rgba"||g.length>3&&g[3]<1)&&(g[3]=g.length>3?g[3]:1,b="rgba"),b+"("+g.slice(0,b==="rgb"?3:4).join(",")+")")},ht=Me,qe=h.unpack,Ze=Math.round,ir=function(){for(var c,d=[],g=arguments.length;g--;)d[g]=arguments[g];d=qe(d,"hsl");var b=d[0],y=d[1],k=d[2],_,j,T;if(y===0)_=j=T=k*255;else{var O=[0,0,0],H=[0,0,0],R=k<.5?k*(1+y):k+y-k*y,K=2*k-R,X=b/360;O[0]=X+1/3,O[1]=X,O[2]=X-1/3;for(var ae=0;ae<3;ae++)O[ae]<0&&(O[ae]+=1),O[ae]>1&&(O[ae]-=1),6*O[ae]<1?H[ae]=K+(R-K)*6*O[ae]:2*O[ae]<1?H[ae]=R:3*O[ae]<2?H[ae]=K+(R-K)*(2/3-O[ae])*6:H[ae]=K;c=[Ze(H[0]*255),Ze(H[1]*255),Ze(H[2]*255)],_=c[0],j=c[1],T=c[2]}return d.length>3?[_,j,T,d[3]]:[_,j,T,1]},pt=ir,et=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,xt=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,mt=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,ot=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,Rt=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,ft=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,St=Math.round,tt=function(c){c=c.toLowerCase().trim();var d;if(w.format.named)try{return w.format.named(c)}catch(ae){}if(d=c.match(et)){for(var g=d.slice(1,4),b=0;b<3;b++)g[b]=+g[b];return g[3]=1,g}if(d=c.match(xt)){for(var y=d.slice(1,5),k=0;k<4;k++)y[k]=+y[k];return y}if(d=c.match(mt)){for(var _=d.slice(1,4),j=0;j<3;j++)_[j]=St(_[j]*2.55);return _[3]=1,_}if(d=c.match(ot)){for(var T=d.slice(1,5),O=0;O<3;O++)T[O]=St(T[O]*2.55);return T[3]=+T[3],T}if(d=c.match(Rt)){var H=d.slice(1,4);H[1]*=.01,H[2]*=.01;var R=pt(H);return R[3]=1,R}if(d=c.match(ft)){var K=d.slice(1,4);K[1]*=.01,K[2]*=.01;var X=pt(K);return X[3]=+d[4],X}};tt.test=function(c){return et.test(c)||xt.test(c)||mt.test(c)||ot.test(c)||Rt.test(c)||ft.test(c)};var Ht=tt,$t=h.type;F.prototype.css=function(c){return ht(this._rgb,c)},J.css=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];return new(Function.prototype.bind.apply(F,[null].concat(c,["css"])))},w.format.css=Ht,w.autodetect.push({p:5,test:function(c){for(var d=[],g=arguments.length-1;g-- >0;)d[g]=arguments[g+1];if(!d.length&&$t(c)==="string"&&Ht.test(c))return"css"}});var Nt=h.unpack;w.format.gl=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];var g=Nt(c,"rgba");return g[0]*=255,g[1]*=255,g[2]*=255,g},J.gl=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];return new(Function.prototype.bind.apply(F,[null].concat(c,["gl"])))},F.prototype.gl=function(){var c=this._rgb;return[c[0]/255,c[1]/255,c[2]/255,c[3]]};var lt=h.unpack,Bt=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];var g=lt(c,"rgb"),b=g[0],y=g[1],k=g[2],_=Math.min(b,y,k),j=Math.max(b,y,k),T=j-_,O=T*100/255,H=_/(255-T)*100,R;return T===0?R=Number.NaN:(b===j&&(R=(y-k)/T),y===j&&(R=2+(k-b)/T),k===j&&(R=4+(b-y)/T),R*=60,R<0&&(R+=360)),[R,O,H]},st=Bt,tn=h.unpack,Cr=Math.floor,rn=function(){for(var c,d,g,b,y,k,_=[],j=arguments.length;j--;)_[j]=arguments[j];_=tn(_,"hcg");var T=_[0],O=_[1],H=_[2],R,K,X;H=H*255;var ae=O*255;if(O===0)R=K=X=H;else{T===360&&(T=0),T>360&&(T-=360),T<0&&(T+=360),T/=60;var de=Cr(T),le=T-de,me=H*(1-O),ke=me+ae*(1-le),Oe=me+ae*le,Ae=me+ae;switch(de){case 0:c=[Ae,Oe,me],R=c[0],K=c[1],X=c[2];break;case 1:d=[ke,Ae,me],R=d[0],K=d[1],X=d[2];break;case 2:g=[me,Ae,Oe],R=g[0],K=g[1],X=g[2];break;case 3:b=[me,ke,Ae],R=b[0],K=b[1],X=b[2];break;case 4:y=[Oe,me,Ae],R=y[0],K=y[1],X=y[2];break;case 5:k=[Ae,me,ke],R=k[0],K=k[1],X=k[2];break}}return[R,K,X,_.length>3?_[3]:1]},Er=rn,nn=h.unpack,an=h.type;F.prototype.hcg=function(){return st(this._rgb)},J.hcg=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];return new(Function.prototype.bind.apply(F,[null].concat(c,["hcg"])))},w.format.hcg=Er,w.autodetect.push({p:1,test:function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];if(c=nn(c,"hcg"),an(c)==="array"&&c.length===3)return"hcg"}});var on=h.unpack,ln=h.last,we=Math.round,or=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];var g=on(c,"rgba"),b=g[0],y=g[1],k=g[2],_=g[3],j=ln(c)||"auto";_===void 0&&(_=1),j==="auto"&&(j=_<1?"rgba":"rgb"),b=we(b),y=we(y),k=we(k);var T=b<<16|y<<8|k,O="000000"+T.toString(16);O=O.substr(O.length-6);var H="0"+we(_*255).toString(16);switch(H=H.substr(H.length-2),j.toLowerCase()){case"rgba":return"#"+O+H;case"argb":return"#"+H+O;default:return"#"+O}},Gt=or,sn=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,qt=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,Sr=function(c){if(c.match(sn)){(c.length===4||c.length===7)&&(c=c.substr(1)),c.length===3&&(c=c.split(""),c=c[0]+c[0]+c[1]+c[1]+c[2]+c[2]);var d=parseInt(c,16),g=d>>16,b=d>>8&255,y=d&255;return[g,b,y,1]}if(c.match(qt)){(c.length===5||c.length===9)&&(c=c.substr(1)),c.length===4&&(c=c.split(""),c=c[0]+c[0]+c[1]+c[1]+c[2]+c[2]+c[3]+c[3]);var k=parseInt(c,16),_=k>>24&255,j=k>>16&255,T=k>>8&255,O=Math.round((k&255)/255*100)/100;return[_,j,T,O]}throw new Error("unknown hex color: "+c)},rt=Sr,cn=h.type;F.prototype.hex=function(c){return Gt(this._rgb,c)},J.hex=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];return new(Function.prototype.bind.apply(F,[null].concat(c,["hex"])))},w.format.hex=rt,w.autodetect.push({p:4,test:function(c){for(var d=[],g=arguments.length-1;g-- >0;)d[g]=arguments[g+1];if(!d.length&&cn(c)==="string"&&[3,4,5,6,7,8,9].indexOf(c.length)>=0)return"hex"}});var un=h.unpack,m=h.TWOPI,v=Math.min,S=Math.sqrt,M=Math.acos,Y=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];var g=un(c,"rgb"),b=g[0],y=g[1],k=g[2];b/=255,y/=255,k/=255;var _,j=v(b,y,k),T=(b+y+k)/3,O=T>0?1-j/T:0;return O===0?_=NaN:(_=(b-y+(b-k))/2,_/=S((b-y)*(b-y)+(b-k)*(y-k)),_=M(_),k>y&&(_=m-_),_/=m),[_*360,O,T]},I=Y,te=h.unpack,Q=h.limit,oe=h.TWOPI,se=h.PITHIRD,he=Math.cos,Ie=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];c=te(c,"hsi");var g=c[0],b=c[1],y=c[2],k,_,j;return isNaN(g)&&(g=0),isNaN(b)&&(b=0),g>360&&(g-=360),g<0&&(g+=360),g/=360,g<1/3?(j=(1-b)/3,k=(1+b*he(oe*g)/he(se-oe*g))/3,_=1-(j+k)):g<2/3?(g-=1/3,k=(1-b)/3,_=(1+b*he(oe*g)/he(se-oe*g))/3,j=1-(k+_)):(g-=2/3,_=(1-b)/3,j=(1+b*he(oe*g)/he(se-oe*g))/3,k=1-(_+j)),k=Q(y*k*3),_=Q(y*_*3),j=Q(y*j*3),[k*255,_*255,j*255,c.length>3?c[3]:1]},De=Ie,Vt=h.unpack,Xe=h.type;F.prototype.hsi=function(){return I(this._rgb)},J.hsi=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];return new(Function.prototype.bind.apply(F,[null].concat(c,["hsi"])))},w.format.hsi=De,w.autodetect.push({p:2,test:function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];if(c=Vt(c,"hsi"),Xe(c)==="array"&&c.length===3)return"hsi"}});var jt=h.unpack,Tt=h.type;F.prototype.hsl=function(){return ee(this._rgb)},J.hsl=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];return new(Function.prototype.bind.apply(F,[null].concat(c,["hsl"])))},w.format.hsl=pt,w.autodetect.push({p:2,test:function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];if(c=jt(c,"hsl"),Tt(c)==="array"&&c.length===3)return"hsl"}});var Lt=h.unpack,lr=Math.min,dn=Math.max,pn=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];c=Lt(c,"rgb");var g=c[0],b=c[1],y=c[2],k=lr(g,b,y),_=dn(g,b,y),j=_-k,T,O,H;return H=_/255,_===0?(T=Number.NaN,O=0):(O=j/_,g===_&&(T=(b-y)/j),b===_&&(T=2+(y-g)/j),y===_&&(T=4+(g-b)/j),T*=60,T<0&&(T+=360)),[T,O,H]},fn=pn,gn=h.unpack,hn=Math.floor,Fs=function(){for(var c,d,g,b,y,k,_=[],j=arguments.length;j--;)_[j]=arguments[j];_=gn(_,"hsv");var T=_[0],O=_[1],H=_[2],R,K,X;if(H*=255,O===0)R=K=X=H;else{T===360&&(T=0),T>360&&(T-=360),T<0&&(T+=360),T/=60;var ae=hn(T),de=T-ae,le=H*(1-O),me=H*(1-O*de),ke=H*(1-O*(1-de));switch(ae){case 0:c=[H,ke,le],R=c[0],K=c[1],X=c[2];break;case 1:d=[me,H,le],R=d[0],K=d[1],X=d[2];break;case 2:g=[le,H,ke],R=g[0],K=g[1],X=g[2];break;case 3:b=[le,me,H],R=b[0],K=b[1],X=b[2];break;case 4:y=[ke,le,H],R=y[0],K=y[1],X=y[2];break;case 5:k=[H,le,me],R=k[0],K=k[1],X=k[2];break}}return[R,K,X,_.length>3?_[3]:1]},Ds=Fs,Os=h.unpack,As=h.type;F.prototype.hsv=function(){return fn(this._rgb)},J.hsv=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];return new(Function.prototype.bind.apply(F,[null].concat(c,["hsv"])))},w.format.hsv=Ds,w.autodetect.push({p:2,test:function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];if(c=Os(c,"hsv"),As(c)==="array"&&c.length===3)return"hsv"}});var xe={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452},Ps=h.unpack,ya=Math.pow,Is=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];var g=Ps(c,"rgb"),b=g[0],y=g[1],k=g[2],_=xs(b,y,k),j=_[0],T=_[1],O=_[2],H=116*T-16;return[H<0?0:H,500*(j-T),200*(T-O)]},mn=function(c){return(c/=255)<=.04045?c/12.92:ya((c+.055)/1.055,2.4)},vn=function(c){return c>xe.t3?ya(c,1/3):c/xe.t2+xe.t0},xs=function(c,d,g){c=mn(c),d=mn(d),g=mn(g);var b=vn((.4124564*c+.3575761*d+.1804375*g)/xe.Xn),y=vn((.2126729*c+.7151522*d+.072175*g)/xe.Yn),k=vn((.0193339*c+.119192*d+.9503041*g)/xe.Zn);return[b,y,k]},ka=Is,Rs=h.unpack,Hs=Math.pow,Ns=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];c=Rs(c,"lab");var g=c[0],b=c[1],y=c[2],k,_,j,T,O,H;return _=(g+16)/116,k=isNaN(b)?_:_+b/500,j=isNaN(y)?_:_-y/200,_=xe.Yn*wn(_),k=xe.Xn*wn(k),j=xe.Zn*wn(j),T=bn(3.2404542*k-1.5371385*_-.4985314*j),O=bn(-.969266*k+1.8760108*_+.041556*j),H=bn(.0556434*k-.2040259*_+1.0572252*j),[T,O,H,c.length>3?c[3]:1]},bn=function(c){return 255*(c<=.00304?12.92*c:1.055*Hs(c,1/2.4)-.055)},wn=function(c){return c>xe.t1?c*c*c:xe.t2*(c-xe.t0)},Ca=Ns,Bs=h.unpack,Gs=h.type;F.prototype.lab=function(){return ka(this._rgb)},J.lab=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];return new(Function.prototype.bind.apply(F,[null].concat(c,["lab"])))},w.format.lab=Ca,w.autodetect.push({p:2,test:function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];if(c=Bs(c,"lab"),Gs(c)==="array"&&c.length===3)return"lab"}});var qs=h.unpack,Vs=h.RAD2DEG,Us=Math.sqrt,Ys=Math.atan2,Ws=Math.round,Js=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];var g=qs(c,"lab"),b=g[0],y=g[1],k=g[2],_=Us(y*y+k*k),j=(Ys(k,y)*Vs+360)%360;return Ws(_*1e4)===0&&(j=Number.NaN),[b,_,j]},Zs=Js,Xs=h.unpack,Ks=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];var g=Xs(c,"rgb"),b=g[0],y=g[1],k=g[2],_=ka(b,y,k),j=_[0],T=_[1],O=_[2];return Zs(j,T,O)},Ea=Ks,Qs=h.unpack,zs=h.DEG2RAD,ec=Math.sin,tc=Math.cos,rc=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];var g=Qs(c,"lch"),b=g[0],y=g[1],k=g[2];return isNaN(k)&&(k=0),k=k*zs,[b,tc(k)*y,ec(k)*y]},nc=rc,ac=h.unpack,ic=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];c=ac(c,"lch");var g=c[0],b=c[1],y=c[2],k=nc(g,b,y),_=k[0],j=k[1],T=k[2],O=Ca(_,j,T),H=O[0],R=O[1],K=O[2];return[H,R,K,c.length>3?c[3]:1]},Sa=ic,oc=h.unpack,lc=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];var g=oc(c,"hcl").reverse();return Sa.apply(void 0,g)},sc=lc,cc=h.unpack,uc=h.type;F.prototype.lch=function(){return Ea(this._rgb)},F.prototype.hcl=function(){return Ea(this._rgb).reverse()},J.lch=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];return new(Function.prototype.bind.apply(F,[null].concat(c,["lch"])))},J.hcl=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];return new(Function.prototype.bind.apply(F,[null].concat(c,["hcl"])))},w.format.lch=Sa,w.format.hcl=sc,["lch","hcl"].forEach(function(c){return w.autodetect.push({p:2,test:function(){for(var d=[],g=arguments.length;g--;)d[g]=arguments[g];if(d=cc(d,c),uc(d)==="array"&&d.length===3)return c}})});var dc={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},Ut=dc,pc=h.type;F.prototype.name=function(){for(var c=Gt(this._rgb,"rgb"),d=0,g=Object.keys(Ut);d<g.length;d+=1){var b=g[d];if(Ut[b]===c)return b.toLowerCase()}return c},w.format.named=function(c){if(c=c.toLowerCase(),Ut[c])return rt(Ut[c]);throw new Error("unknown color name: "+c)},w.autodetect.push({p:5,test:function(c){for(var d=[],g=arguments.length-1;g-- >0;)d[g]=arguments[g+1];if(!d.length&&pc(c)==="string"&&Ut[c.toLowerCase()])return"named"}});var fc=h.unpack,gc=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];var g=fc(c,"rgb"),b=g[0],y=g[1],k=g[2];return(b<<16)+(y<<8)+k},hc=gc,mc=h.type,vc=function(c){if(mc(c)=="number"&&c>=0&&c<=16777215){var d=c>>16,g=c>>8&255,b=c&255;return[d,g,b,1]}throw new Error("unknown num color: "+c)},bc=vc,wc=h.type;F.prototype.num=function(){return hc(this._rgb)},J.num=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];return new(Function.prototype.bind.apply(F,[null].concat(c,["num"])))},w.format.num=bc,w.autodetect.push({p:5,test:function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];if(c.length===1&&wc(c[0])==="number"&&c[0]>=0&&c[0]<=16777215)return"num"}});var $a=h.unpack,ja=h.type,Ta=Math.round;F.prototype.rgb=function(c){return c===void 0&&(c=!0),c===!1?this._rgb.slice(0,3):this._rgb.slice(0,3).map(Ta)},F.prototype.rgba=function(c){return c===void 0&&(c=!0),this._rgb.slice(0,4).map(function(d,g){return g<3?c===!1?d:Ta(d):d})},J.rgb=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];return new(Function.prototype.bind.apply(F,[null].concat(c,["rgb"])))},w.format.rgb=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];var g=$a(c,"rgba");return g[3]===void 0&&(g[3]=1),g},w.autodetect.push({p:3,test:function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];if(c=$a(c,"rgba"),ja(c)==="array"&&(c.length===3||c.length===4&&ja(c[3])=="number"&&c[3]>=0&&c[3]<=1))return"rgb"}});var $r=Math.log,_c=function(c){var d=c/100,g,b,y;return d<66?(g=255,b=-155.25485562709179-.44596950469579133*(b=d-2)+104.49216199393888*$r(b),y=d<20?0:-254.76935184120902+.8274096064007395*(y=d-10)+115.67994401066147*$r(y)):(g=351.97690566805693+.114206453784165*(g=d-55)-40.25366309332127*$r(g),b=325.4494125711974+.07943456536662342*(b=d-50)-28.0852963507957*$r(b),y=255),[g,b,y,1]},La=_c,yc=h.unpack,kc=Math.round,Cc=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];for(var g=yc(c,"rgb"),b=g[0],y=g[2],k=1e3,_=4e4,j=.4,T;_-k>j;){T=(_+k)*.5;var O=La(T);O[2]/O[0]>=y/b?_=T:k=T}return kc(T)},Ec=Cc;F.prototype.temp=F.prototype.kelvin=F.prototype.temperature=function(){return Ec(this._rgb)},J.temp=J.kelvin=J.temperature=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];return new(Function.prototype.bind.apply(F,[null].concat(c,["temp"])))},w.format.temp=w.format.kelvin=w.format.temperature=La;var Sc=h.type;F.prototype.alpha=function(c,d){return d===void 0&&(d=!1),c!==void 0&&Sc(c)==="number"?d?(this._rgb[3]=c,this):new F([this._rgb[0],this._rgb[1],this._rgb[2],c],"rgb"):this._rgb[3]},F.prototype.clipped=function(){return this._rgb._clipped||!1},F.prototype.darken=function(c){c===void 0&&(c=1);var d=this,g=d.lab();return g[0]-=xe.Kn*c,new F(g,"lab").alpha(d.alpha(),!0)},F.prototype.brighten=function(c){return c===void 0&&(c=1),this.darken(-c)},F.prototype.darker=F.prototype.darken,F.prototype.brighter=F.prototype.brighten,F.prototype.get=function(c){var d=c.split("."),g=d[0],b=d[1],y=this[g]();if(b){var k=g.indexOf(b);if(k>-1)return y[k];throw new Error("unknown channel "+b+" in mode "+g)}else return y};var $c=h.type,jc=Math.pow,Tc=1e-7,Lc=20;F.prototype.luminance=function(c){if(c!==void 0&&$c(c)==="number"){if(c===0)return new F([0,0,0,this._rgb[3]],"rgb");if(c===1)return new F([255,255,255,this._rgb[3]],"rgb");var d=this.luminance(),g="rgb",b=Lc,y=function(_,j){var T=_.interpolate(j,.5,g),O=T.luminance();return Math.abs(c-O)<Tc||!b--?T:O>c?y(_,T):y(T,j)},k=(d>c?y(new F([0,0,0]),this):y(this,new F([255,255,255]))).rgb();return new F(k.concat([this._rgb[3]]))}return Mc.apply(void 0,this._rgb.slice(0,3))};var Mc=function(c,d,g){return c=_n(c),d=_n(d),g=_n(g),.2126*c+.7152*d+.0722*g},_n=function(c){return c/=255,c<=.03928?c/12.92:jc((c+.055)/1.055,2.4)},Re={},Ma=h.type,Fa=function(c,d,g){g===void 0&&(g=.5);for(var b=[],y=arguments.length-3;y-- >0;)b[y]=arguments[y+3];var k=b[0]||"lrgb";if(!Re[k]&&!b.length&&(k=Object.keys(Re)[0]),!Re[k])throw new Error("interpolation mode "+k+" is not defined");return Ma(c)!=="object"&&(c=new F(c)),Ma(d)!=="object"&&(d=new F(d)),Re[k](c,d,g).alpha(c.alpha()+g*(d.alpha()-c.alpha()))};F.prototype.mix=F.prototype.interpolate=function(c,d){d===void 0&&(d=.5);for(var g=[],b=arguments.length-2;b-- >0;)g[b]=arguments[b+2];return Fa.apply(void 0,[this,c,d].concat(g))},F.prototype.premultiply=function(c){c===void 0&&(c=!1);var d=this._rgb,g=d[3];return c?(this._rgb=[d[0]*g,d[1]*g,d[2]*g,g],this):new F([d[0]*g,d[1]*g,d[2]*g,g],"rgb")},F.prototype.saturate=function(c){c===void 0&&(c=1);var d=this,g=d.lch();return g[1]+=xe.Kn*c,g[1]<0&&(g[1]=0),new F(g,"lch").alpha(d.alpha(),!0)},F.prototype.desaturate=function(c){return c===void 0&&(c=1),this.saturate(-c)};var Da=h.type;F.prototype.set=function(c,d,g){g===void 0&&(g=!1);var b=c.split("."),y=b[0],k=b[1],_=this[y]();if(k){var j=y.indexOf(k);if(j>-1){if(Da(d)=="string")switch(d.charAt(0)){case"+":_[j]+=+d;break;case"-":_[j]+=+d;break;case"*":_[j]*=+d.substr(1);break;case"/":_[j]/=+d.substr(1);break;default:_[j]=+d}else if(Da(d)==="number")_[j]=d;else throw new Error("unsupported value for Color.set");var T=new F(_,y);return g?(this._rgb=T._rgb,this):T}throw new Error("unknown channel "+k+" in mode "+y)}else return _};var Fc=function(c,d,g){var b=c._rgb,y=d._rgb;return new F(b[0]+g*(y[0]-b[0]),b[1]+g*(y[1]-b[1]),b[2]+g*(y[2]-b[2]),"rgb")};Re.rgb=Fc;var yn=Math.sqrt,Yt=Math.pow,Dc=function(c,d,g){var b=c._rgb,y=b[0],k=b[1],_=b[2],j=d._rgb,T=j[0],O=j[1],H=j[2];return new F(yn(Yt(y,2)*(1-g)+Yt(T,2)*g),yn(Yt(k,2)*(1-g)+Yt(O,2)*g),yn(Yt(_,2)*(1-g)+Yt(H,2)*g),"rgb")};Re.lrgb=Dc;var Oc=function(c,d,g){var b=c.lab(),y=d.lab();return new F(b[0]+g*(y[0]-b[0]),b[1]+g*(y[1]-b[1]),b[2]+g*(y[2]-b[2]),"lab")};Re.lab=Oc;var sr=function(c,d,g,b){var y,k,_,j;b==="hsl"?(_=c.hsl(),j=d.hsl()):b==="hsv"?(_=c.hsv(),j=d.hsv()):b==="hcg"?(_=c.hcg(),j=d.hcg()):b==="hsi"?(_=c.hsi(),j=d.hsi()):(b==="lch"||b==="hcl")&&(b="hcl",_=c.hcl(),j=d.hcl());var T,O,H,R,K,X;b.substr(0,1)==="h"&&(y=_,T=y[0],H=y[1],K=y[2],k=j,O=k[0],R=k[1],X=k[2]);var ae,de,le,me;return!isNaN(T)&&!isNaN(O)?(O>T&&O-T>180?me=O-(T+360):O<T&&T-O>180?me=O+360-T:me=O-T,de=T+g*me):isNaN(T)?isNaN(O)?de=Number.NaN:(de=O,(K==1||K==0)&&b!="hsv"&&(ae=R)):(de=T,(X==1||X==0)&&b!="hsv"&&(ae=H)),ae===void 0&&(ae=H+g*(R-H)),le=K+g*(X-K),new F([de,ae,le],b)},Oa=function(c,d,g){return sr(c,d,g,"lch")};Re.lch=Oa,Re.hcl=Oa;var Ac=function(c,d,g){var b=c.num(),y=d.num();return new F(b+g*(y-b),"num")};Re.num=Ac;var Pc=function(c,d,g){return sr(c,d,g,"hcg")};Re.hcg=Pc;var Ic=function(c,d,g){return sr(c,d,g,"hsi")};Re.hsi=Ic;var xc=function(c,d,g){return sr(c,d,g,"hsl")};Re.hsl=xc;var Rc=function(c,d,g){return sr(c,d,g,"hsv")};Re.hsv=Rc;var Hc=h.clip_rgb,kn=Math.pow,Cn=Math.sqrt,En=Math.PI,Aa=Math.cos,Pa=Math.sin,Nc=Math.atan2,Bc=function(c,d,g){d===void 0&&(d="lrgb"),g===void 0&&(g=null);var b=c.length;g||(g=Array.from(new Array(b)).map(function(){return 1}));var y=b/g.reduce(function(de,le){return de+le});if(g.forEach(function(de,le){g[le]*=y}),c=c.map(function(de){return new F(de)}),d==="lrgb")return Gc(c,g);for(var k=c.shift(),_=k.get(d),j=[],T=0,O=0,H=0;H<_.length;H++)if(_[H]=(_[H]||0)*g[0],j.push(isNaN(_[H])?0:g[0]),d.charAt(H)==="h"&&!isNaN(_[H])){var R=_[H]/180*En;T+=Aa(R)*g[0],O+=Pa(R)*g[0]}var K=k.alpha()*g[0];c.forEach(function(de,le){var me=de.get(d);K+=de.alpha()*g[le+1];for(var ke=0;ke<_.length;ke++)if(!isNaN(me[ke]))if(j[ke]+=g[le+1],d.charAt(ke)==="h"){var Oe=me[ke]/180*En;T+=Aa(Oe)*g[le+1],O+=Pa(Oe)*g[le+1]}else _[ke]+=me[ke]*g[le+1]});for(var X=0;X<_.length;X++)if(d.charAt(X)==="h"){for(var ae=Nc(O/j[X],T/j[X])/En*180;ae<0;)ae+=360;for(;ae>=360;)ae-=360;_[X]=ae}else _[X]=_[X]/j[X];return K/=b,new F(_,d).alpha(K>.99999?1:K,!0)},Gc=function(c,d){for(var g=c.length,b=[0,0,0,0],y=0;y<c.length;y++){var k=c[y],_=d[y]/g,j=k._rgb;b[0]+=kn(j[0],2)*_,b[1]+=kn(j[1],2)*_,b[2]+=kn(j[2],2)*_,b[3]+=j[3]*_}return b[0]=Cn(b[0]),b[1]=Cn(b[1]),b[2]=Cn(b[2]),b[3]>.9999999&&(b[3]=1),new F(Hc(b))},Wt=h.type,qc=Math.pow,jr=function(c){var d="rgb",g=J("#ccc"),b=0,y=[0,1],k=[],_=[0,0],j=!1,T=[],O=!1,H=0,R=1,K=!1,X={},ae=!0,de=1,le=function(B){if(B=B||["#fff","#000"],B&&Wt(B)==="string"&&J.brewer&&J.brewer[B.toLowerCase()]&&(B=J.brewer[B.toLowerCase()]),Wt(B)==="array"){B.length===1&&(B=[B[0],B[0]]),B=B.slice(0);for(var ne=0;ne<B.length;ne++)B[ne]=J(B[ne]);k.length=0;for(var pe=0;pe<B.length;pe++)k.push(pe/(B.length-1))}return Ve(),T=B},me=function(B){if(j!=null){for(var ne=j.length-1,pe=0;pe<ne&&B>=j[pe];)pe++;return pe-1}return 0},ke=function(B){return B},Oe=function(B){return B},Ae=function(B,ne){var pe,ce;if(ne==null&&(ne=!1),isNaN(B)||B===null)return g;if(ne)ce=B;else if(j&&j.length>2){var He=me(B);ce=He/(j.length-2)}else R!==H?ce=(B-H)/(R-H):ce=1;ce=Oe(ce),ne||(ce=ke(ce)),de!==1&&(ce=qc(ce,de)),ce=_[0]+ce*(1-_[0]-_[1]),ce=Math.min(1,Math.max(0,ce));var je=Math.floor(ce*1e4);if(ae&&X[je])pe=X[je];else{if(Wt(T)==="array")for(var _e=0;_e<k.length;_e++){var ye=k[_e];if(ce<=ye){pe=T[_e];break}if(ce>=ye&&_e===k.length-1){pe=T[_e];break}if(ce>ye&&ce<k[_e+1]){ce=(ce-ye)/(k[_e+1]-ye),pe=J.interpolate(T[_e],T[_e+1],ce,d);break}}else Wt(T)==="function"&&(pe=T(ce));ae&&(X[je]=pe)}return pe},Ve=function(){return X={}};le(c);var fe=function(B){var ne=J(Ae(B));return O&&ne[O]?ne[O]():ne};return fe.classes=function(B){if(B!=null){if(Wt(B)==="array")j=B,y=[B[0],B[B.length-1]];else{var ne=J.analyze(y);B===0?j=[ne.min,ne.max]:j=J.limits(ne,"e",B)}return fe}return j},fe.domain=function(B){if(!arguments.length)return y;H=B[0],R=B[B.length-1],k=[];var ne=T.length;if(B.length===ne&&H!==R)for(var pe=0,ce=Array.from(B);pe<ce.length;pe+=1){var He=ce[pe];k.push((He-H)/(R-H))}else{for(var je=0;je<ne;je++)k.push(je/(ne-1));if(B.length>2){var _e=B.map(function(Te,Ce){return Ce/(B.length-1)}),ye=B.map(function(Te){return(Te-H)/(R-H)});ye.every(function(Te,Ce){return _e[Ce]===Te})||(Oe=function(Te){if(Te<=0||Te>=1)return Te;for(var Ce=0;Te>=ye[Ce+1];)Ce++;var wt=(Te-ye[Ce])/(ye[Ce+1]-ye[Ce]),Jt=_e[Ce]+wt*(_e[Ce+1]-_e[Ce]);return Jt})}}return y=[H,R],fe},fe.mode=function(B){return arguments.length?(d=B,Ve(),fe):d},fe.range=function(B,ne){return le(B),fe},fe.out=function(B){return O=B,fe},fe.spread=function(B){return arguments.length?(b=B,fe):b},fe.correctLightness=function(B){return B==null&&(B=!0),K=B,Ve(),K?ke=function(ne){for(var pe=Ae(0,!0).lab()[0],ce=Ae(1,!0).lab()[0],He=pe>ce,je=Ae(ne,!0).lab()[0],_e=pe+(ce-pe)*ne,ye=je-_e,Te=0,Ce=1,wt=20;Math.abs(ye)>.01&&wt-- >0;)(function(){return He&&(ye*=-1),ye<0?(Te=ne,ne+=(Ce-ne)*.5):(Ce=ne,ne+=(Te-ne)*.5),je=Ae(ne,!0).lab()[0],ye=je-_e})();return ne}:ke=function(ne){return ne},fe},fe.padding=function(B){return B!=null?(Wt(B)==="number"&&(B=[B,B]),_=B,fe):_},fe.colors=function(B,ne){arguments.length<2&&(ne="hex");var pe=[];if(arguments.length===0)pe=T.slice(0);else if(B===1)pe=[fe(.5)];else if(B>1){var ce=y[0],He=y[1]-ce;pe=Vc(0,B,!1).map(function(Ce){return fe(ce+Ce/(B-1)*He)})}else{c=[];var je=[];if(j&&j.length>2)for(var _e=1,ye=j.length,Te=1<=ye;Te?_e<ye:_e>ye;Te?_e++:_e--)je.push((j[_e-1]+j[_e])*.5);else je=y;pe=je.map(function(Ce){return fe(Ce)})}return J[ne]&&(pe=pe.map(function(Ce){return Ce[ne]()})),pe},fe.cache=function(B){return B!=null?(ae=B,fe):ae},fe.gamma=function(B){return B!=null?(de=B,fe):de},fe.nodata=function(B){return B!=null?(g=J(B),fe):g},fe};function Vc(c,d,g){for(var b=[],y=c<d,k=g?y?d+1:d-1:d,_=c;y?_<k:_>k;y?_++:_--)b.push(_);return b}var Sn=function(c){var d,g,b,y,k,_,j;if(c=c.map(function(R){return new F(R)}),c.length===2)d=c.map(function(R){return R.lab()}),k=d[0],_=d[1],y=function(R){var K=[0,1,2].map(function(X){return k[X]+R*(_[X]-k[X])});return new F(K,"lab")};else if(c.length===3)g=c.map(function(R){return R.lab()}),k=g[0],_=g[1],j=g[2],y=function(R){var K=[0,1,2].map(function(X){return(1-R)*(1-R)*k[X]+2*(1-R)*R*_[X]+R*R*j[X]});return new F(K,"lab")};else if(c.length===4){var T;b=c.map(function(R){return R.lab()}),k=b[0],_=b[1],j=b[2],T=b[3],y=function(R){var K=[0,1,2].map(function(X){return(1-R)*(1-R)*(1-R)*k[X]+3*(1-R)*(1-R)*R*_[X]+3*(1-R)*R*R*j[X]+R*R*R*T[X]});return new F(K,"lab")}}else if(c.length===5){var O=Sn(c.slice(0,3)),H=Sn(c.slice(2,5));y=function(R){return R<.5?O(R*2):H((R-.5)*2)}}return y},Uc=function(c){var d=Sn(c);return d.scale=function(){return jr(d)},d},nt=function(c,d,g){if(!nt[g])throw new Error("unknown blend mode "+g);return nt[g](c,d)},vt=function(c){return function(d,g){var b=J(g).rgb(),y=J(d).rgb();return J.rgb(c(b,y))}},bt=function(c){return function(d,g){var b=[];return b[0]=c(d[0],g[0]),b[1]=c(d[1],g[1]),b[2]=c(d[2],g[2]),b}},Yc=function(c){return c},Wc=function(c,d){return c*d/255},Jc=function(c,d){return c>d?d:c},Zc=function(c,d){return c>d?c:d},Xc=function(c,d){return 255*(1-(1-c/255)*(1-d/255))},Kc=function(c,d){return d<128?2*c*d/255:255*(1-2*(1-c/255)*(1-d/255))},Qc=function(c,d){return 255*(1-(1-d/255)/(c/255))},zc=function(c,d){return c===255?255:(c=255*(d/255)/(1-c/255),c>255?255:c)};nt.normal=vt(bt(Yc)),nt.multiply=vt(bt(Wc)),nt.screen=vt(bt(Xc)),nt.overlay=vt(bt(Kc)),nt.darken=vt(bt(Jc)),nt.lighten=vt(bt(Zc)),nt.dodge=vt(bt(zc)),nt.burn=vt(bt(Qc));for(var eu=nt,$n=h.type,tu=h.clip_rgb,ru=h.TWOPI,nu=Math.pow,au=Math.sin,iu=Math.cos,ou=function(c,d,g,b,y){c===void 0&&(c=300),d===void 0&&(d=-1.5),g===void 0&&(g=1),b===void 0&&(b=1),y===void 0&&(y=[0,1]);var k=0,_;$n(y)==="array"?_=y[1]-y[0]:(_=0,y=[y,y]);var j=function(T){var O=ru*((c+120)/360+d*T),H=nu(y[0]+_*T,b),R=k!==0?g[0]+T*k:g,K=R*H*(1-H)/2,X=iu(O),ae=au(O),de=H+K*(-.14861*X+1.78277*ae),le=H+K*(-.29227*X-.90649*ae),me=H+K*(1.97294*X);return J(tu([de*255,le*255,me*255,1]))};return j.start=function(T){return T==null?c:(c=T,j)},j.rotations=function(T){return T==null?d:(d=T,j)},j.gamma=function(T){return T==null?b:(b=T,j)},j.hue=function(T){return T==null?g:(g=T,$n(g)==="array"?(k=g[1]-g[0],k===0&&(g=g[1])):k=0,j)},j.lightness=function(T){return T==null?y:($n(T)==="array"?(y=T,_=T[1]-T[0]):(y=[T,T],_=0),j)},j.scale=function(){return J.scale(j)},j.hue(g),j},lu="0123456789abcdef",su=Math.floor,cu=Math.random,uu=function(){for(var c="#",d=0;d<6;d++)c+=lu.charAt(su(cu()*16));return new F(c,"hex")},Ia=Math.log,du=Math.pow,pu=Math.floor,fu=Math.abs,xa=function(c,d){d===void 0&&(d=null);var g={min:Number.MAX_VALUE,max:Number.MAX_VALUE*-1,sum:0,values:[],count:0};return l(c)==="object"&&(c=Object.values(c)),c.forEach(function(b){d&&l(b)==="object"&&(b=b[d]),b!=null&&!isNaN(b)&&(g.values.push(b),g.sum+=b,b<g.min&&(g.min=b),b>g.max&&(g.max=b),g.count+=1)}),g.domain=[g.min,g.max],g.limits=function(b,y){return Ra(g,b,y)},g},Ra=function(c,d,g){d===void 0&&(d="equal"),g===void 0&&(g=7),l(c)=="array"&&(c=xa(c));var b=c.min,y=c.max,k=c.values.sort(function(Dn,On){return Dn-On});if(g===1)return[b,y];var _=[];if(d.substr(0,1)==="c"&&(_.push(b),_.push(y)),d.substr(0,1)==="e"){_.push(b);for(var j=1;j<g;j++)_.push(b+j/g*(y-b));_.push(y)}else if(d.substr(0,1)==="l"){if(b<=0)throw new Error("Logarithmic scales are only possible for values > 0");var T=Math.LOG10E*Ia(b),O=Math.LOG10E*Ia(y);_.push(b);for(var H=1;H<g;H++)_.push(du(10,T+H/g*(O-T)));_.push(y)}else if(d.substr(0,1)==="q"){_.push(b);for(var R=1;R<g;R++){var K=(k.length-1)*R/g,X=pu(K);if(X===K)_.push(k[X]);else{var ae=K-X;_.push(k[X]*(1-ae)+k[X+1]*ae)}}_.push(y)}else if(d.substr(0,1)==="k"){var de,le=k.length,me=new Array(le),ke=new Array(g),Oe=!0,Ae=0,Ve=null;Ve=[],Ve.push(b);for(var fe=1;fe<g;fe++)Ve.push(b+fe/g*(y-b));for(Ve.push(y);Oe;){for(var B=0;B<g;B++)ke[B]=0;for(var ne=0;ne<le;ne++)for(var pe=k[ne],ce=Number.MAX_VALUE,He=void 0,je=0;je<g;je++){var _e=fu(Ve[je]-pe);_e<ce&&(ce=_e,He=je),ke[He]++,me[ne]=He}for(var ye=new Array(g),Te=0;Te<g;Te++)ye[Te]=null;for(var Ce=0;Ce<le;Ce++)de=me[Ce],ye[de]===null?ye[de]=k[Ce]:ye[de]+=k[Ce];for(var wt=0;wt<g;wt++)ye[wt]*=1/ke[wt];Oe=!1;for(var Jt=0;Jt<g;Jt++)if(ye[Jt]!==Ve[Jt]){Oe=!0;break}Ve=ye,Ae++,Ae>200&&(Oe=!1)}for(var cr={},Ln=0;Ln<g;Ln++)cr[Ln]=[];for(var Mr=0;Mr<le;Mr++)de=me[Mr],cr[de].push(k[Mr]);for(var Mt=[],ur=0;ur<g;ur++)Mt.push(cr[ur][0]),Mt.push(cr[ur][cr[ur].length-1]);Mt=Mt.sort(function(Dn,On){return Dn-On}),_.push(Mt[0]);for(var Mn=1;Mn<Mt.length;Mn+=2){var Fn=Mt[Mn];!isNaN(Fn)&&_.indexOf(Fn)===-1&&_.push(Fn)}}return _},Ha={analyze:xa,limits:Ra},gu=function(c,d){c=new F(c),d=new F(d);var g=c.luminance(),b=d.luminance();return g>b?(g+.05)/(b+.05):(b+.05)/(g+.05)},Tr=Math.sqrt,hu=Math.atan2,Na=Math.abs,Ba=Math.cos,jn=Math.PI,mu=function(c,d,g,b){g===void 0&&(g=1),b===void 0&&(b=1),c=new F(c),d=new F(d);for(var y=Array.from(c.lab()),k=y[0],_=y[1],j=y[2],T=Array.from(d.lab()),O=T[0],H=T[1],R=T[2],K=Tr(_*_+j*j),X=Tr(H*H+R*R),ae=k<16?.511:.040975*k/(1+.01765*k),de=.0638*K/(1+.0131*K)+.638,le=K<1e-6?0:hu(j,_)*180/jn;le<0;)le+=360;for(;le>=360;)le-=360;var me=le>=164&&le<=345?.56+Na(.2*Ba(jn*(le+168)/180)):.36+Na(.4*Ba(jn*(le+35)/180)),ke=K*K*K*K,Oe=Tr(ke/(ke+1900)),Ae=de*(Oe*me+1-Oe),Ve=k-O,fe=K-X,B=_-H,ne=j-R,pe=B*B+ne*ne-fe*fe,ce=Ve/(g*ae),He=fe/(b*de),je=Ae;return Tr(ce*ce+He*He+pe/(je*je))},vu=function(c,d,g){g===void 0&&(g="lab"),c=new F(c),d=new F(d);var b=c.get(g),y=d.get(g),k=0;for(var _ in b){var j=(b[_]||0)-(y[_]||0);k+=j*j}return Math.sqrt(k)},bu=function(){for(var c=[],d=arguments.length;d--;)c[d]=arguments[d];try{return new(Function.prototype.bind.apply(F,[null].concat(c))),!0}catch(g){return!1}},wu={cool:function(){return jr([J.hsl(180,1,.9),J.hsl(250,.7,.4)])},hot:function(){return jr(["#000","#f00","#ff0","#fff"]).mode("rgb")}},Lr={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},Tn=0,Ga=Object.keys(Lr);Tn<Ga.length;Tn+=1){var qa=Ga[Tn];Lr[qa.toLowerCase()]=Lr[qa]}var _u=Lr;J.average=Bc,J.bezier=Uc,J.blend=eu,J.cubehelix=ou,J.mix=J.interpolate=Fa,J.random=uu,J.scale=jr,J.analyze=Ha.analyze,J.contrast=gu,J.deltaE=mu,J.distance=vu,J.limits=Ha.limits,J.valid=bu,J.scales=wu,J.colors=Ut,J.brewer=_u;var yu=J;return yu})}),ki=yd;var kd=[62,-1,-1,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,63,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Cd=1;var at=typeof BigInt!="undefined"?BigInt:Number;function Ci(e){let r=Ed(e),t=Sd(r[0],r[1]),n=10**t.precision,a=10**t.thirdDimPrecision,{thirdDim:i}=t,s=0,o=0,l=0,f=[],p=2;for(;p<r.length;){let u=Zn(r[p])/n,h=Zn(r[p+1])/n;s+=u,o+=h,i?(l+=Zn(r[p+2])/a,f.push([s,o,l]),p+=3):(f.push([s,o]),p+=2)}if(p!==r.length)throw new Error("Invalid encoding. Premature ending reached");return{...t,polyline:f}}function $d(e){let r=e.charCodeAt(0);return kd[r-45]}function Ed(e){let r=at(0),t=at(0),n=[];if(e.split("").forEach(a=>{let i=at($d(a));r|=(i&at(31))<<t,(i&at(32))===at(0)?(n.push(r),r=at(0),t=at(0)):t+=at(5)}),t>0)throw new Error("Invalid encoding");return n}function Sd(e,r){if(+e.toString()!==Cd)throw new Error("Invalid format version");let t=+r.toString(),n=t&15,a=t>>4&7,i=t>>7&15;return{precision:n,thirdDim:a,thirdDimPrecision:i}}function Zn(e){let r=e;return r&at(1)&&(r=~r),r>>=at(1),+r.toString()}var jd=Qe(function(e,r){(function(t,n){e.exports=n()})(typeof self!="undefined"?self:We,function(){return function(t){var n={};function a(i){if(n[i])return n[i].exports;var s=n[i]={i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,a),s.l=!0,s.exports}return a.m=t,a.c=n,a.d=function(i,s,o){a.o(i,s)||Object.defineProperty(i,s,{enumerable:!0,get:o})},a.r=function(i){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},a.t=function(i,s){if(1&s&&(i=a(i)),8&s||4&s&&typeof i=="object"&&i&&i.__esModule)return i;var o=Object.create(null);if(a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:i}),2&s&&typeof i!="string")for(var l in i)a.d(o,l,function(f){return i[f]}.bind(null,l));return o},a.n=function(i){var s=i&&i.__esModule?function(){return i.default}:function(){return i};return a.d(s,"a",s),s},a.o=function(i,s){return Object.prototype.hasOwnProperty.call(i,s)},a.p="",a(a.s=1)}([function(t,n,a){var i=a(3);function s(o){return i(o)===!0&&Object.prototype.toString.call(o)==="[object Object]"}t.exports=function(o){var l,f;return s(o)!==!1&&typeof(l=o.constructor)=="function"&&s(f=l.prototype)!==!1&&f.hasOwnProperty("isPrototypeOf")!==!1}},function(t,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.VERSION=n.PALETTE_MATERIAL_CHROME=n.PALETTE_MATERIAL_500=n.COLOR_NAMES=n.getLuminance=n.intToRgb=n.rgbToInt=n.rgbToHsv=n.rgbToHsl=n.hslToRgb=n.rgbToHex=n.parseColor=n.parseColorToHsla=n.parseColorToHsl=n.parseColorToRgba=n.parseColorToRgb=n.from=n.createPicker=void 0;var i=function(){function P(E,C){for(var L=0;L<C.length;L++){var V=C[L];V.enumerable=V.enumerable||!1,V.configurable=!0,"value"in V&&(V.writable=!0),Object.defineProperty(E,V.key,V)}}return function(E,C,L){return C&&P(E.prototype,C),L&&P(E,L),E}}(),s=function(P,E){if(Array.isArray(P))return P;if(Symbol.iterator in Object(P))return function(C,L){var V=[],N=!0,W=!1,x=void 0;try{for(var A,ee=C[Symbol.iterator]();!(N=(A=ee.next()).done)&&(V.push(A.value),!L||V.length!==L);N=!0);}catch(ue){W=!0,x=ue}finally{try{!N&&ee.return&&ee.return()}finally{if(W)throw x}}return V}(P,E);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=a(2),l=p(a(0)),f=p(a(4));function p(P){return P&&P.__esModule?P:{default:P}}function u(P,E){if(!(P instanceof E))throw new TypeError("Cannot call a class as a function")}function h(P){if(Array.isArray(P)){for(var E=0,C=Array(P.length);E<P.length;E++)C[E]=P[E];return C}return Array.from(P)}var w=typeof window!="undefined"&&window.navigator.userAgent.indexOf("Edge")>-1,D=typeof window!="undefined"&&window.navigator.userAgent.indexOf("rv:")>-1,Z={id:null,attachTo:"body",showHSL:!0,showRGB:!0,showHEX:!0,showAlpha:!1,color:"#ff0000",palette:null,paletteEditable:!1,useAlphaInPalette:"auto",slBarSize:[232,150],hueBarSize:[150,11],alphaBarSize:[150,11]},U="COLOR",re="RGBA_USER",F="HSLA_USER";function ie(P,E,C){return P?P instanceof HTMLElement?P:P instanceof NodeList?P[0]:typeof P=="string"?document.querySelector(P):P.jquery?P.get(0):C?E:null:E}function J(P){var E=P.getContext("2d"),C=+P.width,L=+P.height,V=E.createLinearGradient(1,1,1,L-1);return V.addColorStop(0,"white"),V.addColorStop(1,"black"),{setHue:function(N){var W=E.createLinearGradient(1,0,C-1,0);W.addColorStop(0,"hsla("+N+", 100%, 50%, 0)"),W.addColorStop(1,"hsla("+N+", 100%, 50%, 1)"),E.fillStyle=V,E.fillRect(0,0,C,L),E.fillStyle=W,E.globalCompositeOperation="multiply",E.fillRect(0,0,C,L),E.globalCompositeOperation="source-over"},grabColor:function(N,W){return E.getImageData(N,W,1,1).data},findColor:function(N,W,x){var A=(0,o.rgbToHsv)(N,W,x),ee=s(A,3),ue=ee[1],ge=ee[2];return[ue*C,L-ge*L]}}}function $e(P,E,C){return P===null?E:/^\s*$/.test(P)?C:!!/true|yes|1/i.test(P)||!/false|no|0/i.test(P)&&E}function Je(P,E,C){if(P===null)return E;if(/^\s*$/.test(P))return C;var L=P.split(",").map(Number);return L.length===2&&L[0]&&L[1]?L:E}var ze=function(){function P(E,C){if(u(this,P),C?(E=ie(E),this.options=Object.assign({},Z,C)):E&&(0,l.default)(E)?(this.options=Object.assign({},Z,E),E=ie(this.options.attachTo)):(this.options=Object.assign({},Z),E=ie((0,o.nvl)(E,this.options.attachTo))),!E)throw new Error("Container not found: "+this.options.attachTo);(function(N,W){var x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"acp-";if(W.hasAttribute(x+"show-hsl")&&(N.showHSL=$e(W.getAttribute(x+"show-hsl"),Z.showHSL,!0)),W.hasAttribute(x+"show-rgb")&&(N.showRGB=$e(W.getAttribute(x+"show-rgb"),Z.showRGB,!0)),W.hasAttribute(x+"show-hex")&&(N.showHEX=$e(W.getAttribute(x+"show-hex"),Z.showHEX,!0)),W.hasAttribute(x+"show-alpha")&&(N.showAlpha=$e(W.getAttribute(x+"show-alpha"),Z.showAlpha,!0)),W.hasAttribute(x+"palette-editable")&&(N.paletteEditable=$e(W.getAttribute(x+"palette-editable"),Z.paletteEditable,!0)),W.hasAttribute(x+"sl-bar-size")&&(N.slBarSize=Je(W.getAttribute(x+"sl-bar-size"),Z.slBarSize,[232,150])),W.hasAttribute(x+"hue-bar-size")&&(N.hueBarSize=Je(W.getAttribute(x+"hue-bar-size"),Z.hueBarSize,[150,11]),N.alphaBarSize=N.hueBarSize),W.hasAttribute(x+"palette")){var A=W.getAttribute(x+"palette");switch(A){case"PALETTE_MATERIAL_500":N.palette=o.PALETTE_MATERIAL_500;break;case"PALETTE_MATERIAL_CHROME":case"":N.palette=o.PALETTE_MATERIAL_CHROME;break;default:N.palette=A.split(/[;|]/)}}W.hasAttribute(x+"color")&&(N.color=W.getAttribute(x+"color"))})(this.options,E),this.H=0,this.S=0,this.L=0,this.R=0,this.G=0,this.B=0,this.A=1,this.palette={},this.element=document.createElement("div"),this.options.id&&(this.element.id=this.options.id),this.element.className="a-color-picker",this.element.innerHTML=f.default,E.appendChild(this.element);var L=this.element.querySelector(".a-color-picker-h");this.setupHueCanvas(L),this.hueBarHelper=J(L),this.huePointer=this.element.querySelector(".a-color-picker-h+.a-color-picker-dot");var V=this.element.querySelector(".a-color-picker-sl");this.setupSlCanvas(V),this.slBarHelper=J(V),this.slPointer=this.element.querySelector(".a-color-picker-sl+.a-color-picker-dot"),this.preview=this.element.querySelector(".a-color-picker-preview"),this.setupClipboard(this.preview.querySelector(".a-color-picker-clipbaord")),this.options.showHSL?(this.setupInput(this.inputH=this.element.querySelector(".a-color-picker-hsl>input[nameref=H]")),this.setupInput(this.inputS=this.element.querySelector(".a-color-picker-hsl>input[nameref=S]")),this.setupInput(this.inputL=this.element.querySelector(".a-color-picker-hsl>input[nameref=L]"))):this.element.querySelector(".a-color-picker-hsl").remove(),this.options.showRGB?(this.setupInput(this.inputR=this.element.querySelector(".a-color-picker-rgb>input[nameref=R]")),this.setupInput(this.inputG=this.element.querySelector(".a-color-picker-rgb>input[nameref=G]")),this.setupInput(this.inputB=this.element.querySelector(".a-color-picker-rgb>input[nameref=B]"))):this.element.querySelector(".a-color-picker-rgb").remove(),this.options.showHEX?this.setupInput(this.inputRGBHEX=this.element.querySelector("input[nameref=RGBHEX]")):this.element.querySelector(".a-color-picker-rgbhex").remove(),this.options.paletteEditable||this.options.palette&&this.options.palette.length>0?this.setPalette(this.paletteRow=this.element.querySelector(".a-color-picker-palette")):(this.paletteRow=this.element.querySelector(".a-color-picker-palette"),this.paletteRow.remove()),this.options.showAlpha?(this.setupAlphaCanvas(this.element.querySelector(".a-color-picker-a")),this.alphaPointer=this.element.querySelector(".a-color-picker-a+.a-color-picker-dot")):this.element.querySelector(".a-color-picker-alpha").remove(),this.element.style.width=this.options.slBarSize[0]+"px",this.onValueChanged(U,this.options.color)}return i(P,[{key:"setupHueCanvas",value:function(E){var C=this;E.width=this.options.hueBarSize[0],E.height=this.options.hueBarSize[1];for(var L=E.getContext("2d"),V=L.createLinearGradient(0,0,this.options.hueBarSize[0],0),N=0;N<=1;N+=1/360)V.addColorStop(N,"hsl("+360*N+", 100%, 50%)");L.fillStyle=V,L.fillRect(0,0,this.options.hueBarSize[0],this.options.hueBarSize[1]);var W=function(A){var ee=(0,o.limit)(A.clientX-E.getBoundingClientRect().left,0,C.options.hueBarSize[0]),ue=Math.round(360*ee/C.options.hueBarSize[0]);C.huePointer.style.left=ee-7+"px",C.onValueChanged("H",ue)},x=function A(){document.removeEventListener("mousemove",W),document.removeEventListener("mouseup",A)};E.addEventListener("mousedown",function(A){W(A),document.addEventListener("mousemove",W),document.addEventListener("mouseup",x)})}},{key:"setupSlCanvas",value:function(E){var C=this;E.width=this.options.slBarSize[0],E.height=this.options.slBarSize[1];var L=function(N){var W=(0,o.limit)(N.clientX-E.getBoundingClientRect().left,0,C.options.slBarSize[0]-1),x=(0,o.limit)(N.clientY-E.getBoundingClientRect().top,0,C.options.slBarSize[1]-1),A=C.slBarHelper.grabColor(W,x);C.slPointer.style.left=W-7+"px",C.slPointer.style.top=x-7+"px",C.onValueChanged("RGB",A)},V=function N(){document.removeEventListener("mousemove",L),document.removeEventListener("mouseup",N)};E.addEventListener("mousedown",function(N){L(N),document.addEventListener("mousemove",L),document.addEventListener("mouseup",V)})}},{key:"setupAlphaCanvas",value:function(E){var C=this;E.width=this.options.alphaBarSize[0],E.height=this.options.alphaBarSize[1];var L=E.getContext("2d"),V=L.createLinearGradient(0,0,E.width-1,0);V.addColorStop(0,"hsla(0, 0%, 50%, 0)"),V.addColorStop(1,"hsla(0, 0%, 50%, 1)"),L.fillStyle=V,L.fillRect(0,0,this.options.alphaBarSize[0],this.options.alphaBarSize[1]);var N=function(x){var A=(0,o.limit)(x.clientX-E.getBoundingClientRect().left,0,C.options.alphaBarSize[0]),ee=+(A/C.options.alphaBarSize[0]).toFixed(2);C.alphaPointer.style.left=A-7+"px",C.onValueChanged("ALPHA",ee)},W=function x(){document.removeEventListener("mousemove",N),document.removeEventListener("mouseup",x)};E.addEventListener("mousedown",function(x){N(x),document.addEventListener("mousemove",N),document.addEventListener("mouseup",W)})}},{key:"setupInput",value:function(E){var C=this,L=+E.min,V=+E.max,N=E.getAttribute("nameref");E.hasAttribute("select-on-focus")&&E.addEventListener("focus",function(){E.select()}),E.type==="text"?E.addEventListener("change",function(){C.onValueChanged(N,E.value)}):((w||D)&&E.addEventListener("keydown",function(W){W.key==="Up"?(E.value=(0,o.limit)(+E.value+1,L,V),C.onValueChanged(N,E.value),W.returnValue=!1):W.key==="Down"&&(E.value=(0,o.limit)(+E.value-1,L,V),C.onValueChanged(N,E.value),W.returnValue=!1)}),E.addEventListener("change",function(){var W=+E.value;C.onValueChanged(N,(0,o.limit)(W,L,V))}))}},{key:"setupClipboard",value:function(E){var C=this;E.title="click to copy",E.addEventListener("click",function(){E.value=(0,o.parseColor)([C.R,C.G,C.B,C.A],"hexcss4"),E.select(),document.execCommand("copy")})}},{key:"setPalette",value:function(E){var C=this,L=this.options.useAlphaInPalette==="auto"?this.options.showAlpha:this.options.useAlphaInPalette,V=null;switch(this.options.palette){case"PALETTE_MATERIAL_500":V=o.PALETTE_MATERIAL_500;break;case"PALETTE_MATERIAL_CHROME":V=o.PALETTE_MATERIAL_CHROME;break;default:V=(0,o.ensureArray)(this.options.palette)}if(this.options.paletteEditable||V.length>0){var N=function(A,ee,ue){var ge=E.querySelector('.a-color-picker-palette-color[data-color="'+A+'"]')||document.createElement("div");ge.className="a-color-picker-palette-color",ge.style.backgroundColor=A,ge.setAttribute("data-color",A),ge.title=A,E.insertBefore(ge,ee),C.palette[A]=!0,ue&&C.onPaletteColorAdd(A)},W=function(A,ee){A?(E.removeChild(A),C.palette[A.getAttribute("data-color")]=!1,ee&&C.onPaletteColorRemove(A.getAttribute("data-color"))):(E.querySelectorAll(".a-color-picker-palette-color[data-color]").forEach(function(ue){E.removeChild(ue)}),Object.keys(C.palette).forEach(function(ue){C.palette[ue]=!1}),ee&&C.onPaletteColorRemove())};if(V.map(function(A){return(0,o.parseColor)(A,L?"rgbcss4":"hex")}).filter(function(A){return!!A}).forEach(function(A){return N(A)}),this.options.paletteEditable){var x=document.createElement("div");x.className="a-color-picker-palette-color a-color-picker-palette-add",x.innerHTML="+",E.appendChild(x),E.addEventListener("click",function(A){/a-color-picker-palette-add/.test(A.target.className)?A.shiftKey?W(null,!0):N(L?(0,o.parseColor)([C.R,C.G,C.B,C.A],"rgbcss4"):(0,o.rgbToHex)(C.R,C.G,C.B),A.target,!0):/a-color-picker-palette-color/.test(A.target.className)&&(A.shiftKey?W(A.target,!0):C.onValueChanged(U,A.target.getAttribute("data-color")))})}else E.addEventListener("click",function(A){/a-color-picker-palette-color/.test(A.target.className)&&C.onValueChanged(U,A.target.getAttribute("data-color"))})}else E.style.display="none"}},{key:"updatePalette",value:function(E){this.paletteRow.innerHTML="",this.palette={},this.paletteRow.parentElement||this.element.appendChild(this.paletteRow),this.options.palette=E,this.setPalette(this.paletteRow)}},{key:"onValueChanged",value:function(E,C){var L=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{silent:!1};switch(E){case"H":this.H=C;var V=(0,o.hslToRgb)(this.H,this.S,this.L),N=s(V,3);this.R=N[0],this.G=N[1],this.B=N[2],this.slBarHelper.setHue(C),this.updatePointerH(this.H),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGB(this.R,this.G,this.B),this.updateInputRGBHEX(this.R,this.G,this.B);break;case"S":this.S=C;var W=(0,o.hslToRgb)(this.H,this.S,this.L),x=s(W,3);this.R=x[0],this.G=x[1],this.B=x[2],this.updatePointerSL(this.H,this.S,this.L),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGB(this.R,this.G,this.B),this.updateInputRGBHEX(this.R,this.G,this.B);break;case"L":this.L=C;var A=(0,o.hslToRgb)(this.H,this.S,this.L),ee=s(A,3);this.R=ee[0],this.G=ee[1],this.B=ee[2],this.updatePointerSL(this.H,this.S,this.L),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGB(this.R,this.G,this.B),this.updateInputRGBHEX(this.R,this.G,this.B);break;case"R":this.R=C;var ue=(0,o.rgbToHsl)(this.R,this.G,this.B),ge=s(ue,3);this.H=ge[0],this.S=ge[1],this.L=ge[2],this.slBarHelper.setHue(this.H),this.updatePointerH(this.H),this.updatePointerSL(this.H,this.S,this.L),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGBHEX(this.R,this.G,this.B);break;case"G":this.G=C;var be=(0,o.rgbToHsl)(this.R,this.G,this.B),Me=s(be,3);this.H=Me[0],this.S=Me[1],this.L=Me[2],this.slBarHelper.setHue(this.H),this.updatePointerH(this.H),this.updatePointerSL(this.H,this.S,this.L),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGBHEX(this.R,this.G,this.B);break;case"B":this.B=C;var ht=(0,o.rgbToHsl)(this.R,this.G,this.B),qe=s(ht,3);this.H=qe[0],this.S=qe[1],this.L=qe[2],this.slBarHelper.setHue(this.H),this.updatePointerH(this.H),this.updatePointerSL(this.H,this.S,this.L),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGBHEX(this.R,this.G,this.B);break;case"RGB":var Ze=s(C,3);this.R=Ze[0],this.G=Ze[1],this.B=Ze[2];var ir=(0,o.rgbToHsl)(this.R,this.G,this.B),pt=s(ir,3);this.H=pt[0],this.S=pt[1],this.L=pt[2],this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGB(this.R,this.G,this.B),this.updateInputRGBHEX(this.R,this.G,this.B);break;case re:var et=s(C,4);this.R=et[0],this.G=et[1],this.B=et[2],this.A=et[3];var xt=(0,o.rgbToHsl)(this.R,this.G,this.B),mt=s(xt,3);this.H=mt[0],this.S=mt[1],this.L=mt[2],this.slBarHelper.setHue(this.H),this.updatePointerH(this.H),this.updatePointerSL(this.H,this.S,this.L),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGB(this.R,this.G,this.B),this.updateInputRGBHEX(this.R,this.G,this.B),this.updatePointerA(this.A);break;case F:var ot=s(C,4);this.H=ot[0],this.S=ot[1],this.L=ot[2],this.A=ot[3];var Rt=(0,o.hslToRgb)(this.H,this.S,this.L),ft=s(Rt,3);this.R=ft[0],this.G=ft[1],this.B=ft[2],this.slBarHelper.setHue(this.H),this.updatePointerH(this.H),this.updatePointerSL(this.H,this.S,this.L),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGB(this.R,this.G,this.B),this.updateInputRGBHEX(this.R,this.G,this.B),this.updatePointerA(this.A);break;case"RGBHEX":var St=(0,o.cssColorToRgb)(C)||[this.R,this.G,this.B],tt=s(St,3);this.R=tt[0],this.G=tt[1],this.B=tt[2];var Ht=(0,o.rgbToHsl)(this.R,this.G,this.B),$t=s(Ht,3);this.H=$t[0],this.S=$t[1],this.L=$t[2],this.slBarHelper.setHue(this.H),this.updatePointerH(this.H),this.updatePointerSL(this.H,this.S,this.L),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGB(this.R,this.G,this.B);break;case U:var Nt=(0,o.parseColor)(C,"rgba")||[0,0,0,1],lt=s(Nt,4);this.R=lt[0],this.G=lt[1],this.B=lt[2],this.A=lt[3];var Bt=(0,o.rgbToHsl)(this.R,this.G,this.B),st=s(Bt,3);this.H=st[0],this.S=st[1],this.L=st[2],this.slBarHelper.setHue(this.H),this.updatePointerH(this.H),this.updatePointerSL(this.H,this.S,this.L),this.updateInputHSL(this.H,this.S,this.L),this.updateInputRGB(this.R,this.G,this.B),this.updateInputRGBHEX(this.R,this.G,this.B),this.updatePointerA(this.A);break;case"ALPHA":this.A=C}this.A===1?this.preview.style.backgroundColor="rgb("+this.R+","+this.G+","+this.B+")":this.preview.style.backgroundColor="rgba("+this.R+","+this.G+","+this.B+","+this.A+")",L&&L.silent||this.onchange&&this.onchange(this.preview.style.backgroundColor)}},{key:"onPaletteColorAdd",value:function(E){this.oncoloradd&&this.oncoloradd(E)}},{key:"onPaletteColorRemove",value:function(E){this.oncolorremove&&this.oncolorremove(E)}},{key:"updateInputHSL",value:function(E,C,L){this.options.showHSL&&(this.inputH.value=E,this.inputS.value=C,this.inputL.value=L)}},{key:"updateInputRGB",value:function(E,C,L){this.options.showRGB&&(this.inputR.value=E,this.inputG.value=C,this.inputB.value=L)}},{key:"updateInputRGBHEX",value:function(E,C,L){this.options.showHEX&&(this.inputRGBHEX.value=(0,o.rgbToHex)(E,C,L))}},{key:"updatePointerH",value:function(E){var C=this.options.hueBarSize[0]*E/360;this.huePointer.style.left=C-7+"px"}},{key:"updatePointerSL",value:function(E,C,L){var V=(0,o.hslToRgb)(E,C,L),N=s(V,3),W=N[0],x=N[1],A=N[2],ee=this.slBarHelper.findColor(W,x,A),ue=s(ee,2),ge=ue[0],be=ue[1];ge>=0&&(this.slPointer.style.left=ge-7+"px",this.slPointer.style.top=be-7+"px")}},{key:"updatePointerA",value:function(E){if(this.options.showAlpha){var C=this.options.alphaBarSize[0]*E;this.alphaPointer.style.left=C-7+"px"}}}]),P}(),$=function(){function P(E){u(this,P),this.name=E,this.listeners=[]}return i(P,[{key:"on",value:function(E){E&&this.listeners.push(E)}},{key:"off",value:function(E){this.listeners=E?this.listeners.filter(function(C){return C!==E}):[]}},{key:"emit",value:function(E,C){for(var L=this.listeners.slice(0),V=0;V<L.length;V++)L[V].apply(C,E)}}]),P}();function G(P,E){var C=new ze(P,E),L={change:new $("change"),coloradd:new $("coloradd"),colorremove:new $("colorremove")},V=!0,N={},W={get element(){return C.element},get rgb(){return[C.R,C.G,C.B]},set rgb(x){var A=s(x,3),ee=A[0],ue=A[1],ge=A[2],be=[(0,o.limit)(ee,0,255),(0,o.limit)(ue,0,255),(0,o.limit)(ge,0,255)];ee=be[0],ue=be[1],ge=be[2],C.onValueChanged(re,[ee,ue,ge,1])},get hsl(){return[C.H,C.S,C.L]},set hsl(x){var A=s(x,3),ee=A[0],ue=A[1],ge=A[2],be=[(0,o.limit)(ee,0,360),(0,o.limit)(ue,0,100),(0,o.limit)(ge,0,100)];ee=be[0],ue=be[1],ge=be[2],C.onValueChanged(F,[ee,ue,ge,1])},get rgbhex(){return this.all.hex},get rgba(){return[C.R,C.G,C.B,C.A]},set rgba(x){var A=s(x,4),ee=A[0],ue=A[1],ge=A[2],be=A[3],Me=[(0,o.limit)(ee,0,255),(0,o.limit)(ue,0,255),(0,o.limit)(ge,0,255),(0,o.limit)(be,0,1)];ee=Me[0],ue=Me[1],ge=Me[2],be=Me[3],C.onValueChanged(re,[ee,ue,ge,be])},get hsla(){return[C.H,C.S,C.L,C.A]},set hsla(x){var A=s(x,4),ee=A[0],ue=A[1],ge=A[2],be=A[3],Me=[(0,o.limit)(ee,0,360),(0,o.limit)(ue,0,100),(0,o.limit)(ge,0,100),(0,o.limit)(be,0,1)];ee=Me[0],ue=Me[1],ge=Me[2],be=Me[3],C.onValueChanged(F,[ee,ue,ge,be])},get color(){return this.all.toString()},set color(x){C.onValueChanged(U,x)},setColor:function(x){var A=arguments.length>1&&arguments[1]!==void 0&&arguments[1];C.onValueChanged(U,x,{silent:A})},get all(){if(V){var x=[C.R,C.G,C.B,C.A],A=C.A<1?"rgba("+C.R+","+C.G+","+C.B+","+C.A+")":o.rgbToHex.apply(void 0,x);(N=(0,o.parseColor)(x,N)).toString=function(){return A},V=!1}return Object.assign({},N)},get onchange(){return L.change&&L.change.listeners[0]},set onchange(x){this.off("change").on("change",x)},get oncoloradd(){return L.coloradd&&L.coloradd.listeners[0]},set oncoloradd(x){this.off("coloradd").on("coloradd",x)},get oncolorremove(){return L.colorremove&&L.colorremove.listeners[0]},set oncolorremove(x){this.off("colorremove").on("colorremove",x)},get palette(){return Object.keys(C.palette).filter(function(x){return C.palette[x]})},set palette(x){C.updatePalette(x)},show:function(){C.element.classList.remove("hidden")},hide:function(){C.element.classList.add("hidden")},toggle:function(){C.element.classList.toggle("hidden")},on:function(x,A){return x&&L[x]&&L[x].on(A),this},off:function(x,A){return x&&L[x]&&L[x].off(A),this},destroy:function(){L.change.off(),L.coloradd.off(),L.colorremove.off(),C.element.remove(),L=null,C=null}};return C.onchange=function(){for(var x=arguments.length,A=Array(x),ee=0;ee<x;ee++)A[ee]=arguments[ee];V=!0,L.change.emit([W].concat(A),W)},C.oncoloradd=function(){for(var x=arguments.length,A=Array(x),ee=0;ee<x;ee++)A[ee]=arguments[ee];L.coloradd.emit([W].concat(A),W)},C.oncolorremove=function(){for(var x=arguments.length,A=Array(x),ee=0;ee<x;ee++)A[ee]=arguments[ee];L.colorremove.emit([W].concat(A),W)},C.element.ctrl=W,W}if(typeof window!="undefined"&&!document.querySelector('head>style[data-source="a-color-picker"]')){var q=a(5).toString(),z=document.createElement("style");z.setAttribute("type","text/css"),z.setAttribute("data-source","a-color-picker"),z.innerHTML=q,document.querySelector("head").appendChild(z)}n.createPicker=G,n.from=function(P,E){var C=function(L){return L?Array.isArray(L)?L:L instanceof HTMLElement?[L]:L instanceof NodeList?[].concat(h(L)):typeof L=="string"?[].concat(h(document.querySelectorAll(L))):L.jquery?L.get():[]:[]}(P).map(function(L,V){var N=G(L,E);return N.index=V,N});return C.on=function(L,V){return C.forEach(function(N){return N.on(L,V)}),this},C.off=function(L){return C.forEach(function(V){return V.off(L)}),this},C},n.parseColorToRgb=o.parseColorToRgb,n.parseColorToRgba=o.parseColorToRgba,n.parseColorToHsl=o.parseColorToHsl,n.parseColorToHsla=o.parseColorToHsla,n.parseColor=o.parseColor,n.rgbToHex=o.rgbToHex,n.hslToRgb=o.hslToRgb,n.rgbToHsl=o.rgbToHsl,n.rgbToHsv=o.rgbToHsv,n.rgbToInt=o.rgbToInt,n.intToRgb=o.intToRgb,n.getLuminance=o.getLuminance,n.COLOR_NAMES=o.COLOR_NAMES,n.PALETTE_MATERIAL_500=o.PALETTE_MATERIAL_500,n.PALETTE_MATERIAL_CHROME=o.PALETTE_MATERIAL_CHROME,n.VERSION="1.2.1"},function(t,n,a){Object.defineProperty(n,"__esModule",{value:!0}),n.nvl=n.ensureArray=n.limit=n.getLuminance=n.parseColor=n.parseColorToHsla=n.parseColorToHsl=n.cssHslaToHsla=n.cssHslToHsl=n.parseColorToRgba=n.parseColorToRgb=n.cssRgbaToRgba=n.cssRgbToRgb=n.cssColorToRgba=n.cssColorToRgb=n.intToRgb=n.rgbToInt=n.rgbToHsv=n.rgbToHsl=n.hslToRgb=n.rgbToHex=n.PALETTE_MATERIAL_CHROME=n.PALETTE_MATERIAL_500=n.COLOR_NAMES=void 0;var i=function($,G){if(Array.isArray($))return $;if(Symbol.iterator in Object($))return function(q,z){var P=[],E=!0,C=!1,L=void 0;try{for(var V,N=q[Symbol.iterator]();!(E=(V=N.next()).done)&&(P.push(V.value),!z||P.length!==z);E=!0);}catch(W){C=!0,L=W}finally{try{!E&&N.return&&N.return()}finally{if(C)throw L}}return P}($,G);throw new TypeError("Invalid attempt to destructure non-iterable instance")},s=function($){return $&&$.__esModule?$:{default:$}}(a(0));function o($){if(Array.isArray($)){for(var G=0,q=Array($.length);G<$.length;G++)q[G]=$[G];return q}return Array.from($)}var l={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4","indianred ":"#CD5C5C","indigo ":"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function f($,G,q){return $=+$,isNaN($)||$<G?G:$>q?q:$}function p($,G){return $??G}function u($,G,q){var z=[f($,0,255),f(G,0,255),f(q,0,255)];return"#"+("000000"+(($=z[0])<<16|(G=z[1])<<8|(q=z[2])).toString(16)).slice(-6)}function h($,G,q){var z=void 0,P=void 0,E=void 0,C=[f($,0,360)/360,f(G,0,100)/100,f(q,0,100)/100];if($=C[0],q=C[2],(G=C[1])==0)z=P=E=q;else{var L=function(W,x,A){return A<0&&(A+=1),A>1&&(A-=1),A<1/6?W+6*(x-W)*A:A<.5?x:A<2/3?W+(x-W)*(2/3-A)*6:W},V=q<.5?q*(1+G):q+G-q*G,N=2*q-V;z=L(N,V,$+1/3),P=L(N,V,$),E=L(N,V,$-1/3)}return[255*z,255*P,255*E].map(Math.round)}function w($,G,q){var z=[f($,0,255)/255,f(G,0,255)/255,f(q,0,255)/255];$=z[0],G=z[1],q=z[2];var P=Math.max($,G,q),E=Math.min($,G,q),C=void 0,L=void 0,V=(P+E)/2;if(P==E)C=L=0;else{var N=P-E;switch(L=V>.5?N/(2-P-E):N/(P+E),P){case $:C=(G-q)/N+(G<q?6:0);break;case G:C=(q-$)/N+2;break;case q:C=($-G)/N+4}C/=6}return[360*C,100*L,100*V].map(Math.round)}function D($,G,q){return $<<16|G<<8|q}function Z($){if($){var G=l[$.toString().toLowerCase()],q=/^\s*#?((([0-9A-F])([0-9A-F])([0-9A-F]))|(([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})))\s*$/i.exec(G||$)||[],z=i(q,10),P=z[3],E=z[4],C=z[5],L=z[7],V=z[8],N=z[9];if(P!==void 0)return[parseInt(P+P,16),parseInt(E+E,16),parseInt(C+C,16)];if(L!==void 0)return[parseInt(L,16),parseInt(V,16),parseInt(N,16)]}}function U($){if($){var G=l[$.toString().toLowerCase()],q=/^\s*#?((([0-9A-F])([0-9A-F])([0-9A-F])([0-9A-F])?)|(([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})?))\s*$/i.exec(G||$)||[],z=i(q,12),P=z[3],E=z[4],C=z[5],L=z[6],V=z[8],N=z[9],W=z[10],x=z[11];if(P!==void 0)return[parseInt(P+P,16),parseInt(E+E,16),parseInt(C+C,16),L?+(parseInt(L+L,16)/255).toFixed(2):1];if(V!==void 0)return[parseInt(V,16),parseInt(N,16),parseInt(W,16),x?+(parseInt(x,16)/255).toFixed(2):1]}}function re($){if($){var G=/^rgb\((\d+)[\s,](\d+)[\s,](\d+)\)/i.exec($)||[],q=i(G,4),z=q[0],P=q[1],E=q[2],C=q[3];return z?[f(P,0,255),f(E,0,255),f(C,0,255)]:void 0}}function F($){if($){var G=/^rgba?\((\d+)\s*[\s,]\s*(\d+)\s*[\s,]\s*(\d+)(\s*[\s,]\s*(\d*(.\d+)?))?\)/i.exec($)||[],q=i(G,6),z=q[0],P=q[1],E=q[2],C=q[3],L=q[5];return z?[f(P,0,255),f(E,0,255),f(C,0,255),f(p(L,1),0,1)]:void 0}}function ie($){if(Array.isArray($))return[f($[0],0,255),f($[1],0,255),f($[2],0,255),f(p($[3],1),0,1)];var G=U($)||F($);return G&&G.length===3&&G.push(1),G}function J($){if($){var G=/^hsl\((\d+)[\s,](\d+)[\s,](\d+)\)/i.exec($)||[],q=i(G,4),z=q[0],P=q[1],E=q[2],C=q[3];return z?[f(P,0,360),f(E,0,100),f(C,0,100)]:void 0}}function $e($){if($){var G=/^hsla?\((\d+)\s*[\s,]\s*(\d+)\s*[\s,]\s*(\d+)(\s*[\s,]\s*(\d*(.\d+)?))?\)/i.exec($)||[],q=i(G,6),z=q[0],P=q[1],E=q[2],C=q[3],L=q[5];return z?[f(P,0,255),f(E,0,255),f(C,0,255),f(p(L,1),0,1)]:void 0}}function Je($){if(Array.isArray($))return[f($[0],0,360),f($[1],0,100),f($[2],0,100),f(p($[3],1),0,1)];var G=$e($);return G&&G.length===3&&G.push(1),G}function ze($,G){switch(G){case"rgb":default:return $.slice(0,3);case"rgbcss":return"rgb("+$[0]+", "+$[1]+", "+$[2]+")";case"rgbcss4":return"rgb("+$[0]+", "+$[1]+", "+$[2]+", "+$[3]+")";case"rgba":return $;case"rgbacss":return"rgba("+$[0]+", "+$[1]+", "+$[2]+", "+$[3]+")";case"hsl":return w.apply(void 0,o($));case"hslcss":return"hsl("+($=w.apply(void 0,o($)))[0]+", "+$[1]+", "+$[2]+")";case"hslcss4":var q=w.apply(void 0,o($));return"hsl("+q[0]+", "+q[1]+", "+q[2]+", "+$[3]+")";case"hsla":return[].concat(o(w.apply(void 0,o($))),[$[3]]);case"hslacss":var z=w.apply(void 0,o($));return"hsla("+z[0]+", "+z[1]+", "+z[2]+", "+$[3]+")";case"hex":return u.apply(void 0,o($));case"hexcss4":return u.apply(void 0,o($))+("00"+parseInt(255*$[3]).toString(16)).slice(-2);case"int":return D.apply(void 0,o($))}}n.COLOR_NAMES=l,n.PALETTE_MATERIAL_500=["#F44336","#E91E63","#E91E63","#9C27B0","#9C27B0","#673AB7","#673AB7","#3F51B5","#3F51B5","#2196F3","#2196F3","#03A9F4","#03A9F4","#00BCD4","#00BCD4","#009688","#009688","#4CAF50","#4CAF50","#8BC34A","#8BC34A","#CDDC39","#CDDC39","#FFEB3B","#FFEB3B","#FFC107","#FFC107","#FF9800","#FF9800","#FF5722","#FF5722","#795548","#795548","#9E9E9E","#9E9E9E","#607D8B","#607D8B"],n.PALETTE_MATERIAL_CHROME=["#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],n.rgbToHex=u,n.hslToRgb=h,n.rgbToHsl=w,n.rgbToHsv=function($,G,q){var z=[f($,0,255)/255,f(G,0,255)/255,f(q,0,255)/255];$=z[0],G=z[1],q=z[2];var P,E=Math.max($,G,q),C=Math.min($,G,q),L=void 0,V=E,N=E-C;if(P=E===0?0:N/E,E==C)L=0;else{switch(E){case $:L=(G-q)/N+(G<q?6:0);break;case G:L=(q-$)/N+2;break;case q:L=($-G)/N+4}L/=6}return[L,P,V]},n.rgbToInt=D,n.intToRgb=function($){return[$>>16&255,$>>8&255,255&$]},n.cssColorToRgb=Z,n.cssColorToRgba=U,n.cssRgbToRgb=re,n.cssRgbaToRgba=F,n.parseColorToRgb=function($){return Array.isArray($)?$=[f($[0],0,255),f($[1],0,255),f($[2],0,255)]:Z($)||re($)},n.parseColorToRgba=ie,n.cssHslToHsl=J,n.cssHslaToHsla=$e,n.parseColorToHsl=function($){return Array.isArray($)?$=[f($[0],0,360),f($[1],0,100),f($[2],0,100)]:J($)},n.parseColorToHsla=Je,n.parseColor=function($,G){if(G=G||"rgb",$!=null){var q=void 0;if((q=ie($))||(q=Je($))&&(q=[].concat(o(h.apply(void 0,o(q))),[q[3]])))return(0,s.default)(G)?["rgb","rgbcss","rgbcss4","rgba","rgbacss","hsl","hslcss","hslcss4","hsla","hslacss","hex","hexcss4","int"].reduce(function(z,P){return z[P]=ze(q,P),z},G||{}):ze(q,G.toString().toLowerCase())}},n.getLuminance=function($,G,q){return .2126*($=($/=255)<.03928?$/12.92:Math.pow(($+.055)/1.055,2.4))+.7152*(G=(G/=255)<.03928?G/12.92:Math.pow((G+.055)/1.055,2.4))+.0722*((q/=255)<.03928?q/12.92:Math.pow((q+.055)/1.055,2.4))},n.limit=f,n.ensureArray=function($){return $?Array.from($):[]},n.nvl=p},function(t,n,a){t.exports=function(i){return i!=null&&typeof i=="object"&&Array.isArray(i)===!1}},function(t,n){t.exports='<div class="a-color-picker-row a-color-picker-stack a-color-picker-row-top"> <canvas class="a-color-picker-sl a-color-picker-transparent"></canvas> <div class=a-color-picker-dot></div> </div> <div class=a-color-picker-row> <div class="a-color-picker-stack a-color-picker-transparent a-color-picker-circle"> <div class=a-color-picker-preview> <input class=a-color-picker-clipbaord type=text> </div> </div> <div class=a-color-picker-column> <div class="a-color-picker-cell a-color-picker-stack"> <canvas class=a-color-picker-h></canvas> <div class=a-color-picker-dot></div> </div> <div class="a-color-picker-cell a-color-picker-alpha a-color-picker-stack" show-on-alpha> <canvas class="a-color-picker-a a-color-picker-transparent"></canvas> <div class=a-color-picker-dot></div> </div> </div> </div> <div class="a-color-picker-row a-color-picker-hsl" show-on-hsl> <label>H</label> <input nameref=H type=number maxlength=3 min=0 max=360 value=0> <label>S</label> <input nameref=S type=number maxlength=3 min=0 max=100 value=0> <label>L</label> <input nameref=L type=number maxlength=3 min=0 max=100 value=0> </div> <div class="a-color-picker-row a-color-picker-rgb" show-on-rgb> <label>R</label> <input nameref=R type=number maxlength=3 min=0 max=255 value=0> <label>G</label> <input nameref=G type=number maxlength=3 min=0 max=255 value=0> <label>B</label> <input nameref=B type=number maxlength=3 min=0 max=255 value=0> </div> <div class="a-color-picker-row a-color-picker-rgbhex a-color-picker-single-input" show-on-single-input> <label>HEX</label> <input nameref=RGBHEX type=text select-on-focus> </div> <div class="a-color-picker-row a-color-picker-palette"></div>'},function(t,n,a){var i=a(6);t.exports=typeof i=="string"?i:i.toString()},function(t,n,a){(t.exports=a(7)(!1)).push([t.i,`/*!
 * a-color-picker
 * https://github.com/narsenico/a-color-picker
 *
 * Copyright (c) 2017-2018, Gianfranco Caldi.
 * Released under the MIT License.
 */.a-color-picker{background-color:#fff;padding:0;display:inline-flex;flex-direction:column;user-select:none;width:232px;font:400 10px Helvetica,Arial,sans-serif;border-radius:3px;box-shadow:0 0 0 1px rgba(0,0,0,.05),0 2px 4px rgba(0,0,0,.25)}.a-color-picker,.a-color-picker-row,.a-color-picker input{box-sizing:border-box}.a-color-picker-row{padding:15px;display:flex;flex-direction:row;align-items:center;justify-content:space-between;user-select:none}.a-color-picker-row-top{padding:0}.a-color-picker-row:not(:first-child){border-top:1px solid #f5f5f5}.a-color-picker-column{display:flex;flex-direction:column}.a-color-picker-cell{flex:1 1 auto;margin-bottom:4px}.a-color-picker-cell:last-child{margin-bottom:0}.a-color-picker-stack{position:relative}.a-color-picker-dot{position:absolute;width:14px;height:14px;top:0;left:0;background:#fff;pointer-events:none;border-radius:50px;z-index:1000;box-shadow:0 1px 2px rgba(0,0,0,.75)}.a-color-picker-a,.a-color-picker-h,.a-color-picker-sl{cursor:cell}.a-color-picker-a+.a-color-picker-dot,.a-color-picker-h+.a-color-picker-dot{top:-2px}.a-color-picker-a,.a-color-picker-h{border-radius:2px}.a-color-picker-preview{box-sizing:border-box;width:30px;height:30px;user-select:none;border-radius:15px}.a-color-picker-circle{border-radius:50px;border:1px solid #eee}.a-color-picker-hsl,.a-color-picker-rgb,.a-color-picker-single-input{justify-content:space-evenly}.a-color-picker-hsl>label,.a-color-picker-rgb>label,.a-color-picker-single-input>label{padding:0 8px;flex:0 0 auto;color:#969696}.a-color-picker-hsl>input,.a-color-picker-rgb>input,.a-color-picker-single-input>input{text-align:center;padding:2px 0;width:0;flex:1 1 auto;border:1px solid #e0e0e0;line-height:20px}.a-color-picker-hsl>input::-webkit-inner-spin-button,.a-color-picker-rgb>input::-webkit-inner-spin-button,.a-color-picker-single-input>input::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.a-color-picker-hsl>input:focus,.a-color-picker-rgb>input:focus,.a-color-picker-single-input>input:focus{border-color:#04a9f4;outline:none}.a-color-picker-transparent{background-image:linear-gradient(-45deg,#cdcdcd 25%,transparent 0),linear-gradient(45deg,#cdcdcd 25%,transparent 0),linear-gradient(-45deg,transparent 75%,#cdcdcd 0),linear-gradient(45deg,transparent 75%,#cdcdcd 0);background-size:11px 11px;background-position:0 0,0 -5.5px,-5.5px 5.5px,5.5px 0}.a-color-picker-sl{border-radius:3px 3px 0 0}.a-color-picker.hide-alpha [show-on-alpha],.a-color-picker.hide-hsl [show-on-hsl],.a-color-picker.hide-rgb [show-on-rgb],.a-color-picker.hide-single-input [show-on-single-input]{display:none}.a-color-picker-clipbaord{width:100%;height:100%;opacity:0;cursor:pointer}.a-color-picker-palette{flex-flow:wrap;flex-direction:row;justify-content:flex-start;padding:10px}.a-color-picker-palette-color{width:15px;height:15px;flex:0 1 15px;margin:3px;box-sizing:border-box;cursor:pointer;border-radius:3px;box-shadow:inset 0 0 0 1px rgba(0,0,0,.1)}.a-color-picker-palette-add{text-align:center;line-height:13px;color:#607d8b}.a-color-picker.hidden{display:none}`,""])},function(t,n){t.exports=function(a){var i=[];return i.toString=function(){return this.map(function(s){var o=function(l,f){var p=l[1]||"",u=l[3];if(!u)return p;if(f&&typeof btoa=="function"){var h=function(D){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(D))))+" */"}(u),w=u.sources.map(function(D){return"/*# sourceURL="+u.sourceRoot+D+" */"});return[p].concat(w).concat([h]).join(`
`)}return[p].join(`
`)}(s,a);return s[2]?"@media "+s[2]+"{"+o+"}":o}).join("")},i.i=function(s,o){typeof s=="string"&&(s=[[null,s,""]]);for(var l={},f=0;f<this.length;f++){var p=this[f][0];typeof p=="number"&&(l[p]=!0)}for(f=0;f<s.length;f++){var u=s[f];typeof u[0]=="number"&&l[u[0]]||(o&&!u[2]?u[2]=o:o&&(u[2]="("+u[2]+") and ("+o+")"),i.push(u))}},i}}])})}),Td=Kt(jd),Ei=Td;function Si(e,r,t){if(t=t||{},!Ld(t))throw new Error("options is invalid");var n=t.bbox,a=t.id;if(e===void 0)throw new Error("geometry is required");if(r&&r.constructor!==Object)throw new Error("properties must be an Object");n&&Md(n),a&&Fd(a);var i={type:"Feature"};return a&&(i.id=a),n&&(i.bbox=n),i.properties=r||{},i.geometry=e,i}function Dd(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function Ld(e){return!!e&&e.constructor===Object}function Md(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(e.length!==4&&e.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach(function(r){if(!Dd(r))throw new Error("bbox must only contain numbers")})}function Fd(e){if(!e)throw new Error("id is required");if(["string","number"].indexOf(typeof e)===-1)throw new Error("id must be a number or a string")}function mr(e,r,t){if(e!==null)for(var n,a,i,s,o,l,f,p=0,u=0,h,w=e.type,D=w==="FeatureCollection",Z=w==="Feature",U=D?e.features.length:1,re=0;re<U;re++){f=D?e.features[re].geometry:Z?e.geometry:e,h=f?f.type==="GeometryCollection":!1,o=h?f.geometries.length:1;for(var F=0;F<o;F++){var ie=0,J=0;if(s=h?f.geometries[F]:f,s!==null){l=s.coordinates;var $e=s.type;switch(p=t&&($e==="Polygon"||$e==="MultiPolygon")?1:0,$e){case null:break;case"Point":if(r(l,u,re,ie,J)===!1)return!1;u++,ie++;break;case"LineString":case"MultiPoint":for(n=0;n<l.length;n++){if(r(l[n],u,re,ie,J)===!1)return!1;u++,$e==="MultiPoint"&&ie++}$e==="LineString"&&ie++;break;case"Polygon":case"MultiLineString":for(n=0;n<l.length;n++){for(a=0;a<l[n].length-p;a++){if(r(l[n][a],u,re,ie,J)===!1)return!1;u++}$e==="MultiLineString"&&ie++,$e==="Polygon"&&J++}$e==="Polygon"&&ie++;break;case"MultiPolygon":for(n=0;n<l.length;n++){for($e==="MultiPolygon"&&(J=0),a=0;a<l[n].length;a++){for(i=0;i<l[n][a].length-p;i++){if(r(l[n][a][i],u,re,ie,J)===!1)return!1;u++}J++}ie++}break;case"GeometryCollection":for(n=0;n<s.geometries.length;n++)if(mr(s.geometries[n],r,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Xn(e,r){if(e.type==="Feature")r(e,0);else if(e.type==="FeatureCollection")for(var t=0;t<e.features.length&&r(e.features[t],t)!==!1;t++);}function Od(e,r){var t,n,a,i,s,o,l,f,p,u,h=0,w=e.type==="FeatureCollection",D=e.type==="Feature",Z=w?e.features.length:1;for(t=0;t<Z;t++){for(o=w?e.features[t].geometry:D?e.geometry:e,f=w?e.features[t].properties:D?e.properties:{},p=w?e.features[t].bbox:D?e.bbox:void 0,u=w?e.features[t].id:D?e.id:void 0,l=o?o.type==="GeometryCollection":!1,s=l?o.geometries.length:1,a=0;a<s;a++){if(i=l?o.geometries[a]:o,i===null){if(r(null,h,f,p,u)===!1)return!1;continue}switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(r(i,h,f,p,u)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<i.geometries.length;n++)if(r(i.geometries[n],h,f,p,u)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}h++}}function $i(e,r){Od(e,function(t,n,a,i,s){var o=t===null?null:t.type;switch(o){case null:case"Point":case"LineString":case"Polygon":return r(Si(t,a,{bbox:i,id:s}),n,0)===!1?!1:void 0}var l;switch(o){case"MultiPoint":l="Point";break;case"MultiLineString":l="LineString";break;case"MultiPolygon":l="Polygon";break}for(var f=0;f<t.coordinates.length;f++){var p=t.coordinates[f],u={type:l,coordinates:p};if(r(Si(u,a),n,f)===!1)return!1}})}function Ad(e,r,t){if(t=t||{},!ji(t))throw new Error("options is invalid");var n=t.bbox,a=t.id;if(e===void 0)throw new Error("geometry is required");if(r&&r.constructor!==Object)throw new Error("properties must be an Object");n&&Ti(n),a&&Li(a);var i={type:"Feature"};return a&&(i.id=a),n&&(i.bbox=n),i.properties=r||{},i.geometry=e,i}function Mi(e,r,t){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Kn(e[0])||!Kn(e[1]))throw new Error("coordinates must contain numbers");return Ad({type:"Point",coordinates:e},r,t)}function Pd(e,r){if(r=r||{},!ji(r))throw new Error("options is invalid");var t=r.bbox,n=r.id;if(!e)throw new Error("No features passed");if(!Array.isArray(e))throw new Error("features must be an Array");t&&Ti(t),n&&Li(n);var a={type:"FeatureCollection"};return n&&(a.id=n),t&&(a.bbox=t),a.features=e,a}function Kn(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function ji(e){return!!e&&e.constructor===Object}function Ti(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(e.length!==4&&e.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach(function(r){if(!Kn(r))throw new Error("bbox must only contain numbers")})}function Li(e){if(!e)throw new Error("id is required");if(["string","number"].indexOf(typeof e)===-1)throw new Error("id must be a number or a string")}function Id(e){var r=[];return e.type==="FeatureCollection"?Xn(e,function(t){mr(t,function(n){r.push(Mi(n,t.properties))})}):mr(e,function(t){r.push(Mi(t,e.properties))}),Pd(r)}function xd(e){var r=[Infinity,Infinity,-Infinity,-Infinity];return mr(e,function(t){r[0]>t[0]&&(r[0]=t[0]),r[1]>t[1]&&(r[1]=t[1]),r[2]<t[0]&&(r[2]=t[0]),r[3]<t[1]&&(r[3]=t[1])}),r}function Nd(e,r,t){if(t=t||{},!Fi(t))throw new Error("options is invalid");var n=t.bbox,a=t.id;if(e===void 0)throw new Error("geometry is required");if(r&&r.constructor!==Object)throw new Error("properties must be an Object");n&&Rd(n),a&&Hd(a);var i={type:"Feature"};return a&&(i.id=a),n&&(i.bbox=n),i.properties=r||{},i.geometry=e,i}function Bd(e,r,t){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Qn(e[0])||!Qn(e[1]))throw new Error("coordinates must contain numbers");return Nd({type:"Point",coordinates:e},r,t)}function Qn(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function Fi(e){return!!e&&e.constructor===Object}function Rd(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(e.length!==4&&e.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach(function(r){if(!Qn(r))throw new Error("bbox must only contain numbers")})}function Hd(e){if(!e)throw new Error("id is required");if(["string","number"].indexOf(typeof e)===-1)throw new Error("id must be a number or a string")}function Gd(e,r){if(r=r||{},!Fi(r))throw new Error("options is invalid");var t=r.properties;if(!e)throw new Error("geojson is required");var n=xd(e),a=(n[0]+n[2])/2,i=(n[1]+n[3])/2;return Bd([a,i],t)}function Vd(e){if(!e)throw new Error("geojson is required");switch(e.type){case"Feature":return Di(e);case"FeatureCollection":return qd(e);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return zn(e);default:throw new Error("unknown GeoJSON type")}}function Di(e){var r={type:"Feature"};return Object.keys(e).forEach(function(t){switch(t){case"type":case"properties":case"geometry":return;default:r[t]=e[t]}}),r.properties=Oi(e.properties),r.geometry=zn(e.geometry),r}function Oi(e){var r={};return e&&Object.keys(e).forEach(function(t){var n=e[t];typeof n=="object"?n===null?r[t]=null:n.length?r[t]=n.map(function(a){return a}):r[t]=Oi(n):r[t]=n}),r}function qd(e){var r={type:"FeatureCollection"};return Object.keys(e).forEach(function(t){switch(t){case"type":case"features":return;default:r[t]=e[t]}}),r.features=e.features.map(function(t){return Di(t)}),r}function zn(e){var r={type:e.type};return e.bbox&&(r.bbox=e.bbox),e.type==="GeometryCollection"?(r.geometries=e.geometries.map(function(t){return zn(t)}),r):(r.coordinates=Ai(e.coordinates),r)}function Ai(e){return typeof e[0]!="object"?e.slice():e.map(function(r){return Ai(r)})}var Be=63710088e-1,Ud={meters:Be,metres:Be,millimeters:Be*1e3,millimetres:Be*1e3,centimeters:Be*100,centimetres:Be*100,kilometers:Be/1e3,kilometres:Be/1e3,miles:Be/1609.344,nauticalmiles:Be/1852,inches:Be*39.37,yards:Be/1.0936,feet:Be*3.28084,radians:1,degrees:Be/111325};function Yd(e,r){if(e==null)throw new Error("radians is required");if(r&&typeof r!="string")throw new Error("units must be a string");var t=Ud[r||"kilometers"];if(!t)throw new Error(r+" units is invalid");return e*t}function Pr(e){if(e==null)throw new Error("degrees is required");var r=e%360;return r*Math.PI/180}function Wd(e){return!!e&&e.constructor===Object}function Pi(e){if(!e)throw new Error("coord is required");if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return e.geometry.coordinates;if(e.type==="Point")return e.coordinates;if(Array.isArray(e)&&e.length>=2&&e[0].length===void 0&&e[1].length===void 0)return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Jd(e,r,t){if(t=t||{},!Wd(t))throw new Error("options is invalid");var n=t.units,a=Pi(e),i=Pi(r),s=Pr(i[1]-a[1]),o=Pr(i[0]-a[0]),l=Pr(a[1]),f=Pr(i[1]),p=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(o/2),2)*Math.cos(l)*Math.cos(f);return Yd(2*Math.atan2(Math.sqrt(p),Math.sqrt(1-p)),n)}function Zd(e,r){if(!e)throw new Error("targetPoint is required");if(!r)throw new Error("points is required");var t,n=Infinity;return Xn(r,function(a,i){var s=Jd(e,a);s<n&&(t=Vd(a),t.properties.featureIndex=i,t.properties.distanceToPoint=s,n=s)}),t}function Xd(e){if(!e)throw new Error("coord is required");if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return e.geometry.coordinates;if(e.type==="Point")return e.coordinates;if(Array.isArray(e)&&e.length>=2&&e[0].length===void 0&&e[1].length===void 0)return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Kd(e){if(!e)throw new Error("coords is required");if(e.type==="Feature"&&e.geometry!==null)return e.geometry.coordinates;if(e.coordinates)return e.coordinates;if(Array.isArray(e))return e;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function zd(e,r,t){if(t=t||{},typeof t!="object")throw new Error("options is invalid");var n=t.ignoreBoundary;if(!e)throw new Error("point is required");if(!r)throw new Error("polygon is required");var a=Xd(e),i=Kd(r),s=r.geometry?r.geometry.type:r.type,o=r.bbox;if(o&&Qd(a,o)===!1)return!1;s==="Polygon"&&(i=[i]);for(var l=0,f=!1;l<i.length&&!f;l++)if(Ii(a,i[l][0],n)){for(var p=!1,u=1;u<i[l].length&&!p;)Ii(a,i[l][u],!n)&&(p=!0),u++;p||(f=!0)}return f}function Ii(e,r,t){var n=!1;r[0][0]===r[r.length-1][0]&&r[0][1]===r[r.length-1][1]&&(r=r.slice(0,r.length-1));for(var a=0,i=r.length-1;a<r.length;i=a++){var s=r[a][0],o=r[a][1],l=r[i][0],f=r[i][1],p=e[1]*(s-l)+o*(l-e[0])+f*(e[0]-s)==0&&(s-e[0])*(l-e[0])<=0&&(o-e[1])*(f-e[1])<=0;if(p)return!t;var u=o>e[1]!=f>e[1]&&e[0]<(l-s)*(e[1]-o)/(f-o)+s;u&&(n=!n)}return n}function Qd(e,r){return r[0]<=e[0]&&r[1]<=e[1]&&r[2]>=e[0]&&r[3]>=e[1]}function Ni(e,r,t){if(t=t||{},!xi(t))throw new Error("options is invalid");var n=t.bbox,a=t.id;if(e===void 0)throw new Error("geometry is required");if(r&&r.constructor!==Object)throw new Error("properties must be an Object");n&&Ri(n),a&&Hi(a);var i={type:"Feature"};return a&&(i.id=a),n&&(i.bbox=n),i.properties=r||{},i.geometry=e,i}function ep(e,r,t){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!ea(e[0])||!ea(e[1]))throw new Error("coordinates must contain numbers");return Ni({type:"Point",coordinates:e},r,t)}function ta(e,r){if(r=r||{},!xi(r))throw new Error("options is invalid");var t=r.bbox,n=r.id;if(!e)throw new Error("No features passed");if(!Array.isArray(e))throw new Error("features must be an Array");t&&Ri(t),n&&Hi(n);var a={type:"FeatureCollection"};return n&&(a.id=n),t&&(a.bbox=t),a.features=e,a}function ea(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function xi(e){return!!e&&e.constructor===Object}function Ri(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(e.length!==4&&e.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach(function(r){if(!ea(r))throw new Error("bbox must only contain numbers")})}function Hi(e){if(!e)throw new Error("id is required");if(["string","number"].indexOf(typeof e)===-1)throw new Error("id must be a number or a string")}function rp(e){for(var r=tp(e),t=Gd(r),n=!1,a=0;!n&&a<r.features.length;){var i=r.features[a].geometry,s,o,l,f,p,u,h,w=!1;if(i.type==="Point")t.geometry.coordinates[0]===i.coordinates[0]&&t.geometry.coordinates[1]===i.coordinates[1]&&(n=!0);else if(i.type==="MultiPoint"){var D=!1;for(h=0;!D&&h<i.coordinates.length;)t.geometry.coordinates[0]===i.coordinates[h][0]&&t.geometry.coordinates[1]===i.coordinates[h][1]&&(n=!0,D=!0),h++}else if(i.type==="LineString")for(h=0;!w&&h<i.coordinates.length-1;)s=t.geometry.coordinates[0],o=t.geometry.coordinates[1],l=i.coordinates[h][0],f=i.coordinates[h][1],p=i.coordinates[h+1][0],u=i.coordinates[h+1][1],Bi(s,o,l,f,p,u)&&(w=!0,n=!0),h++;else if(i.type==="MultiLineString")for(var Z=0;Z<i.coordinates.length;){w=!1,h=0;for(var U=i.coordinates[Z];!w&&h<U.length-1;)s=t.geometry.coordinates[0],o=t.geometry.coordinates[1],l=U[h][0],f=U[h][1],p=U[h+1][0],u=U[h+1][1],Bi(s,o,l,f,p,u)&&(w=!0,n=!0),h++;Z++}else(i.type==="Polygon"||i.type==="MultiPolygon")&&zd(t,i)&&(n=!0);a++}if(n)return t;var re=ta([]);for(a=0;a<r.features.length;a++)re.features=re.features.concat(Id(r.features[a]).features);return ep(Zd(t,re).geometry.coordinates)}function tp(e){return e.type!=="FeatureCollection"?e.type!=="Feature"?ta([Ni(e)]):ta([e]):e}function Bi(e,r,t,n,a,i){var s=Math.sqrt((a-t)*(a-t)+(i-n)*(i-n)),o=Math.sqrt((e-t)*(e-t)+(r-n)*(r-n)),l=Math.sqrt((a-e)*(a-e)+(i-r)*(i-r));return s===o+l}var Gi=rp;var Ge=63710088e-1,np={centimeters:Ge*100,centimetres:Ge*100,degrees:Ge/111325,feet:Ge*3.28084,inches:Ge*39.37,kilometers:Ge/1e3,kilometres:Ge/1e3,meters:Ge,metres:Ge,miles:Ge/1609.344,millimeters:Ge*1e3,millimetres:Ge*1e3,nauticalmiles:Ge/1852,radians:1,yards:Ge/1.0936};function qi(e,r,t){t===void 0&&(t={});var n={type:"Feature"};return(t.id===0||t.id)&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.properties=r||{},n.geometry=e,n}function Ir(e,r,t){if(t===void 0&&(t={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Vi(e[0])||!Vi(e[1]))throw new Error("coordinates must contain numbers");var n={type:"Point",coordinates:e};return qi(n,r,t)}function Ui(e,r,t){t===void 0&&(t={});for(var n=0,a=e;n<a.length;n++){var i=a[n];if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<i[i.length-1].length;s++)if(i[i.length-1][s]!==i[0][s])throw new Error("First and last Position are not equivalent.")}var o={type:"Polygon",coordinates:e};return qi(o,r,t)}function Yi(e,r){r===void 0&&(r="kilometers");var t=np[r];if(!t)throw new Error(r+" units is invalid");return e/t}function ra(e){var r=e%(2*Math.PI);return r*180/Math.PI}function xr(e){var r=e%360;return r*Math.PI/180}function Vi(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function ip(e){var r,t,n={type:"FeatureCollection",features:[]};if(e.type==="Feature"?t=e.geometry:t=e,t.type==="LineString")r=[t.coordinates];else if(t.type==="MultiLineString")r=t.coordinates;else if(t.type==="MultiPolygon")r=[].concat.apply([],t.coordinates);else if(t.type==="Polygon")r=t.coordinates;else throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return r.forEach(function(a){r.forEach(function(i){for(var s=0;s<a.length-1;s++)for(var o=s;o<i.length-1;o++)if(!(a===i&&(Math.abs(s-o)===1||s===0&&o===a.length-2&&a[s][0]===a[a.length-1][0]&&a[s][1]===a[a.length-1][1]))){var l=ap(a[s][0],a[s][1],a[s+1][0],a[s+1][1],i[o][0],i[o][1],i[o+1][0],i[o+1][1]);l&&n.features.push(Ir([l[0],l[1]]))}})}),n}function ap(e,r,t,n,a,i,s,o){var l,f,p,u,h,w={x:null,y:null,onLine1:!1,onLine2:!1};return l=(o-i)*(t-e)-(s-a)*(n-r),l===0?w.x!==null&&w.y!==null?w:!1:(f=r-i,p=e-a,u=(s-a)*f-(o-i)*p,h=(t-e)*f-(n-r)*p,f=u/l,p=h/l,w.x=e+f*(t-e),w.y=r+f*(n-r),f>=0&&f<=1&&(w.onLine1=!0),p>=0&&p<=1&&(w.onLine2=!0),w.onLine1&&w.onLine2?[w.x,w.y]:!1)}var Wi=ip;function cp(e,r){if(r=r||{},!op(r))throw new Error("options is invalid");var t=r.bbox,n=r.id;if(!e)throw new Error("No features passed");if(!Array.isArray(e))throw new Error("features must be an Array");t&&lp(t),n&&sp(n);var a={type:"FeatureCollection"};return n&&(a.id=n),t&&(a.bbox=t),a.features=e,a}function up(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function op(e){return!!e&&e.constructor===Object}function lp(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(e.length!==4&&e.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach(function(r){if(!up(r))throw new Error("bbox must only contain numbers")})}function sp(e){if(!e)throw new Error("id is required");if(["string","number"].indexOf(typeof e)===-1)throw new Error("id must be a number or a string")}function dp(e){if(!e)throw new Error("geojson is required");var r=[];return $i(e,function(t){r.push(t)}),cp(r)}var Ji=dp;function pp(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return e.geometry.coordinates;if(e.type==="Point")return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function fp(e,r,t,n){n===void 0&&(n={});var a=pp(e),i=xr(a[0]),s=xr(a[1]),o=xr(t),l=Yi(r,n.units),f=Math.asin(Math.sin(s)*Math.cos(l)+Math.cos(s)*Math.sin(l)*Math.cos(o)),p=i+Math.atan2(Math.sin(o)*Math.sin(l)*Math.cos(s),Math.cos(l)-Math.sin(s)*Math.sin(f)),u=ra(p),h=ra(f);return Ir([u,h],n.properties)}function gp(e,r,t){t===void 0&&(t={});for(var n=t.steps||64,a=t.properties?t.properties:!Array.isArray(e)&&e.type==="Feature"&&e.properties?e.properties:{},i=[],s=0;s<n;s++)i.push(fp(e,r,s*-360/n,t).geometry.coordinates);return i.push(i[0]),Ui([i],a)}var Zi=gp;function hp(){this.__data__=[],this.size=0}var mp=hp;function vp(e,r){return e===r||e!==e&&r!==r}var vr=vp;function bp(e,r){for(var t=e.length;t--;)if(vr(e[t][0],r))return t;return-1}var Rr=bp,wp=Array.prototype,_p=wp.splice;function yp(e){var r=this.__data__,t=Rr(r,e);if(t<0)return!1;var n=r.length-1;return t==n?r.pop():_p.call(r,t,1),--this.size,!0}var kp=yp;function Cp(e){var r=this.__data__,t=Rr(r,e);return t<0?void 0:r[t][1]}var Ep=Cp;function Sp(e){return Rr(this.__data__,e)>-1}var $p=Sp;function jp(e,r){var t=this.__data__,n=Rr(t,e);return n<0?(++this.size,t.push([e,r])):t[n][1]=r,this}var Tp=jp;function Qt(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}Qt.prototype.clear=mp;Qt.prototype.delete=kp;Qt.prototype.get=Ep;Qt.prototype.has=$p;Qt.prototype.set=Tp;var Hr=Qt;function Lp(){this.__data__=new Hr,this.size=0}var Mp=Lp;function Fp(e){var r=this.__data__,t=r.delete(e);return this.size=r.size,t}var Dp=Fp;function Op(e){return this.__data__.get(e)}var Ap=Op;function Pp(e){return this.__data__.has(e)}var Ip=Pp,xp=typeof We=="object"&&We&&We.Object===Object&&We,Xi=xp,Rp=typeof self=="object"&&self&&self.Object===Object&&self,Hp=Xi||Rp||Function("return this")(),it=Hp,Np=it.Symbol,Ft=Np,Ki=Object.prototype,Bp=Ki.hasOwnProperty,Gp=Ki.toString,br=Ft?Ft.toStringTag:void 0;function qp(e){var r=Bp.call(e,br),t=e[br];try{e[br]=void 0;var n=!0}catch(i){}var a=Gp.call(e);return n&&(r?e[br]=t:delete e[br]),a}var Vp=qp,Up=Object.prototype,Yp=Up.toString;function Wp(e){return Yp.call(e)}var Jp=Wp,Zp="[object Null]",Xp="[object Undefined]",Qi=Ft?Ft.toStringTag:void 0;function Kp(e){return e==null?e===void 0?Xp:Zp:Qi&&Qi in Object(e)?Vp(e):Jp(e)}var kt=Kp;function Qp(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}var dt=Qp,zp="[object AsyncFunction]",ef="[object Function]",tf="[object GeneratorFunction]",rf="[object Proxy]";function nf(e){if(!dt(e))return!1;var r=kt(e);return r==ef||r==tf||r==zp||r==rf}var Nr=nf,af=it["__core-js_shared__"],na=af,zi=function(){var e=/[^.]+$/.exec(na&&na.keys&&na.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function of(e){return!!zi&&zi in e}var lf=of,sf=Function.prototype,cf=sf.toString;function uf(e){if(e!=null){try{return cf.call(e)}catch(r){}try{return e+""}catch(r){}}return""}var Ct=uf,df=/[\\^$.*+?()[\]{}|]/g,pf=/^\[object .+?Constructor\]$/,ff=Function.prototype,gf=Object.prototype,hf=ff.toString,mf=gf.hasOwnProperty,vf=RegExp("^"+hf.call(mf).replace(df,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function bf(e){if(!dt(e)||lf(e))return!1;var r=Nr(e)?vf:pf;return r.test(Ct(e))}var wf=bf;function _f(e,r){return e==null?void 0:e[r]}var yf=_f;function kf(e,r){var t=yf(e,r);return wf(t)?t:void 0}var Et=kf,Cf=Et(it,"Map"),zt=Cf,Ef=Et(Object,"create"),wr=Ef;function Sf(){this.__data__=wr?wr(null):{},this.size=0}var $f=Sf;function jf(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}var Tf=jf,Lf="__lodash_hash_undefined__",Mf=Object.prototype,Ff=Mf.hasOwnProperty;function Df(e){var r=this.__data__;if(wr){var t=r[e];return t===Lf?void 0:t}return Ff.call(r,e)?r[e]:void 0}var Of=Df,Af=Object.prototype,Pf=Af.hasOwnProperty;function If(e){var r=this.__data__;return wr?r[e]!==void 0:Pf.call(r,e)}var xf=If,Rf="__lodash_hash_undefined__";function Hf(e,r){var t=this.__data__;return this.size+=this.has(e)?0:1,t[e]=wr&&r===void 0?Rf:r,this}var Nf=Hf;function er(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}er.prototype.clear=$f;er.prototype.delete=Tf;er.prototype.get=Of;er.prototype.has=xf;er.prototype.set=Nf;var eo=er;function Bf(){this.size=0,this.__data__={hash:new eo,map:new(zt||Hr),string:new eo}}var Gf=Bf;function qf(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}var Vf=qf;function Uf(e,r){var t=e.__data__;return Vf(r)?t[typeof r=="string"?"string":"hash"]:t.map}var Br=Uf;function Yf(e){var r=Br(this,e).delete(e);return this.size-=r?1:0,r}var Wf=Yf;function Jf(e){return Br(this,e).get(e)}var Zf=Jf;function Xf(e){return Br(this,e).has(e)}var Kf=Xf;function Qf(e,r){var t=Br(this,e),n=t.size;return t.set(e,r),this.size+=t.size==n?0:1,this}var zf=Qf;function tr(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}tr.prototype.clear=Gf;tr.prototype.delete=Wf;tr.prototype.get=Zf;tr.prototype.has=Kf;tr.prototype.set=zf;var eg=tr,tg=200;function rg(e,r){var t=this.__data__;if(t instanceof Hr){var n=t.__data__;if(!zt||n.length<tg-1)return n.push([e,r]),this.size=++t.size,this;t=this.__data__=new eg(n)}return t.set(e,r),this.size=t.size,this}var ng=rg;function rr(e){var r=this.__data__=new Hr(e);this.size=r.size}rr.prototype.clear=Mp;rr.prototype.delete=Dp;rr.prototype.get=Ap;rr.prototype.has=Ip;rr.prototype.set=ng;var Gr=rr,ag=function(){try{var e=Et(Object,"defineProperty");return e({},"",{}),e}catch(r){}}(),_r=ag;function ig(e,r,t){r=="__proto__"&&_r?_r(e,r,{configurable:!0,enumerable:!0,value:t,writable:!0}):e[r]=t}var qr=ig,og=Object.prototype,lg=og.hasOwnProperty;function sg(e,r,t){var n=e[r];(!(lg.call(e,r)&&vr(n,t))||t===void 0&&!(r in e))&&qr(e,r,t)}var aa=sg;function cg(e,r,t,n){var a=!t;t||(t={});for(var i=-1,s=r.length;++i<s;){var o=r[i],l=n?n(t[o],e[o],o,t,e):void 0;l===void 0&&(l=e[o]),a?qr(t,o,l):aa(t,o,l)}return t}var Dt=cg;function ug(e,r){for(var t=-1,n=Array(e);++t<e;)n[t]=r(t);return n}var dg=ug;function pg(e){return e!=null&&typeof e=="object"}var gt=pg,fg="[object Arguments]";function gg(e){return gt(e)&&kt(e)==fg}var to=gg,ro=Object.prototype,hg=ro.hasOwnProperty,mg=ro.propertyIsEnumerable,vg=to(function(){return arguments}())?to:function(e){return gt(e)&&hg.call(e,"callee")&&!mg.call(e,"callee")},Vr=vg,bg=Array.isArray,Ot=bg;function wg(){return!1}var _g=wg,yr=Qe(function(e,r){var t=r&&!r.nodeType&&r,n=t&&!0&&e&&!e.nodeType&&e,a=n&&n.exports===t,i=a?it.Buffer:void 0,s=i?i.isBuffer:void 0,o=s||_g;e.exports=o}),yg=9007199254740991,kg=/^(?:0|[1-9]\d*)$/;function Cg(e,r){var t=typeof e;return r=r??yg,!!r&&(t=="number"||t!="symbol"&&kg.test(e))&&e>-1&&e%1==0&&e<r}var ia=Cg,Eg=9007199254740991;function Sg(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Eg}var no=Sg,$g="[object Arguments]",jg="[object Array]",Tg="[object Boolean]",Lg="[object Date]",Mg="[object Error]",Fg="[object Function]",Dg="[object Map]",Og="[object Number]",Ag="[object Object]",Pg="[object RegExp]",Ig="[object Set]",xg="[object String]",Rg="[object WeakMap]",Hg="[object ArrayBuffer]",Ng="[object DataView]",Bg="[object Float32Array]",Gg="[object Float64Array]",qg="[object Int8Array]",Vg="[object Int16Array]",Ug="[object Int32Array]",Yg="[object Uint8Array]",Wg="[object Uint8ClampedArray]",Jg="[object Uint16Array]",Zg="[object Uint32Array]",Se={};Se[Bg]=Se[Gg]=Se[qg]=Se[Vg]=Se[Ug]=Se[Yg]=Se[Wg]=Se[Jg]=Se[Zg]=!0;Se[$g]=Se[jg]=Se[Hg]=Se[Tg]=Se[Ng]=Se[Lg]=Se[Mg]=Se[Fg]=Se[Dg]=Se[Og]=Se[Ag]=Se[Pg]=Se[Ig]=Se[xg]=Se[Rg]=!1;function Xg(e){return gt(e)&&no(e.length)&&!!Se[kt(e)]}var Kg=Xg;function Qg(e){return function(r){return e(r)}}var Ur=Qg,At=Qe(function(e,r){var t=r&&!r.nodeType&&r,n=t&&!0&&e&&!e.nodeType&&e,a=n&&n.exports===t,i=a&&Xi.process,s=function(){try{var o=n&&n.require&&n.require("util").types;return o||i&&i.binding&&i.binding("util")}catch(l){}}();e.exports=s}),ao=At&&At.isTypedArray,zg=ao?Ur(ao):Kg,oa=zg,eh=Object.prototype,th=eh.hasOwnProperty;function rh(e,r){var t=Ot(e),n=!t&&Vr(e),a=!t&&!n&&yr(e),i=!t&&!n&&!a&&oa(e),s=t||n||a||i,o=s?dg(e.length,String):[],l=o.length;for(var f in e)(r||th.call(e,f))&&!(s&&(f=="length"||a&&(f=="offset"||f=="parent")||i&&(f=="buffer"||f=="byteLength"||f=="byteOffset")||ia(f,l)))&&o.push(f);return o}var la=rh,nh=Object.prototype;function ah(e){var r=e&&e.constructor,t=typeof r=="function"&&r.prototype||nh;return e===t}var Yr=ah;function ih(e,r){return function(t){return e(r(t))}}var sa=ih;function oh(e){return e!=null&&no(e.length)&&!Nr(e)}var nr=oh;function lh(e){var r=[];if(e!=null)for(var t in Object(e))r.push(t);return r}var sh=lh,ch=Object.prototype,uh=ch.hasOwnProperty;function dh(e){if(!dt(e))return sh(e);var r=Yr(e),t=[];for(var n in e)n=="constructor"&&(r||!uh.call(e,n))||t.push(n);return t}var ph=dh;function fh(e){return nr(e)?la(e,!0):ph(e)}var Pt=fh,Wr=Qe(function(e,r){var t=r&&!r.nodeType&&r,n=t&&!0&&e&&!e.nodeType&&e,a=n&&n.exports===t,i=a?it.Buffer:void 0,s=i?i.allocUnsafe:void 0;function o(l,f){if(f)return l.slice();var p=l.length,u=s?s(p):new l.constructor(p);return l.copy(u),u}e.exports=o});function gh(e,r){var t=-1,n=e.length;for(r||(r=Array(n));++t<n;)r[t]=e[t];return r}var Jr=gh,hh=sa(Object.getPrototypeOf,Object),kr=hh,mh=it.Uint8Array,io=mh;function vh(e){var r=new e.constructor(e.byteLength);return new io(r).set(new io(e)),r}var Zr=vh;function bh(e,r){var t=r?Zr(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.length)}var Xr=bh,oo=Object.create,wh=function(){function e(){}return function(r){if(!dt(r))return{};if(oo)return oo(r);e.prototype=r;var t=new e;return e.prototype=void 0,t}}(),_h=wh;function yh(e){return typeof e.constructor=="function"&&!Yr(e)?_h(kr(e)):{}}var Kr=yh;function kh(e,r){for(var t=-1,n=e==null?0:e.length;++t<n&&r(e[t],t,e)!==!1;);return e}var Ch=kh,Eh=sa(Object.keys,Object),Sh=Eh,$h=Object.prototype,jh=$h.hasOwnProperty;function Th(e){if(!Yr(e))return Sh(e);var r=[];for(var t in Object(e))jh.call(e,t)&&t!="constructor"&&r.push(t);return r}var Lh=Th;function Mh(e){return nr(e)?la(e):Lh(e)}var ca=Mh;function Fh(e,r){return e&&Dt(r,ca(r),e)}var Dh=Fh;function Oh(e,r){return e&&Dt(r,Pt(r),e)}var Ah=Oh;function Ph(e,r){for(var t=-1,n=e==null?0:e.length,a=0,i=[];++t<n;){var s=e[t];r(s,t,e)&&(i[a++]=s)}return i}var Ih=Ph;function xh(){return[]}var lo=xh,Rh=Object.prototype,Hh=Rh.propertyIsEnumerable,so=Object.getOwnPropertySymbols,Nh=so?function(e){return e==null?[]:(e=Object(e),Ih(so(e),function(r){return Hh.call(e,r)}))}:lo,ua=Nh;function Bh(e,r){return Dt(e,ua(e),r)}var Gh=Bh;function qh(e,r){for(var t=-1,n=r.length,a=e.length;++t<n;)e[a+t]=r[t];return e}var co=qh,Vh=Object.getOwnPropertySymbols,Uh=Vh?function(e){for(var r=[];e;)co(r,ua(e)),e=kr(e);return r}:lo,uo=Uh;function Yh(e,r){return Dt(e,uo(e),r)}var Wh=Yh;function Jh(e,r,t){var n=r(e);return Ot(e)?n:co(n,t(e))}var po=Jh;function Zh(e){return po(e,ca,ua)}var Xh=Zh;function Kh(e){return po(e,Pt,uo)}var Qh=Kh,zh=Et(it,"DataView"),da=zh,em=Et(it,"Promise"),pa=em,tm=Et(it,"Set"),fa=tm,rm=Et(it,"WeakMap"),ga=rm,fo="[object Map]",nm="[object Object]",go="[object Promise]",ho="[object Set]",mo="[object WeakMap]",vo="[object DataView]",am=Ct(da),im=Ct(zt),om=Ct(pa),lm=Ct(fa),sm=Ct(ga),It=kt;(da&&It(new da(new ArrayBuffer(1)))!=vo||zt&&It(new zt)!=fo||pa&&It(pa.resolve())!=go||fa&&It(new fa)!=ho||ga&&It(new ga)!=mo)&&(It=function(e){var r=kt(e),t=r==nm?e.constructor:void 0,n=t?Ct(t):"";if(n)switch(n){case am:return vo;case im:return fo;case om:return go;case lm:return ho;case sm:return mo}return r});var ha=It,cm=Object.prototype,um=cm.hasOwnProperty;function dm(e){var r=e.length,t=new e.constructor(r);return r&&typeof e[0]=="string"&&um.call(e,"index")&&(t.index=e.index,t.input=e.input),t}var pm=dm;function fm(e,r){var t=r?Zr(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.byteLength)}var gm=fm,hm=/\w*$/;function mm(e){var r=new e.constructor(e.source,hm.exec(e));return r.lastIndex=e.lastIndex,r}var vm=mm,bo=Ft?Ft.prototype:void 0,wo=bo?bo.valueOf:void 0;function bm(e){return wo?Object(wo.call(e)):{}}var wm=bm,_m="[object Boolean]",ym="[object Date]",km="[object Map]",Cm="[object Number]",Em="[object RegExp]",Sm="[object Set]",$m="[object String]",jm="[object Symbol]",Tm="[object ArrayBuffer]",Lm="[object DataView]",Mm="[object Float32Array]",Fm="[object Float64Array]",Dm="[object Int8Array]",Om="[object Int16Array]",Am="[object Int32Array]",Pm="[object Uint8Array]",Im="[object Uint8ClampedArray]",xm="[object Uint16Array]",Rm="[object Uint32Array]";function Hm(e,r,t){var n=e.constructor;switch(r){case Tm:return Zr(e);case _m:case ym:return new n(+e);case Lm:return gm(e,t);case Mm:case Fm:case Dm:case Om:case Am:case Pm:case Im:case xm:case Rm:return Xr(e,t);case km:return new n;case Cm:case $m:return new n(e);case Em:return vm(e);case Sm:return new n;case jm:return wm(e)}}var Nm=Hm,Bm="[object Map]";function Gm(e){return gt(e)&&ha(e)==Bm}var qm=Gm,_o=At&&At.isMap,Vm=_o?Ur(_o):qm,Um=Vm,Ym="[object Set]";function Wm(e){return gt(e)&&ha(e)==Ym}var Jm=Wm,yo=At&&At.isSet,Zm=yo?Ur(yo):Jm,Xm=Zm,Km=1,Qm=2,zm=4,ko="[object Arguments]",ev="[object Array]",tv="[object Boolean]",rv="[object Date]",nv="[object Error]",Co="[object Function]",av="[object GeneratorFunction]",iv="[object Map]",ov="[object Number]",Eo="[object Object]",lv="[object RegExp]",sv="[object Set]",cv="[object String]",uv="[object Symbol]",dv="[object WeakMap]",pv="[object ArrayBuffer]",fv="[object DataView]",gv="[object Float32Array]",hv="[object Float64Array]",mv="[object Int8Array]",vv="[object Int16Array]",bv="[object Int32Array]",wv="[object Uint8Array]",_v="[object Uint8ClampedArray]",yv="[object Uint16Array]",kv="[object Uint32Array]",Ee={};Ee[ko]=Ee[ev]=Ee[pv]=Ee[fv]=Ee[tv]=Ee[rv]=Ee[gv]=Ee[hv]=Ee[mv]=Ee[vv]=Ee[bv]=Ee[iv]=Ee[ov]=Ee[Eo]=Ee[lv]=Ee[sv]=Ee[cv]=Ee[uv]=Ee[wv]=Ee[_v]=Ee[yv]=Ee[kv]=!0;Ee[nv]=Ee[Co]=Ee[dv]=!1;function Qr(e,r,t,n,a,i){var s,o=r&Km,l=r&Qm,f=r&zm;if(t&&(s=a?t(e,n,a,i):t(e)),s!==void 0)return s;if(!dt(e))return e;var p=Ot(e);if(p){if(s=pm(e),!o)return Jr(e,s)}else{var u=ha(e),h=u==Co||u==av;if(yr(e))return Wr(e,o);if(u==Eo||u==ko||h&&!a){if(s=l||h?{}:Kr(e),!o)return l?Wh(e,Ah(s,e)):Gh(e,Dh(s,e))}else{if(!Ee[u])return a?e:{};s=Nm(e,u,o)}}i||(i=new Gr);var w=i.get(e);if(w)return w;i.set(e,s),Xm(e)?e.forEach(function(U){s.add(Qr(U,r,t,U,e,i))}):Um(e)&&e.forEach(function(U,re){s.set(re,Qr(U,r,t,re,e,i))});var D=f?l?Qh:Xh:l?Pt:ca,Z=p?void 0:D(e);return Ch(Z||e,function(U,re){Z&&(re=U,U=e[re]),aa(s,re,Qr(U,r,t,re,e,i))}),s}var Cv=Qr,Ev=1,Sv=4;function $v(e){return Cv(e,Ev|Sv)}var jv=$v,So=jv;function Tv(e,r,t){(t!==void 0&&!vr(e[r],t)||t===void 0&&!(r in e))&&qr(e,r,t)}var ma=Tv;function Lv(e){return function(r,t,n){for(var a=-1,i=Object(r),s=n(r),o=s.length;o--;){var l=s[e?o:++a];if(t(i[l],l,i)===!1)break}return r}}var Mv=Lv,Fv=Mv(),Dv=Fv;function Ov(e){return gt(e)&&nr(e)}var Av=Ov,Pv="[object Object]",Iv=Function.prototype,xv=Object.prototype,$o=Iv.toString,Rv=xv.hasOwnProperty,Hv=$o.call(Object);function Nv(e){if(!gt(e)||kt(e)!=Pv)return!1;var r=kr(e);if(r===null)return!0;var t=Rv.call(r,"constructor")&&r.constructor;return typeof t=="function"&&t instanceof t&&$o.call(t)==Hv}var Bv=Nv;function Gv(e,r){if(!(r==="constructor"&&typeof e[r]=="function")&&r!="__proto__")return e[r]}var va=Gv;function qv(e){return Dt(e,Pt(e))}var Vv=qv;function Uv(e,r,t,n,a,i,s){var o=va(e,t),l=va(r,t),f=s.get(l);if(f){ma(e,t,f);return}var p=i?i(o,l,t+"",e,r,s):void 0,u=p===void 0;if(u){var h=Ot(l),w=!h&&yr(l),D=!h&&!w&&oa(l);p=l,h||w||D?Ot(o)?p=o:Av(o)?p=Jr(o):w?(u=!1,p=Wr(l,!0)):D?(u=!1,p=Xr(l,!0)):p=[]:Bv(l)||Vr(l)?(p=o,Vr(o)?p=Vv(o):(!dt(o)||Nr(o))&&(p=Kr(l))):u=!1}u&&(s.set(l,p),a(p,l,n,i,s),s.delete(l)),ma(e,t,p)}var Yv=Uv;function jo(e,r,t,n,a){e!==r&&Dv(r,function(i,s){if(a||(a=new Gr),dt(i))Yv(e,r,s,t,jo,n,a);else{var o=n?n(va(e,s),i,s+"",e,r,a):void 0;o===void 0&&(o=i),ma(e,s,o)}},Pt)}var Wv=jo;function Jv(e){return e}var To=Jv;function Zv(e,r,t){switch(t.length){case 0:return e.call(r);case 1:return e.call(r,t[0]);case 2:return e.call(r,t[0],t[1]);case 3:return e.call(r,t[0],t[1],t[2])}return e.apply(r,t)}var Xv=Zv,Lo=Math.max;function Kv(e,r,t){return r=Lo(r===void 0?e.length-1:r,0),function(){for(var n=arguments,a=-1,i=Lo(n.length-r,0),s=Array(i);++a<i;)s[a]=n[r+a];a=-1;for(var o=Array(r+1);++a<r;)o[a]=n[a];return o[r]=t(s),Xv(e,this,o)}}var Qv=Kv;function zv(e){return function(){return e}}var eb=zv,tb=_r?function(e,r){return _r(e,"toString",{configurable:!0,enumerable:!1,value:eb(r),writable:!0})}:To,rb=tb,nb=800,ab=16,ib=Date.now;function ob(e){var r=0,t=0;return function(){var n=ib(),a=ab-(n-t);if(t=n,a>0){if(++r>=nb)return arguments[0]}else r=0;return e.apply(void 0,arguments)}}var lb=ob,sb=lb(rb),cb=sb;function ub(e,r){return cb(Qv(e,r,To),e+"")}var db=ub;function pb(e,r,t){if(!dt(t))return!1;var n=typeof r;return(n=="number"?nr(t)&&ia(r,t.length):n=="string"&&r in t)?vr(t[r],e):!1}var fb=pb;function gb(e){return db(function(r,t){var n=-1,a=t.length,i=a>1?t[a-1]:void 0,s=a>2?t[2]:void 0;for(i=e.length>3&&typeof i=="function"?(a--,i):void 0,s&&fb(t[0],t[1],s)&&(i=a<3?void 0:i,a=1),r=Object(r);++n<a;){var o=t[n];o&&e(r,o,n,i)}return r})}var hb=gb,mb=hb(function(e,r,t){Wv(e,r,t)}),vb=mb,Mo=vb;var Fo=(e=21)=>{let r="",t=crypto.getRandomValues(new Uint8Array(e));for(;e--;){let n=t[e]&63;n<36?r+=n.toString(36):n<62?r+=(n-26).toString(36).toUpperCase():n<63?r+="_":r+="-"}return r};var bb={pointOnFeature:Gi,kinks:Wi,flatten:Ji,circle:Zi};var zr={};Va(zr,{de:()=>Do,en:()=>wa,fr:()=>Oo,ja:()=>Po,ko:()=>Io,pl:()=>Ao,zh:()=>xo});var wa={search_header:"Search",search_no_results:"No results for this search",locales_header:"Locales",show_layers_for_locale:"Show layers for the following locale",layers_header:"Layers",locations_header:"Locations",clear_all_locations:"Clear all locations",layer_group_hide_layers:"Hide layers from group",layer_group_toggle:"Toggle group panel",layer_default_icon:"Default icon",layer_zoom_to_extent:"Zoom to filtered layer extent",layer_visibility:"Toggle visibility",layer_toggle_dashboard:"Toggle layer dashboard",layer_style_header:"Style",layer_style_select_theme:"Select thematic style",layer_style_bring_to_front:"Bring layer to front",layer_style_display_labels:"Display labels",layer_style_switch_caption:"Click on labels to switch visibity or ",layer_style_switch_all:"switch all",layer_grid_legend_min:"min",layer_grid_legend_max:"max",layer_grid_legend_avg:"avg",layer_grid_legend_ratio:"Display colour as a ratio to the size",layer_style_other:"other",layer_style_cluster:"Multiple locations",layer_filter_header:"Filter",layer_filter_select:"Select filter from list",layer_filter_run:"Run Output",layer_filter_clear_all:"Clear all filters",layer_filter_date_after:"After",layer_filter_date_before:"Before",layer_filter_pick:"Pick from calendar",layer_filter_boolean:"True",layer_filter_greater:"Greater or equal",layer_filter_smaller:"Smaller or equal",layer_filter_text:"Search",layer_data:"Layer data",layer_data_viewport_only:"Features in viewport only",layer_data_geojson:"Download as GeoJSON",layer_download:"Download",layer_dataview_header:"Data Views",layer_add_new_location:"Add new locations",layer_draw_point:"Point",layer_draw_polygon:"Polygon",layer_draw_rectangle:"Rectangle",layer_draw_circle:"Circle",layer_draw_line:"Line",layer_draw_freehand:"Freehand",layer_draw_edit:"Edit",layer_draw_save:"Save",layer_draw_update:"Update",layer_draw_undo:"Undo",layer_draw_cancel:"Cancel",layer_draw_last:"Remove last vertex",layer_draw_error:"Invalid geometry. Right click to continue.",layer_draw_isoline_mapbox:"Isoline Mapbox",layer_draw_isoline_here:"Isoline Here",mapbox_isoline_settings:"Mapbox Isoline settings",mapbox_mode:"Mode",mapbox_travel_time:"Travel time in minutes ",mapbox_driving:"Driving",mapbox_walking:"Walking",mapbox_cycling:"Cycling",mapbox_minutes:"Minutes",mapbox_created:"Created",mapbox_error:"No route found. Try alternative set up.",here_isoline_settings:"Here Isoline settings",here_mode:"Mode",here_range:"Range",here_range_type:"Range type",here_routing_type_balanced:"balanced",here_destination:"Destination",here_departure:"Departure",here_enable_traffic:"Enable traffic",here_time:"Time (min)",here_distance:"Distance (km)",here_driving:"driving",here_walking:"walking",here_cargo:"truck",here_hov_lane:"HOV lane",here_created:"Created",here_travel_time:"Travel time in minutes ",here_travel_distance:"Travel distance in kilometres ",here_error:"No route found. Try a longer travel time or alternative setup.",location_drawer_toggle:"Toggle location view drawer",location_zoom:"Zoom map to feature bounds",location_hide_marker:"Hide marker",location_save:"Save changes to cloud",location_remove:"Remove feature from selection",location_edit_geometry:"Edit location geometry",location_no_geometry:"No geometry found for this location.",location_geometry_delete_msg:"Are you sure you want to delete this additional geometry?",location_delete:"Delete location",location_source_layer:"Source layer",location_json_edit_msg:"Invalid JSON.",toolbar_zoom_in:"Zoom in",toolbar_zoom_out:"Zoom out",toolbar_zoom_to_area:"Zoom to area",toolbar_current_location:"Current location",toolbar_measure:"Measure distance",toolbar_fullscreen:"Fullscreen mapview",toolbar_admin:"Open account admin view",toolbar_logout:"Logout",here_transport_mode:"Mode",here_depart:"Depart at",here_arrive:"Arrive at",here_use_as_destination:"Use as destination",here_routing_type_fastest:"fast",here_routing_type_shortest:"short",here_routing_type:"Routing type",here_optimize_for:"Optimize for",here_optimize_for_balanced:"balanced",here_optimize_for_quality:"quality",here_optimize_for_performance:"performance",dataview_no_data:"No data available here."};var Do={layers_header:"Ebenen",locations_header:"Orte",clear_all_locations:"Entferne Auswahl"};var Oo={search_header:"Rechercher",search_no_results:"Aucun resultat pour cette recherche",locales_header:"Aires",show_layers_for_locale:"Afficher les couches pour l'aire",layers_header:"Couches",locations_header:"Lieux",clear_all_locations:"DesÃ©lectionner tous les lieux.",layer_group_hide_layers:"Cacher les couches du groupe",layer_group_toggle:"Basculer le panneau du groupe",layer_default_icon:"L'icÃ´ne par dÃ©faut",layer_zoom_to_extent:"Zoom sur l'Ã©tendue de la couche",layer_visibility:"Changer la visiblitÃ©",layer_toggle_dashboard:"Basculer le tableau de bord de la couche",layer_style_header:"Style",layer_style_select_theme:"Choisir un thÃ¨me dans la liste",layer_style_bring_to_front:"La mettre Ã  l'avant",layer_style_display_labels:"Afficher les Ã©tiquettes",layer_style_switch_caption:"Cliquer sur l'etiquette pour changer la visiblitÃ© ou ",layer_style_switch_all:"changer tout",layer_grid_legend_min:"min",layer_grid_legend_max:"max",layer_grid_legend_avg:"avg",layer_grid_legend_ratio:"Rapport de coleur et de taille",layer_style_other:"autre",layer_style_cluster:"Plusieurs lieux",layer_filter_header:"Filtres",layer_filter_select:"Choisir un filtre dans la liste",layer_filter_run:"Obtenir les resultats",layer_filter_clear_all:"Effacer tous les filtres",layer_filter_date_after:"AprÃ¨s",layer_filter_date_before:"Avant",layer_filter_pick:"Dans le calendrier",layer_filter_boolean:"Vrai",layer_filter_greater:"SupÃ©rieur ou Ã©gal",layer_filter_smaller:"InfÃ©rieur ou Ã©gal",layer_filter_text:"Rechercher",layer_data:"DonnÃ©es de la couche",layer_data_viewport_only:"Seulement caractÃ©ristiques en Ã©cran",layer_data_geojson:"TÃ©lÃ©charger GeoJSON",layer_dataview_header:"Vues des donnÃ©es",layer_add_new_location:"Ajouter des nouveaux lieux",layer_draw_point:"Point",layer_draw_polygon:"Polygone",layer_draw_rectangle:"Rectangle",layer_draw_circle:"Cercle",layer_draw_line:"Ligne",layer_draw_freehand:"Ã main levÃ©e",layer_draw_edit:"Modifier",layer_draw_save:"Enregister",layer_draw_update:"Actualiser",layer_draw_undo:"Revenir",layer_draw_cancel:"Annuler",layer_draw_last:"Effacer le dernier point",layer_draw_error:"Cette gÃ©omÃ©trie est invalide. Cliquer droit pour continuer.",layer_draw_isoline_mapbox:"Isoligne de Mapbox",layer_draw_isoline_here:"Isoligne de Here",mapbox_isoline_settings:"ParamÃ¨tres de Mapbox",mapbox_mode:"Mode",mapbox_travel_time:"Temps du trajet en minutes ",mapbox_driving:"En voiture",mapbox_walking:"Ã pied",mapbox_cycling:"Ã velo",mapbox_minutes:"Minutes",mapbox_created:"CrÃ©Ã©e",mapbox_error:"Aucune route n'est trouvÃ©e. Essayez d'autres paramÃ¨tres.",here_isoline_settings:"ParamÃ¨tres de Here",here_mode:"Mode",here_range:"Ampleur",here_range_type:"Type de l'ampleur",here_time:"Temps (min)",here_distance:"Distance (km)",here_driving:"en voiture",here_walking:"Ã  pied",here_cargo:"Le cargo",here_hov_lane:"Voie rÃ©servÃ©e au covoiturage (HOV)",here_created:"CrÃ©Ã©e",here_travel_time:"Temps du trajet en minutes ",here_travel_distance:"Distance du trajet en kilometres ",here_error:"Aucune route n'est trouvÃ©e. Essayez d'autres paramÃ¨tres.",location_drawer_toggle:"Basculer le panneau du lieu",location_zoom:"Zoom sur le lieu",location_hide_marker:"Cacher le marqueur",location_save:"Enregistrer les modifications",location_remove:"Le dÃ©sÃ©lectionner",location_edit_geometry:"Modifier la gÃ©omÃ©trie du lieu",location_no_geometry:"Les gÃ©omÃ©tries n'existent pas pour ce lieux.",location_geometry_delete_msg:"Voulez-vous supprimer la gÃ©omÃ©trie supplÃ©mentaire? Cela ne peut Ãªtre dÃ©fait.",location_delete:"Supprimer le lieu",location_json_edit_msg:"Objet JSON incorrect.",location_source_layer:"La couche de source",toolbar_zoom_in:"Zoomer",toolbar_zoom_out:"DÃ©-zoomer",toolbar_zoom_to_area:"Zoomer sur un encadrÃ©",toolbar_current_location:"Localisation actuelle",toolbar_measure:"Mesurer des distances",toolbar_fullscreen:"Carte en plein Ã©cran",toolbar_admin:"Afficher le compte administrateur",toolbar_logout:"Se dÃ©connecter du compte",here_transport_mode:"Type de transport",here_depart:"Partir Ã ",here_arrive:"Arriver Ã ",here_use_as_destination:"En tant que destination",here_routing_type_fastest:"vite",here_routing_type_shortest:"court",here_routing_type:"Type de trajet",here_optimize_for:"Optimiser",here_optimize_for_balanced:"l'Ã©quilibre",here_optimize_for_quality:"la qualitÃ©",here_optimize_for_performance:"les performances",dataview_no_data:"Aucune donnÃ©e disponible."};var Ao={search_header:"Szukaj",search_no_results:"Nic nie znaleziono",locales_header:"Regiony",show_layers_for_locale:"PokaÅ¼ warstwy dle tego regionu",layers_header:"Warstwy",locations_header:"Miejsca",clear_all_locations:"WyczyÅÄ selekcje",layer_group_hide_layers:"Ukryj warstwy z tej grupy",layer_group_toggle:"WidocznoÅÄ panelu grupy",layer_default_icon:"DomyÅlny symbol",layer_zoom_to_extent:"PokaÅ¼ zasiÄg warstwy",layer_visibility:"WidocznoÅÄ",layer_toggle_dashboard:"WidocznoÅÄ panelu warstwy",layer_style_header:"Styl",layer_style_select_theme:"Wybierz styl tematyczny",layer_style_bring_to_front:"Warstwa na wierzch",layer_style_display_labels:"PokaÅ¼ etykiety",layer_style_switch_caption:"Kliknij etykiety aby zmieniÄ widocznoÅÄ albo ",layer_style_switch_all:"zmieÅ wszystkie",layer_grid_legend_min:"min.",layer_grid_legend_max:"maks.",layer_grid_legend_avg:"Åred.",layer_grid_legend_ratio:"PokaÅ¼ kolor w proporcji do rozmiaru",layer_style_other:"inne",layer_style_cluster:"WiÄcej miejsc",layer_filter_header:"Filtruj",layer_filter_select:"Wybierz filtr z listy",layer_filter_run:"Przelicz",layer_filter_clear_all:"WyczyÅÄ filtry",layer_filter_date_after:"Przed",layer_filter_date_before:"Po",layer_filter_pick:"Z kalendarza",layer_filter_boolean:"Tak",layer_filter_greater:"WiÄksze lub rÃ³wne",layer_filter_smaller:"Mniejsze lub rÃ³wne",layer_filter_text:"Szukaj",layer_data:"Dane warstwy",layer_data_viewport_only:"Tylko widoczne",layer_data_geojson:"Pobierz jako GeoJSON",layer_dataview_header:"Widoki danych",layer_add_new_location:"Dodaj nowe miejsca",layer_draw_point:"Punkt",layer_draw_polygon:"Poligon",layer_draw_rectangle:"ProstokÄt",layer_draw_circle:"Okrag",layer_draw_line:"Linia",layer_draw_freehand:"OdrÄcznie",layer_draw_edit:"Edytuj",layer_draw_save:"Zapisz",layer_draw_update:"ZmieÅ",layer_draw_undo:"Cofnij",layer_draw_cancel:"Anuluj",layer_draw_last:"UsuÅ ostatni wierzchoÅek",layer_draw_error:"Niepoprawna geometria. Kliknij prawym aby kontynuowaÄ.",layer_draw_isoline_mapbox:"Izolinia Mapbox",layer_draw_isoline_here:"Izolinia Here",mapbox_isoline_settings:"Ustawienia izolinii Mapbox",mapbox_mode:"Typ",mapbox_travel_time:"Czas podrÃ³Å¼y w minutach ",mapbox_driving:"Samochodem",mapbox_walking:"PiechotÄ",mapbox_cycling:"Rowerem",mapbox_minutes:"Minuty",mapbox_created:"Utworzono",mapbox_error:"Nie znaleziono trasy. WyprÃ³buj inne ustawienia.",here_isoline_settings:"Ustawienia izolinii Here",here_mode:"Typ",here_range:"ZasiÄg",here_range_type:"Typ zasiÄgu",here_time:"Czas (min)",here_distance:"OdlegÅoÅÄ (km)",here_driving:"samochodem",here_walking:"piechotÄ",here_cargo:"transport towarÃ³w",here_hov_lane:"transport osÃ³b",here_created:"Utworzono",here_travel_time:"Czas podrÃ³Å¼y w minutach ",here_travel_distance:"OdlegÅoÅÄ w kilometrach ",here_error:"Nie znaleziono trasy. WyprÃ³buj dÅuÅ¼szy czas podrÃ³Å¼y lub inne ustawienia.",location_drawer_toggle:"WidocznoÅÄ panelu miejsca",location_zoom:"PokaÅ¼ zasiÄg miejsca",location_hide_marker:"Ukryj ikonÄ",location_save:"Zapisz zmiany",location_remove:"Odznacz miejsce",location_edit_geometry:"Edytuj geometriÄ miejsca",location_no_geometry:"Nie znaleziono geometrii dla tego miejsca.",location_geometry_delete_msg:"Czy na pewno chcesz usunÄÄ geometriÄ towarzyszÄcÄ? Tego nie moÅ¼na cofnÄÄ.",location_delete:"UsuÅ miejsce",location_source_layer:"Warstaw ÅºrÃ³dÅowa",location_json_edit_msg:"Niepoprawny obiekt JSON.",toolbar_zoom_in:"PowiÄksz",toolbar_zoom_out:"Pomniejsz",toolbar_zoom_to_area:"PokaÅ¼ obszar",toolbar_current_location:"Obecna lokalizacja",toolbar_measure:"Pomiar odlegÅoÅci",toolbar_fullscreen:"Mapa na peÅnym ekranie",toolbar_admin:"PokaÅ¼ konto administratora",toolbar_logout:"Wyloguj siÄ",here_transport_mode:"Årodek transportu",here_depart:"Rozpocznij",here_arrive:"OsiÄgnij cel",here_use_as_destination:"Jako cel podrÃ³Å¼y",here_routing_type_fastest:"szybka",here_routing_type_shortest:"krÃ³tka",here_routing_type:"Trasa",here_optimize_for:"Optymalizacja",here_optimize_for_balanced:"zrÃ³wnowaÅ¼ona",here_optimize_for_quality:"jakoÅÄ",here_optimize_for_performance:"wydajnoÅÄ",dataview_no_data:"Brak danych do wyÅwietlenia."};var Po={search_header:"æ¤ç´¢",search_no_results:"çµæãªã",locales_header:"ã­ã«ã¼ã«",show_layers_for_locale:"ä»¥ä¸ã®ã­ã«ã¼ã«ã«å¯¾ãã¬ã¤ã¤ã¼ãè¡¨ç¤º",layers_header:"ã¬ã¤ã¤ã¼",locations_header:"ã­ã±ã¼ã·ã§ã³",clear_all_locations:"å¨ã­ã±ã¼ã·ã§ã³ãã¯ãªã¢",layer_group_hide_layers:"ã°ã«ã¼ãããã¬ã¤ã¤ã¼ãé ã",layer_group_toggle:"ã°ã«ã¼ãããã«åæ¿ã",layer_default_icon:"ããã©ã«ãã¢ã¤ã³ã³",layer_zoom_to_extent:"ãã£ã«ã¿ã¼ãããã¬ã¤ã¤ã¼ç¯å²ããºã¼ã ã«",layer_visibility:"è¡¨ç¤ºåæ¿",layer_toggle_dashboard:"ã¬ã¤ã¤ã¼ããã·ã¥ãã¼ãåæ¿ã",layer_style_header:"ã¹ã¿ã¤ã«",layer_style_select_theme:"ãã¼ãã¹ã¿ã¤ã«ãé¸æ",layer_style_bring_to_front:"ã¬ã¤ã¤ã¼ãåã«",layer_style_display_labels:"ã©ãã«ãè¡¨ç¤º",layer_style_switch_caption:"è¡¨ç¤ºåæ¿ãã«ã¯åã©ãã«ãã¯ãªãã¯ããã ",layer_style_switch_all:"å¨è¡¨ç¤ºæãã¯å¨éè¡¨ç¤º",layer_grid_legend_min:"æå°",layer_grid_legend_max:"æå¤§",layer_grid_legend_avg:"å¹³å",layer_grid_legend_ratio:"è²ã¯ãµã¤ãºã®æ¯çã§è¡¨ç¤º",layer_style_other:"ãã®ä»",layer_style_cluster:"å¤æ°ã®ã­ã±ã¼ã·ã§ã³",layer_filter_header:"ãã£ã«ã¿ã¼",layer_filter_select:"ãªã¹ããããã£ã«ã¿ã¼ãé¸æ",layer_filter_run:"ã¢ã¦ãããããå®è¡",layer_filter_clear_all:"å¨ãã£ã«ã¿ã¼ãã¯ãªã¢",layer_filter_date_after:"å¾",layer_filter_date_before:"å",layer_filter_pick:"ã«ã¬ã³ãã¼ããé¸æ",layer_filter_boolean:"TRUE",layer_filter_greater:"ä»¥ä¸",layer_filter_smaller:"ä»¥ä¸",layer_filter_text:"æ¤ç´¢",layer_data:"Layer data",layer_data_viewport_only:"Features in viewport only",layer_data_geojson:"Download as GeoJSON",layer_dataview_header:"ãã¼ã¿ãã¥ã¼",layer_add_new_location:"æ°ããã­ã±ã¼ã·ã§ã³ãè¿½å ",layer_draw_point:"ãã¤ã³ã",layer_draw_polygon:"ããªã´ã³",layer_draw_rectangle:"é·æ¹å½¢",layer_draw_circle:"ä¸¸",layer_draw_line:"ç·",layer_draw_freehand:"ããªã¼ãã³ã",layer_draw_edit:"ç·¨é",layer_draw_save:"ä¿å­",layer_draw_update:"æ´æ°",layer_draw_undo:"ã¢ã³ãã¥",layer_draw_cancel:"ã­ã£ã³ã»ã«",layer_draw_last:"æå¾ã®ãã¼ããã¯ã¹ãåé¤",layer_draw_error:"ç¡å¹ãªã¸ãªã¡ããªã¼ å³ã¯ãªãã¯ã§ç¶ãã",layer_draw_isoline_mapbox:"ã¤ã½ãªã³ MAPBOX",layer_draw_isoline_here:"ã¤ã½ãªã³ HERE",mapbox_isoline_settings:"MAPBOXã®ã¤ã½ãªã³è¨­å®",mapbox_mode:"ã¢ã¼ã",mapbox_travel_time:"ç§»åæé (å) ",mapbox_driving:"ãã©ã¤ãã³ã°",mapbox_walking:"ã¦ã©ã¼ã­ã³ã°",mapbox_cycling:"ãµã¤ã¯ãªã³ã°",mapbox_recent:"æè¿ã®ã¤ã½ãªã³",mapbox_minutes:"ç§»åæé (å)",mapbox_created:"ä½ææ¸",mapbox_error:"ã«ã¼ããªããä»ã®è¨­å®ãé¸ãã§ãã ãã",here_isoline_settings:"HEREã®ã¤ã½ãªã³è¨­å®",here_mode:"ã¢ã¼ã",here_range:"ç¯å²",here_range_type:"ç¯å²ã¿ã¤ã",here_time:"ç§»åæé (å)",here_distance:"ç§»åè·é¢ (km)",here_driving:"ãã©ã¤ãã³ã°",here_walking:"ã¦ã©ã¼ã­ã³ã°",here_cargo:"è²¨ç©",here_hov_lane:"HOVï¼High Occupied Vehicleä¹è»çã®é«ãè»ç¨ï¼ã¬ã¼ã³",here_recent:"æè¿ã®ã¤ã½ãªã³",here_created:"ä½ææ¸",here_travel_time:"ç§»åæé (å) ",here_travel_distance:"ç§»åè·é¢ (km) ",here_error:"ã«ã¼ããªããããé·ãç§»åæéãæãã¯ä»ã®è¨­å®ãé¸ãã§ãã ãã",location_drawer_toggle:"ã­ã±ã¼ã·ã§ã³ãã¥ã¼ãã­ã¯ã¼ããã°ã«",location_zoom:"ãã£ã¼ãã£ç¯å²ã«ã¯ãããããºã¼ã ",location_hide_marker:"ãã¼ã«ã¼ãé ã",location_save:"ã¯ã©ã¦ãã«å¤æ´ãä¿å­",location_remove:"é¸æãããã£ã¼ãã£ã¼ï¼æ©è½ï¼ãåé¤",location_edit_geometry:"ã­ã±ã¼ã·ã§ã³ã¸ãªã¡ããªã¼ãç·¨é",location_no_geometry:"ãã®å ´æã®ã¸ãªã¡ããªãè¦ã¤ããã¾ããã",location_geometry_delete_msg:"è¿½å ã¸ãªã¡ããªã¼ãæ¬å½ã«åé¤ãã¾ãããåãæ¶ãä¸å¯",location_delete:"ã­ã±ã¼ã·ã§ã³ãåé¤",location_source_layer:"åã®ã¬ã¤ã¤ã¼",location_json_edit_msg:"ç¡å¹ãªJSON",toolbar_zoom_in:"ãºã¼ã ã¤ã³",toolbar_zoom_out:"ãºã¼ã ã¢ã¦ã",toolbar_zoom_to_area:"ã¨ãªã¢ããºã¼ã ã«",toolbar_current_location:"ç¾å¨å°",toolbar_measure:"è·é¢ãè¨æ¸¬",toolbar_fullscreen:"ãã«ã¹ã¯ãªã¼ã³ ããããã¥ã¼",toolbar_admin:"ã¢ã«ã¦ã³ãã¢ããã³ãã¥ã¼ãéã",toolbar_logout:"ã­ã°ã¢ã¦ã"};var Io={search_header:"ê²ì",search_no_results:"ê²ìê²°ê³¼ ìì",locales_header:"íì¥",show_layers_for_locale:"ë¤ì íì¥ì ë ì´ì´(ì¸µ) ë³´ì¬ì£¼ê¸°",layers_header:"ë ì´ì´(ì¸µ)",locations_header:"ìì¹",clear_all_locations:"ëª¨ë  ìì¹ ì ê±°",layer_group_hide_layers:"ê·¸ë£¹ìì ë ì´ì´ ì¨ê¸°ê¸°",layer_group_toggle:"í ê¸ ê·¸ë£¹ í¨ë",layer_default_icon:"ê¸°ë³¸ ìì´ì½",layer_zoom_to_extent:"íí°ë ë ì´ì´í¬ê¸°ì ì¤(zoom)",layer_visibility:"í ê¸ ê°ìì±",layer_toggle_dashboard:"í ê¸ ë ì´ì´ ê³ê¸°í",layer_style_header:"ì¤íì¼",layer_style_select_theme:"ì£¼ì ë³ ì¤íì¼ ì í",layer_style_bring_to_front:"ë ì´ì´ ìì¼ë¡ ê°ì ¸ì¤ê¸°",layer_style_display_labels:"ë¼ë²¨ íì",layer_style_switch_caption:"ê°ìì± ë³ê²½ì ìí´ ë¼ë²¨ í´ë¦­ ëë ",layer_style_switch_all:"ëª¨ë ë³ê²½",layer_grid_legend_min:"ìµì",layer_grid_legend_max:"ìµë",layer_grid_legend_avg:"íê· ",layer_grid_legend_ratio:"í¬ê¸°ë¹ì¨ì ë°ë¥¸ ìì íì",layer_style_other:"ê¸°í",layer_style_cluster:"ë³µì ìì¹",layer_filter_header:"íí°",layer_filter_select:"ë¦¬ì¤í¸ë¡ ë¶í° íí° ì í",layer_filter_run:"ê²°ê³¼ íì",layer_filter_clear_all:"ì ì²´ íí° ì ê±°",layer_filter_date_after:"ì ",layer_filter_date_before:"í",layer_filter_pick:"ë¬ë ¥ìì ì í",layer_filter_boolean:"ì°¸",layer_filter_greater:"ì´ì",layer_filter_smaller:"ì´í",layer_filter_text:"ê²ì",layer_data:"Layer data",layer_data_viewport_only:"Features in viewport only",layer_data_geojson:"Download as GeoJSON",layer_dataview_header:"ë°ì´í° ë³´ê¸°",layer_add_new_location:"ìë¡ì´ ìì¹ ì¶ê°",layer_draw_point:"ì ",layer_draw_polygon:"ë¤ê°í",layer_draw_rectangle:"ì§ì¬ê°í",layer_draw_circle:"ì",layer_draw_line:"ì ",layer_draw_freehand:"ìì¼ë¡ ê·¸ë¦¼(ìì  ì¬ë)",layer_draw_edit:"í¸ì§",layer_draw_save:"ì ì¥",layer_draw_update:"ìë°ì´í¸",layer_draw_undo:"ëëë¦¬ê¸°",layer_draw_cancel:"ì·¨ì",layer_draw_last:"ë§ì§ë§ ì ì (ê¼­ì§ì ) ì ê±°",layer_draw_error:"íë¹íì§ ìë ì§ì¤ë©í¸ë¦¬. ê³ìíë ¤ë©´ ë§ì°ì¤ì¤ë¥¸ìª½ í´ë¦­",layer_draw_isoline_mapbox:"ë±ì¹ì  ë§µë°ì¤",layer_draw_isoline_here:"Here ë±ì¹ì ",mapbox_isoline_settings:"ë±ì¹ì  Mapbox",mapbox_mode:"ëª¨ë",mapbox_travel_time:"ì¬íìê°(ë¶) ",mapbox_driving:"ì´ì ",mapbox_walking:"ëë³´",mapbox_cycling:"ì¬ì´í´",mapbox_recent:"ìµê·¼ ë±ì¹ì ",mapbox_minutes:"ì¬íìê°(ë¶)",mapbox_created:"ìì±",mapbox_error:"ê²½ë¡ ìì. ë¤ë¥¸ ì¤ì  ìë",here_isoline_settings:"ë±ì¹ì  Here",here_mode:"ëª¨ë",here_range:"ë²ì",here_range_type:"ë²ì ì í",here_time:"ì¬íìê°(ë¶)",here_distance:"ì¬íê±°ë¦¬(km)",here_driving:"ì´ì ",here_walking:"ëë³´",here_cargo:"íë¬¼",here_hov_lane:"ë¤ì¸ì¹ ì ì©ì°¨ë¡",here_recent:"ìµê·¼ ë±ì¹ì ",here_created:"ìì±",here_travel_time:"ì¬íìê°(ë¶) ",here_travel_distance:"ì¬íê±°ë¦¬(km) ",here_error:"ê²½ë¡ ìì. ë ê¸´ ì¬íìê° ëë ë¤ë¥¸ ì¤ì  ìë",location_drawer_toggle:"í ê¸ ìì¹ ë·° í¨",location_zoom:"íê³ë¥¼ í¬í¨í ì¤ ì§ë",location_hide_marker:"ë§ì»¤ ì¨ê¸°ê¸°",location_save:"ë³ê²½ì¬í­ í¬ë¼ì°ë ì ì¥",location_remove:"ì íìì í¹ì§ ì ê±°",location_edit_geometry:"ìì¹ ì§ì¤ë©í¸ë¦¬ í¸ì§",location_no_geometry:"ì´ ìì¹ì ëí ì§ì¤ë©í¸ë¦¬ê° ììµëë¤.",location_geometry_delete_msg:"ì¶ê°ì ì¸ ì§ì¤ë©í¸ë¦¬ ì­ì ë¥¼ ìíì­ëê¹? ëëë¦¬ê¸° ë¶ê°",location_delete:"ìì¹ ì­ì ",location_source_layer:"ìë£ ì¶ì² ë ì´ì´",location_json_edit_msg:"íë¹íì§ìì JSON",toolbar_zoom_in:"ì¤ì¸",toolbar_zoom_out:"ì¤ìì",toolbar_zoom_to_area:"í´ë¹ì§ì­ ì¤(Zoom)",toolbar_current_location:"íì¬ ìì¹",toolbar_measure:"ê±°ë¦¬ì¸¡ì ",toolbar_fullscreen:"ì§ëë·° ì ì²´íë©´",toolbar_admin:"ê³ì ê´ë¦¬ë·° ì¤í",toolbar_logout:"ë¡ê·¸ìì"};var xo={search_header:"æç´¢",search_no_results:"æªæ¾å°ç¸å³å°ç¹",locales_header:"å°åº",show_layers_for_locale:"æ¾ç¤ºä»¥ä¸å°åº",layers_header:"å¾å±",locations_header:"å°ç¹",clear_all_locations:"æ¸é¤ææå°ç¹",layer_group_hide_layers:"éèå¾å±",layer_group_toggle:"åæ¢ç»é¢æ¿",layer_default_icon:"é»è®¤å¾æ ",layer_zoom_to_extent:"ç¼©æ¾è³ç¸åºç­éèå´",layer_visibility:"åæ¢å¯è§æ§",layer_toggle_dashboard:"åæ¢å¾å±ä»ªè¡¨æ¿",layer_style_header:"é£æ ¼æ ·å¼",layer_style_select_theme:"éæ©ä¸»é¢é£æ ¼",layer_style_bring_to_front:"å¾å±ç½®é¡¶",layer_style_display_labels:"æ¾ç¤ºæ ç­¾",layer_style_switch_caption:"åå»å¾æ ä»¥åæ¢å¯è§æ§ ",layer_style_switch_all:"å¨é¨åæ¢",layer_grid_legend_min:"æä½",layer_grid_legend_max:"æé«",layer_grid_legend_avg:"å¹³å",layer_grid_legend_ratio:"æ¾ç¤ºé¢è²ä¸å°ºå¯¸æ¯ä¾",layer_style_other:"å¶å®",layer_style_cluster:"å¤ä¸ªå°ç¹",layer_filter_header:"ç­é",layer_filter_select:"ä»åè¡¨ç­é",layer_filter_run:"è¾åºç»æ",layer_filter_clear_all:"æ¸é¤ææç­éè®¾ç½®",layer_filter_date_after:"å",layer_filter_date_before:"å",layer_filter_pick:"ä»æ¥åä¸­éæ©",layer_filter_boolean:"TRUE",layer_filter_greater:"å¤§äºæç­äº",layer_filter_smaller:"å°äºæç­äº",layer_filter_text:"æç´¢",layer_data:"å¾å±æ°æ®",layer_data_viewport_only:"ä»å½åé¡µé¢è¦ç´ ",layer_data_geojson:"ä¸è½½ä¸ºGeoJSON",layer_dataview_header:"æ°æ®æ£è§",layer_add_new_location:"æ°æ®æ£è§",layer_draw_point:"ç¹",layer_draw_polygon:"å¤è¾¹å½¢",layer_draw_rectangle:"é¿æ¹å½¢",layer_draw_circle:"å",layer_draw_line:"çº¿",layer_draw_freehand:"ä»»æå¾å½¢",layer_draw_edit:"ç¼è¾",layer_draw_save:"ä¿å­",layer_draw_update:"æ´æ°",layer_draw_undo:"æ¤æ¶",layer_draw_cancel:"åæ¶",layer_draw_last:"å é¤æåä¸ä¸ªé¡¶ç¹",layer_draw_error:"æ æå¾å½¢ï¼åå»å³é®ä»¥ç»§ç»­",layer_draw_isoline_mapbox:"ç­å¼çº¿å¾æ¡",layer_draw_isoline_here:"æ­¤å¤ç­å¼çº¿",mapbox_isoline_settings:"Mapboxç­å¼çº¿è®¾ç½®",mapbox_mode:"æ¨¡å¼",mapbox_travel_time:"ä»¥åéè®¡äº¤éæ¶é´ ",mapbox_driving:"æºå¨è½¦è¡",mapbox_walking:"æ­¥è¡",mapbox_cycling:"éªè¡",mapbox_recent:"æè¿æçç­å¼çº¿",mapbox_minutes:"ä»¥åéè®¡äº¤éæ¶é´",mapbox_created:"å·²å»ºç«",mapbox_error:"æ¾ä¸å°è·¯çº¿ï¼å°è¯å¶ä»è®¾ç½®",here_isoline_settings:"Hereç­å¼çº¿è®¾ç½®",here_mode:"æ¨¡å¼",here_range:"èå´",here_range_type:"èå´ç±»å",here_time:"ä»¥åéè®¡äº¤éæ¶é´",here_distance:"è¡é©¶è·ç¦»ï¼å¬éï¼",here_driving:"æºå¨è½¦è¡",here_walking:"æ­¥è¡",here_cargo:"è´§ç©",here_hov_lane:"HOVï¼High Occupied Vehicle)è½¦é",here_recent:"æè¿æçç­å¼çº¿",here_created:"å·²å»ºç«",here_travel_time:"ä»¥åéè®¡äº¤éæ¶é´ ",here_travel_distance:"è¡é©¶è·ç¦»ï¼å¬éï¼",here_error:"æ¾ä¸å°è·¯çº¿ï¼è¯·å°è¯å¢é¿äº¤éæ¶é´æå¶ä»è®¾ç½®ã",location_drawer_toggle:"åæ¢å°ç¹ä½ç½®è§å¾",location_zoom:"ç¼©æ¾å°å¾è³ç®æ èå´",location_hide_marker:"éèæ è®°",location_save:"å°æ´æ¹ä¿å­è³äº",location_remove:"å é¤æéç®æ è¦ç´ ",location_edit_geometry:"ç¼è¾å°ç¹æä½ç½®è¾¹ç",location_no_geometry:"å¨æ­¤ä½ç½®æ¾ä¸å°å¹¾ä½ã",location_geometry_delete_msg:"æ¯å¦ç¡®å®å é¤æ°å¢çå ä½å¾å½¢ï¼å½ä»¤æ§è¡åå°æ æ³æ¤æ¶ã",location_delete:"å é¤å°ç¹",location_source_layer:"æ¥çæå¨å¾å±",location_json_edit_msg:"æ æçJSON",toolbar_zoom_in:"æ¾å¤§",toolbar_zoom_out:"ç¼©å°",toolbar_zoom_to_area:"ç¼©æ¾è³åºå",toolbar_current_location:"å½åä½ç½®",toolbar_measure:"æµéè·ç¦»",toolbar_fullscreen:"å¨å±æ¾ç¤ºå°å¾",toolbar_admin:"å¼å¯å¸æ·ç®¡çåè§å¾",toolbar_logout:"éåº"};var Ro=e=>{return{get:{layer:t=>r("layer",t),locale:t=>r("locale",t),locales:t=>r("locales",t)},locale:{}};function r(t,n={}){return new Promise((a,i)=>{let s=new XMLHttpRequest;s.open("GET",`${e.host}/api/workspace/get/${t}?`+e.utils.paramString(n)),s.responseType="json",s.onload=o=>{if(o.target.status!==200)return i();a(o.target.response)},s.send()})}};var Ho=e=>{if(!e.hooks)return null;let r={layers:[],locations:[]};return window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,(l,f,p)=>{r[f]?r[f]=decodeURI(p).split(","):r[f]=decodeURI(p)}),r.token&&(window.history.replaceState({},document.title,window.location.href.replace(new RegExp(`token=${r.token}`),"")),delete r.token),{current:r,set:t,remove:n,removeAll:a,push:i,filter:s};function t(l){Object.assign(e.hooks.current,l),o()}function n(l){Array.isArray(e.hooks.current[l])?e.hooks.current[l].length=0:delete e.hooks.current[l],o()}function a(){Object.keys(e.hooks.current).forEach(l=>n(l)),o()}function i(l,f){e.hooks.current[l]?e.hooks.current[l].indexOf(f)<0&&e.hooks.current[l].push(f):e.hooks.current[l]=[f],o()}function s(l,f){e.hooks.current[l]=e.hooks.current[l].filter(p=>p!==f),o()}function o(){try{window.history.pushState({},document.title,`?${e.utils.paramString(e.hooks.current)}`)}catch(l){console.log(l)}}};var No=e=>(r={})=>{let t=Object.assign(e.locale,r);if(!t.target)return console.log("No target for mapview!");e.mapview.node=t.target,e.mapview.srid=t.srid||"3857";let n=e.hooks&&e.hooks.current.z||t.view&&t.view.z||t.minZoom||0,a=ol.proj.fromLonLat([parseFloat(e.hooks&&e.hooks.current.lng||t.view&&t.view.lng||0),parseFloat(e.hooks&&e.hooks.current.lat||t.view&&t.view.lat||0)]),i=t.bounds&&ol.proj.transformExtent([parseFloat(t.bounds.west||-180),parseFloat(t.bounds.south||-90),parseFloat(t.bounds.east||180),parseFloat(t.bounds.north||90)],"EPSG:4326","EPSG:"+e.mapview.srid);if(e.map=new ol.Map({target:e.mapview.node,interactions:ol.interaction.defaults({mouseWheelZoom:t.scrollWheelZoom||!1,PinchRotate:{threshold:3}}),controls:[],view:new ol.View({projection:"EPSG:"+e.mapview.srid,zoom:n,minZoom:t.minZoom,maxZoom:t.maxZoom,center:a,extent:i})}),e.map.on("pointermove",l=>{e.mapview.position=l.coordinate}),e.map.on("movestart",()=>e.mapview.interaction.break=!0),e.mapview.node.addEventListener("changeEnd",()=>{if(Object.values(e.layers.list).forEach(l=>{l.view&&l.tables&&(l.tableCurrent()===null?l.view.classList.add("disabled"):l.view.classList.remove("disabled"))}),e.hooks){let l=ol.proj.transform(e.map.getView().getCenter(),"EPSG:"+e.mapview.srid,"EPSG:4326");e.hooks.set({lat:l[1],lng:l[0],z:e.map.getView().getZoom()})}setTimeout(()=>delete e.mapview.interaction.break,500)}),e.mapview.interaction.highlight.begin(),t.zoomControl&&e.map.addControl(new ol.control.Zoom),t.attribution&&e.mapview.attribution.create(),t.showScaleBar&&e.map.addControl(new ol.control.ScaleLine({target:"ol-scale",units:t.showScaleBar.units?t.showScaleBar.units:"metric"})),t.maskBounds){let l=[[180,90],[180,-90],[-180,-90],[-180,90],[180,90]],f=[[t.bounds.east,t.bounds.north],[t.bounds.east,t.bounds.south],[t.bounds.west,t.bounds.south],[t.bounds.west,t.bounds.north],[t.bounds.east,t.bounds.north]],p=new ol.Feature({geometry:new ol.geom.Polygon([l,f]).transform("EPSG:4326","EPSG:"+e.mapview.srid)}),u=new ol.layer.Vector({source:new ol.source.Vector({features:[p]}),style:new ol.style.Style({fill:new ol.style.Fill({color:e.utils.Chroma("#000").alpha(.2).rgba()})}),zIndex:999});e.map.addLayer(u)}e.map.on("moveend",o);let s;function o(){clearTimeout(s),s=setTimeout(()=>{e.mapview.node.dispatchEvent(e.mapview.changeEndEvent)},500)}Object.values(e.layers.list).forEach(l=>l.display&&l.show())};var Bo=e=>{let r={create:t,check:n,links:e.utils.html.node`<div>`};return r;function t(){!e.locale.attribution.target||(r.node=e.locale.attribution.target,e.locale.attribution.target.appendChild(r.links))}function n(){let a=Object.assign({},e.locale.attribution&&e.locale.attribution.links||{});Object.values(e.layers.list).forEach(i=>{i.display&&i.attribution&&Object.assign(a,i.attribution)}),e.utils.render(r.links,e.utils.html`
    ${Object.entries(a).map(i=>e.utils.html`
      <a target="_blank" href="${i[1]}">${i[0]}`)}`)}};var Go=e=>{let r={toggle:t,active:!1,icon:{type:"geo",scale:.05},marker:new ol.Feature({geometry:new ol.geom.Point([0,0])})};return r;function t(){r.active=!r.active;let n=!0;if(r.L||(r.L=new ol.layer.Vector({source:new ol.source.Vector({features:[r.marker]}),zIndex:40,style:new ol.style.Style({image:e.mapview.icon(e.mapview.locate.icon)})})),!r.active)return e.map.removeLayer(r.L);e.map.addLayer(r.L),r.watcher||(r.watcher=navigator.geolocation.watchPosition(a=>{if(r.active){let i=ol.proj.fromLonLat([parseFloat(a.coords.longitude),parseFloat(a.coords.latitude)]);r.marker.getGeometry().setCoordinates(i),n&&e.map.getView().animate({center:i},{zoom:e.locale.maxZoom}),n=!1}},a=>{console.error(a)},{}))}};var qo=e=>function(r){let n=new ol.format.GeoJSON().readFeature({type:"Feature",geometry:r.geometry},{dataProjection:"EPSG:"+(r.dataProjection||e.mapview.srid),featureProjection:"EPSG:"+(r.featureProjection||e.mapview.srid)}),a=new ol.source.Vector({features:[n]}),i=new ol.layer.Vector({source:a,zIndex:isNaN(r.zIndex)?2e3:r.zIndex,style:r.style});return e.map.addLayer(i),i};var Vo=e=>{return{create:r};function r(t){this.node&&this.node.remove(),this.node=e.utils.html.node`<div class="popup">`,this.node.appendChild(t.content),this.overlay&&e.map.removeOverlay(this.overlay),this.overlay=new ol.Overlay({element:this.node,position:t.coords||e.mapview.position,positioning:"bottom-center",autoPan:t.autoPan,insertFirst:!0,autoPanAnimation:{duration:250}}),e.map.addOverlay(this.overlay)}};var Uo=e=>{let r={begin:t,finish:f};return r;function t(){e.mapview.interaction.current&&e.mapview.interaction.current.finish&&e.mapview.interaction.current.finish(),e.mapview.interaction.current=r,e.mapview.node.style.cursor="auto",r.featureSet=new Set,e.map.on("pointermove",i),e.mapview.node.addEventListener("mouseout",a),e.map.on("singleclick",o),e.mapview.node.addEventListener("mousedown",n)}function n(){clearTimeout(r.timeout),r.timeout=setTimeout(()=>{r.longClick=!0,e.mapview.node.style.cursor="url('data:image/svg+xml,%3Csvg%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%2212%22%20cy%3D%2212%22%20r%3D%2210%22%20stroke%3D%22%23fff%22%20stroke-width%3D%223%22%20fill%3D%22none%22%2F%3E%0A%20%20%20%20%3Ccircle%20cx%3D%2212%22%20cy%3D%2212%22%20r%3D%2210%22%20stroke%3D%22%23333%22%20stroke-width%3D%222%22%20fill%3D%22none%22%2F%3E%3C%2Fsvg%3E') 12 12, auto"},600)}function a(){e.mapview.pointerLocation={x:null,y:null},s()}function i(p){r.longClick&&(delete r.longClick,e.mapview.node.style.cursor="auto"),clearTimeout(r.timeout),e.mapview.pointerLocation={x:p.originalEvent.clientX,y:p.originalEvent.clientY},e.mapview.infotip.node&&e.mapview.infotip.position();let u=new Set;e.map.forEachFeatureAtPixel(p.pixel,(h,w)=>{u.add(h),!r.featureSet.has(h)&&(r.feature=h,r.layer=w.get("layer"),r.layer.highlight=h.get("id"),r.layer.infoj&&(e.mapview.node.style.cursor="pointer"),p.originalEvent.pointerType!=="touch"&&r.layer.L.setStyle(r.layer.L.getStyle()),p.originalEvent.pointerType!=="touch"&&r.layer.hover&&r.layer.infotip())},{layerFilter:h=>Object.values(e.layers.list).some(w=>w.qID&&w.style&&w.style.highlight&&w.L===h),hitTolerance:5}),r.featureSet=u,(!u.size||!u.has(r.feature))&&s()}function s(){r.featureSet=new Set,e.mapview.infotip.node&&e.mapview.infotip.node.remove(),!!r.layer&&(r.layer.highlight=!0,e.mapview.node.style.cursor="auto",r.layer.L.setStyle(r.layer.L.getStyle()),delete r.layer,delete r.feature)}function o(p){if(r.longClick)return delete r.longClick,e.mapview.node.style.cursor="auto",l(p);if(clearTimeout(r.timeout),p.originalEvent.pointerType==="touch"&&i(p),e.mapview.popup.overlay&&e.map.removeOverlay(e.mapview.popup.overlay),!r.layer||!r.feature)return;let u=p.pixel;r.layer.select(r.feature,u)}function l(p){s(),e.map.forEachFeatureAtPixel(p.pixel,(u,h)=>{h.get("layer").select(u)},{layerFilter:u=>Object.values(e.layers.list).some(h=>h.qID&&h.infoj&&h.style&&h.style.highlight&&h.L===u),hitTolerance:5})}function f(){e.map.un("pointermove",i),e.map.un("singleclick",o),e.mapview.node.removeEventListener("mouseout",a),e.mapview.node.removeEventListener("mousedown",n)}};var Yo=e=>{let r={begin:t,finish:s,cancel:i,update:l,feature:o,polygonKinks:a,format:new ol.format.GeoJSON,Layer:new ol.layer.Vector({source:new ol.source.Vector})};return r;function t(p){e.mapview.interaction.current&&e.mapview.interaction.current.finish&&e.mapview.interaction.current.finish(),e.mapview.interaction.current=r,delete r.kinks,r.finish=p.finish||s,r.callback=p.callback,r.select_callback=p.select_callback,r.update=p.update||l,r.layer=p.layer,r.layer&&!r.layer.display&&r.layer.show(),e.mapview.node.style.cursor="crosshair",r.vertices=[],e.map.addLayer(r.Layer),p.style=p.style||{};let u=new ol.style.Stroke({color:p.style.strokeColor||"#3399CC",width:p.style.strokeWidth||1.25}),h=new ol.style.Fill({color:p.style.fillColor||"rgba(255,255,255,0.4)"}),w=new ol.style.Style({image:p.style.image&&e.mapview.icon(p.style.image)||new ol.style.Circle({fill:h,stroke:u,radius:5}),stroke:u,fill:h});r.interaction=new ol.interaction.Draw({source:r.Layer.getSource(),geometryFunction:p.geometryFunction,freehand:p.freehand,type:p.type,style:()=>w,condition:D=>{if(r.kinks)return!1;if(D.originalEvent.buttons===1)return r.vertices.push(D.coordinate),e.mapview.popup.node&&e.mapview.popup.node.remove(),!0}}),r.interaction.on("drawstart",D=>{p.tooltip&&n(D.feature.getGeometry(),p.tooltip),D.feature.setStyle(w),r.Layer.getSource().clear(),e.mapview.popup.node&&e.mapview.popup.node.remove()}),r.interaction.on("drawend",D=>{if(p.freehand&&r.vertices.push(D.target.sketchCoords_.pop()),p.drawend)return p.drawend(D);r.layer&&setTimeout(f,400)}),e.map.addInteraction(r.interaction),r.layer&&e.mapview.node.addEventListener("contextmenu",f)}function n(p,u){let h={distance:()=>ol.sphere.getLength(new ol.geom.LineString([p.getInteriorPoint().getCoordinates(),e.mapview.position])),area:()=>ol.sphere.getArea(p),length:()=>ol.sphere.getLength(p)};!h[u]||p.on("change",()=>{e.mapview.popup.create({content:e.utils.html.node`
          <div style="padding: 5px">${parseInt(h[u]()).toLocaleString("en-GB")+(u==="area"?"sqm":"m")}`})})}function a(p,u){u||(u=new ol.geom[r.interaction.type_](p));let h=e.utils.turf.kinks({type:r.interaction.type_,coordinates:u.getCoordinates()}).features;return r.interaction.type_==="Polygon"&&p[0].length&&u.setCoordinates([p[0].concat([p[0][0]])]),r.kinks=h.length>0&&h[0].geometry.coordinates.join()!==p[0][0].join(),e.mapview.node.style.cursor=r.kinks?"not-allowed":"crosshair",u}function i(){s(),e.mapview.interaction.highlight.begin()}function s(){r.callback&&(r.callback(),delete r.callback),e.mapview.popup.node&&e.mapview.popup.node.remove(),r.layer&&e.mapview.node.removeEventListener("contextmenu",f),e.map.removeInteraction(r.interaction),e.map.removeLayer(r.Layer),r.Layer.getSource().clear(),e.mapview.node.style.cursor="default"}function o(p){let u=r.format.readFeature({type:"Feature",geometry:p.geometry},{dataProjection:p.dataProjection||"EPSG:4326",featureProjection:"EPSG:"+e.mapview.srid});r.Layer.getSource().clear(),r.Layer.getSource().addFeature(u)}function l(){let p=r.Layer.getSource().getFeatures(),u=JSON.parse(r.format.writeFeature(p[0],{dataProjection:"EPSG:"+r.layer.srid,featureProjection:"EPSG:"+e.mapview.srid})),h=new XMLHttpRequest;h.open("POST",e.host+"/api/location/new?"+e.utils.paramString({locale:e.locale.key,layer:r.layer.key,table:r.layer.table})),h.setRequestHeader("Content-Type","application/json"),h.onload=w=>{w.target.status===200&&(r.layer.reload(),e.locations.select({layer:r.layer,table:r.layer.table,id:w.target.response}),r.select_callback&&r.select_callback(w.target.response))},h.send(JSON.stringify({geometry:u.geometry})),i()}function f(p){if(r.vertices.length===0)return;p&&p.preventDefault();let u=r.Layer.getSource().getFeatures(),h=e.utils.html.node`<ul>`;u.length&&h.appendChild(e.utils.html.node`
      <li style="padding: 5px;" class="off-white-hover" onclick=${r.update}>${e.language.layer_draw_save}</li>`),u.length||h.appendChild(e.utils.html.node`
      <li style="padding: 5px;" class="off-white-hover" onclick=${w=>{w.preventDefault(),r.interaction.removeLastPoint(),r.vertices.pop(),e.mapview.popup.node&&e.mapview.popup.node.remove()}}>${e.language.layer_draw_last}</li>`),h.appendChild(e.utils.html.node`
      <li style="padding: 5px;" class="off-white-hover" onclick=${s}>${e.language.layer_draw_cancel}</li>`),e.mapview.popup.create({coords:r.vertices[r.vertices.length-1],content:h,autoPan:!0})}};var Wo=e=>{return{begin:r,finish:t,update:n,Style:new ol.style.Style({image:new ol.style.Circle({radius:6,stroke:new ol.style.Stroke({color:"#ff69b4",width:2})})}),style:[new ol.style.Style({stroke:new ol.style.Stroke({color:"#FFA500",width:3})}),new ol.style.Style({image:new ol.style.Circle({radius:10,fill:new ol.style.Fill({color:"#FFA500"}),stroke:new ol.style.Stroke({color:"#FFA500",width:2})}),geometry:o=>{let l=o.getGeometry();if(l.getType()==="Point")return new ol.geom.Point(l.getCoordinates());if(l.getType()==="LineString")return new ol.geom.MultiPoint(l.getCoordinates());var f=l.getCoordinates()[0],p=new ol.geom.MultiPoint(f[0]);return p}})]};function r(o){e.mapview.interaction.current.finish&&e.mapview.interaction.current.finish(),e.mapview.interaction.current=e.mapview.interaction.edit,e.mapview.interaction.edit.finish=o.finish||t,e.mapview.interaction.edit.update=o.update||n,e.mapview.interaction.edit.callback=o.callback,e.mapview.interaction.edit.location=o.location,e.mapview.node.style.cursor="crosshair",e.mapview.interaction.edit.vertices=[o.location.marker],e.mapview.interaction.edit.feature=[],e.mapview.interaction.edit.Source=o.source||new ol.source.Vector({features:[e.mapview.interaction.edit.location.Layer.getSource().getFeatures()[0].clone()]}),e.mapview.interaction.edit.Layer=new ol.layer.Vector({source:e.mapview.interaction.edit.Source,zIndex:9999,style:e.mapview.interaction.edit.style}),e.map.addLayer(e.mapview.interaction.edit.Layer),e.mapview.interaction.edit.interaction=new ol.interaction.Modify({source:e.mapview.interaction.edit.Source,style:e.mapview.interaction.edit.Style,condition:l=>o.type!=="Polygon"&&o.type==="LineString"?!0:!(e.mapview.interaction.edit.trail&&e.utils.turf.kinks(e.utils.turf.flatten(e.mapview.interaction.edit.trail).features[0]).features.length>0)}),e.mapview.interaction.edit.interaction.on("modifystart",l=>{e.mapview.popup.node&&e.mapview.popup.node.remove(),e.mapview.interaction.edit.feature.push(e.mapview.interaction.edit.Source.getFeatures()[0].clone())}),e.mapview.interaction.edit.interaction.on("modifyend",l=>{e.mapview.interaction.edit.vertices.push(l.mapBrowserEvent.coordinate),(o.type==="Polygon"||o.type==="LineString")&&s(l)}),e.map.addInteraction(e.mapview.interaction.edit.interaction),e.mapview.node.addEventListener("contextmenu",i)}function t(){delete e.mapview.interaction.edit.finish,e.mapview.interaction.edit.Source&&e.mapview.interaction.edit.Source.clear(),e.mapview.popup.node&&e.mapview.popup.node.remove(),e.mapview.node.removeEventListener("contextmenu",i),e.map.removeLayer(e.mapview.interaction.edit.Layer),e.map.removeInteraction(e.mapview.interaction.edit.interaction),e.mapview.interaction.edit.callback&&e.mapview.interaction.edit.callback(),e.mapview.interaction.highlight.begin(),e.mapview.interaction.edit.info&&e.mapview.interaction.edit.info.remove(),e.mapview.interaction.edit.info=null,e.mapview.interaction.edit.trail=null}function n(){let o=e.mapview.interaction.edit.Source.getFeatures(),l=e.mapview.interaction.edit.location,f=l.layer,p=new ol.format.GeoJSON,u=JSON.parse(p.writeFeature(o[0],{dataProjection:"EPSG:"+f.srid,featureProjection:"EPSG:"+e.mapview.srid})),h=new XMLHttpRequest;h.open("POST",e.host+"/api/location/update?"+e.utils.paramString({locale:e.locale.key,layer:f.key,table:l.table,id:l.id})),h.setRequestHeader("Content-Type","application/json"),h.responseType="json",h.onload=w=>{if(w.target.status!==200)return;l.Layer.getSource().getFeatures()[0].setGeometry(o[0].getGeometry()),e.map.removeLayer(l.Marker),l.geometry=u.geometry,l.marker=ol.proj.transform(e.utils.turf.pointOnFeature(u.geometry).geometry.coordinates,"EPSG:"+l.layer.srid,"EPSG:"+e.mapview.srid),l.Marker=e.mapview.geoJSON({geometry:{type:"Point",coordinates:l.marker},zIndex:2e3,style:new ol.style.Style({image:e.mapview.icon({type:"markerLetter",letter:String.fromCharCode(65+e.locations.list.indexOf(l.record)),color:l.style.strokeColor,scale:2,anchor:[.4,.9]})})}),f.reload()},h.send(JSON.stringify({[f.geom]:u.geometry})),t()}function a(o){e.mapview.popup.node&&e.mapview.popup.node.remove(),e.mapview.interaction.edit.Source.clear(),e.mapview.interaction.edit.Source.addFeature(e.mapview.interaction.edit.feature.pop()),e.mapview.interaction.edit.vertices.pop(),s(o)}function i(o){o.preventDefault();let l=e.utils.html.node`<ul>`;!e.mapview.interaction.edit.info&&e.mapview.interaction.edit.feature.length&&l.appendChild(e.utils.html.node`
        <li style="padding: 5px;" class="off-white-hover" onclick=${e.mapview.interaction.edit.update}>${e.language.layer_draw_update}</li>`),e.mapview.interaction.edit.feature.length&&l.appendChild(e.utils.html.node`
        <li style="padding: 5px;" class="off-white-hover" onclick=${a}>${e.language.layer_draw_undo}</li>`),l.appendChild(e.utils.html.node`
      <li style="padding: 5px;" class="off-white-hover" onclick=${t}>${e.language.layer_draw_cancel}</li>`),e.mapview.popup.create({coords:e.mapview.interaction.edit.vertices[e.mapview.interaction.edit.vertices.length-1],content:l,autoPan:!0})}function s(o){let l=new ol.format.GeoJSON;e.mapview.interaction.edit.trail=null,e.mapview.interaction.edit.trail=l.writeFeatureObject(e.mapview.interaction.edit.Source.getFeatures()[0].clone(),{dataProjection:"EPSG:4326",featureProjection:"EPSG:"+e.mapview.srid}),e.mapview.interaction.edit.trail.geometry.type!=="Point"&&(e.mapview.interaction.edit.info&&e.mapview.interaction.edit.info.remove(),e.mapview.interaction.edit.info=null,e.utils.turf.kinks(e.mapview.interaction.edit.trail).features.length>0&&(e.mapview.interaction.edit.info=e.utils.html.node`
        <div class="infotip" style="color:#d32f2f;">${e.language.layer_draw_error}`,e.mapview.node.appendChild(e.mapview.interaction.edit.info),e.mapview.interaction.edit.info.style.left=`${o.mapBrowserEvent.originalEvent.clientX}px`,e.mapview.interaction.edit.info.style.top=`${o.mapBrowserEvent.originalEvent.clientY}px`,e.mapview.interaction.edit.info.style.opacity=1))}};var Jo=e=>{let r={begin:t,Source:new ol.source.Vector,Style:new ol.style.Style({image:new ol.style.Circle({radius:6,stroke:new ol.style.Stroke({color:"#3399CC",width:2})})})};return r.Layer=new ol.layer.Vector({source:r.Source,zIndex:20,style:[new ol.style.Style({stroke:new ol.style.Stroke({color:"#3399CC",width:1})}),new ol.style.Style({image:new ol.style.Circle({radius:6,stroke:new ol.style.Stroke({color:"#3399CC",width:2})}),geometry:a=>{let i=a.getGeometry();return i.getType()==="Point"?new ol.geom.Point(i.getCoordinates()):i.getType()==="LineString"?new ol.geom.MultiPoint(i.getCoordinates()):new ol.geom.MultiPoint(i.getCoordinates()[0])}})]}),r;function t(a){!a.feature||(e.mapview.interaction.current.finish&&e.mapview.interaction.current.finish(),e.mapview.interaction.current=r,r.finish=n,r.callback=a.callback,e.mapview.node.style.cursor="crosshair",r.Source.addFeatures([a.feature]),e.map.addLayer(r.Layer),r.interaction=new ol.interaction.Modify({source:r.Source,style:r.Style}),e.map.addInteraction(r.interaction))}function n(){delete r.finish,r.Source.clear(),e.map.removeLayer(r.Layer),e.map.removeInteraction(r.interaction),r.callback&&r.callback(),e.mapview.interaction.highlight.begin()}};var Zo=e=>{let r={begin:t,finish:a,cancel:n,Layer:new ol.layer.Vector({source:new ol.source.Vector})};return r;function t(i={}){e.mapview.interaction.current&&e.mapview.interaction.current.finish&&e.mapview.interaction.current.finish(),e.mapview.interaction.current=r,r.callback=i.callback,r.Layer.getSource().clear(),e.map.addLayer(r.Layer),e.mapview.node.style.cursor="zoom-in",r.interaction=new ol.interaction.Draw({source:r.Layer.getSource(),type:"Circle",geometryFunction:ol.interaction.Draw.createBox(),style:new ol.style.Style({stroke:new ol.style.Stroke({color:"#ddd",width:1}),fill:new ol.style.Stroke({color:e.utils.Chroma("#fff").alpha(.3).rgba()})})}),r.interaction.on("drawend",s=>{e.mapview.flyToBounds(s.feature.getGeometry().getExtent()),n()}),e.map.addInteraction(r.interaction)}function n(){a(),e.mapview.interaction.highlight.begin()}function a(){r.callback&&(r.callback(),delete r.callback),e.mapview.node.style.cursor="auto",e.map.removeInteraction(r.interaction),e.map.removeLayer(r.Layer),r.Layer.getSource().clear()}};var Xo=e=>({current:{},highlight:Uo(e),draw:Yo(e),edit:Wo(e),modify:Jo(e),zoom:Zo(e)});var Ko=e=>function(r){let t=e.map.getView().calculateExtent();if(!r)return{south:t[1],west:t[0],north:t[3],east:t[2]};let n=ol.proj.transformExtent(t,"EPSG:"+e.mapview.srid,"EPSG:"+r);return{south:n[1],west:n[0],north:n[3],east:n[2]}};var _a=new Map,Qo=e=>function(r){let t=r.scale||1;delete r.scale;let n=JSON.stringify(r);return _a.has(n)?r.url=_a.get(n):(r.url=e.utils.svg_symbols(r),_a.set(n,r.url)),new ol.style.Icon({src:r.url,scale:t,anchor:r.anchor||[.5,.5]})};var zo=e=>{return{create:r,position:t};function r(n){this.node&&this.node.remove(),this.node=e.utils.html.node`<div class="infotip">`,this.node.innerHTML=n,e.mapview.node.appendChild(this.node),this.position()}function t(){this.node.style.opacity=1,this.node.style.left=e.mapview.pointerLocation.x-this.node.offsetWidth/2+"px",this.node.style.top=e.mapview.pointerLocation.y-15-this.node.offsetHeight+"px"}};var en=e=>function(r,t){let n=this;e.locations.select({locale:e.locale.key,layer:n,table:n.tableCurrent(),id:r.get("id"),pixel:t})};var ar=e=>function(){let r=this;e.query({locale:e.locale.key,layer:r.key,queryparams:{template:r.hover.query||"infotip",qID:r.qID,id:r.highlight,table:r.tableCurrent(),geom:r.geom,field:r.hover.field,coords:r.format==="cluster"&&ol.proj.transform(e.mapview.interaction.highlight.feature.getGeometry().getCoordinates(),"EPSG:"+e.mapview.srid,"EPSG:"+r.srid)}}).then(t=>{!t||t.label!=""&&e.mapview.infotip.create(t.label)})};var el=e=>r=>{r.highlight=!0,r.select=en(e),r.infotip=ar(e),r.reload=()=>{i.refresh()};let t=!1,n=performance.now();function a(u){if(!t)return;let h=performance.now();console.log(`${h-n} | ${u}`),n=h}let i=new ol.source.VectorTile({format:new ol.format.MVT({}),transition:0,cacheSize:0,tileUrlFunction:u=>{a(`tileUrlFunction - ${r.key}:${u[0]}/${u[1]}/${u[2]}`);let h=r.tableCurrent();return h?`${e.host}/api/layer/mvt/${u[0]}/${u[1]}/${u[2]}?`+e.utils.paramString({locale:e.locale.key,layer:r.key,srid:e.mapview.srid,table:h,filter:r.filter&&r.filter.current}):i.clear()}});r.L=new ol.layer.VectorTile({source:i,renderBuffer:200,zIndex:r.style.zIndex||1,style:null}),r.L.set("layer",r,!0),e.map.on("movestart",u=>{!r.display||(a("movestart"),e.map.removeLayer(r.L),i.clear())});let s;e.map.on("moveend",u=>{!r.display||!r.tableCurrent()||(a("moveend"),r.L.setStyle(null),e.map.addLayer(r.L),s=setTimeout(()=>{r.L.setStyle(p)},400))});let o=new Set;i.on("tileloaderror",u=>{console.log(u)}),i.on("tileloadstart",u=>{s&&clearTimeout(s);let h=u.tile.tileCoord.join("-");a(h),o.add(h)}),i.on("tileloadend",u=>{let h=u.tile.tileCoord.join("-");a(`tileloadend - ${h}`),o.delete(h),o.size===0&&l()});function l(){if(a("tilesloaded"),r.style.theme&&r.style.theme.dynamic){let u=function(Z){let U=D.map(ie=>ie.get(Z.field)),F=new geostats(U).getQuantile(Z.cat_arr.length);Z.cat_arr.forEach((ie,J)=>{ie.value=F[J]}),Z.theme&&u(Z.theme)},w=e.map.getView().calculateExtent(),D=i.getFeaturesInExtent(w);if(a(`${D.length||0} Features loaded`),!D.length)return;u(r.style.theme)}r.L.setStyle(p)}let f=new Map;function p(u){let h=Object.assign({},r.style.default);r.style.theme&&r.style.theme.type&&w(r.style.theme);function w(U){if(U&&U.type==="categorized"){let F=u.get(U.field);F&&e.utils.merge(h,U.cat[F]&&U.cat[F].style||U.cat[F])}if(U&&U.type==="graduated"){let F=parseFloat(u.get(U.field));if(F||F===0){for(let ie=0;ie<U.cat_arr.length&&!(F<U.cat_arr[ie].value);ie++)var re=U.cat_arr[ie].style||U.cat_arr[ie];e.utils.merge(h,re)}}U.theme&&w(U.theme)}Object.assign(h,r.highlight===u.get("id")?r.style.highlight:{},r.highlight===u.get("id")?{zIndex:30}:{zIndex:10});let D=JSON.stringify(h);if(f.has(D))return f.get(D);let Z=new ol.style.Style({zIndex:h.zIndex,stroke:h.strokeColor&&new ol.style.Stroke({color:e.utils.Chroma(h.strokeColor).alpha(h.strokeOpacity===void 0?1:parseFloat(h.strokeOpacity)||0).rgba(),width:parseFloat(h.strokeWidth)||1}),fill:h.fillColor&&new ol.style.Fill({color:e.utils.Chroma(h.fillColor).alpha(h.fillOpacity===void 0?1:parseFloat(h.fillOpacity)||0).rgba()}),image:h.marker&&e.mapview.icon(h.marker)});return f.set(D,Z),Z}r.label=e.mapview.layer.mvtLabel(r)};var tl=e=>r=>{if(!r.style.label)return;let t=new ol.source.Vector({loader:function(n,a,i){r.xhr&&r.xhr.abort(),this.resolution=a,t.clear();let s=r.tableCurrent();if(!s)return;let o=e.map.getView().getZoom();o<=r.style.label.minZoom||o>=r.style.label.maxZoom||(r.xhr=new XMLHttpRequest,r.xhr.open("GET",e.host+"/api/query?"+e.utils.paramString({template:"labels",locale:e.locale.key,layer:r.key,table:s,label:r.style.label&&r.style.label.field,filter:r.filter&&r.filter.current,west:n[0],south:n[1],east:n[2],north:n[3]})),r.xhr.setRequestHeader("Content-Type","application/json"),r.xhr.responseType="json",r.xhr.onload=l=>{if(l.target.status!==200)return;let f=l.target.response.map(p=>new ol.Feature({geometry:new ol.geom.Point([p.x,p.y]),properties:{label:p.label&&String(p.label)}}));t.addFeatures(f)},r.xhr.send())},strategy:function(n,a){return this.resolution&&this.resolution!=a&&this.loadedExtentsRtree_.clear(),[ol.proj.transformExtent(n,"EPSG:"+e.mapview.srid,"EPSG:"+r.srid)]}});return new ol.layer.Vector({source:t,declutter:r.style.label?!!r.style.label.declutter:!1,zIndex:r.style.zIndex||1,style:n=>{let a=n.getProperties().properties;return new ol.style.Style({text:new ol.style.Text({font:r.style.label.font||"12px sans-serif",text:a.label,stroke:r.style.label.strokeColor&&new ol.style.Stroke({color:r.style.label.strokeColor,width:r.style.label.strokeWidth||1}),fill:new ol.style.Fill({color:r.style.label.fillColor||"#000"})})})}})};var rl=e=>r=>{r.highlight=!0,r.select=en(e),r.infotip=ar(e),r.reload=()=>{t.refresh()};let t=new ol.source.Vector({loader:function(){r.xhr&&r.xhr.abort(),t.clear();let n=r.tableCurrent();!n||(r.xhr=new XMLHttpRequest,r.xhr.open("GET",e.host+"/api/layer/geojson?"+e.utils.paramString({locale:e.locale.key,layer:r.key,table:n,cat:r.style.theme&&r.style.theme.field,filter:r.filter&&r.filter.current})),r.xhr.setRequestHeader("Content-Type","application/json"),r.xhr.responseType="json",r.xhr.onload=a=>{if(a.target.status!==200)return;let i=new ol.format.GeoJSON,s=a.target.response.map(o=>i.readFeature({type:"Feature",geometry:o.geometry,properties:{id:o.properties.id,cat:o.properties.cat}},{dataProjection:"EPSG:"+r.srid,featureProjection:"EPSG:"+e.mapview.srid}));t.addFeatures(s)},r.xhr.send())},strategy:function(n,a){return this.resolution&&this.resolution!=a&&this.loadedExtentsRtree_.clear(),[ol.proj.transformExtent(n,"EPSG:"+e.mapview.srid,"EPSG:"+r.srid)]}});r.L=new ol.layer.Vector({source:t,zIndex:r.style.zIndex||1,style:n=>{let a=Object.assign({},r.style.default),i=r.style.theme;if(i&&i.type==="categorized"&&Object.assign(a,i.cat[n.get("cat")]||{}),i&&i.type==="graduated"&&i.cat_arr){let o=parseFloat(n.get(i.field));if(o){for(let l=0;l<i.cat_arr.length&&!(o<i.cat_arr[l].value);l++)var s=i.cat_arr[l].style;Object.assign(a,s)}}if(r.highlight===n.get("id")){let o=e.utils.cloneDeep(r.style.highlight);a.marker&&a.marker.scale&&o.marker&&o.marker.scale&&(o.marker.scale*=a.marker.scale),Object.assign(a,o||{})}return new ol.style.Style({zIndex:a.zIndex,stroke:a.strokeColor&&new ol.style.Stroke({color:e.utils.Chroma(a.strokeColor).alpha(a.strokeOpacity===void 0?1:parseFloat(a.strokeOpacity)||0).rgba(),width:parseInt(a.strokeWidth)||1}),fill:a.fillColor&&new ol.style.Fill({color:e.utils.Chroma(a.fillColor).alpha(a.fillOpacity===void 0?1:parseFloat(a.fillOpacity)||0).rgba()}),image:a.marker&&e.mapview.icon(a.marker)})}}),r.L.set("layer",r,!0)};var nl=e=>function(r){let t=this,n=r.get("properties").count,a=r.getGeometry(),i=a.getCoordinates(),s=ol.proj.transform(i,"EPSG:"+e.mapview.srid,"EPSG:"+t.srid),o=new XMLHttpRequest;o.open("GET",e.host+"/api/query/get_nnearest?"+e.utils.paramString({locale:e.locale.key,layer:t.key,geom:t.geom,qID:t.qID,cluster_label:t.cluster_label||t.qID,table:t.tableCurrent(),filter:t.filter&&t.filter.current,n:n>99?99:n,x:s[0],y:s[1],coords:s})),o.setRequestHeader("Content-Type","application/json"),o.responseType="json",o.onload=l=>{if(l.target.status>=300)return;let f=l.target.response;if(f&&f.length>1){let p=e.utils.html.node`
      <div style="
        width: 400px;
        max-width: 75vw;
        max-height: 300px;
        overflow-x: hidden;">
      <ul>
      ${f.map(u=>e.utils.html.node`
        <li
          style="padding: 5px 0 5px 10px; white-space: nowrap; line-height: 1.5;"
          class="secondary-colour-hover"
          onclick=${h=>{h.preventDefault(),e.locations.select({locale:e.locale.key,layer:t,table:t.tableCurrent(),id:u.id,marker:u.coords})}}>${u.label||'"'+t.cluster_label+'"'}`)}`;e.mapview.popup.create({coords:ol.proj.transform(s,"EPSG:"+t.srid,"EPSG:"+e.mapview.srid),content:p,autoPan:!0});return}return e.locations.select({locale:e.locale.key,layer:t,table:t.tableCurrent(),id:f.id})},o.send()};var al=e=>r=>{r.highlight=!0,r.select=nl(e),r.infotip=ar(e),r.reload=()=>{t.clear(),t.refresh({force:!0})};let t=new ol.source.Vector({loader:function(n,a,i){r.xhr&&r.xhr.abort(),this.resolution=a,t.clear();let s=r.tableCurrent();!s||(r.xhr=new XMLHttpRequest,r.xhr.open("GET",e.host+`/api/layer/cluster/${e.mapview.getZoom()}?`+e.utils.paramString({locale:e.locale.key,layer:r.key,table:s,kmeans:r.cluster_kmeans,dbscan:r.cluster_dbscan,pixelRatio:window.devicePixelRatio,aggregate:r.style.theme&&r.style.theme.aggregate,theme:r.style.theme&&r.style.themes&&encodeURIComponent(Object.keys(r.style.themes).find(o=>r.style.themes[o]===r.style.theme)),label:r.style.label&&r.style.label.field,count:r.style.label&&r.style.label.count,filter:r.filter&&r.filter.current,viewport:[n[0],n[1],n[2],n[3]]})),r.xhr.setRequestHeader("Content-Type","application/json"),r.xhr.responseType="json",r.xhr.onload=o=>{if(o.target.status!==200)return;let l=o.target.response;r.max_size=l.reduce((u,h)=>Math.max(u,h.properties.size),0);let f=1,p=l.map(u=>new ol.Feature({id:f++,geometry:new ol.geom.Point(r.srid==4326&&ol.proj.fromLonLat([u.geometry.x,u.geometry.y])||[u.geometry.x,u.geometry.y]),properties:u.properties}));t.addFeatures(p)},r.xhr.send())},strategy:function(n,a){return this.resolution&&this.resolution!=a&&this.loadedExtentsRtree_.clear(),[ol.proj.transformExtent(n,"EPSG:"+e.mapview.srid,"EPSG:"+r.srid)]}});r.L=new ol.layer.Vector({layer:r,source:t,zIndex:r.style.zIndex||10,style:n=>{let a=n.getProperties().properties,i=a.size>1?Object.assign({},r.style.default,r.style.cluster):Object.assign({},r.style.default),s=Object.assign({},r.style.theme);if(s&&s.type==="categorized"&&Object.assign(i,s.cat[a.cat]&&s.cat[a.cat].style||s.cat[a.cat]),s&&s.type==="graduated"){let f=parseFloat(a.cat);if(f||f===0){for(let p=0;p<s.cat_arr.length&&!(f<s.cat_arr[p].value);p++)var o=s.cat_arr[p].style||s.cat_arr[p];Object.assign(i,o)}}if(s&&s.type==="competition"){let f=a.size,p={layers:{}};Object.entries(a.cat).sort((u,h)=>u[1]-h[1]).forEach(u=>{s.cat[u[0]]&&(p.layers[f/a.size]=s.cat[u[0]].style.fillColor),f-=u[1]}),Object.assign({},i,p)}let l=r.cluster_logscale?a.count===1?i.size||r.style.size:(i.size||r.style.size)+(i.size||r.style.size)/Math.log(r.max_size)*Math.log(a.size):a.count===1?i.size||r.style.size:(i.size||r.style.size)+(i.size||r.style.size)/r.max_size*a.size;if(r.highlight===n.get("id")){let f=e.utils.cloneDeep(r.style.highlight);delete f.scale,i.scale&&r.style.highlight.scale&&(i.scale*=r.style.highlight.scale),Object.assign(i,f)}return i.layers&&Array.isArray(i.layers)?i.layers.map(f=>new ol.style.Style({zIndex:parseInt(r.max_size-a.size),image:e.mapview.icon(Object.assign({},f,{scale:l/(f.size||r.style.size)*(f.scale||1)*(f.relative?e.mapview.getZoom()/(e.locale.maxZoom-e.locale.minZoom):1)}))})):new ol.style.Style({zIndex:r.style.zIndex,image:e.mapview.icon(Object.assign({},i,{scale:l/(i.size||r.style.size)*(i.scale||1)*(i.relative?e.mapview.getZoom()/(e.locale.maxZoom-e.locale.minZoom):1)}))})}}),r.label=e.mapview.layer.clusterLabel(r)};var il=e=>r=>{if(!!r.style.label)return new ol.layer.Vector({source:r.L.getSource(),declutter:r.style.label?!!r.style.label.declutter:!1,zIndex:r.style.zIndex+1||11,style:t=>{let n=t.getProperties().properties;return new ol.style.Style({text:new ol.style.Text({font:r.style.label.font||"12px sans-serif",text:n.label||`${n.count>1?n.count:""}`,stroke:r.style.label.strokeColor&&new ol.style.Stroke({color:r.style.label.strokeColor,width:r.style.label.strokeWidth||1}),fill:new ol.style.Fill({color:r.style.label.fillColor||"#000"})})})}})};var ll=e=>r=>{let t=r.proxy&&`${e.host}/api/proxy?url=${r.URI}`||r.URI,n=new ol.source.OSM({url:decodeURIComponent(t),opaque:!1,transition:0});r.L=new ol.layer.Tile({source:n,layer:r,zIndex:r.style.zIndex||0})};var sl=e=>r=>{r.grid_size=Object.values(r.grid_fields)[0],r.grid_color=Object.values(r.grid_fields)[1],r.grid_ratio=!1,r.reload=()=>t.refresh();let t=new ol.source.Vector({loader:function(n,a,i){r.xhr&&r.xhr.abort(),this.resolution=a,t.clear();let s=r.tableCurrent();!s||(r.xhr=new XMLHttpRequest,r.xhr.open("GET",e.host+"/api/layer/grid?"+e.utils.paramString({locale:e.locale.key,layer:r.key,table:s,size:r.grid_size,color:r.grid_color,viewport:[n[0],n[1],n[2],n[3]]})),r.xhr.setRequestHeader("Content-Type","application/json"),r.xhr.responseType="json",r.xhr.onload=o=>{if(o.target.status!==200)return;let l=o.target.response;r.sizeAvg=0,r.colorAvg=0;let f=l.map(w=>{if(parseFloat(w[2])>0)return w[2]=isNaN(w[2])?w[2]:parseFloat(w[2]),w[3]=isNaN(w[3])?w[3]:parseFloat(w[3]),r.grid_ratio&&w[3]>0&&(w[3]/=w[2]),r.sizeAvg+=parseFloat(w[2]),r.colorAvg+=isNaN(w[3])?0:parseFloat(w[3]),new ol.Feature({geometry:new ol.geom.Point(ol.proj.fromLonLat([w[0],w[1]])),properties:{size:parseFloat(w[2]),color:isNaN(w[3])?w[3]:parseFloat(w[3])}})});function p(w,D,Z){let U=w.filter(re=>isFinite(re[D]));return Math[Z].apply(null,U.map(re=>re[D]))}r.sizeMin=p(l,2,"min"),r.sizeAvg/=f.length,r.sizeMax=p(l,2,"max"),r.colorMin=p(l,3,"min"),r.colorAvg/=f.length,r.colorMax=p(l,3,"max"),r.colorBins=[];let u=r.style.range.length;for(var h=1;h<u;h++)h<u/2&&r.colorBins.push(r.colorMin+(r.colorAvg-r.colorMin)/(u/2)*h),h===u/2&&r.colorBins.push(r.colorAvg),h>u/2&&r.colorBins.push(r.colorAvg+(r.colorMax-r.colorAvg)/(u/2)*(h-u/2));t.addFeatures(f),r.style.legend.size_min&&(r.style.legend.size_min.textContent=r.sizeMin.toLocaleString("en-GB",{maximumFractionDigits:0})),r.style.legend.size_avg&&(r.style.legend.size_avg.textContent=r.sizeAvg.toLocaleString("en-GB",{maximumFractionDigits:0})),r.style.legend.size_max&&(r.style.legend.size_max.textContent=r.sizeMax.toLocaleString("en-GB",{maximumFractionDigits:0})),r.grid_ratio?(r.style.legend.color_min&&(r.style.legend.color_min.textContent=r.colorMin.toLocaleString("en-GB",{maximumFractionDigits:0,style:"percent"})),r.style.legend.color_avg&&(r.style.legend.color_avg.textContent=r.colorAvg.toLocaleString("en-GB",{maximumFractionDigits:0,style:"percent"})),r.style.legend.color_max&&(r.style.legend.color_max.textContent=r.colorMax.toLocaleString("en-GB",{maximumFractionDigits:0,style:"percent"}))):(r.style.legend.color_min&&(r.style.legend.color_min.textContent=r.colorMin.toLocaleString("en-GB",{maximumFractionDigits:0})),r.style.legend.color_avg&&(r.style.legend.color_avg.textContent=r.colorAvg.toLocaleString("en-GB",{maximumFractionDigits:0})),r.style.legend.color_max&&(r.style.legend.color_max.textContent=r.colorMax.toLocaleString("en-GB",{maximumFractionDigits:0})))},r.xhr.send())},strategy:function(n,a){return this.resolution&&this.resolution!=a&&this.loadedExtentsRtree_.clear(),[ol.proj.transformExtent(n,"EPSG:"+e.mapview.srid,"EPSG:"+r.srid)]}});r.L=new ol.layer.Vector({source:t,zIndex:r.style.zIndex||1,style:n=>{let a=n.getProperties().properties,i=a.size<=r.sizeAvg?7+7/r.sizeAvg*a.size:14+7/(r.sizeMax-r.sizeAvg)*(a.size-r.sizeAvg);if(a.hxcolor=r.style.hxcolor||"#C0C0C0",parseFloat(a.color)){a.hxcolor=r.style.range[0];for(let s=0;s<r.colorBins.length&&!(a.color<r.colorBins[s]);s++)a.hxcolor=r.style.range[s+1]}return new ol.style.Style({image:e.mapview.icon({type:"dot",fillColor:a.hxcolor,scale:i/30})})}}),r.L.set("layer",r,!0)};var cl=e=>r=>{let t=maplibregl||mapboxgl;t.accessToken=r.accessToken,r.L=new ol.layer.Layer({render:n=>{if(!!r.display)return r.mbMap||(r.mbMap=new t.Map({container:e.mapview.node,style:r.mbStyle,attributionControl:!1,boxZoom:!1,doubleClickZoom:!1,dragPan:!1,dragRotate:!1,interactive:!1,keyboard:!1,pitchWithRotate:!1,scrollZoom:!1,touchZoomRotate:!1})),r.canvas=r.mbMap.getCanvas(),r.zIndex&&(r.canvas.style.zIndex=r.zIndex),r.canvas.style.position="absolute",r.canvas.style.display=r.display&&"block"||"none",r.mbMap.jumpTo({center:ol.proj.toLonLat(n.viewState.center),zoom:n.viewState.zoom-1,bearing:-n.viewState.rotation*180/Math.PI,animate:!1}),r.mbMap._frame&&(r.mbMap._frame.cancel(),r.mbMap._frame=null),r.mbMap._render(),r.resized||(r.resized=!0,window.setTimeout(()=>r.mbMap.resize(),500)),r.canvas}})};var ul=e=>({mvt:el(e),mvtLabel:tl(e),geojson:rl(e),cluster:al(e),clusterLabel:il(e),tiles:ll(e),grid:sl(e),mbtiles:cl(e)});var dl=e=>({create:No(e),changeEndEvent:new CustomEvent("changeEnd"),attribution:Bo(e),locate:Go(e),interaction:Xo(e),popup:Vo(e),infotip:zo(e),geoJSON:qo(e),icon:Qo(e),layer:ul(e),getBounds:Ko(e),flyToBounds:(r,t={})=>{e.map.getView().fit(r,Object.assign({padding:[50,50,50,50],duration:1e3},t))},getZoom:()=>e.map.getView().getZoom()});var pl=e=>{let r={init:t,add:n,plugins:{}};return r;function t(a){!a.node||(r.node=a.node,r.tabs=r.node.appendChild(e.utils.html.node`<div class="tabs">`),Object.values(r.plugins).forEach(i=>i(e)))}function n(a){!r.node||a.tab||(a.show=()=>{r.tabs.childNodes.forEach(i=>i.classList.remove("active")),!a.tab.parentElement&&r.tabs.appendChild(a.tab),a.tab.classList.add("active"),r.timer&&window.clearTimeout(r.timer),r.timer=window.setTimeout(()=>a.tab.dispatchEvent(new CustomEvent("activate")),500),r.node.classList.contains("desktop-display-none")&&(r.node.classList.remove("desktop-display-none"),document.body.style.gridTemplateRows="auto 10px 50px")},a.tab=e.utils.html.node`<div class="tab">`,a.header=a.tab.appendChild(e.utils.html.node`
      <div
        style="${a.tab_style||""}"
        class="header"
        onclick=${a.show}>${a.title||a.key||"Tab"}`),a.panel=a.tab.appendChild(e.utils.html.node`
      <div
        class="${`panel ${a.class||""}`}"
        style="${a.style||""}">`),a.target&&a.target instanceof HTMLElement&&a.panel.appendChild(a.target),a.layer&&a.layer.tabs.add(a),a.location&&a.location.tabs.add(a),a.remove=()=>{if(!a.tab.parentElement)return;let i=a.tab.nextElementSibling||a.tab.previousElementSibling;if(a.tab.remove(),i)return i.querySelector(".header").click();r.node.classList.add("desktop-display-none"),document.body.style.gridTemplateRows="auto 0 0",e.mapview.node.style.marginTop=0})}};var fl=e=>r=>{let t=r.style.theme,n=e.utils.html.node`<div class="legend grid">`;return n.appendChild(e.utils.html.node`
    <div
      class="switch-all label"
      style="grid-column: 1/3;">
        ${e.language.layer_style_switch_caption}
      <a
        class="primary-colour"
        style="cursor: pointer;"
        onclick=${a=>{a.stopPropagation(),n.querySelectorAll(".switch").forEach(i=>i.click()),r.reload()}}>${e.language.layer_style_switch_all}</a>.`),r.filter.current[t.field]||(r.filter.current[t.field]={}),Object.entries(t.cat).forEach(a=>{let i=Object.assign({},r.style.default,a[1].style&&a[1].style.marker||a[1].style||a[1]);i.svg||i.type?n.appendChild(e.utils.svg_symbols(Object.assign({legend:!0},i))):i.fillOpacity===void 0?n.appendChild(e.utils.svg.node`
      <svg height=24 width=24>
      <line
        x1=0 y1=12 x2=24 y2=12
        stroke=${i.strokeColor}
        stroke-width=${i.strokeWidth||1}>`):n.appendChild(e.utils.svg.node`
      <svg height=24 width=24>
      <rect
        width=24 height=24
        fill=${i.fillColor||"#FFF"}
        fill-opacity=${i.fillOpacity}
        stroke=${i.strokeColor}
        stroke-width=${i.strokeWidth||1}>`),n.appendChild(e.utils.html.node`
    <div
      class="label switch"
      onclick=${s=>{s.stopPropagation(),s.target.classList.toggle("disabled"),s.target.classList.contains("disabled")?(r.filter.current[t.field].ni||(r.filter.current[t.field].ni=[]),r.filter.current[t.field].ni.push(a[0])):(r.filter.current[t.field].ni.splice(r.filter.current[t.field].ni.indexOf(a[0]),1),r.filter.current[t.field].ni.length||delete r.filter.current[t.field].ni),r.reload()}}>${a[1].label||a[0]}`)}),r.style.cluster&&(n.appendChild(e.utils.svg_symbols(Object.assign({legend:!0,cluster:!0},r.style.cluster))),n.appendChild(e.utils.html.node`
    <div class="label" style="alignment-baseline:central;">${e.language.layer_style_cluster}`)),n};var gl=e=>r=>{let t=e.utils.html.node`<div class="legend grid">`;return r.style.theme.cat_arr.forEach(n=>{let a=Object.assign({},r.style.default,n.style&&n.style.marker||n.style||n);a.svg||a.type?t.appendChild(e.utils.svg_symbols(Object.assign({legend:!0},a))):a.fillOpacity===void 0?t.appendChild(e.utils.svg.node`
      <svg height=24 width=24>
      <line
        x1=0 y1=12 x2=24 y2=12
        stroke=${a.strokeColor}
        stroke-width=${a.strokeWidth||1}>`):t.appendChild(e.utils.svg.node`
      <svg height=24 width=24>
      <rect
        width=24 height=24
        fill=${a.fillColor||"#FFF"}
        fill-opacity=${a.fillOpacity}
        stroke=${a.strokeColor}
        stroke-width=${a.strokeWidth||1}>`),t.appendChild(e.utils.html.node`
    <div  style="grid-column: 2" class="label">${n.label||n.value}`)}),t};var hl=e=>r=>{let t=e.utils.html.node`<div class="legend">`;t.appendChild(e.utils.html.node`
  <button class="btn-drop">
  <div
    class="head"
    onclick=${o=>{o.preventDefault(),o.target.parentElement.classList.toggle("active")}}>
    <span>${Object.keys(r.grid_fields)[0]}</span>
    <div class="icon"></div>
  </div>
  <ul>
    ${Object.entries(r.grid_fields).map(o=>e.utils.html`
        <li onclick=${l=>{let f=l.target.closest(".btn-drop");f.classList.toggle("active"),f.querySelector(":first-child").textContent=o[0],r.grid_size=o[1],r.reload()}}>${o[0]}`)}`);let n=t.appendChild(e.utils.svg.node`<svg width=100% height=100px>`);t.appendChild(e.utils.html.node`
  <button class="btn-drop">
  <div
    class="head"
    onclick=${o=>{o.preventDefault(),o.target.parentElement.classList.toggle("active")}}>
    <span>${Object.keys(r.grid_fields)[1]}</span>
    <div class="icon"></div>
  </div>
  <ul>
    ${Object.entries(r.grid_fields).map(o=>e.utils.html`
      <li onclick=${l=>{let f=l.target.closest(".btn-drop");f.classList.toggle("active"),f.querySelector(":first-child").textContent=o[0],r.grid_color=o[1],r.reload()}}>${o[0]}`)}`);let a=38,i=r.style.range.length,s=100/i;for(let o=0;o<i;o++){let l=(o+2)*10/i,f=o*s;n.appendChild(e.utils.svg.node`
    <circle
      fill='#777'
      cx='${f+s/2+1+"%"}'
      cy='${a+1}'
      r='${l}'/>
    <circle
      fill='${r.style.hxcolor||"#999"}'
      cx='${f+s/2+"%"}'
      cy='${a}'
      r='${l}'/>`),o===0&&(t.size_min=n.appendChild(e.utils.svg.node`
      <text
        class='label'
        style='text-anchor: start;'
        x=${f+"%"}
        y=${a-20}>${e.language.layer_grid_legend_min}`)),o===(i/2%1!=0&&Math.round(i/2)-1)&&(t.size_avg=n.appendChild(e.utils.svg.node`
      <text
        class='label'
        style='text-anchor: middle;'
        x=${f+s/2+"%"}
        y=${a-20}>${e.language.layer_grid_legend_avg}`)),o===i-1&&(t.size_max=n.appendChild(e.utils.svg.node`
      <text
        class='label'
        style='text-anchor: end;'
        x=${f+s+"%"}
        y=${a-20}>${e.language.layer_grid_legend_max}`))}a+=20;for(let o=0;o<i;o++){let l=o*s;n.appendChild(e.utils.svg.node`
    <rect
      height=20
      width=${s+"%"}
      x=${l+"%"}
      y=${a}
      fill=${r.style.range[o]}`),o===0&&(t.color_min=n.appendChild(e.utils.svg.node`
      <text
        class='label'
        style='text-anchor: start;'
        x=${l+"%"}
        y=${a+40}>${e.language.layer_grid_legend_min}`)),o===(i/2%1!=0&&Math.round(i/2)-1)&&(t.color_avg=n.appendChild(e.utils.svg.node`
      <text
        class='label'
        style='text-anchor: middle;'
        x=${l+s/2+"%"}
        y=${a+40}>${e.language.layer_grid_legend_avg}`)),o===i-1&&(t.color_max=n.appendChild(e.utils.svg.node`
      <text
        class='label'
        style='text-anchor: end;'
        x=${l+s+"%"}
        y=${a+40}>${e.language.layer_grid_legend_max}`))}return t.appendChild(e.utils.html.node`
  <td style="padding-top: 5px;" colSpan=2>
  <label class="input-checkbox">
  <input type="checkbox"
    onchange=${o=>{r.grid_ratio=o.target.checked,r.reload()}}>
  </input>
  <div></div><span>${e.language.layer_grid_legend_ratio}`),t};var ml=e=>r=>{let t=r.style.theme,n=e.utils.html.node`<div class="legend">`;return n.appendChild(e.utils.html.node`
  <button class="btn-drop">
  <div
    class="head"
    onclick=${a=>{a.preventDefault(),a.target.parentElement.classList.toggle("active")}}>
    <span>${t.fields[0]}</span>
    <div class="icon"></div>
  </div>
  <ul>${t.fields.map(a=>e.utils.html`
    <li onclick=${i=>{let s=i.target.closest(".btn-drop");s.classList.toggle("active"),s.querySelector(":first-child").textContent=a,r.reload()}}>${a}`)}`),t.a.forEach(a=>{n.appendChild(e.utils.html.node`
      <img style="grid-column: 1" height=24 src="${e.utils.svg_symbols(a.style.marker)}">`)}),n};var vl=e=>r=>{let t=e.utils.html.node`<div class="legend">`;t.appendChild(e.utils.html.node`
  <button class="btn-drop">
  <div
    class="head"
    onclick=${o=>{o.preventDefault(),o.target.parentElement.classList.toggle("active")}}>
    <span>getEqInterval</span>
    <div class="icon"></div>
  </div>
  <ul>
    ${["getEqInterval","getStdDeviation","getJenks","getQuantile"].map(o=>e.utils.html`
        <li onclick=${l=>{let f=l.target.closest(".btn-drop");f.classList.toggle("active"),f.querySelector(":first-child").textContent=o,r.style.theme.geostat=o,r.reload()}}>${o}`)}`);let n=t.appendChild(e.utils.svg.node`<svg width=100% height=100px>`),a=38,i=r.style.theme.cat_arr.length,s=100/i;for(let o=0;o<i;o++){let l=o*s;n.appendChild(e.utils.svg.node`
    <rect
      height=20
      width=${s+"%"}
      x=${l+"%"}
      y=${a}
      fill=${r.style.theme.cat_arr[o].style.fillColor}`),o===0&&(t.color_min=n.appendChild(e.utils.svg.node`
      <text
        class='label'
        style='text-anchor: start;'
        x=${l+"%"}
        y=${a+40}>${e.language.layer_grid_legend_min}`)),o===(i/2%1!=0&&Math.round(i/2)-1)&&(t.color_avg=n.appendChild(e.utils.svg.node`
      <text
        class='label'
        style='text-anchor: middle;'
        x=${l+s/2+"%"}
        y=${a+40}>${e.language.layer_grid_legend_avg}`)),o===i-1&&(t.color_max=n.appendChild(e.utils.svg.node`
      <text
        class='label'
        style='text-anchor: end;'
        x=${l+s+"%"}
        y=${a+40}>${e.language.layer_grid_legend_max}`))}return t};var bl=e=>r=>{let t,n=e.utils.html.node`<div class="legend" style="margin-top: 5px;">`,a=n.appendChild(e.utils.html.node`
  <div style="display: grid; align-items: center;">`),i={text:s,range:o};return r.style.theme.fields?.forEach(l=>a.appendChild(i[l.type](l))),n;function s(l){return e.utils.html.node`
    <div style="grid-column: 1;">${l.title}</div>
    <input
      style="grid-column: 3;"
      value=${r.style[l.style||"default"][l.field]}
      onchange=${f=>{r.style[l.style||"default"][l.field]=f.target.value,clearTimeout(t),t=setTimeout(()=>r.reload(),1e3)}}>`}function o(l){return e.utils.html.node`
    <div style="grid-column: 1;">${l.title}</div>
    <div style="grid-column: 2;">${r.style[l.style||"default"][l.field]}</div>
    <div class="input-range"  style="grid-column: 3;">
      <input
        type="range"
        class="secondary-colour-bg"
        min=${l.min||0}
        value=${r.style[l.style||"default"][l.field]}
        max=${l.max||1}
        step=${l.step||.1}
        oninput=${f=>{r.style[l.style||"default"][l.field]=f.target.value,f.target.parentNode.previousSibling.previousSibling.textContent=f.target.value,clearTimeout(t),t=setTimeout(()=>r.reload(),1e3)}}>`}};var wl=e=>{let r={panel:t,legend:n,themes:{categorized:fl(e),graduated:gl(e),dynamic:vl(e),grid:hl(e),bivariate:ml(e),basic:bl(e)}};return r;function t(a){if(!a.style||a.style.hidden||!a.style.theme&&!a.style.label)return;let i=e.utils.html.node`<div class="drawer panel expandable">`;if(i.appendChild(e.utils.html.node`
    <div
      class="header primary-colour"
      onclick=${o=>{o.stopPropagation(),e.utils.toggleExpanderParent(o.target,!0)}}>
      <span>${e.language.layer_style_header}</span>
      <button class="btn-header xyz-icon icon-expander primary-colour-filter">`),a.style.label){let o=e.map.getView().getZoom(),l=i.appendChild(e.utils.html.node`
        <label
          class="${`input-checkbox ${o<=a.style.label.minZoom&&"disabled"||""} ${o>=a.style.label.maxZoom&&"disabled"||""}`}"
          style="margin-bottom: 10px;">
          <input type="checkbox"
            .checked=${!!a.style.label.display}
            onchange=${f=>{a.style.label.display=f.target.checked,a.show()}}>
          </input>
          <div></div>
          <span>${a.style.label.title||e.language.layer_style_display_labels}`);(a.style.label.minZoom||a.style.label.maxZoom)&&e.mapview.node.addEventListener("changeEnd",()=>{let f=e.map.getView().getZoom();if(f<=a.style.label.minZoom||f>=a.style.label.maxZoom)return l.classList.add("disabled");l.classList.remove("disabled")})}return a.style.themes&&i.appendChild(e.utils.html.node`
      <div>${e.language.layer_style_select_theme}</div>
      <button class="btn-drop">
      <div
        class="head"
        onclick=${o=>{o.preventDefault(),o.target.parentElement.classList.toggle("active")}}>
        <span>${Object.keys(a.style.themes)[0]}</span>
        <div class="icon"></div>
      </div>
      <ul>
        ${Object.entries(a.style.themes).map(o=>e.utils.html.node`
          <li onclick=${l=>{let f=l.target.closest(".btn-drop");f.querySelector("span").textContent=o[0],f.classList.toggle("active"),a.style.theme=o[1],s(a),a.reload()}}>${o[0]}`)}`),a.style.bringToFront=e.utils.html.node`
      <button 
        title=${e.language.layer_style_bring_to_front}
        style="margin-top: 5px;"
        class="btn-wide primary-colour"
        onclick=${()=>a.bringToFront()}>${e.language.layer_style_bring_to_front}`,!a.style.theme&&a.style.label&&i.appendChild(a.style.bringToFront),a.style.theme&&s(a),i;function s(o){o.style.legend&&o.style.legend.remove(),o.style.bringToFront.remove(),!(o.style.theme&&!o.style.theme.type)&&(o.style.legend=e.layers.view.style.legend(o),i.appendChild(o.style.legend),i.appendChild(o.style.bringToFront))}}function n(a){return a.style.legend=e.utils.html.node`<div class="legend">`,a.filter=a.filter||{},r.themes[a.style.theme.type](a)}};var _l=e=>(r,t)=>{if(t.el&&t.el.parentNode)return e.layers.view.filter.reset(r,t);let n=e.layers.view.filter.block(r,t);n.dataset.field=t.field,t.el=n,n.appendChild(e.utils.html.node`
  <input type="text" placeholder=${e.language.layer_filter_text} onkeyup=${a=>{r.filter.current[t.field]={},r.filter.current[t.field][t.filter]=encodeURIComponent(a.target.value),r.reload(),r.show(),r.count(i=>{t.filterZoom&&i>1&&r.zoomToExtent()})}}>`)};var yl=e=>(r,t)=>{if(t.el&&t.el.parentNode)return e.layers.view.filter.reset(r,t);let n=new XMLHttpRequest;n.open("GET",e.host+"/api/query?"+e.utils.paramString({template:"field_stats",locale:e.locale.key,layer:r.key,table:r.tableCurrent(),field:t.field,filter:r.filter&&r.filter.current})),n.setRequestHeader("Content-Type","application/json"),n.responseType="json",n.onload=a=>{let i=a.target.response,s=e.layers.view.filter.block(r,t);s.dataset.field=t.field,t.el=s;let o=t.type==="integer"?1:.01;var l=e.utils.html.node`
    <div class="input-flex">
      <span>${e.language.layer_filter_greater}`;let f=e.utils.html.node`
    <input
      type="number"
      min=${i.min}
      value=${i.min}
      max=${i.max}
      step=${o}
      onkeyup=${re=>{u.value=re.target.value,U()}}>`;l.appendChild(f),s.appendChild(l);let p=e.utils.html.node`<div class="input-range">`;s.appendChild(p);let u=e.utils.html.node`
    <input
      type="range"
      class="secondary-colour-bg"
      min=${i.min}
      value=${i.min}
      max=${i.max}
      step=${o}
      oninput=${re=>{f.value=re.target.value,U()}}>`;p.appendChild(u);var l=e.utils.html.node`
    <div class="input-flex">
      <span>${e.language.layer_filter_smaller}`;let h=e.utils.html.node`
    <input
      type="number"
      min=${i.min}
      value=${i.max}
      max=${i.max}
      step=${o}
      onkeyup=${re=>{D.value=re.target.value,U()}}>`;l.appendChild(h),s.appendChild(l);var w=e.utils.html.node`<div class="input-range">`;s.appendChild(w);let D=e.utils.html.node`
    <input
      type="range"
      class="secondary-colour-bg"
      min=${i.min}
      value=${i.max}
      max=${i.max}
      step=${o}
      oninput=${re=>{h.value=re.target.value,U()}}>`;w.appendChild(D);let Z;function U(){clearTimeout(Z),Z=setTimeout(()=>{Z=null,r.filter.current[t.field]={},r.filter.current[t.field].gte=parseFloat(f.value),r.filter.current[t.field].lte=parseFloat(h.value),r.reload(),r.show(),r.count(re=>{t.filterZoom&&re>1&&r.zoomToExtent()})},500)}},n.send()};var kl=e=>(r,t)=>{if(t.el&&t.el.parentNode)return e.layers.view.filter.reset(r,t);let n=e.layers.view.filter.block(r,t);n.dataset.field=t.field,t.el=n,r.filter.current[r.style.theme&&r.style.theme.field||t.field]||(r.filter.current[r.style.theme&&r.style.theme.field||t.field]={}),t.filter.in.forEach(a=>{n.appendChild(e.utils.html.node`
    <label class="input-checkbox">
    <input
      type="checkbox"
      onchange=${i=>{if(i.target.checked)r.filter.current[t.field]||(r.filter.current[t.field]={}),r.filter.current[t.field].in||(r.filter.current[t.field].in=[]),r.filter.current[t.field].in.push(encodeURIComponent(i.target.parentNode.innerText));else{let s=r.filter.current[t.field].in.indexOf(encodeURIComponent(i.target.parentNode.innerText));r.filter.current[t.field].in.splice(s,1),r.filter.current[t.field].in.length||delete r.filter.current[t.field].in}r.reload(),r.show(),r.count(s=>{t.filterZoom&&s>1&&r.zoomToExtent()})}}>
    </input>
    <div></div><span>${a}`)})};var Cl=e=>(r,t)=>{if(t.el&&t.el.parentNode)return e.layers.view.filter.reset(r,t);let n=e.layers.view.filter.block(r,t);n.dataset.field=t.field,t.el=n;var a=e.utils.html.node`
  <div class="input-flex">
    <span>${e.language.layer_filter_date_after}`;let i=e.utils.html.node`
  <input type="text" readonly placeholder=${e.language.layer_filter_pick} style="width: 60%;">`;a.appendChild(i),n.appendChild(a);var a=e.utils.html.node`
  <div class="input-flex">
    <span>Before`;let s=e.utils.html.node`
  <input type="text" readonly placeholder=${e.language.layer_filter_pick} style="width: 60%;">`;a.appendChild(s),n.appendChild(a),e.utils.flatpickr({element:i,enableTime:t.type==="datetime",callback:f=>{i.value=f,l()}}),e.utils.flatpickr({element:s,enableTime:t.type==="datetime",callback:f=>{s.value=f,l()}});let o;function l(){clearTimeout(o),o=setTimeout(()=>{o=null,r.filter.current[t.field]={},r.filter.current[t.field].gt=e.utils.meltDateStr(i.value)||null,r.filter.current[t.field].lt=e.utils.meltDateStr(s.value)||null,r.reload(),r.show(),r.count(f=>{t.filterZoom&&f>1&&r.zoomToExtent()})},500)}};var El=e=>(r,t)=>{if(t.el&&t.el.parentNode)return e.layers.view.filter.reset(r,t);let n=e.layers.view.filter.block(r,t);n.dataset.field=t.field,t.el=n,r.filter.current[t.field.field]||(r.filter.current[t.field]={}),r.filter.current[t.field].boolean=!0,n.appendChild(e.utils.html.node`
  <label class="input-checkbox">
  <input type="checkbox"
    checked=true 
    onchange=${a=>{a.target.checked?r.filter.current[t.field].boolean=!0:r.filter.current[t.field].boolean=!1,r.reload(),r.count(i=>{t.filterZoom&&i>1&&r.zoomToExtent()})}}>
  </input>
  <div></div><span>${t.name||e.language.layer_filter_boolean}`),r.reload(),r.show(),r.count(a=>{t.filterZoom&&a>1&&r.zoomToExtent()})};var Sl=e=>{let r={panel:a,block:t,reset:n,filter_text:_l(e),filter_numeric:yl(e),filter_in:kl(e),filter_date:Cl(e),filter_boolean:El(e)};return r;function t(i,s){let o=e.utils.html.node`
    <div class="drawer">
    <div class="header bold">
    <span>${s.title}</span>
    <button
      class="btn-header xyz-icon icon-close primary-colour-filter"
      onclick=${l=>{i.filter.current[s.field]={},i.reload(),i.show(),o.remove(),i.filter.list.children.length||(i.filter.clear_all.style.display="none")}}>`;return i.filter.list.appendChild(o),o}function n(i,s){s.el.parentNode.removeChild(s.el),s.el=null,i.filter.list.children.length||(i.filter.clear_all.style.display="none")}function a(i){if(!i.infoj||!i.infoj.some(f=>f.filter))return;let s=i.infoj.filter(f=>f.filter);s.unshift(e.language.layer_filter_select);let o=e.utils.html.node`
    <div class="drawer panel expandable">`;o.appendChild(e.utils.html.node`
    <div
      class="header primary-colour"
      onclick=${f=>{f.stopPropagation(),e.utils.toggleExpanderParent(f.target,!0)}}><span>${e.language.layer_filter_header}</span><button
      class="btn-header xyz-icon icon-expander primary-colour-filter">`);let l={};return Object.values(s).forEach(f=>{f.field&&(l[f.field]=f.title||f.field)}),i.filter.select=e.utils.html.node`
      <button class="btn-drop">
        <div
          class="head"
          onclick=${f=>{f.preventDefault(),f.target.parentElement.classList.toggle("active")}}>
          <span>${e.language.layer_filter_select}</span>
          <div class="icon"></div>
        </div>
        <ul>${Object.entries(l).map(f=>e.utils.html.node`
          <li onclick=${p=>{p.target.closest(".btn-drop").classList.toggle("active");let h=s.find(w=>w.field===f[0]);if(i.filter.clear_all.style.display="block",h.filter=="date")return r.filter_date(i,h);if(h.filter==="numeric")return r.filter_numeric(i,h);if(h.filter==="like"||h.filter==="match")return r.filter_text(i,h);if(h.filter.in)return r.filter_in(i,h);if(h.filter==="boolean")return r.filter_boolean(i,h)}}>${f[1]}`)}`,o.appendChild(i.filter.select),i.filter.clear_all=e.utils.html.node`
    <button
      class="primary-colour"
      style="display: none; margin-bottom: 5px;"
      onclick=${f=>{f.target.style.display="none",i.filter.list.innerHTML=null,Object.keys(i.filter.current).forEach(p=>i.filter.current[p]={}),i.reload(),i.show()}}>${e.language.layer_filter_clear_all}`,o.appendChild(i.filter.clear_all),i.filter.list=e.utils.html.node`<div>`,o.appendChild(i.filter.list),o}};var $l=e=>r=>e.utils.html.node`
    <button
      class="btn-wide primary-colour"
      onclick=${t=>{t.stopPropagation();let n=t.target;if(n.classList.contains("active"))return e.mapview.interaction.draw.cancel();n.classList.add("active"),r.show(),r.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),e.mapview.interaction.draw.begin({layer:r,type:"Point",callback:()=>{r.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),n.classList.remove("active")}})}}>${e.language.layer_draw_point}`;var jl=e=>r=>e.utils.html.node`
<button
  class="btn-wide primary-colour"
  onclick=${t=>{t.stopPropagation();let n=t.target;if(n.classList.contains("active"))return e.mapview.interaction.draw.cancel();n.classList.add("active"),r.show(),r.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),e.mapview.interaction.draw.begin({layer:r,type:"Polygon",geometryFunction:e.mapview.interaction.draw.polygonKinks,tooltip:r.edit.polygon.tooltip,callback:()=>{r.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),n.classList.remove("active")}})}}>${e.language.layer_draw_polygon}`;var Tl=e=>r=>e.utils.html.node`
  <button
    class="btn-wide primary-colour"
    onclick=${t=>{t.stopPropagation();let n=t.target;if(n.classList.contains("active"))return e.mapview.interaction.draw.cancel();n.classList.add("active"),r.show(),r.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),e.mapview.interaction.draw.begin({layer:r,type:"Circle",geometryFunction:ol.interaction.Draw.createBox(),tooltip:r.edit.rectangle.tooltip,callback:()=>{r.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),n.classList.remove("active")}})}}>${e.language.layer_draw_rectangle}`;var Ll=e=>r=>e.utils.html.node`
  <button
    class="btn-wide primary-colour"
    onclick=${t=>{t.stopPropagation();let n=t.target;if(n.classList.contains("active"))return e.mapview.interaction.draw.cancel();n.classList.add("active"),r.show(),r.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),e.mapview.interaction.draw.begin({layer:r,type:"Circle",geometryFunction:ol.interaction.Draw.createRegularPolygon(33),tooltip:r.edit.circle.tooltip,callback:()=>{r.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),n.classList.remove("active")}})}}>${e.language.layer_draw_circle}`;var Ml=e=>r=>e.utils.html.node`
    <button
      class="btn-wide primary-colour"
      onclick=${t=>{t.stopPropagation();let n=t.target;if(n.classList.contains("active"))return e.mapview.interaction.draw.cancel();n.classList.add("active"),r.show(),r.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),e.mapview.interaction.draw.begin({layer:r,type:"LineString",tooltip:r.edit.line.tooltip,callback:()=>{r.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),n.classList.remove("active")}})}}>${e.language.layer_draw_line}`;var Fl=e=>r=>e.utils.html.node`
  <button
    class="btn-wide primary-colour"
    onclick=${t=>{t.stopPropagation();let n=t.target;if(n.classList.contains("active"))return e.mapview.interaction.draw.cancel();n.classList.add("active"),r.show(),r.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),e.mapview.interaction.draw.begin({layer:r,type:"LineString",freehand:!0,callback:()=>{r.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),n.classList.remove("active")}})}}>${e.language.layer_draw_freehand}`;var Dl=e=>r=>{typeof r.edit.isoline_mapbox!="object"&&(r.edit.isoline_mapbox={});let t=e.utils.html.node`<div>`,n=e.utils.html.node`
    <div
      class="drawer group panel expandable">
      <div
        class="header primary-colour"
        style="text-align: left;"
        onclick=${s=>{e.utils.toggleExpanderParent(s.target)}}>
        <span>${e.language.mapbox_isoline_settings}</span>
        <span class="xyz-icon btn-header icon-expander primary-colour-filter">`;r.edit.isoline_mapbox.profile=r.edit.isoline_mapbox.profile||"driving",r.edit.isoline_mapbox.minutes=r.edit.isoline_mapbox.minutes||10;let a=[{[e.language.mapbox_driving]:"driving"},{[e.language.mapbox_walking]:"walking"},{[e.language.mapbox_cycling]:"cycling"}];return r.edit.isoline_mapbox.profile="driving",n.appendChild(e.utils.html.node`
    <div
      class="display-grid"
      style="margin-top: 8px; grid-template-columns: 50px 1fr; align-items: center;">
      <span style="grid-column: 1;">${e.language.mapbox_mode}</span>
      <div style="grid-column: 2;">
        <button class="btn-drop">
          <div class="head"
            onclick=${s=>{s.preventDefault(),s.target.parentElement.classList.toggle("active")}}>
            <span>${e.language.mapbox_driving}</span>
            <div class="icon"></div>
          </div>
          <ul>${a.map(s=>e.utils.html.node`
            <li onclick=${o=>{let l=o.target.closest(".btn-drop");l.classList.toggle("active"),l.querySelector(":first-child").textContent=Object.keys(s)[0],r.edit.isoline_mapbox.profile=Object.values(s)[0]}}>${Object.keys(s)[0]}`)}`),n.appendChild(e.utils.html.node`
    <div style="margin-top: 12px;">
      <span>${e.language.mapbox_travel_time}</span>
      <span class="bold">${r.edit.isoline_mapbox.minutes}</span>
      <div class="input-range">
        <input
          class="secondary-colour-bg"
          type="range" min=5 max=${r.edit.isoline_mapbox.maxMinutes||30} step=1
          value=${r.edit.isoline_mapbox.minutes}
          oninput=${s=>{r.edit.isoline_mapbox.minutes=parseInt(s.target.value),s.target.parentNode.previousElementSibling.textContent=r.edit.isoline_mapbox.minutes}}>`),t.appendChild(n),t.appendChild(e.utils.html.node`
    <button
      class="btn-wide primary-colour"
      onclick=${i}>${e.language.layer_draw_isoline_mapbox}`),t;function i(s){s.stopPropagation();let o=s.target;if(o.classList.contains("active"))return e.mapview.interaction.draw.cancel();o.classList.add("active"),r.show(),r.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),e.mapview.interaction.draw.begin({layer:r,type:"Point",geometryFunction:function(l,f){f=new ol.geom.Circle(l,r.edit.isoline_mapbox.minutes*1e3);let p=ol.proj.transform(l,`EPSG:${e.mapview.srid}`,"EPSG:4326"),u=new XMLHttpRequest;return u.open("GET",`https://api.mapbox.com/isochrone/v1/mapbox/${r.edit.isoline_mapbox.profile||"driving"}/${p.join(",")}?`+e.utils.paramString({contours_minutes:r.edit.isoline_mapbox.minutes,generalize:r.edit.isoline_mapbox.minutes,polygons:!0,access_token:r.edit.isoline_mapbox.access_token})),u.setRequestHeader("Content-Type","application/json"),u.responseType="json",u.onload=h=>{if(h.target.status!==200||!h.target.response.features)return alert("No route found. Try a longer travel time or alternative setup.");e.mapview.interaction.draw.feature({geometry:h.target.response.features[0].geometry,dataProjection:"EPSG:4326"})},u.send(),f},callback:()=>{r.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),o.classList.remove("active")}})}};var Ol=e=>r=>{typeof r.edit.isoline_here!="object"&&(r.edit.isoline_here={}),r.edit.defaults={};let t=e.utils.html.node`<div>`,n=e.utils.html.node`
    <div
      class="drawer group panel expandable">
      <div
        class="header primary-colour"
        style="text-align: left;"
        onclick=${l=>{e.utils.toggleExpanderParent(l.target)}}>
        <span>${e.language.here_isoline_settings}</span>
        <span class="xyz-icon btn-header icon-expander primary-colour-filter">`;return i(n),t.appendChild(n),t.appendChild(e.utils.html.node`
    <button
      class="btn-wide primary-colour"
      onclick=${a}>${e.language.layer_draw_isoline_here}`),t;function a(l){l.stopPropagation();let f=l.target;if(f.classList.contains("active"))return e.mapview.interaction.draw.cancel();f.classList.add("active"),r.show(),r.view.querySelector(".header").classList.add("edited","secondary-colour-bg"),e.mapview.interaction.draw.begin({layer:r,type:"Point",geometryFunction:function(p,u){u=new ol.geom.Circle(p,r.edit.isoline_here.minutes*1e3);let h=ol.proj.transform(p,`EPSG:${e.mapview.srid}`,"EPSG:4326"),w=r.edit.isoline_here.range*60,D=`${h[1]},${h[0]}`,Z=r.edit.isoline_here.destination||r.edit.defaults.destination,U=r.edit.isoline_here.dateISO?new Date(r.edit.isoline_here.dateISO).toISOString():r.edit.defaults.dateISO?new Date(r.edit.defaults.dateISO).toISOString():null,re={transportMode:r.edit.isoline_here.transportMode||"car",[Z?"destination":"origin"]:D,"range[values]":w||10*60,"range[type]":r.edit.isoline_here.rangetype||"time",optimizeFor:r.edit.isoline_here.optimizeFor||"balanced"};return U&&Object.assign(re,{[Z?"arrivalTime":"departureTime"]:U}),e.proxy(`https://isoline.router.hereapi.com/v8/isolines?${e.utils.paramString(re)}${r.edit.isoline_here.maxPoints?`&shape[${r.edit.isoline_here.maxPoints}]`:""}&{HERE}`).then(F=>{if(!F.isolines)return console.log(F),alert(e.language.here_error);let ie=e.utils.isoline_here_decode(F.isolines[0].polygons[0].outer);ie.polyline.map(J=>J.reverse()),ie.polyline.push(ie.polyline[0]),e.mapview.interaction.draw.feature({geometry:{type:"Polygon",coordinates:[ie.polyline]}})}),u},callback:()=>{r.view.querySelector(".header").classList.remove("edited","secondary-colour-bg"),f.classList.remove("active")}})}function i(l){let f=e.utils.html.node`<span>${e.language.here_depart}`;l.appendChild(e.utils.html.node`
            <div style="padding-top: 5px; grid-column: 1 / 3;">
            <label class="input-checkbox">
            <input type="checkbox" "checked"=false
            onchange=${Z=>{f.textContent=Z.target.checked?`${e.language.here_arrive}`:`${e.language.here_depart}`,r.edit.isoline_here.destination=Z.target.checked}}></input><div></div><span>${e.language.here_use_as_destination}`);let p=[{[e.language.here_driving]:"car"},{[e.language.here_walking]:"pedestrian"}];l.appendChild(s({title:e.language.here_transport_mode,options:p,callback:(Z,U)=>{r.edit.isoline_here.transportMode=U}}));let u=[{[e.language.here_time]:"time"}],h=[{[e.language.here_routing_type_fastest]:"fast"},{[e.language.here_routing_type_shortest]:"short"}];l.appendChild(s({title:e.language.here_routing_type,options:h,callback:(Z,U)=>{r.edit.isoline_here.routingType=U}}));let w=[{[e.language.here_optimize_for_balanced]:"balanced"},{[e.language.here_optimize_for_quality]:"quality"},{[e.language.here_optimize_for_performance]:"performance"}];l.appendChild(s({title:e.language.here_optimize_for,options:w,callback:(Z,U)=>{r.edit.isoline_here.optimizeFor=U}}));let D=e.utils.html.node`<input type="text" placeholder=${e.language.layer_filter_pick} style="text-align: end;">`;l.appendChild(e.utils.html.node`
                <div style="margin-top: 12px; grid-column: 1 / 3; margin-bottom: 8px;">
                <div style="display: grid; grid-template-columns: 100px 1fr; align-items: center;">
                <div style="grid-column: 1;">${f}</div>
                <div style="grid-column: 2;">${D}</div>`),e.utils.flatpickr({locale:e.hooks.current.language||null,element:D,enableTime:!0,callback:Z=>{!Z||(D.value=Z,r.edit.isoline_here.dateISO=new Date(Z).toISOString())}}),l.appendChild(o({title:e.language.here_travel_time,max:r.edit.isoline_here.maxMinutes,range:10,callback:Z=>{r.edit.isoline_here.range=parseInt(Z.target.value)}}))}function s(l){return e.utils.html.node`<div style="margin-top: 8px; grid-column: 1 / 3; align-items: center;">
            <div style="display: grid; grid-template-columns: 100px 1fr; align-items: center;">
            <div style="grid-column: 1;">${l.title}</div>
            <div style="grid-column: 2;">
            <button class="btn-drop">
            <div
                class="head"
                onclick=${f=>{f.preventDefault(),f.target.parentElement.classList.toggle("active")}}>
                <span>${Object.keys(l.options[0])}</span>
                <div class="icon"></div>
            </div>
            <ul>
                ${l.options.map(f=>e.utils.html.node`
                <li onclick=${p=>{let u=p.target.closest(".btn-drop");u.classList.toggle("active"),u.querySelector(":first-child").textContent=Object.keys(f)[0],l.callback&&l.callback(p,Object.values(f)[0])}}>${Object.keys(f)[0]}`)}`}function o(l){return e.utils.html.node`
        <div style="margin-top: 12px; grid-column: 1 / 3;">
        <span>${l.title}</span>
        <span class="bold">${l.range}</span>
        <div class="input-range">
        <input
          class="secondary-colour-bg"
          type="range"
          min=5
          value=${l.range}
          max=${l.max||30}
          step=1
          oninput=${f=>{f.target.parentNode.previousElementSibling.textContent=parseInt(f.target.value),l.callback&&l.callback(f)}}>`}};var Al=e=>{let r={panel:t,polygon:jl(e),point:$l(e),rectangle:Tl(e),circle:Ll(e),line:Ml(e),freehand:Fl(e),isoline_mapbox:Dl(e),isoline_here:Ol(e)};return r;function t(n){if(!n.edit)return;let a=e.utils.html.node`
    <div class="drawer panel expandable">`;if(a.appendChild(e.utils.html.node`
    <div
      class="header primary-colour"
      onclick=${i=>{i.stopPropagation(),e.utils.toggleExpanderParent(i.target,!0)}}><span>${e.language.layer_add_new_location}</span><button
      class="btn-header xyz-icon icon-expander primary-colour-filter">`),n.edit.point&&a.appendChild(r.point(n)),n.edit.polygon&&a.appendChild(r.polygon(n)),n.edit.rectangle&&a.appendChild(r.rectangle(n)),n.edit.circle&&a.appendChild(r.circle(n)),n.edit.line&&a.appendChild(r.line(n)),n.edit.freehand&&a.appendChild(r.freehand(n)),n.edit.isoline_mapbox&&a.appendChild(r.isoline_mapbox(n)),n.edit.isoline_here&&a.appendChild(r.isoline_here(n)),!(a.children.length<2))return a}};var Pl=e=>{return{panel:r};function r(t){if(!t.dataviews||!e.tabview.node)return;let n=e.utils.html.node`<div class="drawer panel expandable">`;return n.appendChild(e.utils.html.node`
      <div
        class="header primary-colour"
        onclick=${a=>{a.stopPropagation(),e.utils.toggleExpanderParent(a.target,!0)}}>
        <span>${e.language.layer_dataview_header}</span>
        <button class="btn-header xyz-icon icon-expander primary-colour-filter">`),Object.entries(t.dataviews).forEach(a=>{let i=a[1];i.key=a[0],i.layer=t,e.tabview.add(i),e.dataviews.create(i),t.display&&i.display&&i.show(),n.appendChild(e.utils.html.node`
        <label class="input-checkbox inline">
          <input
            type="checkbox"
            .checked=${!!i.display}
            onchange=${s=>{i.display=s.target.checked,i.display?i.show():i.remove()}}></input>
          <div></div>
        </label>
        <span>${i.title||i.key}`)}),n}};var Il=e=>{return{panel:t};function t(n){if(!n.reports)return;let a=e.utils.html.node`
    <div class="drawer panel expandable">`;return a.appendChild(e.utils.html.node`
    <div
      class="header primary-colour"
      onclick=${i=>{i.stopPropagation(),e.utils.toggleExpanderParent(i.target,!0)}}><span>Reports</span><button
      class="btn-header xyz-icon icon-expander primary-colour-filter">`),Object.entries(n.reports).forEach(i=>{let s=e.host+"/view?"+e.utils.paramString(Object.assign(i[1],{template:i[0],locale:e.locale.key,layer:n.key,lat:e.hooks.current.lat,lng:e.hooks.current.lng,z:e.hooks.current.z}));a.appendChild(e.utils.html.node`
      <a
        target="_blank"
        href="${s}"
        class="link-with-img">
        <div class="xyz-icon icon-event-note"></div><span>${i[0]}`)}),a}};var xl=e=>{return{panel:t};function t(s){if(!s.download)return;let o=e.utils.html.node`<div class="drawer panel expandable">`;return o.appendChild(e.utils.html.node`
      <div
        class="header primary-colour"
        onclick=${l=>{e.utils.toggleExpanderParent(l.target,!0)}}>
        <span>${e.language.layer_data}</span>
        <button class="btn-header xyz-icon icon-expander primary-colour-filter">`),o.appendChild(e.utils.html.node`
      <label class="input-checkbox">
        <input type="checkbox"
          onchange=${l=>{s.download.viewport=l.target.checked}}>
        </input>
        <div></div>
        <span>${e.language.layer_data_viewport_only}`),o.appendChild(e.utils.html.node`
      <button
        class="btn-wide primary-colour"
        onclick=${l=>{n(s)}}>${e.language.layer_download}`),o}function n(s){s.download.layer=s,e.query(s.download).then(o=>{let l=s.download.format==="json"&&a(o)||i(o);e.utils.html.node`<a
        href=${URL.createObjectURL(l)}
        download=${`${s.key}.${s.download.format||"csv"}`}>`.click()})}function a(s){let o=s.map(f=>{let p={type:"Feature",properties:f};return p.geometry=JSON.parse(f.geometry),delete p.properties.geometry,p}),l=JSON.stringify({type:"FeatureCollection",features:o});return new Blob([l],{type:"application/json"})}function i(s){let l=s.map(f=>Object.values(f).map(p=>isNaN(p)&&`"${p}"`||p).join(",")).join(`\r
`);return new Blob([l],{type:"text/csv;charset=utf-8;"})}};var Rl=e=>{let r={create:t,style:wl(e),filter:Sl(e),draw:Al(e),report:Il(e),data:Pl(e),download:xl(e)};return r;function t(n){n.view=e.utils.html.node`<div class="drawer layer-view">`;let a=e.utils.html.node`
    <div class="header enabled"><span>${n.name||n.key}`;n.style.default&&n.style.default.showInHeader&&a.appendChild(e.utils.html.node`
      <img
        class="btn-header"
        title=${e.language.layer_default_icon}
        style="float: right; cursor: help;"
        src="${e.utils.svg_symbols(n.style.default)}">`),a.appendChild(e.utils.html.node`
    <button
      title=${e.language.layer_zoom_to_extent}
      class="btn-header xyz-icon icon-fullscreen"
      onclick=${h=>{h.stopPropagation(),n.zoomToExtent()}}>`);let i=e.utils.html.node`
    <button
      title=${e.language.layer_visibility}
      class="${`btn-header xyz-icon icon-toggle ${n.display&&"on"||"off"}`}"
      onclick=${h=>{h.stopPropagation(),n.display?n.remove():n.show()}}>`;if(a.appendChild(i),n.view.addEventListener("display-on",()=>{i.classList.add("on")}),n.view.addEventListener("display-off",()=>{i.classList.remove("on")}),n.view.appendChild(a),n.meta){let h=n.view.appendChild(e.utils.html.node`<p class="meta">`);h.innerHTML=n.meta}let s=r.style.panel(n);s&&n.view.appendChild(s);let o=r.filter.panel(n);o&&n.view.appendChild(o);let l=r.data.panel(n);l&&n.view.appendChild(l);let f=r.draw.panel(n);f&&n.view.appendChild(f);let p=r.report.panel(n);p&&n.view.appendChild(p);let u=r.download.panel(n);u&&n.view.appendChild(u),n.plugins&&n.plugins.forEach(h=>e.layers.plugins[h]&&e.layers.plugins[h](n)),!(n.view.children.length<=1)&&(n.view.classList.add("expandable"),a.onclick=h=>{h.stopPropagation(),e.utils.toggleExpanderParent(h.target,!0)},a.appendChild(e.utils.html.node`
    <button
      title=${e.language.layer_toggle_dashboard}
      class="btn-header xyz-icon icon-expander"
      onclick=${h=>{h.stopPropagation(),e.utils.toggleExpanderParent(h.target)}}>`))}};var Hl=e=>{return{init:r};function r(n){e.layers.listview.node=n.target,e.layers.listview.groups={},Object.values(e.layers.list).forEach(a=>{if(!a.hidden){if(e.layers.view.create(a),!a.group){e.layers.listview.node.appendChild(a.view);return}e.layers.listview.groups[a.group]||t(a),e.layers.listview.groups[a.group].addLayer(a)}})}function t(n){let a={list:[]};e.layers.listview.groups[n.group]=a;let i=e.layers.listview.node.appendChild(e.utils.html.node`<div class="drawer layer-group expandable">`),s=i.appendChild(e.utils.html.node`
      <div
        class="header enabled"
        onclick=${f=>{f.stopPropagation(),e.utils.toggleExpanderParent(f.target,!0)}}>
        <span>${n.group}`),o=i.appendChild(e.utils.html.node`<div class="meta">`);a.chkVisibleLayer=()=>{a.list.some(f=>f.display)?l.classList.add("on"):l.classList.remove("on")},a.addLayer=f=>{if(f.groupmeta){let p=o.appendChild(e.utils.html.node`<div>`);p.innerHTML=f.groupmeta}a.list.push(f),i.appendChild(f.view),a.chkVisibleLayer()};let l=s.appendChild(e.utils.html.node`
      <button
        class="btn-header xyz-icon icon-toggle"
        title=${e.language.layer_group_hide_layers}
        onclick=${f=>{if(f.stopPropagation(),f.target.classList.toggle("on"),f.target.classList.contains("on")){a.list.filter(p=>!p.display).forEach(p=>p.show());return}a.list.filter(p=>p.display).forEach(p=>p.remove())}}>`);s.appendChild(e.utils.html.node`
      <button 
        class="xyz-icon btn-header icon-expander"
        title=${e.language.layer_group_toggle}
        onclick=${f=>{f.stopPropagation(),e.utils.toggleExpanderParent(f.target)}}>`)}};var Nl=e=>function(){let r=this;if(!r.tables)return r.table;let t,n=parseInt(e.mapview.getZoom()),a=Object.keys(r.tables),i=parseInt(a[0]),s=parseInt(a[a.length-1]);return t=r.tables[n],t=n<i?r.tables[i]:t,t=n>s?r.tables[s]:t,t};var Bl=e=>function(){let r=this;if(!r.tables)return r.table;let t=Object.keys(r.tables);return r.tables[t[0]]||r.tables[t[1]]};var Gl=e=>function(){let r=this;if(!r.tables)return r.table;let t=Object.keys(r.tables);return r.tables[t[t.length-1]]||r.tables[t[t.length-2]]};var ql=e=>function(r){let t=this,n=new XMLHttpRequest;n.open("GET",e.host+"/api/query/layer_extent?"+e.utils.paramString({locale:e.locale.key,layer:t.key,table:t.table||Object.values(t.tables)[0]||Object.values(t.tables)[1],geom:t.geom,proj:t.srid,srid:e.mapview.srid,filter:t.filter&&t.filter.current})),n.setRequestHeader("Content-Type","application/json"),n.responseType="json",n.onload=a=>{if(a.target.status!==200)return;let i=/\((.*?)\)/.exec(a.target.response.box2d)[1].replace(/ /g,",");e.mapview.flyToBounds(i.split(",").map(s=>parseFloat(s)),r)},n.send()};var Vl=e=>function(){if(!e.map)return;let r=this;r.display=!0,r.view&&r.view.dispatchEvent(new CustomEvent("display-on")),r.L&&e.map.removeLayer(r.L),e.map.addLayer(r.L),r.style&&r.style.label&&(e.map.getLayers().forEach(t=>{t===r.label&&e.map.removeLayer(r.label)}),r.style.label.display&&e.map.addLayer(r.label)),e.mapview.attribution.check(),e.hooks&&e.hooks.push("layers",r.key),r.group&&e.layers.listview.groups&&e.layers.listview.groups[r.group]&&e.layers.listview.groups[r.group].chkVisibleLayer(),r.tabs.forEach(t=>{t.display&&t.show()})};var Ul=e=>function(){let r=this;r.display=!1,r.view&&r.view.dispatchEvent(new CustomEvent("display-off")),r.L&&e.map.removeLayer(r.L),r.style&&r.style.label&&r.label&&e.map.removeLayer(r.label),e.mapview.attribution.check(),e.hooks&&e.hooks.filter("layers",r.key),r.group&&e.layers.listview.groups&&e.layers.listview.groups[r.group]&&e.layers.listview.groups[r.group].chkVisibleLayer(),r.tabs.forEach(t=>t.remove())};var Yl=e=>async function(r){let t=this,n=await e.query({query:"count_locations",locale:e.locale.key,layer:t,filter:t.filter&&t.filter.current,queryparams:{table:t.tableMin()}});return r?r(parseInt(n.count)):parseInt(n.count)};var Wl=e=>function(){let r=this;r.L.getZIndex()!==1e3&&(Object.values(e.layers.list).map(t=>{t.format!=="tiles"&&t.L.setZIndex(t.style.zIndex||1)&&t.display&&t.reload()}),r.L.setZIndex(1e3),r.reload())};var Jl=e=>{return{decorate:t,list:{},plugins:{},view:Rl(e),listview:Hl(e),load:n};function t(a){let i=Object.assign({tableCurrent:Nl(e),tableMin:Bl(e),tableMax:Gl(e),zoomToExtent:ql(e),show:Vl(e),remove:Ul(e),count:Yl(e),bringToFront:Wl(e),tabs:new Set,filter:{}},a);return i.filter.current=i.filter.current||{},i.style&&i.style.themes&&(i.style.theme=i.style.theme||i.style.themes[Object.keys(i.style.themes)[0]]),i.format&&e.mapview.layer[i.format]&&e.mapview.layer[i.format](i),i}function n(a){return new Promise((i,s)=>{e.locale.layers||i();let o=e.locale.layers.filter(l=>!a||!a.length||a.includes(l)).map(l=>e.workspace.get.layer({locale:e.locale.key,layer:l}));Promise.all(o).then(l=>{e.hooks&&e.hooks.current.layers.length&&l.forEach(f=>{f.display=!!~e.hooks.current.layers.indexOf(f.key)}),l.forEach((f,p)=>{!f.format||(f=e.layers.decorate(f),e.layers.list[f.key]=f,f.display&&f.show(),l[p]=f)}),i(l)}).catch(l=>{console.error(l),s(l)})})}};var Zl=e=>r=>{if(typeof r.layer=="string"&&(r.layer=e.layers.list[r.layer]),!r.layer||!r.layer.infoj)return;e.mapview.popup.node&&e.mapview.popup.node.remove(),r.hook=`${r.layer.key}!${r.table}!${r.id}`;let t={stamp:parseInt(Date.now())};if(e.locations.list.some(a=>{if(a.location?.hook===r.hook)return a.location.remove(),a.stamp=0,!0}))return;for(let a of e.locations.list)if(a.location)a.stamp<t.stamp&&(t=a);else{t=a;break}if(t.stamp=parseInt(Date.now()),t.location&&t.location.remove(),t.location=r,r.style=t.style,r.colorFilter=t.colorFilter,r._new)return e.locations.decorate(r),r.marker=ol.proj.transform(e.utils.turf.pointOnFeature(r.geometry).geometry.coordinates,"EPSG:"+r.layer.srid,"EPSG:"+e.mapview.srid),typeof r.callback=="function"?r.callback(r):e.locations.selectCallback(r);let n=new XMLHttpRequest;t.location.xhr=n,n.open("GET",e.host+"/api/location/get?"+e.utils.paramString({locale:e.locale.key,layer:r.layer.key,table:r.table,id:r.id})),n.setRequestHeader("Content-Type","application/json"),n.responseType="json",n.onload=a=>{if(a.target.status>200){delete t.stamp,e.hooks&&e.hooks.filter("locations",r.hook);return}e.hooks&&e.hooks.push("locations",r.hook);let i=r.layer.infoj.map(s=>{let o=e.utils.cloneDeep(s);return o.title=a.target.response.properties[o.field+"_label"]||o.title,o.value=a.target.response.properties[o.field],o});if(e.locations.decorate(r,{infoj:i,geometry:a.target.response.geometry,editable:r.layer.edit,record:t}),r.marker=ol.proj.transform(e.utils.turf.pointOnFeature(a.target.response.geometry).geometry.coordinates,"EPSG:"+r.layer.srid,"EPSG:"+e.mapview.srid),typeof r.callback=="function")return r.callback(r);e.locations.selectCallback(r)},n.send(),t.location.remove=()=>{t.location.xhr.abort(),t.location=null}};var Xl=e=>r=>{if(e.locations.view.create(r),r.draw(),!e.mapview.popup)return alert(JSON.stringify(r.infoj,e.utils.getCircularReplacer()," "));if(!e.locations.listview.node){r.view.style.width="300px",e.mapview.popup.create({coords:r.marker,content:r.view,autoPan:!0});return}return r.Marker=e.mapview.geoJSON({geometry:{type:"Point",coordinates:r.marker},zIndex:2e3,style:new ol.style.Style({image:e.mapview.icon({type:"markerLetter",letter:String.fromCharCode(65+e.locations.list.indexOf(r.record)),color:r.style.strokeColor,scale:3,anchor:[.5,1]})})}),r._flyTo&&r.flyTo(),e.locations.listview.add(r)};var Kl=e=>r=>{if(!r.infoj||r.infoj.length<1)return;r.geometries=r.geometries.filter(a=>{e.map.removeLayer(a)}),r.geometryCollection=r.geometryCollection.filter(a=>{e.map.removeLayer(a)}),r.tabs.forEach(a=>a.remove&&a.remove());let t=e.utils.html.node`<div class="location-view-grid">`,n={};for(let a of r.infoj){if(r.view&&r.view.classList.contains("disabled"))break;if(a.listview=t,a.location=r,a.type=a.type||"text",a.inline=a.inline||a.type==="integer"||a.type==="numeric",a.class=`${a.class||""} ${a.type} ${a.inline&&"inline"||""}`,a.type==="key"){a.listview.appendChild(e.utils.html.node`
        <div
          class="${a.class}">
          <span
            title=${e.language.location_source_layer}
            style="${`background-color: ${e.utils.Chroma(r.style.strokeColor||"#090").alpha(.3)}`}"
            >${r.layer.name||r.layer.key}`);continue}if(a.displayValue=a.type==="numeric"?parseFloat(a.value).toLocaleString("en-GB",{maximumFractionDigits:2}):a.type==="integer"?parseInt(a.value).toLocaleString("en-GB",{maximumFractionDigits:0}):a.type==="date"?e.utils.formatDate(a.value):a.type==="datetime"?e.utils.formatDateTime(a.value):a.value,a.displayValue=`${a.prefix||""}${a.displayValue}${a.suffix||""}`,a.group&&(n[a.group]||(n[a.group]=e.utils.html.node`
        <div
          class="${`drawer group panel expandable ${a.class||""}`}"
          style="${a.group_css||""}">
          <div
            class="header primary-colour"
            onclick=${i=>{e.utils.toggleExpanderParent(i.target)}}>
            <span>${a.group}</span>
            <span class="xyz-icon btn-header icon-expander primary-colour-filter">`,a.listview.appendChild(n[a.group])),a.expanded&&n[a.group].classList.add("expanded"),a.listview=n[a.group]),a.plugin){e.locations.plugins[a.plugin]&&e.locations.plugins[a.plugin](a);continue}if(!(typeof a.value!="undefined"&&a.value===null&&!a.edit)&&!(a.title&&!a.query&&!a.dataviews&&(!a.edit&&typeof a.value=="undefined"&&a.type!=="title"||(a.listview.appendChild(e.utils.html.node`
        <div
          class="${`label ${a.class}`}"
          style="${`${a.css_title||""}`}"
          title="${a.tooltip||null}">${a.title}`),a.type==="title")))){if(a.type==="dataview"){let i=e.locations.view.dataview(a);i&&a.listview.appendChild(i);continue}if(e.locations.view[a.type]){e.locations.view[a.type](a);continue}if(!(!a.query&&!a.edit&&typeof a.value=="undefined")){if(a.val=a.listview.appendChild(e.utils.html.node`
      <div
        class="${`val ${a.class}`}"
        style="${`${a.css_val||""}`}">`),a.query){a.layer=a.layer||a.location.layer,e.query(a).then(i=>{!i||(a.val.textContent=Object.values(i)[0])});continue}if(a.edit&&!a.fieldfx){e.locations.view.edit.input(a);continue}if(a.type==="html"){a.val.innerHTML=a.value;continue}if(a.displayValue=="null"){a.val.remove();continue}a.val.textContent=a.displayValue}}}return t};var Ql=e=>r=>{let t=ol.proj.transform(r.location.marker,"EPSG:"+e.mapview.srid,"EPSG:4326"),n=`${e.host}/api/proxy?url=${encodeURIComponent(`https://maps.googleapis.com/maps/api/streetview?location=${t[1]},${t[0]}&source=outdoor&size=300x230&{GOOGLE}`)}`;r.listview.appendChild(e.utils.html.node`
    <div
      class="${r.class}">
      <a
        target="_blank"
        href="${"https://www.google.com/maps?cbll="+t[1]+","+t[0]+"&layer=c"}">
        <img src="${n}">`)};var zl=e=>r=>{let t=e.utils.html.node`<div class="images-grid">`;r.listview.appendChild(t);for(let a of r.value)t.appendChild(e.utils.html.node`
      <div
        class="${r.class||""}"
        style="position: relative; width: 90px; height: 90px; flex-grow: 1;">
        <img src=${a}
          style="width: 100%; height: 100%; object-fit: cover; padding: 2px; border-radius: 2px;"
          onclick=${i=>{!document.getElementById("modalOverlay")||(document.getElementById("modalOverlay").style.display="block",document.getElementById("modalOverlay").childNodes[r.value.indexOf(i.target.src)+1].scrollIntoView())}}>
          ${r.edit&&e.utils.html.node`
            <button
              class="xyz-icon icon-trash img-remove"
              data-name=${a.replace(/.*\//,"").replace(/\.([\w-]{3})/,"")}
              data-src=${a}
              onclick=${i=>n(i)}>
            </button>`}`);if(!r.edit)return;if(document.getElementById("modalOverlay")){document.getElementById("modalOverlay").appendChild(e.utils.html.node`
      <span onclick=${a=>{document.getElementById("modalOverlay").style.display="none"}}>&times;`);for(let a of r.value)document.getElementById("modalOverlay").appendChild(e.utils.html.node`<div><img style="padding-top: 40px;" src=${a}>`)}r.listview.appendChild(e.utils.html.node`
    <div class="list" style="grid-column: 1 / 3;">
    <div class="add xyz-icon icon-add-photo off-black-filter">
    <input
      type="file"
      accept="image/*;capture=camera"
      onchange=${a=>{let i=new FileReader,s=a.target.files[0];if(!s)return;let o=e.utils.html.node`
          <div
            class="${r.class||""}" 
            style="position: relative; width: 90px; height: 90px; flex-grow: 1;"
            onclick=${l=>{!document.getElementById("modalOverlay")||(document.getElementById("modalOverlay").style.display="block",Array.from(document.querySelectorAll("#modalOverlay img")).some(f=>{f.src===l.target.src&&f.scrollIntoView()}))}}>`;t.appendChild(o),i.onload=l=>{let f=new Image;f.onload=async()=>{let p=e.utils.html.node`<canvas>`,u=1024,h=f.width,w=f.height;h>w&&h>u?(w*=u/h,h=u):w>u&&(h*=u/w,w=u),p.width=h,p.height=w,p.getContext("2d").drawImage(f,0,0,h,w);let D=p.toDataURL("image/jpeg",.5),Z=await e.xhr({method:"POST",content_type:"application/octet-stream",url:`${e.host}/api/provider/cloudinary?${e.utils.paramString({public_id:s.name.replace(/.*\//,"").replace(/\.([\w-]{3})/,""),resource_type:"image"})}`,body:e.utils.dataURLtoBlob(D)});await e.xhr({url:`${e.host}/api/query?${e.utils.paramString({template:"set_field_array",locale:e.locale.key,layer:r.location.layer.key,table:r.location.table,action:"append",field:r.field,secure_url:Z.secure_url,id:r.location.id})}`}),e.utils.render(o,e.utils.html`
              <img src=${Z.secure_url}
                style="width: 100%; height: 100%; object-fit: cover; padding: 2px; border-radius: 2px;">
                ${r.edit&&e.utils.html.node`
                  <button
                    class="xyz-icon icon-trash img-remove"
                    data-name=${Z.public_id}
                    data-src=${Z.secure_url}
                    onclick=${U=>n(U)}>
                  </button>`}`),document.getElementById("modalOverlay")&&document.getElementById("modalOverlay").appendChild(e.utils.html.node`
                <div><img style="padding-top: 40px;" src=${Z.secure_url}>`)},f.src=l.target.result},i.readAsDataURL(s),a.target.value=""}}>`);async function n(a){if(!confirm("Remove image?"))return;let i=a.target;e.xhr({url:`${e.host}/api/provider/cloudinary?${e.utils.paramString({destroy:!0,public_id:i.dataset.name})}`}),await e.xhr({url:`${e.host}/api/query?${e.utils.paramString({template:"set_field_array",locale:e.locale.key,layer:r.location.layer.key,table:r.location.table,action:"remove",field:r.field,secure_url:i.dataset.src,id:r.location.id})}`}),i.parentNode.remove()}};var es=e=>r=>{r.documents=e.utils.html.node`<div style="grid-column: 1 / 3;"">`,r.listview.appendChild(r.documents);for(let n of r.value)r.documents.appendChild(e.utils.html.node`
		<div class="item">
		${r.edit&&e.utils.html.node`
		<button
			class="xyz-icon icon-trash link-remove"
			data-name=${n.replace(/.*\//,"").replace(/\.([\w-]{3})/,"")}
			data-href=${n}
			onclick=${a=>t(a)}>
		</button>`}		
		<a href=${n}>${n.replace(/.*\//,"").replace(/\.([\w-]{3})/,"")}`);if(!r.edit)return;r.listview.appendChild(e.utils.html.node`
    <div class="list" style="grid-column: 1 / 3;">
      <div class="add xyz-icon icon-cloud-upload off-black-filter">
      <input
      type="file"
      accept=".txt,.pdf,.doc,.docx,.xls,.xlsx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document;"
      onchange=${n=>{let a=new FileReader,i=n.target.files[0];if(!i)return;let s=e.utils.html.node`<div class="item"><div class="xyz-icon loader">`;r.documents.appendChild(s),a.onload=o=>{let l=new XMLHttpRequest;l.open("POST",e.host+"/api/provider/cloudinary?"+e.utils.paramString({resource_type:"raw",public_id:i.name})),l.setRequestHeader("Content-Type","application/octet-stream"),l.responseType="json",l.onload=f=>{if(f.target.status>202)return console.log("document_upload failed");let p=f.target.response.secure_url,u=f.target.response.public_id.replace(/.*\//,"").replace(/\.([\w-]{3})/,""),h=new XMLHttpRequest;h.open("GET",e.host+"/api/query?"+e.utils.paramString({template:"set_field_array",locale:e.locale.key,layer:r.location.layer.key,table:r.location.table,action:"append",field:r.field,secure_url:p,id:r.location.id})),h.setRequestHeader("Content-Type","application/json"),h.responseType="json",h.onload=w=>{w.target.status>202||e.utils.render(s,e.utils.html`
              <div class="item">
              ${r.edit&&e.utils.html.node`
              <button
                class="xyz-icon icon-trash link-remove"
                data-name=${u}
                data-href=${p}
                onclick=${D=>t(D)}>
              </button>`}
              <a href=${p} target="_blank">${u}`)},h.send()},l.send(o.target.result)},a.readAsDataURL(i),n.target.value=""}}>`);function t(n){if(!confirm("Remove document link?"))return;let a=n.target,i=new XMLHttpRequest;i.open("GET",e.host+"/api/provider/cloudinary?"+e.utils.paramString({destroy:!0,public_id:a.dataset.name})),i.onload=s=>{if(s.target.status>202)return;let o=new XMLHttpRequest;o.open("GET",e.host+"/api/query?"+e.utils.paramString({template:"set_field_array",locale:e.locale.key,layer:r.location.layer.key,table:r.location.table,action:"remove",field:r.field,secure_url:a.dataset.href,id:r.location.id})),o.setRequestHeader("Content-Type","application/json"),o.responseType="json",o.onload=l=>{l.target.status>202||a.parentNode.remove()},o.send()},i.send()}};var ts=e=>r=>{if(!r.report.template)return;let t=`${e.host}/view?${e.utils.paramString(Object.assign(r.report,{locale:e.locale.key,layer:r.location.layer.key,table:r.location.table,id:r.location.id,host:e.host}))}`;r.listview.appendChild(e.utils.html.node`
    <div
      class="${`label ${r.class}`}">
      <a
        class="primary-colour"
        target="_blank"
        href="${t}">
          ${r.report.title||r.report.name||"Location Report"}`)};var rs=e=>r=>{r.listview.appendChild(e.utils.html.node`
    <div style="padding-top: 5px; grid-column: 1 / 3">
      <label class="input-checkbox">
        <input type="checkbox"
          .disabled=${!r.edit}
          .checked=${!!r.value}
          onchange=${t=>{r.location.view.dispatchEvent(new CustomEvent("valChange",{detail:{input:t.target,entry:r,newValue:!!t.target.checked}}))}}>
        </input>
        <div></div><span>${r.title||r.name||r.field}`)};var ns=e=>{return{create:t,settings:r};function r(o){o.edit.defaults===void 0&&(o.edit.defaults=Object.assign({},o.edit.isoline_here)),!(o.edit.isoline_here&&!o.edit.isoline_here.geometry&&(o.edit.isoline_here.minutes||o.value))&&(o.edit.isoline_here&&o.edit.isoline_here.geometry&&o.edit.isoline_here.minutes&&!o.value||(n(o),o.container&&o.container.parentNode.insertBefore(o.edit.panel,o.container.nextSibling)))}function t(o){o.edit.defaults===void 0&&(o.edit.defaults=Object.assign({},o.edit.isoline_here));let l=(o.edit.isoline_here.minutes||o.edit.isoline_here.range)*60,f=ol.proj.toLonLat(o.location.geometry.coordinates,`EPSG:${o.location.layer.srid}`),p=o.edit.isoline_here.destination||o.edit.defaults.destination,u=o.edit.isoline_here.dateISO?new Date(o.edit.isoline_here.dateISO).toISOString():o.edit.defaults.dateISO?new Date(o.edit.defaults.dateISO).toISOString():null,h={transportMode:o.edit.isoline_here.transportMode||"car",[p?"destination":"origin"]:`${f[1]},${f[0]}`,"range[values]":l||10*60,"range[type]":o.edit.isoline_here.rangetype||"time",optimizeFor:o.edit.isoline_here.optimizeFor||"balanced"};u&&Object.assign(h,{[p?"arrivalTime":"departureTime"]:u}),e.proxy(`https://isoline.router.hereapi.com/v8/isolines?${e.utils.paramString(h)}${o.edit.isoline_here.maxPoints?`&shape[${o.edit.isoline_here.maxPoints}]`:""}&{HERE}`).then(w=>{if(!w.isolines)return console.log(w),alert(e.language.here_error);if(w.isolines[0].polygons.length){let D=e.utils.isoline_here_decode(w.isolines[0].polygons[0].outer);if(D.polyline.map(Z=>Z.reverse()),D.polyline.push(D.polyline[0]),o.newValue={type:"Polygon",coordinates:[D.polyline]},o.edit.meta){let Z=new Date;o.location.infoj.filter(U=>U.type==="json"&&U.field===o.edit.meta).forEach(U=>U.newValue=Object.assign({provider:"Here"},h))}o.edit.panel&&(o.edit.panel.remove(),o.edit.panel=null,n(o)),o.location.update(),o.edit.defaults.dateISO||(o.edit.isoline_here.dateISO=null),o.edit.defaults.destination||(o.edit.isoline_here.destination=null)}else{o.location.view&&o.location.view.classList.remove("disabled");return}o.location.view&&o.location.view.classList.add("disabled")})}function n(o){o.edit.panel||o.edit.isoline_here.minutes||(o.edit.panel=e.utils.html.node`
        <div
        class="${`drawer group panel expandable ${o.class||""}`}"
        style="display: grid; grid-column: 1 / 3; border-bottom: solid 1px grey;">
        <div
        class="header primary-colour"
        style="text-align: left; grid-column: 1 / 3;"
        onclick=${l=>{e.utils.toggleExpanderParent(l.target)}}
        ><span>${e.language.here_isoline_settings}</span>
        <span class="xyz-icon btn-header icon-expander primary-colour-filter">`,a(o))}function a(o){let l=e.utils.html.node`<span>${e.language.here_depart}`;o.edit.panel.appendChild(e.utils.html.node`
            <div style="padding-top: 5px; grid-column: 1 / 3;">
            <label class="input-checkbox">
            <input type="checkbox" "checked"=false
            onchange=${w=>{l.textContent=w.target.checked?`${e.language.here_arrive}`:`${e.language.here_depart}`,o.edit.isoline_here.destination=w.target.checked}}></input><div></div><span>${e.language.here_use_as_destination}`);let f=[{[e.language.here_driving]:"car"},{[e.language.here_walking]:"pedestrian"}];o.edit.defaults.transportMode===void 0&&o.edit.panel.appendChild(i({title:e.language.here_transport_mode,options:f,callback:(w,D)=>{o.edit.isoline_here.transportMode=D}}));let p=[{[e.language.here_time]:"time"}],u=[{[e.language.here_routing_type_fastest]:"fast"},{[e.language.here_routing_type_shortest]:"short"}];o.edit.defaults.routingType===void 0&&o.edit.panel.appendChild(i({title:e.language.here_routing_type,options:u,callback:(w,D)=>{o.edit.isoline_here.routingType=D}}));let h=[{[e.language.here_optimize_for_balanced]:"balanced"},{[e.language.here_optimize_for_quality]:"quality"},{[e.language.here_optimize_for_performance]:"performance"}];if(o.edit.defaults.optimizeFor===void 0&&o.edit.panel.appendChild(i({title:e.language.here_optimize_for,options:h,callback:(w,D)=>{o.edit.isoline_here.optimizeFor=D}})),o.edit.defaults.departureTime===void 0&&o.edit.defaults.arrivalTime===void 0){let w=e.utils.html.node`<input type="text" placeholder=${e.language.layer_filter_pick} style="text-align: end;">`;o.edit.panel.appendChild(e.utils.html.node`
                <div style="margin-top: 12px; grid-column: 1 / 3; margin-bottom: 8px;">
                <div style="display: grid; grid-template-columns: 100px 1fr; align-items: center;">
                <div style="grid-column: 1;">${l}</div>
                <div style="grid-column: 2;">${w}</div>`),e.utils.flatpickr({locale:e.hooks.current.language||null,element:w,enableTime:!0,callback:D=>{!D||(w.value=D,o.edit.isoline_here.dateISO=new Date(D).toISOString())}})}o.edit.defaults.range===void 0&&o.edit.panel.appendChild(s({title:e.language.here_travel_time,max:o.edit.isoline_here.maxMinutes,range:10,callback:w=>{o.edit.isoline_here.range=parseInt(w.target.value)}}))}function i(o){return e.utils.html.node`<div style="margin-top: 8px; grid-column: 1 / 3; align-items: center;">
            <div style="display: grid; grid-template-columns: 100px 1fr; align-items: center;">
            <div style="grid-column: 1;">${o.title}</div>
            <div style="grid-column: 2;">
            <button class="btn-drop">
            <div
                class="head"
                onclick=${l=>{l.preventDefault(),l.target.parentElement.classList.toggle("active")}}>
                <span>${Object.keys(o.options[0])}</span>
                <div class="icon"></div>
            </div>
            <ul>
                ${o.options.map(l=>e.utils.html.node`
                <li onclick=${f=>{let p=f.target.closest(".btn-drop");p.classList.toggle("active"),p.querySelector(":first-child").textContent=Object.keys(l)[0],o.callback&&o.callback(f,Object.values(l)[0])}}>${Object.keys(l)[0]}`)}`}function s(o){return e.utils.html.node`
        <div style="margin-top: 12px; grid-column: 1 / 3;">
        <span>${o.title}</span>
        <span class="bold">${o.range}</span>
        <div class="input-range">
        <input
          class="secondary-colour-bg"
          type="range"
          min=5
          value=${o.range}
          max=${o.max||30}
          step=1
          oninput=${l=>{l.target.parentNode.previousElementSibling.textContent=parseInt(l.target.value),o.callback&&o.callback(l)}}>`}};var as=e=>{return{create:t,settings:r};function r(s){if(s.edit.isoline_mapbox&&!s.edit.isoline_mapbox.geometry&&(s.edit.isoline_mapbox.minutes||!s.edit.isoline_mapbox.minutes&&s.value)||s.edit.isoline_mapbox&&s.edit.isoline_mapbox.geometry&&s.edit.isoline_mapbox.minutes&&!s.value)return;if(a(s),s.edit.isoline_mapbox&&s.edit.isoline_mapbox.geometry&&(s.edit.isoline_mapbox.minutes||!s.edit.isoline_mapbox.minutes&&s.value))return n(s),s.edit.panel;s.edit.isoline_mapbox.profile=s.edit.isoline_mapbox.profile||"driving",s.edit.isoline_mapbox._minutes=s.edit.isoline_mapbox.minutes||10;let o=[{[e.language.mapbox_driving]:"driving"},{[e.language.mapbox_walking]:"walking"},{[e.language.mapbox_cycling]:"cycling"}];s.edit.isoline_mapbox.profile="driving",s.edit.panel.appendChild(e.utils.html.node`
    <div
      style="margin-top: 8px; grid-column: 1 / 3; align-items: center;">
        <span style="grid-column: 1;">${e.language.mapbox_mode}</span>
        <div style="grid-column: 2;">
        <button class="btn-drop">
            <div
                class="head"
                onclick=${l=>{l.preventDefault(),l.target.parentElement.classList.toggle("active")}}>
                <span>${e.language.mapbox_driving}</span>
                <div class="icon"></div>
            </div>
            <ul>
                ${o.map(l=>e.utils.html.node`
                <li onclick=${f=>{let p=f.target.closest(".btn-drop");p.classList.toggle("active"),p.querySelector(":first-child").textContent=Object.keys(l)[0],s.edit.isoline_mapbox.profile=Object.values(l)[0]}}>${Object.keys(l)[0]}`)}`),s.edit.panel.appendChild(e.utils.html.node`
    <div style="margin-top: 12px; grid-column: 1 / 3;">
      <span>${e.language.mapbox_travel_time} </span>
      <span class="bold">${s.edit.isoline_mapbox._minutes}</span>
      <div class="input-range">
      <input
        class="secondary-colour-bg"
        type="range"
        min=5
        value=${s.edit.isoline_mapbox._minutes}
        max=${s.edit.isoline_mapbox.maxMinutes||30}
        step=1
        oninput=${l=>{s.edit.isoline_mapbox._minutes=parseInt(l.target.value),l.target.parentNode.previousElementSibling.textContent=s.edit.isoline_mapbox._minutes}}>`),s.container&&s.container.parentNode.insertBefore(s.edit.panel,s.container.nextSibling)}function t(s){let o=ol.proj.toLonLat(s.location.geometry.coordinates,`EPSG:${s.location.layer.srid}`),l=new XMLHttpRequest;l.open("GET",`https://api.mapbox.com/isochrone/v1/mapbox/${s.edit.isoline_mapbox.profile||"driving"}/${o.join(",")}?`+e.utils.paramString({contours_minutes:s.edit.isoline_mapbox._minutes||s.edit.isoline_mapbox.minutes,generalize:s.edit.isoline_mapbox._minutes||s.edit.isoline_mapbox.minutes,polygons:!0,access_token:s.edit.isoline_mapbox.access_token})),l.setRequestHeader("Content-Type","application/json"),l.responseType="json",l.onload=f=>{if(f.target.status!==200||!f.target.response.features)return s.location.view&&s.location.view.classList.remove("disabled"),console.log(f.target.response),alert(e.language.mapbox_error);if(s.newValue=f.target.response.features[0].geometry,s.edit.isoline_mapbox.meta){let p=new Date;s.location.infoj.filter(u=>u.type==="meta"&&u.field===s.edit.isoline_mapbox.meta).forEach(u=>u.newValue={provider:"Mapbox",[e.language.mapbox_mode]:s.edit.isoline_mapbox.profile,[e.language.mapbox_minutes]:s.edit.isoline_mapbox._minutes,[e.language.mapbox_created]:`${p.getFullYear()}/${p.getMonth()+1}/${p.getDate()} ${p.getHours()}:${p.getMinutes()>8?p.getMinutes()+1:`0${p.getMinutes()+1}`}`})}s.edit.panel&&(s.edit.panel.remove(),s.edit.panel=null,a(s)),s.location.update()},l.send(),s.location.view&&s.location.view.classList.add("disabled")}function n(s){a(s),!s.edit.edit&&(s.edit.edit=e.utils.html.node`
      <div style="
      margin-top: 8px;
      grid-column: 1 / 3;
      display: grid;
      grid-template-columns: 50px 1fr;
      align-items: center;
      ">
      <div style="grid-column: 1 / span 3;">
      <button class="btn-wide primary-colour" style="font-size: x-small;"
      onclick=${o=>{o.stopPropagation();let l=o.target;if(l.classList.contains("active"))return l.classList.remove("active"),e.mapview.interaction.edit.finish(),e.map.removeLayer(s.edit.feature);l.classList.add("active"),s.edit.feature=e.mapview.geoJSON({geometry:typeof s.value=="object"?s.value:JSON.parse(s.value),dataProjection:"4326"}),e.mapview.interaction.edit.begin({location:s.location,type:"Polygon",source:new ol.source.Vector({features:[s.edit.feature.getSource().getFeatures()[0].clone()]}),callback:()=>{l.classList.remove("active"),e.map.removeLayer(s.edit.feature)},update:()=>i(s)})}}>${e.language.layer_draw_edit}`,s.edit.panel.appendChild(s.edit.edit))}function a(s){s.edit.panel||(s.edit.panel=e.utils.html.node`
    <div
      class="${`drawer group panel expandable ${s.class||""}`}"
      style="display: grid; grid-column: 1 / 3;">
      <div
        class="header primary-colour"
        style="text-align: left; grid-column: 1 / 3;"
          onclick=${o=>{e.utils.toggleExpanderParent(o.target)}}
          ><span>${e.language.mapbox_isoline_settings}</span>
          <span class="xyz-icon btn-header icon-expander primary-colour-filter">`)}function i(s){let o=e.mapview.interaction.edit.Source.getFeatures(),l=new ol.format.GeoJSON;s.newValue=JSON.parse(l.writeFeature(o[0],{dataProjection:"EPSG:"+s.location.layer.srid,featureProjection:"EPSG:"+e.mapview.srid})).geometry,s.location.update(),e.map.removeLayer(s.edit.feature),e.mapview.interaction.edit.finish()}};var is=e=>{return{create:n,settings:r};function r(l){l.edit.defaults=Object.assign({},l.edit.isoline_tomtom),!(l.edit.isoline_tomtom&&!l.edit.isoline_tomtom.geometry&&(l.edit.isoline_tomtom.timeBudgetInSec||!l.edit.isoline_tomtom.timeBudgetInSec&&l.value))&&(l.edit.isoline_tomtom&&l.edit.isoline_tomtom.geometry&&l.edit.isoline_tomtom.timeBudgetInSec&&!l.value||(a(l),l.edit.isoline_tomtom&&l.edit.isoline_tomtom.geometry&&(l.edit.isoline_tomtom.timeBudgetInSec||!l.edit.isoline_tomtom.timeBudgetInSec&&l.value)&&i(l),l.container&&l.container.parentNode.insertBefore(l.edit.panel,l.container.nextSibling)))}function t(l){if(l.edit.defaults.departAt===void 0){let u=e.utils.html.node`<input type="text" placeholder=${e.language.layer_filter_pick} style="text-align: end;">`;l.edit.panel.appendChild(e.utils.html.node`
				<div style="margin-top: 12px; grid-column: 1 / 3;">
				<div style="display: grid; grid-template-columns: 100px 1fr; align-items: center;">
				<div style="grid-column: 1;"><span>Depart at </span></div>
				<div style="grid-column: 2;">${u}</div>`),e.utils.flatpickr({element:u,enableTime:!0,callback:h=>{u.value=h,l.edit.isoline_tomtom.departAt=new Date(h).toISOString()}})}l.edit.defaults.timeBudgetInSec===void 0&&l.edit.panel.appendChild(e.utils.html.node`
        	<div style="margin-top: 12px; grid-column: 1 / 3;">
        	<span>Time budget in minutes: </span>
        	<span class="bold">${l.edit.isoline_tomtom.timeBudgetInSec||10}</span>
        	<div class="input-range">
        	<input class="secondary-colour-bg"
        	type="range"
            min=5
            value=10
            max=${l.edit.isoline_tomtom.maxMinutes||30}
            step=1
            oninput=${u=>{l.edit.isoline_tomtom.timeBudgetInSec=60*parseInt(u.target.value),u.target.parentNode.previousElementSibling.textContent=u.target.value}}>`);let f=[{car:"car"},{truck:"truck"},{taxi:"taxi"},{bus:"bus"},{van:"van"},{motorcycle:"motorcycle"},{bicycle:"bicycle"},{pedestrian:"pedestrian"}],p=[{fastest:"fastest"},{shortest:"shortest"},{eco:"eco"},{thrilling:"thrilling"}];l.edit.defaults.traffic===void 0&&l.edit.panel.appendChild(e.utils.html.node`
        <div style="padding-top: 5px; grid-column: 1 / 3">
        <label class="input-checkbox">
        <input type="checkbox"
          .checked=${!!l.edit.isoline_tomtom.traffic}
          onchange=${u=>{l.edit.isoline_tomtom.traffic=u.target.checked}}>
        </input>
        <div></div><span>Include current traffic`),l.edit.defaults.travelMode===void 0&&l.edit.panel.appendChild(o({title:"Travel mode",options:f,callback:u=>{l.edit.isoline_tomtom.travelMode=u.target.value}})),l.edit.defaults.routeType===void 0&&l.edit.panel.appendChild(o({title:"Route type",options:p,callback:u=>{l.edit.isoline_tomtom.routeType=u.target.value}})),l.edit.defaults.vehicleMaxSpeed===void 0&&l.edit.panel.appendChild(e.utils.html.node`
        <div style="padding-top: 5px; grid-column: 1 / 3">
        <div style="display: grid; grid-template-columns: 150px 1fr; align-items: center;">
        <div style="grid-column: 1;"><span>Max Vehicle Speed </span></div>
        <div style="grid-column: 2;"><input type="number" value="${l.value||l.displayValue||""}"
        placeholder="km/h"
        onkeyup=${u=>{l.edit.isoline_tomtom.vehicleMaxSpeed=parseInt(u.target.value)}}>`)}function n(l){l.edit.isoline_tomtom.timeBudgetInSec||(l.edit.isoline_tomtom.timeBudgetInSec=60*10),l.edit.isoline_tomtom.routeType||(l.edit.isoline_tomtom.routeType="fastest"),l.edit.isoline_tomtom.travelMode||(l.edit.isoline_tomtom.travelMode="car");let f=ol.proj.toLonLat(l.location.geometry.coordinates,`EPSG:${l.location.layer.srid}`);e.proxy(`https://api.tomtom.com/routing/1/calculateReachableRange/${f[1]},${f[0]}/json?${e.utils.paramString(l.edit.isoline_tomtom)}&key={TOMTOM}`).then(p=>{if(!p.reachableRange)return console.log(p),alert("Wrong");if(l.newValue={type:"Polygon",coordinates:[p.reachableRange.boundary.map(u=>[u.longitude,u.latitude])]},l.edit.meta){let u=new Date;l.location.infoj.filter(h=>h.type==="json"&&h.field===l.edit.meta).forEach(h=>h.newValue=Object.assign({"Recent range":"TomTom",Created:`${u.getFullYear()}/${u.getMonth()+1}/${u.getDate()} ${u.getHours()}:${u.getMinutes()>8?u.getMinutes()+1:`0${u.getMinutes()+1}`}`},l.edit.isoline_tomtom))}l.edit.panel&&(l.edit.panel.remove(),l.edit.panel=null,l.edit.isoline_tomtom=Object.assign({},l.edit.defaults),a(l)),l.location.update()}),l.location.view&&l.location.view.classList.add("disabled")}function a(l){l.edit.panel||(l.edit.panel=e.utils.html.node`
		<div
		class="${`drawer group panel expandable ${l.class||""}`}"
		style="display: grid; grid-column: 1 / 3;">
		<div
		class="header primary-colour"
		style="text-align: left; grid-column: 1 / 3;"
        onclick=${f=>{e.utils.toggleExpanderParent(f.target)}}
        ><span>TomTom Settings</span>
        <span class="xyz-icon btn-header icon-expander primary-colour-filter">`,t(l))}function i(l){a(l),!l.edit.edit&&(l.edit.edit=e.utils.html.node`
    	<div style="
    	margin-top: 8px;
        grid-column: 1 / 3;
        display: grid;
        grid-template-columns: 50px 1fr;
        align-items: center;
        ">
        <div style="grid-column: 1 / span 3;">
        <button class="btn-wide primary-colour" style="font-size: x-small;"
        onclick=${f=>{f.stopPropagation();let p=f.target;if(p.classList.contains("active"))return p.classList.remove("active"),e.mapview.interaction.edit.finish(),e.map.removeLayer(l.edit.feature);p.classList.add("active"),l.edit.feature=e.mapview.geoJSON({geometry:typeof l.value=="object"?l.value:JSON.parse(l.value),dataProjection:"4326"}),e.mapview.interaction.edit.begin({location:l.location,type:"Polygon",source:new ol.source.Vector({features:[l.edit.feature.getSource().getFeatures()[0].clone()]}),callback:()=>{p.classList.remove("active"),e.map.removeLayer(l.edit.feature)},update:()=>s(l)})}}>Edit`,l.edit.panel.appendChild(l.edit.edit))}function s(l){let f=e.mapview.interaction.edit.Source.getFeatures(),p=new ol.format.GeoJSON;l.newValue=JSON.parse(p.writeFeature(f[0],{dataProjection:"EPSG:"+l.location.layer.srid,featureProjection:"EPSG:"+e.mapview.srid})).geometry,l.location.update(),e.map.removeLayer(l.edit.feature),e.mapview.interaction.edit.finish()}function o(l){return e.utils.html.node`<div style="margin-top: 8px; grid-column: 1 / 3; align-items: center;">
            <div style="display: grid; grid-template-columns: 100px 1fr; align-items: center;">
          	<div style="grid-column: 1;">${l.title}</div>
          	<div style="grid-column: 2;">
          	<button class="btn-drop">
          	<div
                class="head"
                onclick=${f=>{f.preventDefault(),f.target.parentElement.classList.toggle("active")}}>
                <span>${Object.keys(l.options[0])}</span>
                <div class="icon"></div>
            </div>
            <ul>
                ${l.options.map(f=>e.utils.html.node`
                <li onclick=${p=>{let u=p.target.closest(".btn-drop");u.classList.toggle("active"),u.querySelector(":first-child").textContent=Object.keys(f)[0],l.callback&&l.callback(p)}}>${Object.keys(f)[0]}`)}`}};var os=e=>r=>{!r.value.features||(r.value.features.map(t=>{let n;if(r.style||(n=r.location.style),r.style.theme||(n=r.style),r.style.theme&&r.style.theme.type==="categorized"&&(n=r.style.theme&&r.style.theme.cat[t.properties[r.style.theme.field]].style),r.style.theme&&r.style.theme.type==="graduated")for(let i=0;i<r.style.theme.cat_arr.length&&!(t.properties[r.style.theme.field]<r.style.theme.cat_arr[i].value);i++)n=r.style.theme.cat_arr[i].style;let a=e.mapview.geoJSON({geometry:t.geometry,dataProjection:"4326",zIndex:r.location.layer.L.getZIndex()-1,style:new ol.style.Style({stroke:n.strokeColor&&new ol.style.Stroke({color:e.utils.Chroma(n.color||n.strokeColor).alpha(1),width:r.style.strokeWidth||1}),fill:new ol.style.Fill({color:e.utils.Chroma(n.fillColor||n.strokeColor).alpha(n.fillOpacity===void 0?1:parseFloat(n.fillOpacity)||0).rgba()})})});r.location.geometryCollection.push(a)}),r.location.geometries.push(r.location.geometryCollection),r.display=!0,!(!r.style||!r.style.theme)&&(!r.style.theme.legend||(r.legend=e.utils.html.node`
      <div class="${`${r.class} legend`}">`,Object.entries(r.style.theme.cat).forEach(t=>{r.legend.appendChild(e.utils.svg.node`
        <svg height=20 width=20>
          <rect
            width=20 height=20
            fill=${t[1].style.fillColor||"#FFF"}
            fill-opacity=${t[1].style.fillOpacity}
            stroke=${t[1].style.strokeColor}
            stroke-width=${t[1].style.strokeWidth||1}>`),r.legend.appendChild(e.utils.html.node`
        <div
          class="label switch">${t[1].label||t[0]}`)}),r.container.style.display="block",r.container.appendChild(r.legend))))};var ls=e=>{return{polygon:t,circle:n,rectangle:a,freehand:i,line:s,edit:o};function r(p){if(!p.edit.panel)return p.edit.panel=e.utils.html.node`
		<div
		class="drawer group panel expandable ${p.class||""}"
		style="display: grid; grid-column: 1 / 3;">
		<div
		class="header primary-colour"
        style="text-align: left; grid-column: 1 / 3;"
        onclick=${u=>{e.utils.toggleExpanderParent(u.target)}}
        ><span>${p.name?`${e.language.layer_draw_edit} ${p.name}`:e.language.layer_draw_edit}</span>
        <span class="xyz-icon btn-header icon-expander primary-colour-filter">`,p.edit.group={},p.value?o(p):p.edit.panel}function t(p){return p.value?o(p):(r(p),p.edit.group.edit&&(p.edit.group.edit.remove(),p.edit.group.edit=null),p.edit.group.polygon=e.utils.html.node`
    		<div style="
          margin-top: 8px;
          grid-column: 1 / 3;
          display: grid;
          grid-template-columns: 50px 1fr;
          align-items: center;">
    		<div style="grid-column: 1 / span 3;">
    		<button class="btn-wide primary-colour" style="font-size: x-small;"
    		onclick=${u=>{u.stopPropagation();let h=u.target;if(h.classList.contains("active"))return e.mapview.interaction.draw.cancel();h.classList.add("active"),e.mapview.interaction.draw.begin({layer:p.location.layer,type:"Polygon",callback:()=>{h.classList.remove("active"),Object.values(p.edit.group).map(w=>{!w||(w.remove(),w=null)})},update:()=>l(p)})}}>${e.language.layer_draw_polygon}`,p.edit.panel.appendChild(p.edit.group.polygon),p.edit.panel)}function n(p){return p.value?e.utils.html.node`<div>`:(r(p),p.edit.group.edit&&(p.edit.group.edit.remove(),p.edit.group.edit=null),p.edit.group.circle=e.utils.html.node`
    	<div style="
        margin-top: 8px;
        grid-column: 1 / 3;
        display: grid;
        grid-template-columns: 50px 1fr;
        align-items: center;">
    	<div style="grid-column: 1 / span 3;">
    	<button class="btn-wide primary-colour" style="font-size: x-small;"
    	onclick=${u=>{u.stopPropagation();let h=u.target;if(h.classList.contains("active"))return e.mapview.interaction.draw.cancel();h.classList.add("active"),e.mapview.interaction.draw.begin({layer:p.location.layer,type:"Circle",geometryFunction:ol.interaction.Draw.createRegularPolygon(33),callback:()=>{h.classList.remove("active"),Object.values(p.edit.group).map(w=>{!w||(w.remove(),w=null)})},update:()=>l(p)})}}>${e.language.layer_draw_circle}`,p.edit.panel.appendChild(p.edit.group.circle),p.edit.panel)}function a(p){return p.value?o(p):(r(p),p.edit.group.edit&&(p.edit.group.edit.remove(),p.edit.group.edit=null),p.edit.group.rectangle=e.utils.html.node`
    	<div style="
        margin-top: 8px;
        grid-column: 1 / 3;
        display: grid;
        grid-template-columns: 50px 1fr;
        align-items: center;">
    	<div style="grid-column: 1 / span 3;">
    	<button class="btn-wide primary-colour" style="font-size: x-small;"
    	onclick=${u=>{u.stopPropagation();let h=u.target;if(h.classList.contains("active"))return e.mapview.interaction.draw.cancel();h.classList.add("active"),e.mapview.interaction.draw.begin({layer:p.location.layer,type:"Circle",geometryFunction:ol.interaction.Draw.createBox(),callback:()=>{h.classList.remove("active"),Object.values(p.edit.group).map(w=>{!w||(w.remove(),w=null)})},update:()=>l(p)})}}>${e.language.layer_draw_rectangle}`,p.edit.panel.appendChild(p.edit.group.rectangle),p.edit.panel)}function i(p){return p.value?e.utils.html.node`<div>`:(r(p),p.edit.group.edit&&(p.edit.group.edit.remove(),p.edit.group.edit=null),p.edit.group.freehand=e.utils.html.node`
    	<div style="
        margin-top: 8px;
        grid-column: 1 / 3;
        display: grid;
        grid-template-columns: 50px 1fr;
        align-items: center;">
    	<div style="grid-column: 1 / span 3;">
    	<button class="btn-wide primary-colour" style="font-size: x-small;"
    	onclick=${u=>{u.stopPropagation();let h=u.target;if(h.classList.contains("active"))return e.mapview.interaction.draw.cancel();h.classList.add("active"),e.mapview.interaction.draw.begin({layer:p.location.layer,type:"LineString",freehand:!0,callback:()=>{h.classList.remove("active"),Object.values(p.edit.group).map(w=>{!w||(w.remove(),w=null)})},update:()=>l(p)})}}>${e.language.layer_draw_freehand}`,p.edit.panel.appendChild(p.edit.group.freehand),p.edit.panel)}function s(p){return p.value?o(p):(r(p),p.edit.group.edit&&(p.edit.group.edit.remove(),p.edit.group.edit=null),p.edit.group.line=e.utils.html.node`
    	<div style="
        margin-top: 8px;
        grid-column: 1 / 3;
        display: grid;
        grid-template-columns: 50px 1fr;
        align-items: center;">
    	<div style="grid-column: 1 / span 3;">
    	<button class="btn-wide primary-colour" style="font-size: x-small;"
    	onclick=${u=>{u.stopPropagation();let h=u.target;if(h.classList.contains("active"))return e.mapview.interaction.draw.cancel();h.classList.add("active"),e.mapview.interaction.draw.begin({layer:p.location.layer,type:"LineString",callback:()=>{h.classList.remove("active"),Object.values(p.edit.group).map(w=>{!w||(w.remove(),w=null)})},update:()=>l(p)})}}>${e.language.layer_draw_line}`,p.edit.panel.appendChild(p.edit.group.line),p.edit.panel)}function o(p){return r(p),p.edit.group.edit||(p.edit.group.edit=e.utils.html.node`
    	    <div style="
            margin-top: 8px;
            grid-column: 1 / 3;
            display: grid;
            grid-template-columns: 50px 1fr;
            align-items: center;">
    	    <div style="grid-column: 1 / span 3;">
    	    <button class="btn-wide primary-colour" style="font-size: x-small;"
    	    onclick=${u=>{u.stopPropagation();let h=u.target;if(h.classList.contains("active"))return h.classList.remove("active"),e.mapview.interaction.edit.finish(),e.map.removeLayer(p.edit.feature);h.classList.add("active"),p.edit.feature=e.mapview.geoJSON({geometry:typeof p.value=="object"?p.value:JSON.parse(p.value),dataProjection:"4326"}),e.mapview.interaction.edit.begin({location:p.location,type:typeof p.value=="object"?p.value.type:JSON.parse(p.value).type,source:new ol.source.Vector({features:[p.edit.feature.getSource().getFeatures()[0].clone()]}),callback:()=>{h.classList.remove("active"),e.map.removeLayer(p.edit.feature)},update:()=>f(p)})}}>${e.language.layer_draw_edit}`,p.edit.panel.appendChild(p.edit.group.edit)),p.edit.panel}function l(p){let u=e.mapview.interaction.draw.Layer.getSource().getFeatures();p.newValue=JSON.parse(e.mapview.interaction.draw.format.writeFeature(u[0],{dataProjection:"EPSG:"+e.mapview.interaction.draw.layer.srid,featureProjection:"EPSG:"+e.mapview.srid})).geometry,p.location.update(),e.mapview.interaction.draw.finish()}function f(p){let u=e.mapview.interaction.edit.Source.getFeatures(),h=new ol.format.GeoJSON;p.newValue=JSON.parse(h.writeFeature(u[0],{dataProjection:"EPSG:"+p.location.layer.srid,featureProjection:"EPSG:"+e.mapview.srid})).geometry,p.location.update(),e.map.removeLayer(p.edit.feature),e.mapview.interaction.edit.finish()}};var ss=e=>{let r=ls(e),t=ns(e),n=as(e),a=is(e),i=os(e);return s;function s(u){if(u.query&&u.display)return e.query(Object.assign({layer:u.location.layer,id:u.location.id},u)).then(h=>{!h||(u.value=h[u.field],!!u.value&&(o(u),l(u)))});if(o(u),u.edit&&u.edit.isoline_mapbox&&n.settings(u),u.edit&&u.edit.isoline_here&&t.settings(u),u.edit&&u.edit.isoline_tomtom&&a.settings(u),u.edit&&u.edit.polygon&&u.container.parentNode.appendChild(r.polygon(u)),u.edit&&u.edit.rectangle&&u.container.parentNode.appendChild(r.rectangle(u)),u.edit&&u.edit.circle&&u.container.parentNode.appendChild(r.circle(u)),u.edit&&u.edit.line&&u.container.parentNode.appendChild(r.line(u)),u.edit&&u.edit.freehand&&u.container.parentNode.appendChild(r.freehand(u)),u.value&&(u.display||u.edit))return l(u);!u.value&&u.display&&p(u)}function o(u){u.style=Object.assign({},u.location?.style,u.style),u.container=u.listview.appendChild(e.utils.html.node`
      <div class="${`${u.type} ${u.class}`}">`),u.container.appendChild(e.utils.html.node`
      <label class="input-checkbox">
        <input type="checkbox"
          .checked=${u.edit&&u.value||!!u.display}
          onchange=${h=>{if(u.display=h.target.checked,u.display&&u.query)return e.query(Object.assign({layer:u.location.layer,id:u.location.id},u)).then(w=>{if(u.value=typeof w[u.field]=="string"?JSON.parse(w[u.field]):w[u.field],!u.value){alert(e.language.location_no_geometry),h.target.checked=!1;return}l(u)});if(u.display&&u.edit)return p(u,h);if(u.display&&!u.edit)return l(u);if(!u.display&&u.edit){if(u.value&&!u.edit.skipConfirm&&!confirm(e.language.location_geometry_delete_msg))return h.target.checked=!0;u.newValue=null,u.edit.edit&&(u.edit.edit.remove(),u.edit.edit=null),u.edit&&u.edit.meta&&u.location.infoj.filter(w=>w.type==="json"&&w.field===u.edit.meta).forEach(w=>w.newValue=null),u.location.update();return}if(!u.display&&!u.edit)return f(u)}}>
          </input>
          <div></div>
          <span>${u.name||"Geometry"}<span>`),!u.style.theme&&u.container.appendChild(e.utils.html.node`
      <div
        class="sample-circle"
        style="${`
          background-color: ${e.utils.Chroma(u.style.fillColor||u.style.strokeColor).alpha(u.style.fillOpacity===void 0?1:parseFloat(u.style.fillOpacity)||0)};
          border-color: ${e.utils.Chroma(u.style.color||u.style.strokeColor).alpha(1)};
          border-style: solid;
          border-width: ${u.style.strokeWidth||1}px;
          margin-left: auto;`}">`)}function l(u){u.value&&u.value.type==="FeatureCollection"?i(u):(u.geometry=u.value&&e.mapview.geoJSON({geometry:typeof u.value=="object"&&u.value||JSON.parse(u.value),dataProjection:"4326",zIndex:u.style.zIndex||u.location?.layer.L.getZIndex()-1,style:new ol.style.Style({stroke:u.style.strokeColor&&new ol.style.Stroke({color:e.utils.Chroma(u.style.color||u.style.strokeColor).alpha(1),width:u.style.strokeWidth||1,lineDash:u.style.lineDash}),fill:new ol.style.Fill({color:e.utils.Chroma(u.style.fillColor||u.style.strokeColor).alpha(u.style.fillOpacity===void 0?1:parseFloat(u.style.fillOpacity)||0).rgba()})})}),u.geometry&&u.location.geometries.push(u.geometry),u.display=!0)}function f(u){u.display=!1,u.legend&&u.legend.remove(),u.value.type==="FeatureCollection"?u.location.geometries.splice(u.location.geometries.indexOf(u.geometryCollection),1)&&u.location.geometryCollection.map(h=>e.map.removeLayer(h)):u.geometry&&u.location.geometries.splice(u.location.geometries.indexOf(u.geometry),1)&&e.map.removeLayer(u.geometry)}function p(u,h){if(!!u.edit){if(u.edit.isoline_mapbox)return n.create(u);if(u.edit.isoline_here)return t.create(u);if(u.edit.isoline_tomtom)return a.create(u);if(h)return h.target.checked=!1,u.display=h.target.checked,alert("This geometry doesn't exist. Create it first.")}}};var cs=e=>r=>{r.val.appendChild(e.utils.html.node`
  <div>
  <span>${r.edit.range.label}</span>
  <span class="bold">${r.value}</span>
  <div class="input-range">
  <input
    class="secondary-colour-bg"
    type="range"
    min=${r.edit.range.min}
    value=${r.value}
    max=${r.edit.range.max}
    oninput=${t=>{t.target.parentNode.previousElementSibling.textContent=t.target.value}}>`)};var us=e=>r=>{let t=r.edit.options.find(n=>typeof n=="object"&&Object.values(n)[0]===r.value||n===r.value)||r.value;r.displayValue=t&&typeof t=="object"&&Object.keys(t)[0]||t||r.value,r.val.appendChild(e.utils.html.node`
      <button class="btn-drop">
      <div
      class="head"
      onclick=${n=>{n.preventDefault(),n.target.parentElement.classList.toggle("active")}}>
      <span>${r.displayValue}</span>
      <div class="icon"></div>
      </div>
      <ul>
      ${r.edit.options.map(n=>{let a=n,i=n;return typeof n=="object"&&(a=Object.keys(n)[0],i=Object.values(n)[0]),e.utils.html.node`<li onclick=${s=>{let o=s.target.closest(".btn-drop");o.classList.toggle("active"),o.querySelector(":first-child").textContent=a,o.querySelector(":first-child").value=i,r.location.view.dispatchEvent(new CustomEvent("valChange",{detail:{input:o.querySelector(":first-child"),entry:r}}))}}>${a}`})}`)};var ds=e=>r=>{let n=e.utils.html.node`<input type="text" placeholder=${e.language.layer_filter_pick} style="text-align: end;">${r.type==="datetime"&&e.utils.formatDateTime(r.value)||e.utils.formatDate(r.value)||""}`.childNodes[0];n.value=r.type==="datetime"&&e.utils.formatDateTime(r.value)||e.utils.formatDate(r.value)||"",r.val.appendChild(n),e.utils.flatpickr({value:r.value?new Date(r.value*1e3).toISOString():"",element:n,enableTime:r.type==="datetime",callback:a=>{n.value=a;let i=e.utils.meltDateStr(a);r.location.view.dispatchEvent(new CustomEvent("valChange",{detail:{input:n,entry:r,newValue:i}}))}})};var ps=e=>r=>r.val.appendChild(e.utils.html.node`
    <textarea
      style="auto; min-height: 50px;"
      onfocus=${t=>{t.target.style.height=t.target.scrollHeight+"px"}}
      onfocusout=${t=>{t.target.style.height="auto"}}
      onkeyup=${t=>{r.location.view.dispatchEvent(new CustomEvent("valChange",{detail:{input:t.target,entry:r}}))}}
      onkeydown=${t=>setTimeout(()=>{t.target.style.height="auto",t.target.style.height=t.target.scrollHeight+"px"},100)}>
      ${r.value||""}`);var fs=e=>{let r={input:t,range:cs(e),date:ds(e),options:us(e),textarea:ps(e)};return r;function t(n){if(!!n.edit){if(n.type==="date"||n.type==="datetime")return r.date(n);if(n.edit.range)return r.range(n);if(n.edit.options)return r.options(n);if(n.type==="textarea"||n.type==="html")return r.textarea(n);n.val.appendChild(e.utils.html.node`
    <input
      type="${(n.type==="numeric"||n.type==="integer")&&"number"||"text"}"
      value="${n.value||n.displayValue||""}"
      onkeyup=${a=>{n.location.view.dispatchEvent(new CustomEvent("valChange",{detail:{input:a.target,entry:n}}))}}>`)}}};var gs=e=>r=>{if(r.dependents&&r.dependents.some(t=>r.location.infoj.some(n=>!n.value&&n.field===t))&&delete r.display,r.layer=typeof r.layer=="object"&&r.layer||typeof r.layer=="string"&&e.layers.list[r.layer]||r.location.layer,r.target==="location"||r.dataview&&r.dataview.classList.contains("location"))return r.dataview?(r.update(),r.dataview):(r.target=e.utils.html.node`
      <div
        class="${`location ${r.class}`}"
        style="${`${r.style||""}`}">`,e.dataviews.create(r),r.dataview);if(typeof r.target=="string"&&document.getElementById(r.target)){r.target=document.getElementById(r.target),e.dataviews.create(r);return}if(e.tabview.node)return r.tab_style=`border-bottom: 2px solid ${r.location.style.strokeColor}`,e.tabview.add(r),e.dataviews.create(r),r.display&&r.show(),e.utils.html.node`
      <label
        class="${`input-checkbox mobile-disabled ${r.class}`}">
        <input
          type="checkbox"
          .checked=${!!r.display}
          onchange=${t=>{r.display=t.target.checked,r.display?r.show():r.remove()}}></input>
        <div></div>
        <span>${r.title||"Dataview"}`};var hs=e=>r=>{if(!r.value)return;r.value=typeof r.value=="object"?r.value:JSON.parse(r.value);let t=e.utils.html.node`
	<div 
    style="grid-column: 1 / 3;
      width: 100%;
      padding: 4px;
      margin-top: 2px;
      color: #666;
      border-radius: 4px;
      background-color: linen;
      max-height: 200px;
      overflow-y: scroll;
      font-size: small;">`,n=e.utils.html.node`
      <span
        style="display: none; font-size: smaller; color: red;">${e.language.location_json_edit_msg}`,a=JSON.stringify(r.value,null,2),i=r.edit?e.utils.html.node`<pre><code><textarea 
    style="background-color:linen; color: rgb(102, 102, 102); font-size: small;"
    rows=10
    oninput=${s=>{r._valid=(()=>{if(!s.target.value)return!0;try{return JSON.parse(s.target.value),!0}catch(o){return!1}})(),r._valid?n.style.display="none":n.style.display="block"}}
    onkeyup=${s=>{!r._valid||r.location.view.dispatchEvent(new CustomEvent("valChange",{detail:{input:s.target,entry:r}}))}}>${a}`:e.utils.html.node`<pre><code>${a}`;t.appendChild(i),r.edit&&t.appendChild(n),r.listview.appendChild(t)};var ms=e=>{return{create:r,infoj:Kl(e),streetview:Ql(e),images:zl(e),documents:es(e),geometry:ss(e),edit:fs(e),boolean:rs(e),report:ts(e),dataview:gs(e),json:hs(e)};function r(t){t.view&&t.view.remove(),t.view=e.utils.html.node`<div class="drawer location-view expandable expanded">`;let n=t.view.appendChild(e.utils.html.node`
      <div
        class = "header"
        style = "${"border-bottom: 2px solid "+t.style.strokeColor}"
        onclick = ${o=>{o.preventDefault(),e.utils.toggleExpanderParent(o.target,!0)}}>
        <div>${String.fromCharCode(65+e.locations.list.indexOf(t.record))}`);t.infoj&&n.appendChild(e.utils.html.node`
      <button
        style = "${"filter: "+t.colorFilter+"; -webkit-filter: "+t.colorFilter}"
        title = ${e.language.location_drawer_toggle}
        class = "btn-header xyz-icon icon-expander "
        onclick = ${o=>{o.stopPropagation(),e.utils.toggleExpanderParent(o.target)}}>`),n.appendChild(e.utils.html.node`
      <button
        style = "${"filter: "+t.colorFilter+"; -webkit-filter: "+t.colorFilter}"
        title = ${e.language.location_zoom}
        class = "btn-header xyz-icon icon-search"
        onclick = ${o=>{o.stopPropagation(),t.flyTo()}}>`);let a=n.appendChild(e.utils.html.node`
      <button
        style = "${"display: none; filter: "+t.colorFilter+"; -webkit-filter: "+t.colorFilter}"
        title = ${e.language.location_save}
        class = "btn-header xyz-icon icon-cloud-upload"
        onclick = ${o=>{o.stopPropagation(),t.update()}}>`);if(t.layer.edit&&t.layer.edit.geometry&&n.appendChild(e.utils.html.node`
      <button
        style = "${"filter: "+t.colorFilter+"; -webkit-filter: "+t.colorFilter}"
        title = ${e.language.location_edit_geometry}
        class = "btn-header xyz-icon icon-build"
        onclick = ${o=>{if(o.stopPropagation(),n.classList.contains("edited"))return e.mapview.interaction.edit.finish();n.classList.add("edited","secondary-colour-bg"),e.mapview.interaction.edit.begin({location:t,type:"LineString",callback:()=>{n.classList.remove("edited","secondary-colour-bg")}})}}>`),t.layer.edit&&t.layer.edit.delete&&n.appendChild(e.utils.html.node`
      <button
        style = "${"filter: "+t.colorFilter+"; -webkit-filter: "+t.colorFilter}"
        title = ${e.language.location_delete}
        class = "btn-header xyz-icon icon-trash"
        onclick = ${o=>{o.stopPropagation(),t.trash()}}>`),n.appendChild(e.utils.html.node`
    <button
      style = "${"filter: "+t.colorFilter+"; -webkit-filter: "+t.colorFilter}"
      title = ${e.language.location_hide_marker}
      class = "btn-header xyz-icon icon-location-tick" 
      onclick = ${o=>{o.stopPropagation(),o.target.classList.toggle("icon-location"),o.target.classList.toggle("icon-location-tick"),o.target.classList.contains("icon-location")?e.map.removeLayer(t.Marker):e.map.addLayer(t.Marker)}}>`),n.appendChild(e.utils.html.node`
    <button
      style = "${"filter: "+t.colorFilter+"; -webkit-filter: "+t.colorFilter}"
      title = ${e.language.location_remove}
      class = "btn-header xyz-icon icon-close"
      onclick = ${o=>{o.stopPropagation(),t.remove(),e.map.updateSize()}}>`),t.view.addEventListener("valChange",o=>{let l=typeof o.detail.newValue=="undefined"&&o.detail.input.value||o.detail.newValue;o.detail.entry.value!=l?(o.detail.entry.newValue=l,o.detail.input.classList.add("primary-colour")):(delete o.detail.entry.newValue,o.detail.input.classList.remove("primary-colour")),a.style.display=o.detail.entry.location.infoj.some(f=>typeof f.newValue!="undefined")&&"inline-block"||"none"}),!t.infoj)return;let i;t.view.addEventListener("updateInfo",s),s();function s(){i&&i.remove(),t.view.classList.remove("disabled"),i=e.locations.view.infoj(t),t.view.appendChild(i)}}};var vs=e=>{return{init:r};function r(t){e.locations.listview.node=t.target,e.locations.listview.node.addEventListener("passover",()=>{setTimeout(()=>{if(e.locations.listview.node.children.length>1)return;let n=e.locations.listview.node.closest(".tab");n.style.display="none",n.previousElementSibling.click()},300)}),e.locations.listview.add=n=>{!e.locations.listview.node||(Object.values(e.locations.listview.node.children).forEach(a=>a.classList.remove("expanded")),e.locations.listview.node.insertBefore(n.view,e.locations.listview.node.firstChild),e.locations.listview.node.appendChild(n.view),e.locations.listview.node.closest(".tab").style.display="block",e.locations.listview.node.closest(".tab").click())},e.locations.list=[["#4227b0","invert(19%) sepia(57%) saturate(4245%) hue-rotate(247deg) brightness(76%) contrast(101%)"],["#2196f3","invert(60%) sepia(94%) saturate(3876%) hue-rotate(184deg) brightness(98%) contrast(94%)"],["#009688","invert(37%) sepia(46%) saturate(1993%) hue-rotate(144deg) brightness(96%) contrast(101%)"],["#cddc39","invert(84%) sepia(82%) saturate(420%) hue-rotate(6deg) brightness(88%) contrast(94%)"],["#ff9800","invert(59%) sepia(90%) saturate(1526%) hue-rotate(358deg) brightness(99%) contrast(106%)"],["#673ab7","invert(23%) sepia(26%) saturate(6371%) hue-rotate(251deg) brightness(87%) contrast(87%)"],["#03a9f4","invert(65%) sepia(61%) saturate(5963%) hue-rotate(168deg) brightness(101%) contrast(103%)"],["#4caf50","invert(65%) sepia(8%) saturate(3683%) hue-rotate(73deg) brightness(92%) contrast(69%)"],["#ffeb3b","invert(75%) sepia(76%) saturate(391%) hue-rotate(2deg) brightness(104%) contrast(109%)"],["#ff5722","invert(47%) sepia(96%) saturate(3254%) hue-rotate(346deg) brightness(100%) contrast(102%)"],["#0d47a1","invert(15%) sepia(99%) saturate(2827%) hue-rotate(213deg) brightness(87%) contrast(90%)"],["#00bcd4","invert(60%) sepia(39%) saturate(2788%) hue-rotate(144deg) brightness(93%) contrast(102%)"],["#8bc34a","invert(87%) sepia(8%) saturate(3064%) hue-rotate(35deg) brightness(85%) contrast(85%)"],["#ffc107","invert(79%) sepia(86%) saturate(3969%) hue-rotate(346deg) brightness(98%) contrast(111%)"],["#d32f2f","invert(28%) sepia(94%) saturate(3492%) hue-rotate(345deg) brightness(85%) contrast(92%)"]].map(n=>({style:{strokeColor:n[0]},colorFilter:n[1]}))}};var bs=e=>function(){let r=this;r.Layer=e.mapview.geoJSON({geometry:r.geometry,zIndex:1999,style:[new ol.style.Style({stroke:new ol.style.Stroke({color:"rgba(255, 255, 255, 0.2)",width:8})}),new ol.style.Style({stroke:new ol.style.Stroke({color:"rgba(255, 255, 255, 0.2)",width:6})}),new ol.style.Style({stroke:new ol.style.Stroke({color:"rgba(255, 255, 255, 0.2)",width:4})}),new ol.style.Style({stroke:r.style.strokeColor&&new ol.style.Stroke({color:r.style.strokeColor,width:r.style.strokeWidth||1}),fill:r.style.fillColor&&new ol.style.Fill({color:e.utils.Chroma(r.style.fillColor).alpha(r.style.fillOpacity===void 0?1:parseFloat(r.style.fillOpacity)||0).rgba()})})],dataProjection:r.layer.srid,featureProjection:e.mapview.srid})};var ws=e=>function(){let r=this;e.hooks&&e.hooks.filter("locations",r.hook),e.mapview.interaction.edit.finish&&e.mapview.interaction.edit.finish(),r.view&&(r.view.parentElement&&r.view.parentElement.dispatchEvent(new Event("passover")),r.view.remove()),r.tabs&&r.tabs.forEach(t=>t.remove()),r.geometries.forEach(t=>e.map.removeLayer(t)),r.geometryCollection.forEach(t=>e.map.removeLayer(t)),r.Layer&&e.map.removeLayer(r.Layer),r.Marker&&e.map.removeLayer(r.Marker),typeof r.removeCallback=="function"&&r.removeCallback(),r.removeCallbacks.forEach(t=>typeof t=="function"&&t()),r.record.location=null};var _s=e=>function(){if(!e.map)return;let r=this,t=new ol.source.Vector;r.Layer&&t.addFeatures(r.Layer.getSource().getFeatures()),r.Marker&&t.addFeatures(r.Marker.getSource().getFeatures()),r.geometries.forEach(n=>{n.length?n.forEach(a=>t.addFeatures(a.getSource().getFeatures())):t.addFeatures(n.getSource().getFeatures())}),e.mapview.flyToBounds(t.getExtent())};var ys=e=>function(r){let t=this,n={};if(t.infoj.filter(i=>typeof i.newValue!="undefined").forEach(i=>{i.type==="integer"&&(i.newValue=isNaN(parseInt(i.newValue))?null:i.newValue),i.type==="numeric"&&(i.newValue=isNaN(parseFloat(i.newValue))?null:i.newValue),i.type==="json"&&(i.newValue=i.newValue||null),Object.assign(n,{[i.field]:i.newValue})}),!Object.keys(n).length)return;t.view&&t.view.classList.add("disabled");let a=new XMLHttpRequest;a.open("POST",e.host+"/api/location/update?"+e.utils.paramString({locale:e.locale.key,layer:t.layer.key,table:t.table,id:t.id})),a.setRequestHeader("Content-Type","application/json"),a.responseType="json",a.onload=i=>{if(i.target.status!==200)return console.error(i.target.response);let s=t.infoj.filter(o=>typeof o.newValue!="undefined").filter(o=>o.dependents&&o.dependents.length).map(o=>o.dependents).flat();if(t.infoj.filter(o=>typeof o.newValue!="undefined").forEach(o=>{o.value=o.newValue,delete o.newValue}),s.length){let o=[...new Set(s)],l=new XMLHttpRequest;l.open("GET",e.host+"/api/location/get?"+e.utils.paramString({locale:e.locale.key,layer:t.layer.key,table:t.table,id:t.id,fields:o.join()})),l.setRequestHeader("Content-Type","application/json"),l.responseType="json",l.onload=f=>{t.infoj.filter(p=>typeof f.target.response[p.field]!="undefined").forEach(p=>{p.value=f.target.response[p.field]}),t.view&&t.view.dispatchEvent(new Event("updateInfo")),t.layer.reload(),r&&r()},l.send();return}t.view&&t.view.dispatchEvent(new Event("updateInfo")),t.layer.reload(),r&&r()},a.send(JSON.stringify(n))};var ks=e=>function(){let r=this,t=new XMLHttpRequest;t.open("GET",e.host+"/api/location/delete?"+e.utils.paramString({locale:e.locale.key,layer:r.layer.key,table:r.table,id:r.id})),t.onload=n=>{n.target.status===200&&(r.layer.reload(),r.remove())},confirm("Are you sure you want to delete this feature? This cannot be undone.")&&t.send()};var Cs=e=>{return{decorate:t,plugins:{},list:[{style:{strokeColor:"#9c27b0"},colorFilter:"invert(22%) sepia(80%) saturate(1933%) hue-rotate(272deg) brightness(97%) contrast(104%)"}],listview:vs(e),view:ms(e),select:Zl(e),selectCallback:Xl(e)};function t(n,a={}){Object.assign(n,{remove:ws(e),trash:ks(e),flyTo:_s(e),update:ys(e),draw:bs(e),geometries:[],tables:[],tabs:new Set,geometryCollection:[],removeCallbacks:[],style:Object.assign({strokeColor:"#1F964D"},n.style||{})},a)}};var Es=e=>r=>new Promise((t,n)=>{let a=new XMLHttpRequest,i=r.viewport&&e.map&&e.mapview.getBounds(),s=r.center&&e.map&&ol.proj.transform(e.map.getView().getCenter(),`EPSG:${e.mapview.srid}`,"EPSG:4326");a.open("GET",e.host+"/api/query?"+e.utils.paramString(Object.assign({template:encodeURIComponent(r.query),dbs:r.dbs,layer:typeof r.layer=="string"&&r.layer||r.layer&&r.layer.key,filter:r.filter??r?.layer?.filter?.current,locale:r.layer&&e.locale.key,id:r.location&&r.location.id,lat:r.lat||s&&s[1],lng:r.lng||s&&s[0],z:r.z&&e.map&&e.map.getView().getZoom(),viewport:i&&[i.west,i.south,i.east,i.north,e.mapview.srid]},r.queryparams||{}))),a.setRequestHeader("Content-Type","application/json"),a.responseType="json",a.onload=o=>{if(o.target.status>=300)return n({err:o.target.status});t(o.target.response)},a.send()});var Ss=e=>r=>new Promise((t,n)=>{let a=new XMLHttpRequest;a.open(r.method||"GET",r.url),a.setRequestHeader("Content-Type",r.content_type||"application/json"),a.responseType=r.responseType||"json",a.onload=i=>{if(i.target.status>=300)return n({err:i.target.status});t(i.target.response)},a.send(r.body)});var $s=e=>r=>new Promise((t,n)=>{let a=new XMLHttpRequest;a.open("GET",`${e.host}/api/proxy?url=${encodeURIComponent(r)}`),a.setRequestHeader("Content-Type","application/json"),a.responseType="json",a.onload=i=>{if(i.target.status>=300)return n({err:i.target.status});t(i.target.response)},a.send()});var js=e=>()=>new Promise(r=>{let t=Object.entries(e.locale.plugins||{}).map(n=>new Promise((a,i)=>{let s=document.createElement("script");s.type="application/javascript",s.src=n[1];let o;s.onload=()=>{setTimeout(()=>{!o&&console.error(`${n[1]} event not triggered`),document.removeEventListener(n[0],l,!0),s.remove(),a()},400)},s.onerror=()=>{document.removeEventListener(n[0],l,!0),s.remove(),i()},document.addEventListener(n[0],l,!0),document.head.append(s);function l(f){o=!0,f.detail(e)}}));Promise.all(t).then(r).catch(r)});var Ts=e=>{return{create:r,plugins:{}};function r(i){if(!i.dataview){if(i.dataview=typeof i.target=="string"&&document.getElementById(i.target),i.dataview=i.target instanceof HTMLElement&&i.target||e.utils.html.node`<div class="${`${i.class||""}`}" style="${i.style||""}">`,i.panel instanceof HTMLElement&&i.panel.appendChild(i.dataview),i.dataviews){i.dataview.classList.add("dataview-container");for(let s of i.dataviews)s.tab=i.tab,s.layer=s.layer||i.layer,s.location=s.location||i.location,s.panel=i.dataview,r(s);return}if(i.dataview.classList.add("dataview"),t(i),i.target=i.dataview.appendChild(e.utils.html.node`
      <div class="target">`),i.target.style.height=i.toolbar&&"calc(100% - 25px)",i.update=()=>{!i.query||e.query(i).then(s=>{i.setData(s)})},i.tab&&i.tab.addEventListener("activate",i.update),i.mapChange&&e.mapview.node.addEventListener("changeEnd",()=>{i.layer&&!i.layer.display||i.tab&&!i.tab.classList.contains("active")||i.update()}),i.chart&&n(i),i.columns&&a(i),i.data)return i.setData(i.data);!i.tab&&i.update()}}function t(i){typeof i.toolbar=="object"&&(i.toolbar.node=i.dataview.appendChild(e.utils.html.node`
      <div class="toolbar">`),i.toolbar.viewport&&i.toolbar.node.appendChild(e.utils.html.node`
        <button
          class="off-white-hover primary-colour"
          onclick=${s=>{s.target.classList.toggle("primary-colour"),i.viewport=!i.viewport,i.update()}}>Viewport`),i.toolbar.download_csv&&i.toolbar.node.appendChild(e.utils.html.node`
        <button
          class="off-white-hover primary-colour"
          onclick=${()=>{i.Tabulator.download("csv",`${i.title||"table"}.csv`)}}>CSV`),i.toolbar.download_json&&i.toolbar.node.appendChild(e.utils.html.node`
        <button
          class="off-white-hover primary-colour"
          onclick=${()=>{i.Tabulator.download("json",`${i.title||"table"}.json`)}}>JSON`))}function n(i){i.target.style.position="relative";let s=i.target.appendChild(e.utils.html.node`<canvas>`);i.chart.height&&s.setAttribute("height",i.chart.height),i.chart.width&&s.setAttribute("width",i.chart.width),i.chart.ChartJS=new Chart(s,{type:i.chart.type||"bar",options:i.chart.options}),i.setData=o=>{if(!o){if(i.dataview.classList.contains("location")){i.target.innerHTML="";return}i.target.innerHTML=`<div style="text-align:center;"><small>${e.language.dataview_no_data}</small></div>`;return}if(i.data=o,i.chart.responseFunction&&i.chart.responseFunction(o),!(o.datasets&&o.datasets.length&&o.datasets.some(f=>!f.data||f.data.some(p=>p!==null))))return i.target.style.display="none";i.chart.datasets&&i.chart.datasets.length&&o.datasets.forEach((f,p)=>Object.assign(f,i.chart.datasets[p])),i.chart.ChartJS.data={labels:typeof i.chart.labels=="function"&&i.chart.labels(o)||o.labels||i.chart.labels,datasets:o.datasets},i.target.style.display="block",i.chart.ChartJS.update()}}function a(i){i.fixed_header&&(i.target.style.display="grid",i.target.style.position="absolute"),i.target=i.target.appendChild(e.utils.html.node`<div>`),function s(o){o.forEach(l=>{l.plugin&&(l.formatter=e.dataviews.plugins[l.plugin]),l.columns&&s(l.columns)})}(i.columns),i.target.style.visibility="hidden",i.Tabulator=new Tabulator(i.target,Object.assign({invalidOptionWarnings:!1,tooltipsHeader:!0,columnHeaderVertAlign:"center",layout:i.layout||"fitDataFill",autoColumns:i.autoColumns||!1,height:"auto",rowFormatter:s=>{if(s.getData().backgroundcolour){let o=s.getElement();o.style.backgroundColor=s.getData().backgroundcolour}},selectable:!1,rowClick:(s,o)=>{let l=o.getData();!i.layer||!l[i.qID||"id"]||(e.locations.select({locale:e.locale.key,layer:l.layer||i.layer,table:l.table||i.table,id:l[i.qID||"id"]}),o.deselect())}},i)),i.setData=s=>{!s||(i.data=s,i.responseFunction&&i.responseFunction(s),i.Tabulator.setData(s.length&&s||[s]),i.target.style.visibility="visible")}}};var Ls=e=>{let r={init:t,search:n,sources:{glx:s,mapbox:o,google:l,opencage:f},select:i,createFeature:a,icon:{type:"markerColor",colorMarker:"#64dd17",colorDot:"#33691e",anchor:[.5,1],scale:2}};return r;function t(p){!p||(Object.assign(r,p),r.result=r.group.querySelector("ul"),r.input=r.group.querySelector("input"),r.input.placeholder=e.locale.gazetteer.placeholder||"",r.input.addEventListener("keyup",u=>{!new Set([37,38,39,40,13]).has(u.keyCode||u.charCode)&&u.target.value.length>0&&r.search(u.target.value)}),r.input.addEventListener("keydown",u=>{let h=u.keyCode||u.charCode;if(h===46||h===8){r.xhr&&r.xhr.abort(),r.clear(),r.layer&&e.map.removeLayer(r.layer);return}if(h===13){let w=u.target.value.split(",").map(parseFloat);w[1]>-90&&w[1]<90&&w[0]>-180&&w[0]<180&&(r.xhr&&r.xhr.abort(),r.clear(),r.createFeature({type:"Point",coordinates:[w[1],w[0]]})),r.result.querySelector("li").click()}}),r.input.addEventListener("focusout",()=>{r.xhr&&r.xhr.abort(),setTimeout(r.clear,400)}),r.clear=()=>{r.group.classList.remove("active"),r.result.innerHTML=""})}function n(p,u={}){r.clear&&r.clear(),r.xhr&&r.xhr.abort(),r.xhr=new XMLHttpRequest,r.xhr.open("GET",e.host+"/api/gazetteer?"+e.utils.paramString({locale:e.locale.key,q:encodeURIComponent(p),source:u.source})),r.xhr.setRequestHeader("Content-Type","application/json"),r.xhr.responseType="json",r.xhr.onload=h=>{if(h.target.status===200){if(u.callback)return u.callback(h.target.response);if(h.target.response.length===0)return r.result.appendChild(e.utils.html.node`
        <li>${e.language.search_no_results}`),r.group.classList.add("active");Object.values(h.target.response).forEach(w=>{r.result.appendChild(e.utils.html.node`
        <li style="cursor:pointer;" onclick=${D=>{if(D.preventDefault(),!w.source||!w.id){if(r.callback)return r.callback(w);w.marker&&r.createFeature({type:"Point",coordinates:w.marker.split(",")});return}r.select({label:w.label,id:w.id,source:w.source,layer:w.layer,table:w.table,marker:w.marker,callback:u.callback})}}>
        ${e.locale.gazetteer.label?e.utils.html.node`
          <span class="secondary-colour-bg" 
          style="font-size: smaller; padding: 0 2px 0 2px; cursor: help; border-radius: 2px;"
          >${e.layers.list[w.layer]&&e.layers.list[w.layer].name||w.layer||w.source}</span>`:""}
          <span>${w.label}</span>
        `),r.group.classList.add("active")})}},r.xhr.send()}function a(p){p=typeof p=="string"?JSON.parse(p):p,r.layer&&e.map.removeLayer(r.layer),r.layer=e.mapview.geoJSON({geometry:p,dataProjection:"4326",style:new ol.style.Style({image:e.mapview.icon(r.icon)})}),e.mapview.flyToBounds(r.layer.getSource().getExtent())}function i(p){r.clear&&r.clear(),r.input&&(r.input.value=p.label),r.sources[p.source](p)}function s(p){if(r.callback)return r.callback(p);e.locations.select({locale:e.locale.key,layer:e.layers.list[p.layer],table:p.table,id:p.id,_flyTo:!0}),p.callback&&p.callback()}function o(p){r.createFeature({type:"Point",coordinates:p.marker}),p.callback&&p.callback()}function l(p){e.proxy(`https://maps.googleapis.com/maps/api/place/details/json?placeid=${p.id}&{GOOGLE}`).then(u=>{let h={type:"Point",coordinates:[u.result.geometry.location.lng,u.result.geometry.location.lat]};if(r.createFeature(h),r.callback)return r.callback(h);p.callback&&p.callback(h)})}function f(p){r.createFeature({type:"Point",coordinates:p.marker}),p.callback&&p.callback()}};function Ms(e={}){let r=Object.assign({version:"3.5.2",defaults:{colours:[{hex:"#c62828",name:"Fire Engine Red"},{hex:"#f50057",name:"Folly"},{hex:"#9c27b0",name:"Dark Orchid"},{hex:"#673ab7",name:"Plump Purple"},{hex:"#3f51b5",name:"Violet Blue"},{hex:"#2196f3",name:"Dodger Blue"},{hex:"#03a9f4",name:"Vivid Cerulean"},{hex:"#00bcd4",name:"Turquoise Surf"},{hex:"#009688",name:"Dark Cyan"},{hex:"#4caf50",name:"Middle Green"},{hex:"#8bc34a",name:"Dollar Bill"},{hex:"#cddc39",name:"Pear"},{hex:"#ffeb3b",name:"Banana Yellow"},{hex:"#ffb300",name:"UCLA Gold"},{hex:"#fb8c00",name:"Dark Orange"},{hex:"#f4511e",name:"Orioles Orange"},{hex:"#8d6e63",name:"Dark Chestnut"},{hex:"#777777",name:"Sonic Silver"},{hex:"#bdbdbd",name:"X11 Gray"},{hex:"#aaaaaa",name:"Dark Medium Gray"},{hex:"#78909c",name:"Light Slate Gray"}]},locale:{},utils:ba},e);return r.workspace=Ro(r),r.hooks=Ho(r),r.language=Object.assign(wa,r.hooks&&r.hooks.current&&r.hooks.current.language&&zr[r.hooks.current.language]||e.language&&zr[e.language]||{}),r.mapview=typeof ol!="undefined"&&dl(r),r.tabview=pl(r),r.layers=Jl(r),r.locations=Cs(r),r.gazetteer=Ls(r),r.query=Es(r),r.xhr=Ss(r),r.proxy=$s(r),r.dataviews=Ts(r),r.plugins=js(r),e.callback&&wb(r),r}window._xyz=Ms;var _b=Ms;function wb(e){if(!e.locale)return console.log("No locale defined for callback");e.workspace.get.locale({locale:e.locale}).then(r=>{e.locale=r,e.callback(e)})}export{_b as default};
/*!
 * a-color-picker
 * https://github.com/narsenico/a-color-picker
 *
 * Copyright (c) 2017-2019, Gianfranco Caldi.
 * Released under the MIT License.
 */
/*!
 * a-color-picker (https://github.com/narsenico/a-color-picker)
 * 
 * Copyright (c) 2017-2018, Gianfranco Caldi.
 * Released under the MIT License.
 */
/*!
* is-plain-object <https://github.com/jonschlinkert/is-plain-object>
*
* Copyright (c) 2014-2017, Jon Schlinkert.
* Released under the MIT License.
*/
/*!
* isobject <https://github.com/jonschlinkert/isobject>
*
* Copyright (c) 2014-2017, Jon Schlinkert.
* Released under the MIT License.
*/
/*! (c) Andrea Giammarchi - ISC */
/**
 * chroma.js - JavaScript library for color conversions
 *
 * Copyright (c) 2011-2019, Gregor Aisch
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice, this
 * list of conditions and the following disclaimer.
 *
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 * this list of conditions and the following disclaimer in the documentation
 * and/or other materials provided with the distribution.
 *
 * 3. The name Gregor Aisch may not be used to endorse or promote products
 * derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL GREGOR AISCH OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * -------------------------------------------------------
 *
 * chroma.js includes colors from colorbrewer2.org, which are released under
 * the following license:
 *
 * Copyright (c) 2002 Cynthia Brewer, Mark Harrower,
 * and The Pennsylvania State University.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
 * either express or implied. See the License for the specific
 * language governing permissions and limitations under the License.
 *
 * ------------------------------------------------------
 *
 * Named colors are taken from X11 Color Names.
 * http://www.w3.org/TR/css3-color/#svg-color
 *
 * @preserve
 */
//# sourceMappingURL=mapp.js.map
