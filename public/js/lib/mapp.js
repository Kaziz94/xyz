var ua=e=>Object.entries(e).filter(r=>r[1]===0||!!r[1]).filter(r=>r[1]!=="{}").filter(r=>typeof r[1]!="object"||r[1].length||Object.values(r[1]).some(t=>typeof t=="object"&&Object.keys(t).length)).map(r=>(typeof r[1]=="object"&&!r[1].length&&(r[1]=JSON.stringify(r[1])),encodeURI(`${r[0]}=${r[1]}`))).join("&");var fa=e=>new Promise((r,t)=>{Promise.all(e).then(r).catch(o=>{console.error(o),t(o)})});var Xr=new Map,da=e=>new Promise((r,t)=>{if(!e)return t();if(e=typeof e=="string"?{url:e}:e,!e.no_cache&&Xr.has(e))return r(Xr.get(e));let o=new XMLHttpRequest;o.open(e.method||"GET",e.url),o.setRequestHeader("Content-Type",e.content_type||"application/json"),o.responseType=e.responseType||"json",o.onload=l=>{if(l.target.status>=300)return t({err:l.target.status});Xr.set(e,l.target.response),r(l.target.response)},o.send(e.body)});var pa=e=>{if(e.svg&&!e.legend)return e.svg;let r={dot:Yr(e),target:ss(e),triangle:cs(e),square:us(e),semiCircle:ds(e),markerLetter:ps(e),markerColor:hs(e),geo:_s(),circle:gs(e),diamond:fs(e)};function t(o){let l=`height: ${o.cluster?40:24}px; width: ${o.cluster?40:24}px; position: relative;`,s=mapp.utils.html.node`<div style="${l}">`;function u(p){let _=`position:absolute; height:${p.cluster?40:20}px; width:${p.cluster?40:20}px;`;return p.svg?s.appendChild(mapp.utils.html.node`<img style="${_}" src="${p.svg}"/>`):p.type?s.appendChild(mapp.utils.html.node`<img style="${_}" src="${r[p.type]}"/>`):s.appendChild(mapp.utils.html.node`<img style="${_}" src="${Yr({color:"#666"})}"/>`)}return o.layers&&Array.isArray(o.layers)?o.layers.map(p=>u(p)):u(o),s}return e.legend?t(e):e.type?r[e.type]:Yr({color:"#666"})},ue=new XMLSerializer;function Yr(e){let r=mapp.utils.svg.node`
    <svg width=24 height=24 viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'>
      <circle cx=13 cy=13 r=10 fill='#333'></circle>
      <circle cx=12 cy=12 r=10 fill=${e.fillColor||"#fff"}></circle>`;return`data:image/svg+xml,${encodeURIComponent(ue.serializeToString(r))}`}function ss(e){let r=mapp.utils.svg.node`
  <svg width=24 height=24 viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'>
    <circle cx=13 cy=13 fill='#333' r=10 opacity=0.4></circle>
    <circle cx=12 cy=12 r=10 fill=${e.fillColor||"#FFF"}>`;return e.layers&&Object.entries(e.layers).forEach(t=>{r.appendChild(mapp.utils.svg.node`<circle cx=12 cy=12 r=${parseFloat(t[0])*10} fill=${t[1]}>`)}),`data:image/svg+xml,${encodeURIComponent(ue.serializeToString(r))}`}function cs(e){let r=mapp.utils.svg.node`
  <svg width=24 height=24 viewBox='${"0 0 24 24"}' xmlns='http://www.w3.org/2000/svg'>
  <polygon points="12,4.68 2,22 22,22" 
  fill="#333" stroke="#333" opacity=0.4 stroke-opacity=0.4 stroke-width=3
  stroke-linejoin="round"/>`;return r.appendChild(mapp.utils.svg.node`<polygon
    fill=${e.fillColor||"#FFF"} stroke=${e.fillColor||"#FFF"} stroke-width=2
    points="12,4.68 2,22 22,22"  stroke-linejoin="round"/>`),e.layers&&Object.entries(e.layers).forEach(t=>{function o(u,p){return 12+(u-12)*p}function l(u,p){return 16+(u-16)*p}let s=`${o(12,t[0])},${l(4.68,t[0])} ${o(2,t[0])}, ${l(22,t[0])} ${o(22,t[0])}, ${l(22,t[0])}`;r.appendChild(mapp.utils.svg.node`<polygon
    fill=${t[1]} stroke=${t[1]||"#FFF"} stroke-width=1
    points="${s}" stroke-linejoin="round"/>`)}),`data:image/svg+xml,${encodeURIComponent(ue.serializeToString(r))}`}function us(e){let r=mapp.utils.svg.node`
  <svg width=24 height=24 viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'>
    <rect fill='#333' opacity=0.3 width=20 height=20 x=2 y=2 rx=1></rect>
    <rect fill=${e.fillColor||"#FFF"} width=20 height=20 x=0 y=0 rx=1></rect>`;return e.layers&&Object.entries(e.layers).forEach(t=>{r.appendChild(mapp.utils.svg.node`<rect fill=${t[1]}
      width=${parseFloat(t[0])*20}
      height=${parseFloat(t[0])*20}
      x=${10*(1-parseFloat(t[0]))}
      y=${10*(1-parseFloat(t[0]))} rx=${parseFloat(t[0])}></rect>`)}),`data:image/svg+xml,${encodeURIComponent(ue.serializeToString(r))}`}function fs(e){let r=mapp.utils.svg.node`
  <svg width=24 height=24 viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'>
  <polygon fill='#333' opacity=0.3
    points="12 0, 24 12, 12 24, 0 12"
    ></polygon>
    <polygon fill=${e.fillColor||"#FFF"}
    points="12 0, 24 12, 12 24, 0 12"
    ></polygon>`;function t(o,l){return 12+(o-12)*l}return e.layers&&Object.entries(e.layers).forEach(o=>{let l=`${t(12,o[0])} ${t(0,o[0])},${t(24,o[0])} ${t(12,o[0])},${t(12,o[0])} ${t(24,o[0])}, ${t(0,o[0])} ${t(12,o[0])}`;r.appendChild(mapp.utils.svg.node`
      <polygon fill=${o[1]||"#FFF"}
      points="${l}"
      ></polygon>`)}),`data:image/svg+xml,${encodeURIComponent(ue.serializeToString(r))}`}function ds(e){let r=mapp.utils.svg.node`
  <svg width=30 height=30 viewBox='0 0 20 24' xmlns='http://www.w3.org/2000/svg'>
    <defs>
      <clipPath id="cut-off-shade">
        <rect x="0" y="0" width="24" height="11"/>
      </clipPath>
      <clipPath id="cut-off">
        <rect x="0" y="0" width="24" height="10"/>
      </clipPath>
    </defs>
    <circle cx="11" cy="10" r="10" clip-path="url(#cut-off-shade)" fill="#333" opacity=0.4></circle>
    <circle cx=10 cy=10 r=10 fill=${e.fillColor||"#FFF"} clip-path="url(#cut-off-shade)">`;return e.layers&&Object.entries(e.layers).forEach(t=>{r.appendChild(mapp.utils.svg.node`
    <circle cx=10 cy=10 r=${parseFloat(t[0])*10} fill=${t[1]} clip-path="url(#cut-off-shade)">`)}),`data:image/svg+xml,${encodeURIComponent(ue.serializeToString(r))}`}function ps(e){let r=mapp.utils.svg.node`
  <svg width=24 height=24 viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'>
    <path style="opacity: 0.5;" fill=${e.colorMarker}
      d=" M 12.692 1.969 C 8.605 1.969 5.334 5.239 5.334 9.328 C 5.334 10.963 5.743 12.189 6.764 14.028 C 8.808 17.504 11.922 21.996 11.922 21.996 C 11.922 21.996 16.576 17.504 18.62 14.028 C 19.642 12.189 20.051 10.963 20.051 9.328 C 20.051 5.239 16.78 1.969 12.692 1.969 Z "/>
    <path fill=${e.color}
      d=" M 12 1.969 C 7.878 1.969 4.813 5.239 4.813 9.328 C 4.813 10.554 5.222 12.189 6.244 14.028 C 8.289 17.504 12 22 12 22 C 12 22 16.055 17.504 18.099 14.028 C 19.122 12.189 19.341 10.963 19.341 9.328 C 19.341 5.239 16.054 1.969 12 1.969 Z "/>
    <circle cx="12.17192400568182" cy="8.918683238636365" r="5.109789772727275" opacity=0.8 fill="rgb(255, 255, 255)"/>
    <text x=12 y=12 style="text-anchor: middle; font-weight: 600; font-size: 10px; font-family: sans-serif; fill: rgb(85, 85, 85);">
    ${e.letter}`;return`data:image/svg+xml,${encodeURIComponent(ue.serializeToString(r))}`}function hs(e){let r=mapp.utils.svg.node`
  <svg width=18 height=24 viewBox='0 0 24 18' xmlns='http://www.w3.org/2000/svg'>
    <path style="opacity: 0.5;" fill=${e.colorMarker}
      d="M 10.797 1.238 C 6.308 1.238 2.716 4.83 2.716 9.32 C 2.716 11.116 3.165 12.463 4.287 14.483 C 6.532 18.3 9.952 23.234 9.952 23.234 C 9.952 23.234 15.063 18.3 17.308 14.483 C 18.43 12.463 18.879 11.116 18.879 9.32 C 18.879 4.83 15.287 1.238 10.797 1.238 Z"/>
    <path fill=${e.colorMarker}
      d="M 10 1.238 C 5.51 1.238 2.144 4.83 2.144 9.32 C 2.144 10.667 2.593 12.463 3.716 14.483 C 5.961 18.3 10 23.238 10 23.238 C 10 23.238 14.491 18.3 16.736 14.483 C 17.859 12.463 18.1 11.116 18.1 9.32 C 18.1 4.83 14.49 1.238 10 1.238 Z"/>
    <circle cx=10.226 cy=8.871 r=5.612 opacity=0.8 fill="rgb(255, 255, 255)"/>
    <circle cx=10.226 cy=8.871 r=2.806 opacity=0.8 fill=${e.colorDot}/>`;return`data:image/svg+xml,${encodeURIComponent(ue.serializeToString(r))}`}function _s(){let e=mapp.utils.svg.node`
  <svg width=1000 height=1000 viewBox='0 0 1000 1000' xmlns='http://www.w3.org/2000/svg'>
    <circle cx=500 cy=500 r=350 stroke='#1F964D' opacity=0.8 stroke-width=75 fill=none></circle>
    <circle cx=500 cy=500 r=200 fill='#1F964D' opacity=0.8></circle>
    <path stroke='#1F964D' opacity=0.8 stroke-width=75 d="M500,150L500,0M500,850L500,1000M0,500L150,500M850,500L1000,500" />`;return`data:image/svg+xml,${encodeURIComponent(ue.serializeToString(e))}`}function gs(e){let r=mapp.utils.svg.node`
  <svg width=24 height=24 viewBox='0 0 30 30' xmlns='http://www.w3.org/2000/svg'>
    <circle cx=16 cy=16 r=10
      stroke="#333"
      stroke-width="${e.strokeWidth||1}"
      fill="none"></circle>
    <circle cx=15 cy=15 r=10
      stroke="${e.strokeColor||"#333"}"
      stroke-width="${e.strokeWidth||1}"
      fill="${e.fillColor||"none"}"></circle>`;return`data:image/svg+xml,${encodeURIComponent(ue.serializeToString(r))}`}var Qr=new Map,ha=e=>{let r=e.scale||1;delete e.scale;let t=JSON.stringify(e);return Qr.has(t)?e.url=Qr.get(t):(e.url=pa(e),Qr.set(t,e.url)),new ol.style.Icon({src:e.url,scale:r,anchor:e.anchor||[.5,.5]})};var _a=e=>()=>new Promise(r=>{let t=Object.entries(e.locale.plugins||{}).map(o=>new Promise((l,s)=>{let u=document.createElement("script");u.type="application/javascript",u.src=o[1];let p;u.onload=()=>{setTimeout(()=>{!p&&console.error(`${o[1]} event not triggered`),document.removeEventListener(o[0],_,!0),u.remove(),l()},400)},u.onerror=()=>{document.removeEventListener(o[0],_,!0),u.remove(),s()},document.addEventListener(o[0],_,!0),document.head.append(u);function _(m){p=!0,m.detail(e)}}));Promise.all(t).then(r).catch(r)});function ga(e){if(e.indexOf(";base64,")==-1){let s=e.split(","),u=s[0].split(":")[1],p=s[1];return new Blob([p],{type:u})}let r=e.split(";base64,"),t=r[0].split(":")[1],o=window.atob(r[1]),l=new Uint8Array(o.length);for(let s=0;s<o.length;++s)l[s]=o.charCodeAt(s);return new Blob([l],{type:t})}var va=()=>{let e=new WeakSet;return(r,t)=>{if(typeof t=="object"&&t!==null){if(e.has(t))return;e.add(t)}return t}};var vs=[62,-1,-1,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,63,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],ms=1;var le=typeof BigInt!="undefined"?BigInt:Number;function ma(e){let r=ys(e),t=bs(r[0],r[1]),o=10**t.precision,l=10**t.thirdDimPrecision,{thirdDim:s}=t,u=0,p=0,_=0,m=[],w=2;for(;w<r.length;){let b=et(r[w])/o,y=et(r[w+1])/o;u+=b,p+=y,s?(_+=et(r[w+2])/l,m.push([u,p,_]),w+=3):(m.push([u,p]),w+=2)}if(w!==r.length)throw new Error("Invalid encoding. Premature ending reached");return{...t,polyline:m}}function ws(e){let r=e.charCodeAt(0);return vs[r-45]}function ys(e){let r=le(0),t=le(0),o=[];if(e.split("").forEach(l=>{let s=le(ws(l));r|=(s&le(31))<<t,(s&le(32))===le(0)?(o.push(r),r=le(0),t=le(0)):t+=le(5)}),t>0)throw new Error("Invalid encoding");return o}function bs(e,r){if(+e.toString()!==ms)throw new Error("Invalid format version");let t=+r.toString(),o=t&15,l=t>>4&7,s=t>>7&15;return{precision:o,thirdDim:l,thirdDimPrecision:s}}function et(e){let r=e;return r&le(1)&&(r=~r),r>>=le(1),+r.toString()}var rt=e=>({get:r=>e.get(r),set:(r,t)=>(e.set(r,t),t)}),ya=/([^\s\\>"'=]+)\s*=\s*(['"]?)$/,xs=/^(?:area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)$/i,ks=/<[a-z][^>]+$/i,js=/>[^<>]*$/,Cs=/<([a-z]+[a-z0-9:._-]*)([^>]*?)(\/>)/ig,Ts=/\s+$/,ba=(e,r)=>0<r--&&(ks.test(e[r])||!js.test(e[r])&&ba(e,r)),Ms=(e,r,t)=>xs.test(r)?e:`<${r}${t.replace(Ts,"")}></${r}>`,Ss=(e,r,t)=>{let o=[],{length:l}=e;for(let u=1;u<l;u++){let p=e[u-1];o.push(ya.test(p)&&ba(e,u)?p.replace(ya,(_,m,w)=>`${r}${u-1}=${w||'"'}${m}${w?"":'"'}`):`${p}<!--${r}${u-1}-->`)}o.push(e[l-1]);let s=o.join("").trim();return t?s:s.replace(Cs,Ms)},{isArray:tt}=Array,{indexOf:Os,slice:wa}=[],$s=1,xa=111,Ps=({firstChild:e,lastChild:r})=>{let t=document.createRange();return t.setStartAfter(e),t.setEndAfter(r),t.deleteContents(),e},Es=(e,r)=>e.nodeType===xa?1/r<0?r?Ps(e):e.lastChild:r?e.valueOf():e.firstChild:e,zs=e=>{let{childNodes:r}=e,{length:t}=r;if(t<2)return t?r[0]:e;let o=wa.call(r,0),l=o[0],s=o[t-1];return{ELEMENT_NODE:$s,nodeType:xa,firstChild:l,lastChild:s,valueOf(){if(r.length!==t){let u=0;for(;u<t;)e.appendChild(o[u++])}return e}}},As=(e,r,t,o,l)=>{let s=t.length,u=r.length,p=s,_=0,m=0,w=null;for(;_<u||m<p;)if(u===_){let b=p<s?m?o(t[m-1],-0).nextSibling:o(t[p-m],0):l;for(;m<p;)e.insertBefore(o(t[m++],1),b)}else if(p===m)for(;_<u;)(!w||!w.has(r[_]))&&e.removeChild(o(r[_],-1)),_++;else if(r[_]===t[m])_++,m++;else if(r[u-1]===t[p-1])u--,p--;else if(r[_]===t[p-1]&&t[m]===r[u-1]){let b=o(r[--u],-1).nextSibling;e.insertBefore(o(t[m++],1),o(r[_++],-1).nextSibling),e.insertBefore(o(t[--p],1),b),r[u]=t[p]}else{if(!w){w=new Map;let b=m;for(;b<p;)w.set(t[b],b++)}if(w.has(r[_])){let b=w.get(r[_]);if(m<b&&b<p){let y=_,k=1;for(;++y<u&&y<p&&w.get(r[y])===b+k;)k++;if(k>b-m){let H=o(r[_],0);for(;m<b;)e.insertBefore(o(t[m++],1),H)}else e.replaceChild(o(t[m++],1),o(r[_++],-1))}else _++}else e.removeChild(o(r[_++],-1))}return t},Ls=e=>r=>{for(let t in r){let o=t==="role"?t:`aria-${t}`,l=r[t];l==null?e.removeAttribute(o):e.setAttribute(o,l)}},Fs=(e,r)=>{let t,o=!0,l=document.createAttributeNS(null,r);return s=>{t!==s&&(t=s,t==null?o||(e.removeAttributeNode(l),o=!0):(l.value=s,o&&(e.setAttributeNodeNS(l),o=!1)))}},Is=(e,r,t)=>o=>{t!==!!o&&((t=!!o)?e.setAttribute(r,""):e.removeAttribute(r))},Ns=({dataset:e})=>r=>{for(let t in r){let o=r[t];o==null?delete e[t]:e[t]=o}},Rs=(e,r)=>{let t,o=r.slice(2);return!(r in e)&&r.toLowerCase()in e&&(o=o.toLowerCase()),l=>{let s=tt(l)?l:[l,!1];t!==s[0]&&(t&&e.removeEventListener(o,t,s[1]),(t=s[0])&&e.addEventListener(o,t,s[1]))}},Gs=e=>r=>{typeof r=="function"?r(e):r.current=e},Ds=(e,r)=>r==="dataset"?Ns(e):t=>{e[r]=t},qs=e=>{let r;return t=>{r!=t&&(r=t,e.textContent=t??"")}};var ka=function(e){var r="fragment",t="template",o="content"in u(t),l=o?function(_){var m=u(t);return m.innerHTML=_,m.content}:function(_){var m=u(r),w=u(t),b=null;if(/^[^\S]*?<(col(?:group)?|t(?:head|body|foot|r|d|h))/i.test(_)){var y=RegExp.$1;w.innerHTML="<table>"+_+"</table>",b=w.querySelectorAll(y)}else w.innerHTML=_,b=w.childNodes;return s(m,b),m};return function(m,w){return(w==="svg"?p:l)(m)};function s(_,m){for(var w=m.length;w--;)_.appendChild(m[0])}function u(_){return _===r?e.createDocumentFragment():e.createElementNS("http://www.w3.org/1999/xhtml",_)}function p(_){var m=u(r),w=u("div");return w.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+_+"</svg>",s(m,w.firstChild.childNodes),m}}(document),Bs=({childNodes:e},r)=>e[r],at=e=>{let r=[],{parentNode:t}=e;for(;t;)r.push(Os.call(t.childNodes,e)),e=t,t=e.parentNode;return r},{createTreeWalker:ja,importNode:nt}=document,Ca=nt.length!=1,Us=Ca?(e,r,t)=>nt.call(document,ka(e,r,t),!0):ka,Hs=Ca?e=>ja.call(document,e,1|128,null,!1):e=>ja.call(document,e,1|128),Ve=(e,r,t)=>As(e.parentNode,r,t,Es,e),Zs=e=>{let r,t,o=[],l=s=>{switch(typeof s){case"string":case"number":case"boolean":r!==s&&(r=s,t||(t=document.createTextNode("")),t.nodeValue=s,o=Ve(e,o,[t]));break;case"object":case"undefined":if(s==null){r!=s&&(r=s,o=Ve(e,o,[]));break}if(tt(s)){r=s,s.length===0?o=Ve(e,o,[]):typeof s[0]=="object"?o=Ve(e,o,s):l(String(s));break}"ELEMENT_NODE"in s&&r!==s&&(r=s,o=Ve(e,o,s.nodeType===11?wa.call(s.childNodes):[s]));break;case"function":l(s(e));break}};return l},Ws=(e,r)=>{switch(r[0]){case"?":return Is(e,r.slice(1),!1);case".":return Ds(e,r.slice(1));case"o":if(r[1]==="n")return Rs(e,r)}switch(r){case"ref":return Gs(e);case"aria":return Ls(e)}return Fs(e,r)};function Vs(e){let{type:r,path:t}=e,o=t.reduceRight(Bs,this);return r==="node"?Zs(o):r==="attr"?Ws(o,e.name):qs(o)}var Je="isµ",Ta=rt(new WeakMap),Js=/^(?:plaintext|script|style|textarea|title|xmp)$/i,Ke=()=>({stack:[],entry:null,wire:null}),Xs=(e,r)=>{let{content:t,updates:o}=Ks(e,r);return{type:e,template:r,content:t,updates:o,wire:null}},Ys=(e,r)=>{let t=Ss(r,Je,e==="svg"),o=Us(t,e),l=Hs(o),s=[],u=r.length-1,p=0,_=`${Je}${p}`;for(;p<u;){let m=l.nextNode();if(!m)throw`bad template: ${t}`;if(m.nodeType===8)m.nodeValue===_&&(s.push({type:"node",path:at(m)}),_=`${Je}${++p}`);else{for(;m.hasAttribute(_);)s.push({type:"attr",path:at(m),name:m.getAttribute(_)}),m.removeAttribute(_),_=`${Je}${++p}`;Js.test(m.tagName)&&m.textContent.trim()===`<!--${_}-->`&&(m.textContent="",s.push({type:"text",path:at(m)}),_=`${Je}${++p}`)}}return{content:o,nodes:s}},Ks=(e,r)=>{let{content:t,nodes:o}=Ta.get(r)||Ta.set(r,Ys(e,r)),l=nt.call(document,t,!0),s=o.map(Vs,l);return{content:l,updates:s}},fr=(e,{type:r,template:t,values:o})=>{let{length:l}=o;Ma(e,o,l);let{entry:s}=e;(!s||s.template!==t||s.type!==r)&&(e.entry=s=Xs(r,t));let{content:u,updates:p,wire:_}=s;for(let m=0;m<l;m++)p[m](o[m]);return _||(s.wire=zs(u))},Ma=({stack:e},r,t)=>{for(let o=0;o<t;o++){let l=r[o];l instanceof ot?r[o]=fr(e[o]||(e[o]=Ke()),l):tt(l)?Ma(e[o]||(e[o]=Ke()),l,l.length):e[o]=null}t<e.length&&e.splice(t)};function ot(e,r,t){this.type=e,this.template=r,this.values=t}var{create:Qs,defineProperties:ec}=Object,Sa=e=>{let r=rt(new WeakMap),t=o=>(l,...s)=>fr(o,{type:e,template:l,values:s});return ec((o,...l)=>new ot(e,o,l),{for:{value(o,l){let s=r.get(o)||r.set(o,Qs(null));return s[l]||(s[l]=t(Ke()))}},node:{value:(o,...l)=>fr(Ke(),{type:e,template:o,values:l}).valueOf()}})},Oa=rt(new WeakMap),$a=(e,r)=>{let t=typeof r=="function"?r():r,o=Oa.get(e)||Oa.set(e,Ke()),l=t instanceof ot?fr(o,t):t;return l!==o.wire&&(o.wire=l,e.textContent="",e.appendChild(l.valueOf())),e},Pa=Sa("html"),Ea=Sa("svg");var xe=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Ie(e,r,t){return t={path:r,exports:{},require:function(o,l){return rc(o,l??t.path)}},e(t,t.exports),t.exports}function rc(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var tc=Ie(function(e,r){(function(t,o){e.exports=o()})(xe,function(){for(var t=function(a,n,i){return n===void 0&&(n=0),i===void 0&&(i=1),a<n?n:a>i?i:a},o=function(a){a._clipped=!1,a._unclipped=a.slice(0);for(var n=0;n<=3;n++)n<3?((a[n]<0||a[n]>255)&&(a._clipped=!0),a[n]=t(a[n],0,255)):n===3&&(a[n]=t(a[n],0,1));return a},l={},s=0,u=["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"];s<u.length;s+=1){var p=u[s];l["[object "+p+"]"]=p.toLowerCase()}var _=function(a){return l[Object.prototype.toString.call(a)]||"object"},m=function(a,n){return n===void 0&&(n=null),a.length>=3?Array.prototype.slice.call(a):_(a[0])=="object"&&n?n.split("").filter(function(i){return a[0][i]!==void 0}).map(function(i){return a[0][i]}):a[0]},w=function(a){if(a.length<2)return null;var n=a.length-1;return _(a[n])=="string"?a[n].toLowerCase():null},b=Math.PI,y={clip_rgb:o,limit:t,type:_,unpack:m,last:w,PI:b,TWOPI:b*2,PITHIRD:b/3,DEG2RAD:b/180,RAD2DEG:180/b},k={format:{},autodetect:[]},H=y.last,K=y.clip_rgb,W=y.type,A=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];var c=this;if(W(n[0])==="object"&&n[0].constructor&&n[0].constructor===this.constructor)return n[0];var d=H(n),h=!1;if(!d){h=!0,k.sorted||(k.autodetect=k.autodetect.sort(function(C,j){return j.p-C.p}),k.sorted=!0);for(var f=0,g=k.autodetect;f<g.length;f+=1){var v=g[f];if(d=v.test.apply(v,n),d)break}}if(k.format[d]){var x=k.format[d].apply(null,h?n:n.slice(0,-1));c._rgb=K(x)}else throw new Error("unknown format: "+n);c._rgb.length===3&&c._rgb.push(1)};A.prototype.toString=function(){return W(this.hex)=="function"?this.hex():"["+this._rgb.join(",")+"]"};var M=A,G=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];return new(Function.prototype.bind.apply(G.Color,[null].concat(a)))};G.Color=M,G.version="2.1.0";var O=G,ce=y.unpack,Mt=Math.max,po=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];var i=ce(a,"rgb"),c=i[0],d=i[1],h=i[2];c=c/255,d=d/255,h=h/255;var f=1-Mt(c,Mt(d,h)),g=f<1?1/(1-f):0,v=(1-c-f)*g,x=(1-d-f)*g,C=(1-h-f)*g;return[v,x,C,f]},ho=po,_o=y.unpack,go=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];a=_o(a,"cmyk");var i=a[0],c=a[1],d=a[2],h=a[3],f=a.length>4?a[4]:1;return h===1?[0,0,0,f]:[i>=1?0:255*(1-i)*(1-h),c>=1?0:255*(1-c)*(1-h),d>=1?0:255*(1-d)*(1-h),f]},vo=go,mo=y.unpack,yo=y.type;M.prototype.cmyk=function(){return ho(this._rgb)},O.cmyk=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];return new(Function.prototype.bind.apply(M,[null].concat(a,["cmyk"])))},k.format.cmyk=vo,k.autodetect.push({p:2,test:function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];if(a=mo(a,"cmyk"),yo(a)==="array"&&a.length===4)return"cmyk"}});var bo=y.unpack,wo=y.last,Mr=function(a){return Math.round(a*100)/100},xo=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];var i=bo(a,"hsla"),c=wo(a)||"lsa";return i[0]=Mr(i[0]||0),i[1]=Mr(i[1]*100)+"%",i[2]=Mr(i[2]*100)+"%",c==="hsla"||i.length>3&&i[3]<1?(i[3]=i.length>3?i[3]:1,c="hsla"):i.length=3,c+"("+i.join(",")+")"},ko=xo,jo=y.unpack,Co=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];a=jo(a,"rgba");var i=a[0],c=a[1],d=a[2];i/=255,c/=255,d/=255;var h=Math.min(i,c,d),f=Math.max(i,c,d),g=(f+h)/2,v,x;return f===h?(v=0,x=Number.NaN):v=g<.5?(f-h)/(f+h):(f-h)/(2-f-h),i==f?x=(c-d)/(f-h):c==f?x=2+(d-i)/(f-h):d==f&&(x=4+(i-c)/(f-h)),x*=60,x<0&&(x+=360),a.length>3&&a[3]!==void 0?[x,v,g,a[3]]:[x,v,g]},St=Co,To=y.unpack,Mo=y.last,Sr=Math.round,So=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];var i=To(a,"rgba"),c=Mo(a)||"rgb";return c.substr(0,3)=="hsl"?ko(St(i),c):(i[0]=Sr(i[0]),i[1]=Sr(i[1]),i[2]=Sr(i[2]),(c==="rgba"||i.length>3&&i[3]<1)&&(i[3]=i.length>3?i[3]:1,c="rgba"),c+"("+i.slice(0,c==="rgb"?3:4).join(",")+")")},Oo=So,$o=y.unpack,Or=Math.round,Po=function(){for(var a,n=[],i=arguments.length;i--;)n[i]=arguments[i];n=$o(n,"hsl");var c=n[0],d=n[1],h=n[2],f,g,v;if(d===0)f=g=v=h*255;else{var x=[0,0,0],C=[0,0,0],j=h<.5?h*(1+d):h+d-h*d,$=2*h-j,S=c/360;x[0]=S+1/3,x[1]=S,x[2]=S-1/3;for(var E=0;E<3;E++)x[E]<0&&(x[E]+=1),x[E]>1&&(x[E]-=1),6*x[E]<1?C[E]=$+(j-$)*6*x[E]:2*x[E]<1?C[E]=j:3*x[E]<2?C[E]=$+(j-$)*(2/3-x[E])*6:C[E]=$;a=[Or(C[0]*255),Or(C[1]*255),Or(C[2]*255)],f=a[0],g=a[1],v=a[2]}return n.length>3?[f,g,v,n[3]]:[f,g,v,1]},$r=Po,Ot=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,$t=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,Pt=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,Et=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,zt=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,At=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,Lt=Math.round,Ft=function(a){a=a.toLowerCase().trim();var n;if(k.format.named)try{return k.format.named(a)}catch(E){}if(n=a.match(Ot)){for(var i=n.slice(1,4),c=0;c<3;c++)i[c]=+i[c];return i[3]=1,i}if(n=a.match($t)){for(var d=n.slice(1,5),h=0;h<4;h++)d[h]=+d[h];return d}if(n=a.match(Pt)){for(var f=n.slice(1,4),g=0;g<3;g++)f[g]=Lt(f[g]*2.55);return f[3]=1,f}if(n=a.match(Et)){for(var v=n.slice(1,5),x=0;x<3;x++)v[x]=Lt(v[x]*2.55);return v[3]=+v[3],v}if(n=a.match(zt)){var C=n.slice(1,4);C[1]*=.01,C[2]*=.01;var j=$r(C);return j[3]=1,j}if(n=a.match(At)){var $=n.slice(1,4);$[1]*=.01,$[2]*=.01;var S=$r($);return S[3]=+n[4],S}};Ft.test=function(a){return Ot.test(a)||$t.test(a)||Pt.test(a)||Et.test(a)||zt.test(a)||At.test(a)};var It=Ft,Eo=y.type;M.prototype.css=function(a){return Oo(this._rgb,a)},O.css=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];return new(Function.prototype.bind.apply(M,[null].concat(a,["css"])))},k.format.css=It,k.autodetect.push({p:5,test:function(a){for(var n=[],i=arguments.length-1;i-- >0;)n[i]=arguments[i+1];if(!n.length&&Eo(a)==="string"&&It.test(a))return"css"}});var zo=y.unpack;k.format.gl=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];var i=zo(a,"rgba");return i[0]*=255,i[1]*=255,i[2]*=255,i},O.gl=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];return new(Function.prototype.bind.apply(M,[null].concat(a,["gl"])))},M.prototype.gl=function(){var a=this._rgb;return[a[0]/255,a[1]/255,a[2]/255,a[3]]};var Ao=y.unpack,Lo=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];var i=Ao(a,"rgb"),c=i[0],d=i[1],h=i[2],f=Math.min(c,d,h),g=Math.max(c,d,h),v=g-f,x=v*100/255,C=f/(255-v)*100,j;return v===0?j=Number.NaN:(c===g&&(j=(d-h)/v),d===g&&(j=2+(h-c)/v),h===g&&(j=4+(c-d)/v),j*=60,j<0&&(j+=360)),[j,x,C]},Fo=Lo,Io=y.unpack,No=Math.floor,Ro=function(){for(var a,n,i,c,d,h,f=[],g=arguments.length;g--;)f[g]=arguments[g];f=Io(f,"hcg");var v=f[0],x=f[1],C=f[2],j,$,S;C=C*255;var E=x*255;if(x===0)j=$=S=C;else{v===360&&(v=0),v>360&&(v-=360),v<0&&(v+=360),v/=60;var F=No(v),z=v-F,R=C*(1-x),B=R+E*(1-z),Q=R+E*z,ee=R+E;switch(F){case 0:a=[ee,Q,R],j=a[0],$=a[1],S=a[2];break;case 1:n=[B,ee,R],j=n[0],$=n[1],S=n[2];break;case 2:i=[R,ee,Q],j=i[0],$=i[1],S=i[2];break;case 3:c=[R,B,ee],j=c[0],$=c[1],S=c[2];break;case 4:d=[Q,R,ee],j=d[0],$=d[1],S=d[2];break;case 5:h=[ee,R,B],j=h[0],$=h[1],S=h[2];break}}return[j,$,S,f.length>3?f[3]:1]},Go=Ro,Do=y.unpack,qo=y.type;M.prototype.hcg=function(){return Fo(this._rgb)},O.hcg=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];return new(Function.prototype.bind.apply(M,[null].concat(a,["hcg"])))},k.format.hcg=Go,k.autodetect.push({p:1,test:function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];if(a=Do(a,"hcg"),qo(a)==="array"&&a.length===3)return"hcg"}});var Bo=y.unpack,Uo=y.last,or=Math.round,Ho=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];var i=Bo(a,"rgba"),c=i[0],d=i[1],h=i[2],f=i[3],g=Uo(a)||"auto";f===void 0&&(f=1),g==="auto"&&(g=f<1?"rgba":"rgb"),c=or(c),d=or(d),h=or(h);var v=c<<16|d<<8|h,x="000000"+v.toString(16);x=x.substr(x.length-6);var C="0"+or(f*255).toString(16);switch(C=C.substr(C.length-2),g.toLowerCase()){case"rgba":return"#"+x+C;case"argb":return"#"+C+x;default:return"#"+x}},Nt=Ho,Zo=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,Wo=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,Vo=function(a){if(a.match(Zo)){(a.length===4||a.length===7)&&(a=a.substr(1)),a.length===3&&(a=a.split(""),a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]);var n=parseInt(a,16),i=n>>16,c=n>>8&255,d=n&255;return[i,c,d,1]}if(a.match(Wo)){(a.length===5||a.length===9)&&(a=a.substr(1)),a.length===4&&(a=a.split(""),a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]+a[3]+a[3]);var h=parseInt(a,16),f=h>>24&255,g=h>>16&255,v=h>>8&255,x=Math.round((h&255)/255*100)/100;return[f,g,v,x]}throw new Error("unknown hex color: "+a)},Rt=Vo,Jo=y.type;M.prototype.hex=function(a){return Nt(this._rgb,a)},O.hex=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];return new(Function.prototype.bind.apply(M,[null].concat(a,["hex"])))},k.format.hex=Rt,k.autodetect.push({p:4,test:function(a){for(var n=[],i=arguments.length-1;i-- >0;)n[i]=arguments[i+1];if(!n.length&&Jo(a)==="string"&&[3,4,5,6,7,8,9].indexOf(a.length)>=0)return"hex"}});var Ko=y.unpack,Gt=y.TWOPI,Xo=Math.min,Yo=Math.sqrt,Qo=Math.acos,ei=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];var i=Ko(a,"rgb"),c=i[0],d=i[1],h=i[2];c/=255,d/=255,h/=255;var f,g=Xo(c,d,h),v=(c+d+h)/3,x=v>0?1-g/v:0;return x===0?f=NaN:(f=(c-d+(c-h))/2,f/=Yo((c-d)*(c-d)+(c-h)*(d-h)),f=Qo(f),h>d&&(f=Gt-f),f/=Gt),[f*360,x,v]},ri=ei,ti=y.unpack,Pr=y.limit,Pe=y.TWOPI,Er=y.PITHIRD,Ee=Math.cos,ai=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];a=ti(a,"hsi");var i=a[0],c=a[1],d=a[2],h,f,g;return isNaN(i)&&(i=0),isNaN(c)&&(c=0),i>360&&(i-=360),i<0&&(i+=360),i/=360,i<1/3?(g=(1-c)/3,h=(1+c*Ee(Pe*i)/Ee(Er-Pe*i))/3,f=1-(g+h)):i<2/3?(i-=1/3,h=(1-c)/3,f=(1+c*Ee(Pe*i)/Ee(Er-Pe*i))/3,g=1-(h+f)):(i-=2/3,f=(1-c)/3,g=(1+c*Ee(Pe*i)/Ee(Er-Pe*i))/3,h=1-(f+g)),h=Pr(d*h*3),f=Pr(d*f*3),g=Pr(d*g*3),[h*255,f*255,g*255,a.length>3?a[3]:1]},ni=ai,oi=y.unpack,ii=y.type;M.prototype.hsi=function(){return ri(this._rgb)},O.hsi=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];return new(Function.prototype.bind.apply(M,[null].concat(a,["hsi"])))},k.format.hsi=ni,k.autodetect.push({p:2,test:function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];if(a=oi(a,"hsi"),ii(a)==="array"&&a.length===3)return"hsi"}});var li=y.unpack,si=y.type;M.prototype.hsl=function(){return St(this._rgb)},O.hsl=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];return new(Function.prototype.bind.apply(M,[null].concat(a,["hsl"])))},k.format.hsl=$r,k.autodetect.push({p:2,test:function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];if(a=li(a,"hsl"),si(a)==="array"&&a.length===3)return"hsl"}});var ci=y.unpack,ui=Math.min,fi=Math.max,di=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];a=ci(a,"rgb");var i=a[0],c=a[1],d=a[2],h=ui(i,c,d),f=fi(i,c,d),g=f-h,v,x,C;return C=f/255,f===0?(v=Number.NaN,x=0):(x=g/f,i===f&&(v=(c-d)/g),c===f&&(v=2+(d-i)/g),d===f&&(v=4+(i-c)/g),v*=60,v<0&&(v+=360)),[v,x,C]},pi=di,hi=y.unpack,_i=Math.floor,gi=function(){for(var a,n,i,c,d,h,f=[],g=arguments.length;g--;)f[g]=arguments[g];f=hi(f,"hsv");var v=f[0],x=f[1],C=f[2],j,$,S;if(C*=255,x===0)j=$=S=C;else{v===360&&(v=0),v>360&&(v-=360),v<0&&(v+=360),v/=60;var E=_i(v),F=v-E,z=C*(1-x),R=C*(1-x*F),B=C*(1-x*(1-F));switch(E){case 0:a=[C,B,z],j=a[0],$=a[1],S=a[2];break;case 1:n=[R,C,z],j=n[0],$=n[1],S=n[2];break;case 2:i=[z,C,B],j=i[0],$=i[1],S=i[2];break;case 3:c=[z,R,C],j=c[0],$=c[1],S=c[2];break;case 4:d=[B,z,C],j=d[0],$=d[1],S=d[2];break;case 5:h=[C,z,R],j=h[0],$=h[1],S=h[2];break}}return[j,$,S,f.length>3?f[3]:1]},vi=gi,mi=y.unpack,yi=y.type;M.prototype.hsv=function(){return pi(this._rgb)},O.hsv=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];return new(Function.prototype.bind.apply(M,[null].concat(a,["hsv"])))},k.format.hsv=vi,k.autodetect.push({p:2,test:function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];if(a=mi(a,"hsv"),yi(a)==="array"&&a.length===3)return"hsv"}});var re={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452},bi=y.unpack,Dt=Math.pow,wi=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];var i=bi(a,"rgb"),c=i[0],d=i[1],h=i[2],f=xi(c,d,h),g=f[0],v=f[1],x=f[2],C=116*v-16;return[C<0?0:C,500*(g-v),200*(v-x)]},zr=function(a){return(a/=255)<=.04045?a/12.92:Dt((a+.055)/1.055,2.4)},Ar=function(a){return a>re.t3?Dt(a,1/3):a/re.t2+re.t0},xi=function(a,n,i){a=zr(a),n=zr(n),i=zr(i);var c=Ar((.4124564*a+.3575761*n+.1804375*i)/re.Xn),d=Ar((.2126729*a+.7151522*n+.072175*i)/re.Yn),h=Ar((.0193339*a+.119192*n+.9503041*i)/re.Zn);return[c,d,h]},qt=wi,ki=y.unpack,ji=Math.pow,Ci=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];a=ki(a,"lab");var i=a[0],c=a[1],d=a[2],h,f,g,v,x,C;return f=(i+16)/116,h=isNaN(c)?f:f+c/500,g=isNaN(d)?f:f-d/200,f=re.Yn*Fr(f),h=re.Xn*Fr(h),g=re.Zn*Fr(g),v=Lr(3.2404542*h-1.5371385*f-.4985314*g),x=Lr(-.969266*h+1.8760108*f+.041556*g),C=Lr(.0556434*h-.2040259*f+1.0572252*g),[v,x,C,a.length>3?a[3]:1]},Lr=function(a){return 255*(a<=.00304?12.92*a:1.055*ji(a,1/2.4)-.055)},Fr=function(a){return a>re.t1?a*a*a:re.t2*(a-re.t0)},Bt=Ci,Ti=y.unpack,Mi=y.type;M.prototype.lab=function(){return qt(this._rgb)},O.lab=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];return new(Function.prototype.bind.apply(M,[null].concat(a,["lab"])))},k.format.lab=Bt,k.autodetect.push({p:2,test:function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];if(a=Ti(a,"lab"),Mi(a)==="array"&&a.length===3)return"lab"}});var Si=y.unpack,Oi=y.RAD2DEG,$i=Math.sqrt,Pi=Math.atan2,Ei=Math.round,zi=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];var i=Si(a,"lab"),c=i[0],d=i[1],h=i[2],f=$i(d*d+h*h),g=(Pi(h,d)*Oi+360)%360;return Ei(f*1e4)===0&&(g=Number.NaN),[c,f,g]},Ai=zi,Li=y.unpack,Fi=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];var i=Li(a,"rgb"),c=i[0],d=i[1],h=i[2],f=qt(c,d,h),g=f[0],v=f[1],x=f[2];return Ai(g,v,x)},Ut=Fi,Ii=y.unpack,Ni=y.DEG2RAD,Ri=Math.sin,Gi=Math.cos,Di=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];var i=Ii(a,"lch"),c=i[0],d=i[1],h=i[2];return isNaN(h)&&(h=0),h=h*Ni,[c,Gi(h)*d,Ri(h)*d]},qi=Di,Bi=y.unpack,Ui=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];a=Bi(a,"lch");var i=a[0],c=a[1],d=a[2],h=qi(i,c,d),f=h[0],g=h[1],v=h[2],x=Bt(f,g,v),C=x[0],j=x[1],$=x[2];return[C,j,$,a.length>3?a[3]:1]},Ht=Ui,Hi=y.unpack,Zi=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];var i=Hi(a,"hcl").reverse();return Ht.apply(void 0,i)},Wi=Zi,Vi=y.unpack,Ji=y.type;M.prototype.lch=function(){return Ut(this._rgb)},M.prototype.hcl=function(){return Ut(this._rgb).reverse()},O.lch=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];return new(Function.prototype.bind.apply(M,[null].concat(a,["lch"])))},O.hcl=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];return new(Function.prototype.bind.apply(M,[null].concat(a,["hcl"])))},k.format.lch=Ht,k.format.hcl=Wi,["lch","hcl"].forEach(function(a){return k.autodetect.push({p:2,test:function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];if(n=Vi(n,a),Ji(n)==="array"&&n.length===3)return a}})});var Ki={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},ze=Ki,Xi=y.type;M.prototype.name=function(){for(var a=Nt(this._rgb,"rgb"),n=0,i=Object.keys(ze);n<i.length;n+=1){var c=i[n];if(ze[c]===a)return c.toLowerCase()}return a},k.format.named=function(a){if(a=a.toLowerCase(),ze[a])return Rt(ze[a]);throw new Error("unknown color name: "+a)},k.autodetect.push({p:5,test:function(a){for(var n=[],i=arguments.length-1;i-- >0;)n[i]=arguments[i+1];if(!n.length&&Xi(a)==="string"&&ze[a.toLowerCase()])return"named"}});var Yi=y.unpack,Qi=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];var i=Yi(a,"rgb"),c=i[0],d=i[1],h=i[2];return(c<<16)+(d<<8)+h},el=Qi,rl=y.type,tl=function(a){if(rl(a)=="number"&&a>=0&&a<=16777215){var n=a>>16,i=a>>8&255,c=a&255;return[n,i,c,1]}throw new Error("unknown num color: "+a)},al=tl,nl=y.type;M.prototype.num=function(){return el(this._rgb)},O.num=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];return new(Function.prototype.bind.apply(M,[null].concat(a,["num"])))},k.format.num=al,k.autodetect.push({p:5,test:function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];if(a.length===1&&nl(a[0])==="number"&&a[0]>=0&&a[0]<=16777215)return"num"}});var Zt=y.unpack,Wt=y.type,Vt=Math.round;M.prototype.rgb=function(a){return a===void 0&&(a=!0),a===!1?this._rgb.slice(0,3):this._rgb.slice(0,3).map(Vt)},M.prototype.rgba=function(a){return a===void 0&&(a=!0),this._rgb.slice(0,4).map(function(n,i){return i<3?a===!1?n:Vt(n):n})},O.rgb=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];return new(Function.prototype.bind.apply(M,[null].concat(a,["rgb"])))},k.format.rgb=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];var i=Zt(a,"rgba");return i[3]===void 0&&(i[3]=1),i},k.autodetect.push({p:3,test:function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];if(a=Zt(a,"rgba"),Wt(a)==="array"&&(a.length===3||a.length===4&&Wt(a[3])=="number"&&a[3]>=0&&a[3]<=1))return"rgb"}});var ir=Math.log,il=function(a){var n=a/100,i,c,d;return n<66?(i=255,c=-155.25485562709179-.44596950469579133*(c=n-2)+104.49216199393888*ir(c),d=n<20?0:-254.76935184120902+.8274096064007395*(d=n-10)+115.67994401066147*ir(d)):(i=351.97690566805693+.114206453784165*(i=n-55)-40.25366309332127*ir(i),c=325.4494125711974+.07943456536662342*(c=n-50)-28.0852963507957*ir(c),d=255),[i,c,d,1]},Jt=il,ll=y.unpack,sl=Math.round,cl=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];for(var i=ll(a,"rgb"),c=i[0],d=i[2],h=1e3,f=4e4,g=.4,v;f-h>g;){v=(f+h)*.5;var x=Jt(v);x[2]/x[0]>=d/c?f=v:h=v}return sl(v)},ul=cl;M.prototype.temp=M.prototype.kelvin=M.prototype.temperature=function(){return ul(this._rgb)},O.temp=O.kelvin=O.temperature=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];return new(Function.prototype.bind.apply(M,[null].concat(a,["temp"])))},k.format.temp=k.format.kelvin=k.format.temperature=Jt;var fl=y.type;M.prototype.alpha=function(a,n){return n===void 0&&(n=!1),a!==void 0&&fl(a)==="number"?n?(this._rgb[3]=a,this):new M([this._rgb[0],this._rgb[1],this._rgb[2],a],"rgb"):this._rgb[3]},M.prototype.clipped=function(){return this._rgb._clipped||!1},M.prototype.darken=function(a){a===void 0&&(a=1);var n=this,i=n.lab();return i[0]-=re.Kn*a,new M(i,"lab").alpha(n.alpha(),!0)},M.prototype.brighten=function(a){return a===void 0&&(a=1),this.darken(-a)},M.prototype.darker=M.prototype.darken,M.prototype.brighter=M.prototype.brighten,M.prototype.get=function(a){var n=a.split("."),i=n[0],c=n[1],d=this[i]();if(c){var h=i.indexOf(c);if(h>-1)return d[h];throw new Error("unknown channel "+c+" in mode "+i)}else return d};var dl=y.type,pl=Math.pow,hl=1e-7,_l=20;M.prototype.luminance=function(a){if(a!==void 0&&dl(a)==="number"){if(a===0)return new M([0,0,0,this._rgb[3]],"rgb");if(a===1)return new M([255,255,255,this._rgb[3]],"rgb");var n=this.luminance(),i="rgb",c=_l,d=function(f,g){var v=f.interpolate(g,.5,i),x=v.luminance();return Math.abs(a-x)<hl||!c--?v:x>a?d(f,v):d(v,g)},h=(n>a?d(new M([0,0,0]),this):d(this,new M([255,255,255]))).rgb();return new M(h.concat([this._rgb[3]]))}return gl.apply(void 0,this._rgb.slice(0,3))};var gl=function(a,n,i){return a=Ir(a),n=Ir(n),i=Ir(i),.2126*a+.7152*n+.0722*i},Ir=function(a){return a/=255,a<=.03928?a/12.92:pl((a+.055)/1.055,2.4)},te={},Kt=y.type,Xt=function(a,n,i){i===void 0&&(i=.5);for(var c=[],d=arguments.length-3;d-- >0;)c[d]=arguments[d+3];var h=c[0]||"lrgb";if(!te[h]&&!c.length&&(h=Object.keys(te)[0]),!te[h])throw new Error("interpolation mode "+h+" is not defined");return Kt(a)!=="object"&&(a=new M(a)),Kt(n)!=="object"&&(n=new M(n)),te[h](a,n,i).alpha(a.alpha()+i*(n.alpha()-a.alpha()))};M.prototype.mix=M.prototype.interpolate=function(a,n){n===void 0&&(n=.5);for(var i=[],c=arguments.length-2;c-- >0;)i[c]=arguments[c+2];return Xt.apply(void 0,[this,a,n].concat(i))},M.prototype.premultiply=function(a){a===void 0&&(a=!1);var n=this._rgb,i=n[3];return a?(this._rgb=[n[0]*i,n[1]*i,n[2]*i,i],this):new M([n[0]*i,n[1]*i,n[2]*i,i],"rgb")},M.prototype.saturate=function(a){a===void 0&&(a=1);var n=this,i=n.lch();return i[1]+=re.Kn*a,i[1]<0&&(i[1]=0),new M(i,"lch").alpha(n.alpha(),!0)},M.prototype.desaturate=function(a){return a===void 0&&(a=1),this.saturate(-a)};var Yt=y.type;M.prototype.set=function(a,n,i){i===void 0&&(i=!1);var c=a.split("."),d=c[0],h=c[1],f=this[d]();if(h){var g=d.indexOf(h);if(g>-1){if(Yt(n)=="string")switch(n.charAt(0)){case"+":f[g]+=+n;break;case"-":f[g]+=+n;break;case"*":f[g]*=+n.substr(1);break;case"/":f[g]/=+n.substr(1);break;default:f[g]=+n}else if(Yt(n)==="number")f[g]=n;else throw new Error("unsupported value for Color.set");var v=new M(f,d);return i?(this._rgb=v._rgb,this):v}throw new Error("unknown channel "+h+" in mode "+d)}else return f};var vl=function(a,n,i){var c=a._rgb,d=n._rgb;return new M(c[0]+i*(d[0]-c[0]),c[1]+i*(d[1]-c[1]),c[2]+i*(d[2]-c[2]),"rgb")};te.rgb=vl;var Nr=Math.sqrt,Ae=Math.pow,ml=function(a,n,i){var c=a._rgb,d=c[0],h=c[1],f=c[2],g=n._rgb,v=g[0],x=g[1],C=g[2];return new M(Nr(Ae(d,2)*(1-i)+Ae(v,2)*i),Nr(Ae(h,2)*(1-i)+Ae(x,2)*i),Nr(Ae(f,2)*(1-i)+Ae(C,2)*i),"rgb")};te.lrgb=ml;var yl=function(a,n,i){var c=a.lab(),d=n.lab();return new M(c[0]+i*(d[0]-c[0]),c[1]+i*(d[1]-c[1]),c[2]+i*(d[2]-c[2]),"lab")};te.lab=yl;var He=function(a,n,i,c){var d,h,f,g;c==="hsl"?(f=a.hsl(),g=n.hsl()):c==="hsv"?(f=a.hsv(),g=n.hsv()):c==="hcg"?(f=a.hcg(),g=n.hcg()):c==="hsi"?(f=a.hsi(),g=n.hsi()):(c==="lch"||c==="hcl")&&(c="hcl",f=a.hcl(),g=n.hcl());var v,x,C,j,$,S;c.substr(0,1)==="h"&&(d=f,v=d[0],C=d[1],$=d[2],h=g,x=h[0],j=h[1],S=h[2]);var E,F,z,R;return!isNaN(v)&&!isNaN(x)?(x>v&&x-v>180?R=x-(v+360):x<v&&v-x>180?R=x+360-v:R=x-v,F=v+i*R):isNaN(v)?isNaN(x)?F=Number.NaN:(F=x,($==1||$==0)&&c!="hsv"&&(E=j)):(F=v,(S==1||S==0)&&c!="hsv"&&(E=C)),E===void 0&&(E=C+i*(j-C)),z=$+i*(S-$),new M([F,E,z],c)},Qt=function(a,n,i){return He(a,n,i,"lch")};te.lch=Qt,te.hcl=Qt;var bl=function(a,n,i){var c=a.num(),d=n.num();return new M(c+i*(d-c),"num")};te.num=bl;var wl=function(a,n,i){return He(a,n,i,"hcg")};te.hcg=wl;var xl=function(a,n,i){return He(a,n,i,"hsi")};te.hsi=xl;var kl=function(a,n,i){return He(a,n,i,"hsl")};te.hsl=kl;var jl=function(a,n,i){return He(a,n,i,"hsv")};te.hsv=jl;var Cl=y.clip_rgb,Rr=Math.pow,Gr=Math.sqrt,Dr=Math.PI,ea=Math.cos,ra=Math.sin,Tl=Math.atan2,Ml=function(a,n,i){n===void 0&&(n="lrgb"),i===void 0&&(i=null);var c=a.length;i||(i=Array.from(new Array(c)).map(function(){return 1}));var d=c/i.reduce(function(F,z){return F+z});if(i.forEach(function(F,z){i[z]*=d}),a=a.map(function(F){return new M(F)}),n==="lrgb")return Sl(a,i);for(var h=a.shift(),f=h.get(n),g=[],v=0,x=0,C=0;C<f.length;C++)if(f[C]=(f[C]||0)*i[0],g.push(isNaN(f[C])?0:i[0]),n.charAt(C)==="h"&&!isNaN(f[C])){var j=f[C]/180*Dr;v+=ea(j)*i[0],x+=ra(j)*i[0]}var $=h.alpha()*i[0];a.forEach(function(F,z){var R=F.get(n);$+=F.alpha()*i[z+1];for(var B=0;B<f.length;B++)if(!isNaN(R[B]))if(g[B]+=i[z+1],n.charAt(B)==="h"){var Q=R[B]/180*Dr;v+=ea(Q)*i[z+1],x+=ra(Q)*i[z+1]}else f[B]+=R[B]*i[z+1]});for(var S=0;S<f.length;S++)if(n.charAt(S)==="h"){for(var E=Tl(x/g[S],v/g[S])/Dr*180;E<0;)E+=360;for(;E>=360;)E-=360;f[S]=E}else f[S]=f[S]/g[S];return $/=c,new M(f,n).alpha($>.99999?1:$,!0)},Sl=function(a,n){for(var i=a.length,c=[0,0,0,0],d=0;d<a.length;d++){var h=a[d],f=n[d]/i,g=h._rgb;c[0]+=Rr(g[0],2)*f,c[1]+=Rr(g[1],2)*f,c[2]+=Rr(g[2],2)*f,c[3]+=g[3]*f}return c[0]=Gr(c[0]),c[1]=Gr(c[1]),c[2]=Gr(c[2]),c[3]>.9999999&&(c[3]=1),new M(Cl(c))},Le=y.type,Ol=Math.pow,lr=function(a){var n="rgb",i=O("#ccc"),c=0,d=[0,1],h=[],f=[0,0],g=!1,v=[],x=!1,C=0,j=1,$=!1,S={},E=!0,F=1,z=function(T){if(T=T||["#fff","#000"],T&&Le(T)==="string"&&O.brewer&&O.brewer[T.toLowerCase()]&&(T=O.brewer[T.toLowerCase()]),Le(T)==="array"){T.length===1&&(T=[T[0],T[0]]),T=T.slice(0);for(var P=0;P<T.length;P++)T[P]=O(T[P]);h.length=0;for(var I=0;I<T.length;I++)h.push(I/(T.length-1))}return oe(),v=T},R=function(T){if(g!=null){for(var P=g.length-1,I=0;I<P&&T>=g[I];)I++;return I-1}return 0},B=function(T){return T},Q=function(T){return T},ee=function(T,P){var I,L;if(P==null&&(P=!1),isNaN(T)||T===null)return i;if(P)L=T;else if(g&&g.length>2){var ae=R(T);L=ae/(g.length-2)}else j!==C?L=(T-C)/(j-C):L=1;L=Q(L),P||(L=B(L)),F!==1&&(L=Ol(L,F)),L=f[0]+L*(1-f[0]-f[1]),L=Math.min(1,Math.max(0,L));var J=Math.floor(L*1e4);if(E&&S[J])I=S[J];else{if(Le(v)==="array")for(var D=0;D<h.length;D++){var q=h[D];if(L<=q){I=v[D];break}if(L>=q&&D===h.length-1){I=v[D];break}if(L>q&&L<h[D+1]){L=(L-q)/(h[D+1]-q),I=O.interpolate(v[D],v[D+1],L,n);break}}else Le(v)==="function"&&(I=v(L));E&&(S[J]=I)}return I},oe=function(){return S={}};z(a);var N=function(T){var P=O(ee(T));return x&&P[x]?P[x]():P};return N.classes=function(T){if(T!=null){if(Le(T)==="array")g=T,d=[T[0],T[T.length-1]];else{var P=O.analyze(d);T===0?g=[P.min,P.max]:g=O.limits(P,"e",T)}return N}return g},N.domain=function(T){if(!arguments.length)return d;C=T[0],j=T[T.length-1],h=[];var P=v.length;if(T.length===P&&C!==j)for(var I=0,L=Array.from(T);I<L.length;I+=1){var ae=L[I];h.push((ae-C)/(j-C))}else{for(var J=0;J<P;J++)h.push(J/(P-1));if(T.length>2){var D=T.map(function(X,U){return U/(T.length-1)}),q=T.map(function(X){return(X-C)/(j-C)});q.every(function(X,U){return D[U]===X})||(Q=function(X){if(X<=0||X>=1)return X;for(var U=0;X>=q[U+1];)U++;var ve=(X-q[U])/(q[U+1]-q[U]),Fe=D[U]+ve*(D[U+1]-D[U]);return Fe})}}return d=[C,j],N},N.mode=function(T){return arguments.length?(n=T,oe(),N):n},N.range=function(T,P){return z(T),N},N.out=function(T){return x=T,N},N.spread=function(T){return arguments.length?(c=T,N):c},N.correctLightness=function(T){return T==null&&(T=!0),$=T,oe(),$?B=function(P){for(var I=ee(0,!0).lab()[0],L=ee(1,!0).lab()[0],ae=I>L,J=ee(P,!0).lab()[0],D=I+(L-I)*P,q=J-D,X=0,U=1,ve=20;Math.abs(q)>.01&&ve-- >0;)(function(){return ae&&(q*=-1),q<0?(X=P,P+=(U-P)*.5):(U=P,P+=(X-P)*.5),J=ee(P,!0).lab()[0],q=J-D})();return P}:B=function(P){return P},N},N.padding=function(T){return T!=null?(Le(T)==="number"&&(T=[T,T]),f=T,N):f},N.colors=function(T,P){arguments.length<2&&(P="hex");var I=[];if(arguments.length===0)I=v.slice(0);else if(T===1)I=[N(.5)];else if(T>1){var L=d[0],ae=d[1]-L;I=$l(0,T,!1).map(function(U){return N(L+U/(T-1)*ae)})}else{a=[];var J=[];if(g&&g.length>2)for(var D=1,q=g.length,X=1<=q;X?D<q:D>q;X?D++:D--)J.push((g[D-1]+g[D])*.5);else J=d;I=J.map(function(U){return N(U)})}return O[P]&&(I=I.map(function(U){return U[P]()})),I},N.cache=function(T){return T!=null?(E=T,N):E},N.gamma=function(T){return T!=null?(F=T,N):F},N.nodata=function(T){return T!=null?(i=O(T),N):i},N};function $l(a,n,i){for(var c=[],d=a<n,h=i?d?n+1:n-1:n,f=a;d?f<h:f>h;d?f++:f--)c.push(f);return c}var qr=function(a){var n,i,c,d,h,f,g;if(a=a.map(function(j){return new M(j)}),a.length===2)n=a.map(function(j){return j.lab()}),h=n[0],f=n[1],d=function(j){var $=[0,1,2].map(function(S){return h[S]+j*(f[S]-h[S])});return new M($,"lab")};else if(a.length===3)i=a.map(function(j){return j.lab()}),h=i[0],f=i[1],g=i[2],d=function(j){var $=[0,1,2].map(function(S){return(1-j)*(1-j)*h[S]+2*(1-j)*j*f[S]+j*j*g[S]});return new M($,"lab")};else if(a.length===4){var v;c=a.map(function(j){return j.lab()}),h=c[0],f=c[1],g=c[2],v=c[3],d=function(j){var $=[0,1,2].map(function(S){return(1-j)*(1-j)*(1-j)*h[S]+3*(1-j)*(1-j)*j*f[S]+3*(1-j)*j*j*g[S]+j*j*j*v[S]});return new M($,"lab")}}else if(a.length===5){var x=qr(a.slice(0,3)),C=qr(a.slice(2,5));d=function(j){return j<.5?x(j*2):C((j-.5)*2)}}return d},Pl=function(a){var n=qr(a);return n.scale=function(){return lr(n)},n},ie=function(a,n,i){if(!ie[i])throw new Error("unknown blend mode "+i);return ie[i](a,n)},_e=function(a){return function(n,i){var c=O(i).rgb(),d=O(n).rgb();return O.rgb(a(c,d))}},ge=function(a){return function(n,i){var c=[];return c[0]=a(n[0],i[0]),c[1]=a(n[1],i[1]),c[2]=a(n[2],i[2]),c}},El=function(a){return a},zl=function(a,n){return a*n/255},Al=function(a,n){return a>n?n:a},Ll=function(a,n){return a>n?a:n},Fl=function(a,n){return 255*(1-(1-a/255)*(1-n/255))},Il=function(a,n){return n<128?2*a*n/255:255*(1-2*(1-a/255)*(1-n/255))},Nl=function(a,n){return 255*(1-(1-n/255)/(a/255))},Rl=function(a,n){return a===255?255:(a=255*(n/255)/(1-a/255),a>255?255:a)};ie.normal=_e(ge(El)),ie.multiply=_e(ge(zl)),ie.screen=_e(ge(Fl)),ie.overlay=_e(ge(Il)),ie.darken=_e(ge(Al)),ie.lighten=_e(ge(Ll)),ie.dodge=_e(ge(Rl)),ie.burn=_e(ge(Nl));for(var Gl=ie,Br=y.type,Dl=y.clip_rgb,ql=y.TWOPI,Bl=Math.pow,Ul=Math.sin,Hl=Math.cos,Zl=function(a,n,i,c,d){a===void 0&&(a=300),n===void 0&&(n=-1.5),i===void 0&&(i=1),c===void 0&&(c=1),d===void 0&&(d=[0,1]);var h=0,f;Br(d)==="array"?f=d[1]-d[0]:(f=0,d=[d,d]);var g=function(v){var x=ql*((a+120)/360+n*v),C=Bl(d[0]+f*v,c),j=h!==0?i[0]+v*h:i,$=j*C*(1-C)/2,S=Hl(x),E=Ul(x),F=C+$*(-.14861*S+1.78277*E),z=C+$*(-.29227*S-.90649*E),R=C+$*(1.97294*S);return O(Dl([F*255,z*255,R*255,1]))};return g.start=function(v){return v==null?a:(a=v,g)},g.rotations=function(v){return v==null?n:(n=v,g)},g.gamma=function(v){return v==null?c:(c=v,g)},g.hue=function(v){return v==null?i:(i=v,Br(i)==="array"?(h=i[1]-i[0],h===0&&(i=i[1])):h=0,g)},g.lightness=function(v){return v==null?d:(Br(v)==="array"?(d=v,f=v[1]-v[0]):(d=[v,v],f=0),g)},g.scale=function(){return O.scale(g)},g.hue(i),g},Wl="0123456789abcdef",Vl=Math.floor,Jl=Math.random,Kl=function(){for(var a="#",n=0;n<6;n++)a+=Wl.charAt(Vl(Jl()*16));return new M(a,"hex")},ta=Math.log,Xl=Math.pow,Yl=Math.floor,Ql=Math.abs,aa=function(a,n){n===void 0&&(n=null);var i={min:Number.MAX_VALUE,max:Number.MAX_VALUE*-1,sum:0,values:[],count:0};return _(a)==="object"&&(a=Object.values(a)),a.forEach(function(c){n&&_(c)==="object"&&(c=c[n]),c!=null&&!isNaN(c)&&(i.values.push(c),i.sum+=c,c<i.min&&(i.min=c),c>i.max&&(i.max=c),i.count+=1)}),i.domain=[i.min,i.max],i.limits=function(c,d){return na(i,c,d)},i},na=function(a,n,i){n===void 0&&(n="equal"),i===void 0&&(i=7),_(a)=="array"&&(a=aa(a));var c=a.min,d=a.max,h=a.values.sort(function(Jr,Kr){return Jr-Kr});if(i===1)return[c,d];var f=[];if(n.substr(0,1)==="c"&&(f.push(c),f.push(d)),n.substr(0,1)==="e"){f.push(c);for(var g=1;g<i;g++)f.push(c+g/i*(d-c));f.push(d)}else if(n.substr(0,1)==="l"){if(c<=0)throw new Error("Logarithmic scales are only possible for values > 0");var v=Math.LOG10E*ta(c),x=Math.LOG10E*ta(d);f.push(c);for(var C=1;C<i;C++)f.push(Xl(10,v+C/i*(x-v)));f.push(d)}else if(n.substr(0,1)==="q"){f.push(c);for(var j=1;j<i;j++){var $=(h.length-1)*j/i,S=Yl($);if(S===$)f.push(h[S]);else{var E=$-S;f.push(h[S]*(1-E)+h[S+1]*E)}}f.push(d)}else if(n.substr(0,1)==="k"){var F,z=h.length,R=new Array(z),B=new Array(i),Q=!0,ee=0,oe=null;oe=[],oe.push(c);for(var N=1;N<i;N++)oe.push(c+N/i*(d-c));for(oe.push(d);Q;){for(var T=0;T<i;T++)B[T]=0;for(var P=0;P<z;P++)for(var I=h[P],L=Number.MAX_VALUE,ae=void 0,J=0;J<i;J++){var D=Ql(oe[J]-I);D<L&&(L=D,ae=J),B[ae]++,R[P]=ae}for(var q=new Array(i),X=0;X<i;X++)q[X]=null;for(var U=0;U<z;U++)F=R[U],q[F]===null?q[F]=h[U]:q[F]+=h[U];for(var ve=0;ve<i;ve++)q[ve]*=1/B[ve];Q=!1;for(var Fe=0;Fe<i;Fe++)if(q[Fe]!==oe[Fe]){Q=!0;break}oe=q,ee++,ee>200&&(Q=!1)}for(var Ze={},Zr=0;Zr<i;Zr++)Ze[Zr]=[];for(var ur=0;ur<z;ur++)F=R[ur],Ze[F].push(h[ur]);for(var we=[],We=0;We<i;We++)we.push(Ze[We][0]),we.push(Ze[We][Ze[We].length-1]);we=we.sort(function(Jr,Kr){return Jr-Kr}),f.push(we[0]);for(var Wr=1;Wr<we.length;Wr+=2){var Vr=we[Wr];!isNaN(Vr)&&f.indexOf(Vr)===-1&&f.push(Vr)}}return f},oa={analyze:aa,limits:na},es=function(a,n){a=new M(a),n=new M(n);var i=a.luminance(),c=n.luminance();return i>c?(i+.05)/(c+.05):(c+.05)/(i+.05)},sr=Math.sqrt,rs=Math.atan2,ia=Math.abs,la=Math.cos,Ur=Math.PI,ts=function(a,n,i,c){i===void 0&&(i=1),c===void 0&&(c=1),a=new M(a),n=new M(n);for(var d=Array.from(a.lab()),h=d[0],f=d[1],g=d[2],v=Array.from(n.lab()),x=v[0],C=v[1],j=v[2],$=sr(f*f+g*g),S=sr(C*C+j*j),E=h<16?.511:.040975*h/(1+.01765*h),F=.0638*$/(1+.0131*$)+.638,z=$<1e-6?0:rs(g,f)*180/Ur;z<0;)z+=360;for(;z>=360;)z-=360;var R=z>=164&&z<=345?.56+ia(.2*la(Ur*(z+168)/180)):.36+ia(.4*la(Ur*(z+35)/180)),B=$*$*$*$,Q=sr(B/(B+1900)),ee=F*(Q*R+1-Q),oe=h-x,N=$-S,T=f-C,P=g-j,I=T*T+P*P-N*N,L=oe/(i*E),ae=N/(c*F),J=ee;return sr(L*L+ae*ae+I/(J*J))},as=function(a,n,i){i===void 0&&(i="lab"),a=new M(a),n=new M(n);var c=a.get(i),d=n.get(i),h=0;for(var f in c){var g=(c[f]||0)-(d[f]||0);h+=g*g}return Math.sqrt(h)},ns=function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];try{return new(Function.prototype.bind.apply(M,[null].concat(a))),!0}catch(i){return!1}},os={cool:function(){return lr([O.hsl(180,1,.9),O.hsl(250,.7,.4)])},hot:function(){return lr(["#000","#f00","#ff0","#fff"]).mode("rgb")}},cr={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},Hr=0,sa=Object.keys(cr);Hr<sa.length;Hr+=1){var ca=sa[Hr];cr[ca.toLowerCase()]=cr[ca]}var is=cr;O.average=Ml,O.bezier=Pl,O.blend=Gl,O.cubehelix=Zl,O.mix=O.interpolate=Xt,O.random=Kl,O.scale=lr,O.analyze=oa.analyze,O.contrast=es,O.deltaE=ts,O.distance=as,O.limits=oa.limits,O.valid=ns,O.scales=os,O.colors=ze,O.brewer=is;var ls=O;return ls})}),za=tc;var Aa=(e=21)=>{let r="",t=crypto.getRandomValues(new Uint8Array(e));for(;e--;){let o=t[e]&63;o<36?r+=o.toString(36):o<62?r+=(o-26).toString(36).toUpperCase():o<63?r+="_":r+="-"}return r};var ne=63710088e-1,La={centimeters:ne*100,centimetres:ne*100,degrees:ne/111325,feet:ne*3.28084,inches:ne*39.37,kilometers:ne/1e3,kilometres:ne/1e3,meters:ne,metres:ne,miles:ne/1609.344,millimeters:ne*1e3,millimetres:ne*1e3,nauticalmiles:ne/1852,radians:1,yards:ne/1.0936};function ke(e,r,t){t===void 0&&(t={});var o={type:"Feature"};return(t.id===0||t.id)&&(o.id=t.id),t.bbox&&(o.bbox=t.bbox),o.properties=r||{},o.geometry=e,o}function de(e,r,t){if(t===void 0&&(t={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Fa(e[0])||!Fa(e[1]))throw new Error("coordinates must contain numbers");var o={type:"Point",coordinates:e};return ke(o,r,t)}function Ia(e,r,t){t===void 0&&(t={});for(var o=0,l=e;o<l.length;o++){var s=l[o];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var u=0;u<s[s.length-1].length;u++)if(s[s.length-1][u]!==s[0][u])throw new Error("First and last Position are not equivalent.")}var p={type:"Polygon",coordinates:e};return ke(p,r,t)}function je(e,r){r===void 0&&(r={});var t={type:"FeatureCollection"};return r.id&&(t.id=r.id),r.bbox&&(t.bbox=r.bbox),t.features=e,t}function Na(e,r){r===void 0&&(r="kilometers");var t=La[r];if(!t)throw new Error(r+" units is invalid");return e*t}function Ra(e,r){r===void 0&&(r="kilometers");var t=La[r];if(!t)throw new Error(r+" units is invalid");return e/t}function it(e){var r=e%(2*Math.PI);return r*180/Math.PI}function pe(e){var r=e%360;return r*Math.PI/180}function Fa(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function Xe(e,r,t){if(e!==null)for(var o,l,s,u,p,_,m,w=0,b=0,y,k=e.type,H=k==="FeatureCollection",K=k==="Feature",W=H?e.features.length:1,A=0;A<W;A++){m=H?e.features[A].geometry:K?e.geometry:e,y=m?m.type==="GeometryCollection":!1,p=y?m.geometries.length:1;for(var M=0;M<p;M++){var G=0,O=0;if(u=y?m.geometries[M]:m,u!==null){_=u.coordinates;var ce=u.type;switch(w=t&&(ce==="Polygon"||ce==="MultiPolygon")?1:0,ce){case null:break;case"Point":if(r(_,b,A,G,O)===!1)return!1;b++,G++;break;case"LineString":case"MultiPoint":for(o=0;o<_.length;o++){if(r(_[o],b,A,G,O)===!1)return!1;b++,ce==="MultiPoint"&&G++}ce==="LineString"&&G++;break;case"Polygon":case"MultiLineString":for(o=0;o<_.length;o++){for(l=0;l<_[o].length-w;l++){if(r(_[o][l],b,A,G,O)===!1)return!1;b++}ce==="MultiLineString"&&G++,ce==="Polygon"&&O++}ce==="Polygon"&&G++;break;case"MultiPolygon":for(o=0;o<_.length;o++){for(O=0,l=0;l<_[o].length;l++){for(s=0;s<_[o][l].length-w;s++){if(r(_[o][l][s],b,A,G,O)===!1)return!1;b++}O++}G++}break;case"GeometryCollection":for(o=0;o<u.geometries.length;o++)if(Xe(u.geometries[o],r,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function lt(e,r){if(e.type==="Feature")r(e,0);else if(e.type==="FeatureCollection")for(var t=0;t<e.features.length&&r(e.features[t],t)!==!1;t++);}function ac(e,r){var t,o,l,s,u,p,_,m,w,b,y=0,k=e.type==="FeatureCollection",H=e.type==="Feature",K=k?e.features.length:1;for(t=0;t<K;t++){for(p=k?e.features[t].geometry:H?e.geometry:e,m=k?e.features[t].properties:H?e.properties:{},w=k?e.features[t].bbox:H?e.bbox:void 0,b=k?e.features[t].id:H?e.id:void 0,_=p?p.type==="GeometryCollection":!1,u=_?p.geometries.length:1,l=0;l<u;l++){if(s=_?p.geometries[l]:p,s===null){if(r(null,y,m,w,b)===!1)return!1;continue}switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(r(s,y,m,w,b)===!1)return!1;break}case"GeometryCollection":{for(o=0;o<s.geometries.length;o++)if(r(s.geometries[o],y,m,w,b)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}y++}}function Ga(e,r){ac(e,function(t,o,l,s,u){var p=t===null?null:t.type;switch(p){case null:case"Point":case"LineString":case"Polygon":return r(ke(t,l,{bbox:s,id:u}),o,0)===!1?!1:void 0}var _;switch(p){case"MultiPoint":_="Point";break;case"MultiLineString":_="LineString";break;case"MultiPolygon":_="Polygon";break}for(var m=0;m<t.coordinates.length;m++){var w=t.coordinates[m],b={type:_,coordinates:w};if(r(ke(b,l),o,m)===!1)return!1}})}function Ne(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return e.geometry.coordinates;if(e.type==="Point")return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Da(e){return e.type==="Feature"?e.geometry:e}function nc(e){var r=[];return e.type==="FeatureCollection"?lt(e,function(t){Xe(t,function(o){r.push(de(o,t.properties))})}):Xe(e,function(t){r.push(de(t,e.properties))}),je(r)}function st(e){var r=[Infinity,Infinity,-Infinity,-Infinity];return Xe(e,function(t){r[0]>t[0]&&(r[0]=t[0]),r[1]>t[1]&&(r[1]=t[1]),r[2]<t[0]&&(r[2]=t[0]),r[3]<t[1]&&(r[3]=t[1])}),r}st.default=st;function oc(e,r){r===void 0&&(r={});var t=st(e),o=(t[0]+t[2])/2,l=(t[1]+t[3])/2;return de([o,l],r.properties,r)}function lc(e){if(!e)throw new Error("geojson is required");switch(e.type){case"Feature":return qa(e);case"FeatureCollection":return ic(e);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return ct(e);default:throw new Error("unknown GeoJSON type")}}function qa(e){var r={type:"Feature"};return Object.keys(e).forEach(function(t){switch(t){case"type":case"properties":case"geometry":return;default:r[t]=e[t]}}),r.properties=Ba(e.properties),r.geometry=ct(e.geometry),r}function Ba(e){var r={};return e&&Object.keys(e).forEach(function(t){var o=e[t];typeof o=="object"?o===null?r[t]=null:Array.isArray(o)?r[t]=o.map(function(l){return l}):r[t]=Ba(o):r[t]=o}),r}function ic(e){var r={type:"FeatureCollection"};return Object.keys(e).forEach(function(t){switch(t){case"type":case"features":return;default:r[t]=e[t]}}),r.features=e.features.map(function(t){return qa(t)}),r}function ct(e){var r={type:e.type};return e.bbox&&(r.bbox=e.bbox),e.type==="GeometryCollection"?(r.geometries=e.geometries.map(function(t){return ct(t)}),r):(r.coordinates=Ua(e.coordinates),r)}function Ua(e){var r=e;return typeof r[0]!="object"?r.slice():r.map(function(t){return Ua(t)})}function sc(e,r,t){t===void 0&&(t={});var o=Ne(e),l=Ne(r),s=pe(l[1]-o[1]),u=pe(l[0]-o[0]),p=pe(o[1]),_=pe(l[1]),m=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(u/2),2)*Math.cos(p)*Math.cos(_);return Na(2*Math.atan2(Math.sqrt(m),Math.sqrt(1-m)),t.units)}function cc(e,r){if(!e)throw new Error("targetPoint is required");if(!r)throw new Error("points is required");var t,o=Infinity,l=0;return lt(r,function(s,u){var p=sc(e,s);p<o&&(l=u,o=p)}),t=lc(r.features[l]),t.properties.featureIndex=l,t.properties.distanceToPoint=o,t}function fc(e,r,t){if(t===void 0&&(t={}),!e)throw new Error("point is required");if(!r)throw new Error("polygon is required");var o=Ne(e),l=Da(r),s=l.type,u=r.bbox,p=l.coordinates;if(u&&uc(o,u)===!1)return!1;s==="Polygon"&&(p=[p]);for(var _=!1,m=0;m<p.length&&!_;m++)if(Ha(o,p[m][0],t.ignoreBoundary)){for(var w=!1,b=1;b<p[m].length&&!w;)Ha(o,p[m][b],!t.ignoreBoundary)&&(w=!0),b++;w||(_=!0)}return _}function Ha(e,r,t){var o=!1;r[0][0]===r[r.length-1][0]&&r[0][1]===r[r.length-1][1]&&(r=r.slice(0,r.length-1));for(var l=0,s=r.length-1;l<r.length;s=l++){var u=r[l][0],p=r[l][1],_=r[s][0],m=r[s][1],w=e[1]*(u-_)+p*(_-e[0])+m*(e[0]-u)==0&&(u-e[0])*(_-e[0])<=0&&(p-e[1])*(m-e[1])<=0;if(w)return!t;var b=p>e[1]!=m>e[1]&&e[0]<(_-u)*(e[1]-p)/(m-p)+u;b&&(o=!o)}return o}function uc(e,r){return r[0]<=e[0]&&r[1]<=e[1]&&r[2]>=e[0]&&r[3]>=e[1]}function pc(e){for(var r=dc(e),t=oc(r),o=!1,l=0;!o&&l<r.features.length;){var s=r.features[l].geometry,u,p,_,m,w,b,y,k=!1;if(s.type==="Point")t.geometry.coordinates[0]===s.coordinates[0]&&t.geometry.coordinates[1]===s.coordinates[1]&&(o=!0);else if(s.type==="MultiPoint"){var H=!1;for(y=0;!H&&y<s.coordinates.length;)t.geometry.coordinates[0]===s.coordinates[y][0]&&t.geometry.coordinates[1]===s.coordinates[y][1]&&(o=!0,H=!0),y++}else if(s.type==="LineString")for(y=0;!k&&y<s.coordinates.length-1;)u=t.geometry.coordinates[0],p=t.geometry.coordinates[1],_=s.coordinates[y][0],m=s.coordinates[y][1],w=s.coordinates[y+1][0],b=s.coordinates[y+1][1],Za(u,p,_,m,w,b)&&(k=!0,o=!0),y++;else if(s.type==="MultiLineString")for(var K=0;K<s.coordinates.length;){k=!1,y=0;for(var W=s.coordinates[K];!k&&y<W.length-1;)u=t.geometry.coordinates[0],p=t.geometry.coordinates[1],_=W[y][0],m=W[y][1],w=W[y+1][0],b=W[y+1][1],Za(u,p,_,m,w,b)&&(k=!0,o=!0),y++;K++}else(s.type==="Polygon"||s.type==="MultiPolygon")&&fc(t,s)&&(o=!0);l++}if(o)return t;var A=je([]);for(l=0;l<r.features.length;l++)A.features=A.features.concat(nc(r.features[l]).features);return de(cc(t,A).geometry.coordinates)}function dc(e){return e.type!=="FeatureCollection"?e.type!=="Feature"?je([ke(e)]):je([e]):e}function Za(e,r,t,o,l,s){var u=Math.sqrt((l-t)*(l-t)+(s-o)*(s-o)),p=Math.sqrt((e-t)*(e-t)+(r-o)*(r-o)),_=Math.sqrt((l-e)*(l-e)+(s-r)*(s-r));return u===p+_}var Wa=pc;function _c(e){var r,t,o={type:"FeatureCollection",features:[]};if(e.type==="Feature"?t=e.geometry:t=e,t.type==="LineString")r=[t.coordinates];else if(t.type==="MultiLineString")r=t.coordinates;else if(t.type==="MultiPolygon")r=[].concat.apply([],t.coordinates);else if(t.type==="Polygon")r=t.coordinates;else throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return r.forEach(function(l){r.forEach(function(s){for(var u=0;u<l.length-1;u++)for(var p=u;p<s.length-1;p++)if(!(l===s&&(Math.abs(u-p)===1||u===0&&p===l.length-2&&l[u][0]===l[l.length-1][0]&&l[u][1]===l[l.length-1][1]))){var _=hc(l[u][0],l[u][1],l[u+1][0],l[u+1][1],s[p][0],s[p][1],s[p+1][0],s[p+1][1]);_&&o.features.push(de([_[0],_[1]]))}})}),o}function hc(e,r,t,o,l,s,u,p){var _,m,w,b,y,k={x:null,y:null,onLine1:!1,onLine2:!1};return _=(p-s)*(t-e)-(u-l)*(o-r),_===0?k.x!==null&&k.y!==null?k:!1:(m=r-s,w=e-l,b=(u-l)*m-(p-s)*w,y=(t-e)*m-(o-r)*w,m=b/_,w=y/_,k.x=e+m*(t-e),k.y=r+m*(o-r),m>=0&&m<=1&&(k.onLine1=!0),w>=0&&w<=1&&(k.onLine2=!0),k.onLine1&&k.onLine2?[k.x,k.y]:!1)}var Va=_c;function gc(e){if(!e)throw new Error("geojson is required");var r=[];return Ga(e,function(t){r.push(t)}),je(r)}var Ja=gc;function vc(e,r,t,o){o===void 0&&(o={});var l=Ne(e),s=pe(l[0]),u=pe(l[1]),p=pe(t),_=Ra(r,o.units),m=Math.asin(Math.sin(u)*Math.cos(_)+Math.cos(u)*Math.sin(_)*Math.cos(p)),w=s+Math.atan2(Math.sin(p)*Math.sin(_)*Math.cos(u),Math.cos(_)-Math.sin(u)*Math.sin(m)),b=it(w),y=it(m);return de([b,y],o.properties)}function mc(e,r,t){t===void 0&&(t={});for(var o=t.steps||64,l=t.properties?t.properties:!Array.isArray(e)&&e.type==="Feature"&&e.properties?e.properties:{},s=[],u=0;u<o;u++)s.push(vc(e,r,u*-360/o,t).geometry.coordinates);return s.push(s[0]),Ia([s],l)}var Ka=mc;function yc(){this.__data__=[],this.size=0}var bc=yc;function wc(e,r){return e===r||e!==e&&r!==r}var Ye=wc;function xc(e,r){for(var t=e.length;t--;)if(Ye(e[t][0],r))return t;return-1}var dr=xc,kc=Array.prototype,jc=kc.splice;function Cc(e){var r=this.__data__,t=dr(r,e);if(t<0)return!1;var o=r.length-1;return t==o?r.pop():jc.call(r,t,1),--this.size,!0}var Tc=Cc;function Mc(e){var r=this.__data__,t=dr(r,e);return t<0?void 0:r[t][1]}var Sc=Mc;function Oc(e){return dr(this.__data__,e)>-1}var $c=Oc;function Pc(e,r){var t=this.__data__,o=dr(t,e);return o<0?(++this.size,t.push([e,r])):t[o][1]=r,this}var Ec=Pc;function Re(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var o=e[r];this.set(o[0],o[1])}}Re.prototype.clear=bc;Re.prototype.delete=Tc;Re.prototype.get=Sc;Re.prototype.has=$c;Re.prototype.set=Ec;var pr=Re;function zc(){this.__data__=new pr,this.size=0}var Ac=zc;function Lc(e){var r=this.__data__,t=r.delete(e);return this.size=r.size,t}var Fc=Lc;function Ic(e){return this.__data__.get(e)}var Nc=Ic;function Rc(e){return this.__data__.has(e)}var Gc=Rc,Dc=typeof xe=="object"&&xe&&xe.Object===Object&&xe,Xa=Dc,qc=typeof self=="object"&&self&&self.Object===Object&&self,Bc=Xa||qc||Function("return this")(),se=Bc,Uc=se.Symbol,Ce=Uc,Ya=Object.prototype,Hc=Ya.hasOwnProperty,Zc=Ya.toString,Qe=Ce?Ce.toStringTag:void 0;function Wc(e){var r=Hc.call(e,Qe),t=e[Qe];try{e[Qe]=void 0;var o=!0}catch(s){}var l=Zc.call(e);return o&&(r?e[Qe]=t:delete e[Qe]),l}var Vc=Wc,Jc=Object.prototype,Kc=Jc.toString;function Xc(e){return Kc.call(e)}var Yc=Xc,Qc="[object Null]",eu="[object Undefined]",Qa=Ce?Ce.toStringTag:void 0;function ru(e){return e==null?e===void 0?eu:Qc:Qa&&Qa in Object(e)?Vc(e):Yc(e)}var me=ru;function tu(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}var fe=tu,au="[object AsyncFunction]",nu="[object Function]",ou="[object GeneratorFunction]",iu="[object Proxy]";function lu(e){if(!fe(e))return!1;var r=me(e);return r==nu||r==ou||r==au||r==iu}var hr=lu,su=se["__core-js_shared__"],ut=su,en=function(){var e=/[^.]+$/.exec(ut&&ut.keys&&ut.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function cu(e){return!!en&&en in e}var uu=cu,fu=Function.prototype,du=fu.toString;function pu(e){if(e!=null){try{return du.call(e)}catch(r){}try{return e+""}catch(r){}}return""}var ye=pu,hu=/[\\^$.*+?()[\]{}|]/g,_u=/^\[object .+?Constructor\]$/,gu=Function.prototype,vu=Object.prototype,mu=gu.toString,yu=vu.hasOwnProperty,bu=RegExp("^"+mu.call(yu).replace(hu,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function wu(e){if(!fe(e)||uu(e))return!1;var r=hr(e)?bu:_u;return r.test(ye(e))}var xu=wu;function ku(e,r){return e==null?void 0:e[r]}var ju=ku;function Cu(e,r){var t=ju(e,r);return xu(t)?t:void 0}var be=Cu,Tu=be(se,"Map"),Ge=Tu,Mu=be(Object,"create"),er=Mu;function Su(){this.__data__=er?er(null):{},this.size=0}var Ou=Su;function $u(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}var Pu=$u,Eu="__lodash_hash_undefined__",zu=Object.prototype,Au=zu.hasOwnProperty;function Lu(e){var r=this.__data__;if(er){var t=r[e];return t===Eu?void 0:t}return Au.call(r,e)?r[e]:void 0}var Fu=Lu,Iu=Object.prototype,Nu=Iu.hasOwnProperty;function Ru(e){var r=this.__data__;return er?r[e]!==void 0:Nu.call(r,e)}var Gu=Ru,Du="__lodash_hash_undefined__";function qu(e,r){var t=this.__data__;return this.size+=this.has(e)?0:1,t[e]=er&&r===void 0?Du:r,this}var Bu=qu;function De(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var o=e[r];this.set(o[0],o[1])}}De.prototype.clear=Ou;De.prototype.delete=Pu;De.prototype.get=Fu;De.prototype.has=Gu;De.prototype.set=Bu;var rn=De;function Uu(){this.size=0,this.__data__={hash:new rn,map:new(Ge||pr),string:new rn}}var Hu=Uu;function Zu(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}var Wu=Zu;function Vu(e,r){var t=e.__data__;return Wu(r)?t[typeof r=="string"?"string":"hash"]:t.map}var _r=Vu;function Ju(e){var r=_r(this,e).delete(e);return this.size-=r?1:0,r}var Ku=Ju;function Xu(e){return _r(this,e).get(e)}var Yu=Xu;function Qu(e){return _r(this,e).has(e)}var ef=Qu;function rf(e,r){var t=_r(this,e),o=t.size;return t.set(e,r),this.size+=t.size==o?0:1,this}var tf=rf;function qe(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var o=e[r];this.set(o[0],o[1])}}qe.prototype.clear=Hu;qe.prototype.delete=Ku;qe.prototype.get=Yu;qe.prototype.has=ef;qe.prototype.set=tf;var af=qe,nf=200;function of(e,r){var t=this.__data__;if(t instanceof pr){var o=t.__data__;if(!Ge||o.length<nf-1)return o.push([e,r]),this.size=++t.size,this;t=this.__data__=new af(o)}return t.set(e,r),this.size=t.size,this}var lf=of;function Be(e){var r=this.__data__=new pr(e);this.size=r.size}Be.prototype.clear=Ac;Be.prototype.delete=Fc;Be.prototype.get=Nc;Be.prototype.has=Gc;Be.prototype.set=lf;var gr=Be,sf=function(){try{var e=be(Object,"defineProperty");return e({},"",{}),e}catch(r){}}(),rr=sf;function cf(e,r,t){r=="__proto__"&&rr?rr(e,r,{configurable:!0,enumerable:!0,value:t,writable:!0}):e[r]=t}var vr=cf,uf=Object.prototype,ff=uf.hasOwnProperty;function df(e,r,t){var o=e[r];(!(ff.call(e,r)&&Ye(o,t))||t===void 0&&!(r in e))&&vr(e,r,t)}var ft=df;function pf(e,r,t,o){var l=!t;t||(t={});for(var s=-1,u=r.length;++s<u;){var p=r[s],_=o?o(t[p],e[p],p,t,e):void 0;_===void 0&&(_=e[p]),l?vr(t,p,_):ft(t,p,_)}return t}var Te=pf;function hf(e,r){for(var t=-1,o=Array(e);++t<e;)o[t]=r(t);return o}var _f=hf;function gf(e){return e!=null&&typeof e=="object"}var he=gf,vf="[object Arguments]";function mf(e){return he(e)&&me(e)==vf}var tn=mf,an=Object.prototype,yf=an.hasOwnProperty,bf=an.propertyIsEnumerable,wf=tn(function(){return arguments}())?tn:function(e){return he(e)&&yf.call(e,"callee")&&!bf.call(e,"callee")},mr=wf,xf=Array.isArray,Me=xf;function kf(){return!1}var jf=kf,tr=Ie(function(e,r){var t=r&&!r.nodeType&&r,o=t&&!0&&e&&!e.nodeType&&e,l=o&&o.exports===t,s=l?se.Buffer:void 0,u=s?s.isBuffer:void 0,p=u||jf;e.exports=p}),Cf=9007199254740991,Tf=/^(?:0|[1-9]\d*)$/;function Mf(e,r){var t=typeof e;return r=r??Cf,!!r&&(t=="number"||t!="symbol"&&Tf.test(e))&&e>-1&&e%1==0&&e<r}var dt=Mf,Sf=9007199254740991;function Of(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Sf}var nn=Of,$f="[object Arguments]",Pf="[object Array]",Ef="[object Boolean]",zf="[object Date]",Af="[object Error]",Lf="[object Function]",Ff="[object Map]",If="[object Number]",Nf="[object Object]",Rf="[object RegExp]",Gf="[object Set]",Df="[object String]",qf="[object WeakMap]",Bf="[object ArrayBuffer]",Uf="[object DataView]",Hf="[object Float32Array]",Zf="[object Float64Array]",Wf="[object Int8Array]",Vf="[object Int16Array]",Jf="[object Int32Array]",Kf="[object Uint8Array]",Xf="[object Uint8ClampedArray]",Yf="[object Uint16Array]",Qf="[object Uint32Array]",V={};V[Hf]=V[Zf]=V[Wf]=V[Vf]=V[Jf]=V[Kf]=V[Xf]=V[Yf]=V[Qf]=!0;V[$f]=V[Pf]=V[Bf]=V[Ef]=V[Uf]=V[zf]=V[Af]=V[Lf]=V[Ff]=V[If]=V[Nf]=V[Rf]=V[Gf]=V[Df]=V[qf]=!1;function ed(e){return he(e)&&nn(e.length)&&!!V[me(e)]}var rd=ed;function td(e){return function(r){return e(r)}}var yr=td,Se=Ie(function(e,r){var t=r&&!r.nodeType&&r,o=t&&!0&&e&&!e.nodeType&&e,l=o&&o.exports===t,s=l&&Xa.process,u=function(){try{var p=o&&o.require&&o.require("util").types;return p||s&&s.binding&&s.binding("util")}catch(_){}}();e.exports=u}),on=Se&&Se.isTypedArray,ad=on?yr(on):rd,pt=ad,nd=Object.prototype,od=nd.hasOwnProperty;function id(e,r){var t=Me(e),o=!t&&mr(e),l=!t&&!o&&tr(e),s=!t&&!o&&!l&&pt(e),u=t||o||l||s,p=u?_f(e.length,String):[],_=p.length;for(var m in e)(r||od.call(e,m))&&!(u&&(m=="length"||l&&(m=="offset"||m=="parent")||s&&(m=="buffer"||m=="byteLength"||m=="byteOffset")||dt(m,_)))&&p.push(m);return p}var ht=id,ld=Object.prototype;function sd(e){var r=e&&e.constructor,t=typeof r=="function"&&r.prototype||ld;return e===t}var br=sd;function cd(e,r){return function(t){return e(r(t))}}var _t=cd;function ud(e){return e!=null&&nn(e.length)&&!hr(e)}var Ue=ud;function fd(e){var r=[];if(e!=null)for(var t in Object(e))r.push(t);return r}var dd=fd,pd=Object.prototype,hd=pd.hasOwnProperty;function _d(e){if(!fe(e))return dd(e);var r=br(e),t=[];for(var o in e)o=="constructor"&&(r||!hd.call(e,o))||t.push(o);return t}var gd=_d;function vd(e){return Ue(e)?ht(e,!0):gd(e)}var Oe=vd,wr=Ie(function(e,r){var t=r&&!r.nodeType&&r,o=t&&!0&&e&&!e.nodeType&&e,l=o&&o.exports===t,s=l?se.Buffer:void 0,u=s?s.allocUnsafe:void 0;function p(_,m){if(m)return _.slice();var w=_.length,b=u?u(w):new _.constructor(w);return _.copy(b),b}e.exports=p});function md(e,r){var t=-1,o=e.length;for(r||(r=Array(o));++t<o;)r[t]=e[t];return r}var xr=md,yd=_t(Object.getPrototypeOf,Object),ar=yd,bd=se.Uint8Array,ln=bd;function wd(e){var r=new e.constructor(e.byteLength);return new ln(r).set(new ln(e)),r}var kr=wd;function xd(e,r){var t=r?kr(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.length)}var jr=xd,sn=Object.create,kd=function(){function e(){}return function(r){if(!fe(r))return{};if(sn)return sn(r);e.prototype=r;var t=new e;return e.prototype=void 0,t}}(),jd=kd;function Cd(e){return typeof e.constructor=="function"&&!br(e)?jd(ar(e)):{}}var Cr=Cd;function Td(e,r,t){(t!==void 0&&!Ye(e[r],t)||t===void 0&&!(r in e))&&vr(e,r,t)}var gt=Td;function Md(e){return function(r,t,o){for(var l=-1,s=Object(r),u=o(r),p=u.length;p--;){var _=u[e?p:++l];if(t(s[_],_,s)===!1)break}return r}}var Sd=Md,Od=Sd(),$d=Od;function Pd(e){return he(e)&&Ue(e)}var Ed=Pd,zd="[object Object]",Ad=Function.prototype,Ld=Object.prototype,cn=Ad.toString,Fd=Ld.hasOwnProperty,Id=cn.call(Object);function Nd(e){if(!he(e)||me(e)!=zd)return!1;var r=ar(e);if(r===null)return!0;var t=Fd.call(r,"constructor")&&r.constructor;return typeof t=="function"&&t instanceof t&&cn.call(t)==Id}var Rd=Nd;function Gd(e,r){if(!(r==="constructor"&&typeof e[r]=="function")&&r!="__proto__")return e[r]}var vt=Gd;function Dd(e){return Te(e,Oe(e))}var qd=Dd;function Bd(e,r,t,o,l,s,u){var p=vt(e,t),_=vt(r,t),m=u.get(_);if(m){gt(e,t,m);return}var w=s?s(p,_,t+"",e,r,u):void 0,b=w===void 0;if(b){var y=Me(_),k=!y&&tr(_),H=!y&&!k&&pt(_);w=_,y||k||H?Me(p)?w=p:Ed(p)?w=xr(p):k?(b=!1,w=wr(_,!0)):H?(b=!1,w=jr(_,!0)):w=[]:Rd(_)||mr(_)?(w=p,mr(p)?w=qd(p):(!fe(p)||hr(p))&&(w=Cr(_))):b=!1}b&&(u.set(_,w),l(w,_,o,s,u),u.delete(_)),gt(e,t,w)}var Ud=Bd;function un(e,r,t,o,l){e!==r&&$d(r,function(s,u){if(l||(l=new gr),fe(s))Ud(e,r,u,t,un,o,l);else{var p=o?o(vt(e,u),s,u+"",e,r,l):void 0;p===void 0&&(p=s),gt(e,u,p)}},Oe)}var Hd=un;function Zd(e){return e}var fn=Zd;function Wd(e,r,t){switch(t.length){case 0:return e.call(r);case 1:return e.call(r,t[0]);case 2:return e.call(r,t[0],t[1]);case 3:return e.call(r,t[0],t[1],t[2])}return e.apply(r,t)}var Vd=Wd,dn=Math.max;function Jd(e,r,t){return r=dn(r===void 0?e.length-1:r,0),function(){for(var o=arguments,l=-1,s=dn(o.length-r,0),u=Array(s);++l<s;)u[l]=o[r+l];l=-1;for(var p=Array(r+1);++l<r;)p[l]=o[l];return p[r]=t(u),Vd(e,this,p)}}var Kd=Jd;function Xd(e){return function(){return e}}var Yd=Xd,Qd=rr?function(e,r){return rr(e,"toString",{configurable:!0,enumerable:!1,value:Yd(r),writable:!0})}:fn,ep=Qd,rp=800,tp=16,ap=Date.now;function np(e){var r=0,t=0;return function(){var o=ap(),l=tp-(o-t);if(t=o,l>0){if(++r>=rp)return arguments[0]}else r=0;return e.apply(void 0,arguments)}}var op=np,ip=op(ep),lp=ip;function sp(e,r){return lp(Kd(e,r,fn),e+"")}var cp=sp;function up(e,r,t){if(!fe(t))return!1;var o=typeof r;return(o=="number"?Ue(t)&&dt(r,t.length):o=="string"&&r in t)?Ye(t[r],e):!1}var fp=up;function dp(e){return cp(function(r,t){var o=-1,l=t.length,s=l>1?t[l-1]:void 0,u=l>2?t[2]:void 0;for(s=e.length>3&&typeof s=="function"?(l--,s):void 0,u&&fp(t[0],t[1],u)&&(s=l<3?void 0:s,l=1),r=Object(r);++o<l;){var p=t[o];p&&e(r,p,o,s)}return r})}var pp=dp,hp=pp(function(e,r,t){Hd(e,r,t)}),_p=hp,pn=_p;function gp(e,r){for(var t=-1,o=e==null?0:e.length;++t<o&&r(e[t],t,e)!==!1;);return e}var vp=gp,mp=_t(Object.keys,Object),yp=mp,bp=Object.prototype,wp=bp.hasOwnProperty;function xp(e){if(!br(e))return yp(e);var r=[];for(var t in Object(e))wp.call(e,t)&&t!="constructor"&&r.push(t);return r}var kp=xp;function jp(e){return Ue(e)?ht(e):kp(e)}var mt=jp;function Cp(e,r){return e&&Te(r,mt(r),e)}var Tp=Cp;function Mp(e,r){return e&&Te(r,Oe(r),e)}var Sp=Mp;function Op(e,r){for(var t=-1,o=e==null?0:e.length,l=0,s=[];++t<o;){var u=e[t];r(u,t,e)&&(s[l++]=u)}return s}var $p=Op;function Pp(){return[]}var hn=Pp,Ep=Object.prototype,zp=Ep.propertyIsEnumerable,_n=Object.getOwnPropertySymbols,Ap=_n?function(e){return e==null?[]:(e=Object(e),$p(_n(e),function(r){return zp.call(e,r)}))}:hn,yt=Ap;function Lp(e,r){return Te(e,yt(e),r)}var Fp=Lp;function Ip(e,r){for(var t=-1,o=r.length,l=e.length;++t<o;)e[l+t]=r[t];return e}var gn=Ip,Np=Object.getOwnPropertySymbols,Rp=Np?function(e){for(var r=[];e;)gn(r,yt(e)),e=ar(e);return r}:hn,vn=Rp;function Gp(e,r){return Te(e,vn(e),r)}var Dp=Gp;function qp(e,r,t){var o=r(e);return Me(e)?o:gn(o,t(e))}var mn=qp;function Bp(e){return mn(e,mt,yt)}var Up=Bp;function Hp(e){return mn(e,Oe,vn)}var Zp=Hp,Wp=be(se,"DataView"),bt=Wp,Vp=be(se,"Promise"),wt=Vp,Jp=be(se,"Set"),xt=Jp,Kp=be(se,"WeakMap"),kt=Kp,yn="[object Map]",Xp="[object Object]",bn="[object Promise]",wn="[object Set]",xn="[object WeakMap]",kn="[object DataView]",Yp=ye(bt),Qp=ye(Ge),eh=ye(wt),rh=ye(xt),th=ye(kt),$e=me;(bt&&$e(new bt(new ArrayBuffer(1)))!=kn||Ge&&$e(new Ge)!=yn||wt&&$e(wt.resolve())!=bn||xt&&$e(new xt)!=wn||kt&&$e(new kt)!=xn)&&($e=function(e){var r=me(e),t=r==Xp?e.constructor:void 0,o=t?ye(t):"";if(o)switch(o){case Yp:return kn;case Qp:return yn;case eh:return bn;case rh:return wn;case th:return xn}return r});var jt=$e,ah=Object.prototype,nh=ah.hasOwnProperty;function oh(e){var r=e.length,t=new e.constructor(r);return r&&typeof e[0]=="string"&&nh.call(e,"index")&&(t.index=e.index,t.input=e.input),t}var ih=oh;function lh(e,r){var t=r?kr(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.byteLength)}var sh=lh,ch=/\w*$/;function uh(e){var r=new e.constructor(e.source,ch.exec(e));return r.lastIndex=e.lastIndex,r}var fh=uh,jn=Ce?Ce.prototype:void 0,Cn=jn?jn.valueOf:void 0;function dh(e){return Cn?Object(Cn.call(e)):{}}var ph=dh,hh="[object Boolean]",_h="[object Date]",gh="[object Map]",vh="[object Number]",mh="[object RegExp]",yh="[object Set]",bh="[object String]",wh="[object Symbol]",xh="[object ArrayBuffer]",kh="[object DataView]",jh="[object Float32Array]",Ch="[object Float64Array]",Th="[object Int8Array]",Mh="[object Int16Array]",Sh="[object Int32Array]",Oh="[object Uint8Array]",$h="[object Uint8ClampedArray]",Ph="[object Uint16Array]",Eh="[object Uint32Array]";function zh(e,r,t){var o=e.constructor;switch(r){case xh:return kr(e);case hh:case _h:return new o(+e);case kh:return sh(e,t);case jh:case Ch:case Th:case Mh:case Sh:case Oh:case $h:case Ph:case Eh:return jr(e,t);case gh:return new o;case vh:case bh:return new o(e);case mh:return fh(e);case yh:return new o;case wh:return ph(e)}}var Ah=zh,Lh="[object Map]";function Fh(e){return he(e)&&jt(e)==Lh}var Ih=Fh,Tn=Se&&Se.isMap,Nh=Tn?yr(Tn):Ih,Rh=Nh,Gh="[object Set]";function Dh(e){return he(e)&&jt(e)==Gh}var qh=Dh,Mn=Se&&Se.isSet,Bh=Mn?yr(Mn):qh,Uh=Bh,Hh=1,Zh=2,Wh=4,Sn="[object Arguments]",Vh="[object Array]",Jh="[object Boolean]",Kh="[object Date]",Xh="[object Error]",On="[object Function]",Yh="[object GeneratorFunction]",Qh="[object Map]",e_="[object Number]",$n="[object Object]",r_="[object RegExp]",t_="[object Set]",a_="[object String]",n_="[object Symbol]",o_="[object WeakMap]",i_="[object ArrayBuffer]",l_="[object DataView]",s_="[object Float32Array]",c_="[object Float64Array]",u_="[object Int8Array]",f_="[object Int16Array]",d_="[object Int32Array]",p_="[object Uint8Array]",h_="[object Uint8ClampedArray]",__="[object Uint16Array]",g_="[object Uint32Array]",Z={};Z[Sn]=Z[Vh]=Z[i_]=Z[l_]=Z[Jh]=Z[Kh]=Z[s_]=Z[c_]=Z[u_]=Z[f_]=Z[d_]=Z[Qh]=Z[e_]=Z[$n]=Z[r_]=Z[t_]=Z[a_]=Z[n_]=Z[p_]=Z[h_]=Z[__]=Z[g_]=!0;Z[Xh]=Z[On]=Z[o_]=!1;function Tr(e,r,t,o,l,s){var u,p=r&Hh,_=r&Zh,m=r&Wh;if(t&&(u=l?t(e,o,l,s):t(e)),u!==void 0)return u;if(!fe(e))return e;var w=Me(e);if(w){if(u=ih(e),!p)return xr(e,u)}else{var b=jt(e),y=b==On||b==Yh;if(tr(e))return wr(e,p);if(b==$n||b==Sn||y&&!l){if(u=_||y?{}:Cr(e),!p)return _?Dp(e,Sp(u,e)):Fp(e,Tp(u,e))}else{if(!Z[b])return l?e:{};u=Ah(e,b,p)}}s||(s=new gr);var k=s.get(e);if(k)return k;s.set(e,u),Uh(e)?e.forEach(function(W){u.add(Tr(W,r,t,W,e,s))}):Rh(e)&&e.forEach(function(W,A){u.set(A,Tr(W,r,t,A,e,s))});var H=m?_?Zp:Up:_?Oe:mt,K=w?void 0:H(e);return vp(K||e,function(W,A){K&&(A=W,W=e[A]),ft(u,A,Tr(W,r,t,A,e,s))}),u}var v_=Tr,m_=1,y_=4;function b_(e){return v_(e,m_|y_)}var w_=b_,Pn=w_;var x_={paramString:ua,promiseAll:fa,dataURLtoBlob:ga,turf:{pointOnFeature:Wa,kinks:Va,flatten:Ja,circle:Ka},lodash:{merge:pn,cloneDeep:Pn},xhr:da,icon:ha,loadPlugins:_a,getCircularReplacer:va,isolineHereDecode:ma,chroma:za,nanoid:Aa,render:$a,html:Pa,svg:Ea},En=x_;var Y={current:{layers:[],locations:[]},set:j_,parse:k_,remove:zn,removeAll:C_,push:T_,filter:M_},Ct=Y;function k_(){window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,(e,r,t)=>{Y.current[r]?Y.current[r]=decodeURI(t).split(","):Y.current[r]=decodeURI(t)}),Y.current.token&&(window.history.replaceState({},document.title,window.location.href.replace(new RegExp(`token=${Y.current.token}`),"")),delete Y.current.token)}function j_(e){Object.assign(Y.current,e),nr()}function zn(e){Array.isArray(Y.current[e])?Y.current[e].length=0:delete Y.current[e],nr()}function C_(){Object.keys(Y.current).forEach(e=>zn(e)),nr()}function T_(e,r){Y.current[e]?Y.current[e].indexOf(r)<0&&Y.current[e].push(r):Y.current[e]=[r],nr()}function M_(e,r){Y.current[e]=Y.current[e].filter(t=>t!==r),nr()}function nr(){try{window.history.pushState({},document.title,`?${mapp.utils.paramString(Y.current)}`)}catch(e){console.log(e)}}var An={search_header:"Search",search_no_results:"No results for this search",locales_header:"Locales",show_layers_for_locale:"Show layers for the following locale",layers_header:"Layers",locations_header:"Locations",clear_all_locations:"Clear all locations",layer_group_hide_layers:"Hide layers from group",layer_group_toggle:"Toggle group panel",layer_default_icon:"Default icon",layer_zoom_to_extent:"Zoom to filtered layer extent",layer_visibility:"Toggle visibility",layer_toggle_dashboard:"Toggle layer dashboard",layer_style_header:"Style",layer_style_select_theme:"Select thematic style",layer_style_bring_to_front:"Bring layer to front",layer_style_display_labels:"Display labels",layer_style_switch_caption:"Click on labels to switch visibity or ",layer_style_switch_all:"switch all",layer_grid_legend_min:"min",layer_grid_legend_max:"max",layer_grid_legend_avg:"avg",layer_grid_legend_ratio:"Display colour as a ratio to the size",layer_style_other:"other",layer_style_cluster:"Multiple locations",layer_filter_header:"Filter",layer_filter_select:"Select filter from list",layer_filter_run:"Run Output",layer_filter_clear_all:"Clear all filters",layer_filter_date_after:"After",layer_filter_date_before:"Before",layer_filter_pick:"Pick from calendar",layer_filter_boolean:"True",layer_filter_greater:"Greater or equal",layer_filter_smaller:"Smaller or equal",layer_filter_text:"Search",layer_data:"Layer data",layer_data_viewport_only:"Features in viewport only",layer_data_geojson:"Download as GeoJSON",layer_download:"Download",layer_dataview_header:"Data Views",layer_add_new_location:"Add new locations",layer_draw_point:"Point",layer_draw_polygon:"Polygon",layer_draw_rectangle:"Rectangle",layer_draw_circle:"Circle",layer_draw_line:"Line",layer_draw_freehand:"Freehand",layer_draw_edit:"Edit",layer_draw_save:"Save",layer_draw_update:"Update",layer_draw_undo:"Undo",layer_draw_cancel:"Cancel",layer_draw_last:"Remove last vertex",layer_draw_error:"Invalid geometry. Right click to continue.",layer_draw_isoline_mapbox:"Isoline Mapbox",layer_draw_isoline_here:"Isoline Here",mapbox_isoline_settings:"Mapbox Isoline settings",mapbox_mode:"Mode",mapbox_travel_time:"Travel time in minutes ",mapbox_driving:"Driving",mapbox_walking:"Walking",mapbox_cycling:"Cycling",mapbox_minutes:"Minutes",mapbox_created:"Created",mapbox_error:"No route found. Try alternative set up.",here_isoline_settings:"Here Isoline settings",here_mode:"Mode",here_range:"Range",here_range_type:"Range type",here_routing_type_balanced:"balanced",here_destination:"Destination",here_departure:"Departure",here_enable_traffic:"Enable traffic",here_time:"Time (min)",here_distance:"Distance (km)",here_driving:"driving",here_walking:"walking",here_cargo:"truck",here_hov_lane:"HOV lane",here_created:"Created",here_travel_time:"Travel time in minutes ",here_travel_distance:"Travel distance in kilometres ",here_error:"No route found. Try a longer travel time or alternative setup.",location_drawer_toggle:"Toggle location view drawer",location_zoom:"Zoom map to feature bounds",location_hide_marker:"Hide marker",location_save:"Save changes to cloud",location_remove:"Remove feature from selection",location_edit_geometry:"Edit location geometry",location_no_geometry:"No geometry found for this location.",location_geometry_delete_msg:"Are you sure you want to delete this additional geometry?",location_delete:"Delete location",location_source_layer:"Source layer",location_json_edit_msg:"Invalid JSON.",toolbar_zoom_in:"Zoom in",toolbar_zoom_out:"Zoom out",toolbar_zoom_to_area:"Zoom to area",toolbar_current_location:"Current location",toolbar_measure:"Measure distance",toolbar_fullscreen:"Fullscreen mapview",toolbar_admin:"Open account admin view",toolbar_logout:"Logout",here_transport_mode:"Mode",here_depart:"Depart at",here_arrive:"Arrive at",here_use_as_destination:"Use as destination",here_routing_type_fastest:"fast",here_routing_type_shortest:"short",here_routing_type:"Routing type",here_optimize_for:"Optimize for",here_optimize_for_balanced:"balanced",here_optimize_for_quality:"quality",here_optimize_for_performance:"performance",dataview_no_data:"No data available here."};var Ln={layers_header:"Ebenen",locations_header:"Orte",clear_all_locations:"Entferne Auswahl"};var Fn={search_header:"Rechercher",search_no_results:"Aucun resultat pour cette recherche",locales_header:"Aires",show_layers_for_locale:"Afficher les couches pour l'aire",layers_header:"Couches",locations_header:"Lieux",clear_all_locations:"Desélectionner tous les lieux.",layer_group_hide_layers:"Cacher les couches du groupe",layer_group_toggle:"Basculer le panneau du groupe",layer_default_icon:"L'icône par défaut",layer_zoom_to_extent:"Zoom sur l'étendue de la couche",layer_visibility:"Changer la visiblité",layer_toggle_dashboard:"Basculer le tableau de bord de la couche",layer_style_header:"Style",layer_style_select_theme:"Choisir un thème dans la liste",layer_style_bring_to_front:"La mettre à l'avant",layer_style_display_labels:"Afficher les étiquettes",layer_style_switch_caption:"Cliquer sur l'etiquette pour changer la visiblité ou ",layer_style_switch_all:"changer tout",layer_grid_legend_min:"min",layer_grid_legend_max:"max",layer_grid_legend_avg:"avg",layer_grid_legend_ratio:"Rapport de coleur et de taille",layer_style_other:"autre",layer_style_cluster:"Plusieurs lieux",layer_filter_header:"Filtres",layer_filter_select:"Choisir un filtre dans la liste",layer_filter_run:"Obtenir les resultats",layer_filter_clear_all:"Effacer tous les filtres",layer_filter_date_after:"Après",layer_filter_date_before:"Avant",layer_filter_pick:"Dans le calendrier",layer_filter_boolean:"Vrai",layer_filter_greater:"Supérieur ou égal",layer_filter_smaller:"Inférieur ou égal",layer_filter_text:"Rechercher",layer_data:"Données de la couche",layer_data_viewport_only:"Seulement caractéristiques en écran",layer_data_geojson:"Télécharger GeoJSON",layer_dataview_header:"Vues des données",layer_add_new_location:"Ajouter des nouveaux lieux",layer_draw_point:"Point",layer_draw_polygon:"Polygone",layer_draw_rectangle:"Rectangle",layer_draw_circle:"Cercle",layer_draw_line:"Ligne",layer_draw_freehand:"À main levée",layer_draw_edit:"Modifier",layer_draw_save:"Enregister",layer_draw_update:"Actualiser",layer_draw_undo:"Revenir",layer_draw_cancel:"Annuler",layer_draw_last:"Effacer le dernier point",layer_draw_error:"Cette géométrie est invalide. Cliquer droit pour continuer.",layer_draw_isoline_mapbox:"Isoligne de Mapbox",layer_draw_isoline_here:"Isoligne de Here",mapbox_isoline_settings:"Paramètres de Mapbox",mapbox_mode:"Mode",mapbox_travel_time:"Temps du trajet en minutes ",mapbox_driving:"En voiture",mapbox_walking:"À pied",mapbox_cycling:"À velo",mapbox_minutes:"Minutes",mapbox_created:"Créée",mapbox_error:"Aucune route n'est trouvée. Essayez d'autres paramètres.",here_isoline_settings:"Paramètres de Here",here_mode:"Mode",here_range:"Ampleur",here_range_type:"Type de l'ampleur",here_time:"Temps (min)",here_distance:"Distance (km)",here_driving:"en voiture",here_walking:"à pied",here_cargo:"Le cargo",here_hov_lane:"Voie réservée au covoiturage (HOV)",here_created:"Créée",here_travel_time:"Temps du trajet en minutes ",here_travel_distance:"Distance du trajet en kilometres ",here_error:"Aucune route n'est trouvée. Essayez d'autres paramètres.",location_drawer_toggle:"Basculer le panneau du lieu",location_zoom:"Zoom sur le lieu",location_hide_marker:"Cacher le marqueur",location_save:"Enregistrer les modifications",location_remove:"Le désélectionner",location_edit_geometry:"Modifier la géométrie du lieu",location_no_geometry:"Les géométries n'existent pas pour ce lieux.",location_geometry_delete_msg:"Voulez-vous supprimer la géométrie supplémentaire? Cela ne peut être défait.",location_delete:"Supprimer le lieu",location_json_edit_msg:"Objet JSON incorrect.",location_source_layer:"La couche de source",toolbar_zoom_in:"Zoomer",toolbar_zoom_out:"Dé-zoomer",toolbar_zoom_to_area:"Zoomer sur un encadré",toolbar_current_location:"Localisation actuelle",toolbar_measure:"Mesurer des distances",toolbar_fullscreen:"Carte en plein écran",toolbar_admin:"Afficher le compte administrateur",toolbar_logout:"Se déconnecter du compte",here_transport_mode:"Type de transport",here_depart:"Partir à",here_arrive:"Arriver à",here_use_as_destination:"En tant que destination",here_routing_type_fastest:"vite",here_routing_type_shortest:"court",here_routing_type:"Type de trajet",here_optimize_for:"Optimiser",here_optimize_for_balanced:"l'équilibre",here_optimize_for_quality:"la qualité",here_optimize_for_performance:"les performances",dataview_no_data:"Aucune donnée disponible."};var In={search_header:"Szukaj",search_no_results:"Nic nie znaleziono",locales_header:"Regiony",show_layers_for_locale:"Pokaż warstwy dle tego regionu",layers_header:"Warstwy",locations_header:"Miejsca",clear_all_locations:"Wyczyść selekcje",layer_group_hide_layers:"Ukryj warstwy z tej grupy",layer_group_toggle:"Widoczność panelu grupy",layer_default_icon:"Domyślny symbol",layer_zoom_to_extent:"Pokaż zasięg warstwy",layer_visibility:"Widoczność",layer_toggle_dashboard:"Widoczność panelu warstwy",layer_style_header:"Styl",layer_style_select_theme:"Wybierz styl tematyczny",layer_style_bring_to_front:"Warstwa na wierzch",layer_style_display_labels:"Pokaż etykiety",layer_style_switch_caption:"Kliknij etykiety aby zmienić widoczność albo ",layer_style_switch_all:"zmień wszystkie",layer_grid_legend_min:"min.",layer_grid_legend_max:"maks.",layer_grid_legend_avg:"śred.",layer_grid_legend_ratio:"Pokaż kolor w proporcji do rozmiaru",layer_style_other:"inne",layer_style_cluster:"Więcej miejsc",layer_filter_header:"Filtruj",layer_filter_select:"Wybierz filtr z listy",layer_filter_run:"Przelicz",layer_filter_clear_all:"Wyczyść filtry",layer_filter_date_after:"Przed",layer_filter_date_before:"Po",layer_filter_pick:"Z kalendarza",layer_filter_boolean:"Tak",layer_filter_greater:"Większe lub równe",layer_filter_smaller:"Mniejsze lub równe",layer_filter_text:"Szukaj",layer_data:"Dane warstwy",layer_data_viewport_only:"Tylko widoczne",layer_data_geojson:"Pobierz jako GeoJSON",layer_dataview_header:"Widoki danych",layer_add_new_location:"Dodaj nowe miejsca",layer_draw_point:"Punkt",layer_draw_polygon:"Poligon",layer_draw_rectangle:"Prostokąt",layer_draw_circle:"Okrag",layer_draw_line:"Linia",layer_draw_freehand:"Odręcznie",layer_draw_edit:"Edytuj",layer_draw_save:"Zapisz",layer_draw_update:"Zmień",layer_draw_undo:"Cofnij",layer_draw_cancel:"Anuluj",layer_draw_last:"Usuń ostatni wierzchołek",layer_draw_error:"Niepoprawna geometria. Kliknij prawym aby kontynuować.",layer_draw_isoline_mapbox:"Izolinia Mapbox",layer_draw_isoline_here:"Izolinia Here",mapbox_isoline_settings:"Ustawienia izolinii Mapbox",mapbox_mode:"Typ",mapbox_travel_time:"Czas podróży w minutach ",mapbox_driving:"Samochodem",mapbox_walking:"Piechotą",mapbox_cycling:"Rowerem",mapbox_minutes:"Minuty",mapbox_created:"Utworzono",mapbox_error:"Nie znaleziono trasy. Wypróbuj inne ustawienia.",here_isoline_settings:"Ustawienia izolinii Here",here_mode:"Typ",here_range:"Zasięg",here_range_type:"Typ zasięgu",here_time:"Czas (min)",here_distance:"Odległość (km)",here_driving:"samochodem",here_walking:"piechotą",here_cargo:"transport towarów",here_hov_lane:"transport osób",here_created:"Utworzono",here_travel_time:"Czas podróży w minutach ",here_travel_distance:"Odległość w kilometrach ",here_error:"Nie znaleziono trasy. Wypróbuj dłuższy czas podróży lub inne ustawienia.",location_drawer_toggle:"Widoczność panelu miejsca",location_zoom:"Pokaż zasięg miejsca",location_hide_marker:"Ukryj ikonę",location_save:"Zapisz zmiany",location_remove:"Odznacz miejsce",location_edit_geometry:"Edytuj geometrię miejsca",location_no_geometry:"Nie znaleziono geometrii dla tego miejsca.",location_geometry_delete_msg:"Czy na pewno chcesz usunąć geometrię towarzyszącą? Tego nie można cofnąć.",location_delete:"Usuń miejsce",location_source_layer:"Warstaw źródłowa",location_json_edit_msg:"Niepoprawny obiekt JSON.",toolbar_zoom_in:"Powiększ",toolbar_zoom_out:"Pomniejsz",toolbar_zoom_to_area:"Pokaż obszar",toolbar_current_location:"Obecna lokalizacja",toolbar_measure:"Pomiar odległości",toolbar_fullscreen:"Mapa na pełnym ekranie",toolbar_admin:"Pokaż konto administratora",toolbar_logout:"Wyloguj się",here_transport_mode:"Środek transportu",here_depart:"Rozpocznij",here_arrive:"Osiągnij cel",here_use_as_destination:"Jako cel podróży",here_routing_type_fastest:"szybka",here_routing_type_shortest:"krótka",here_routing_type:"Trasa",here_optimize_for:"Optymalizacja",here_optimize_for_balanced:"zrównoważona",here_optimize_for_quality:"jakość",here_optimize_for_performance:"wydajność",dataview_no_data:"Brak danych do wyświetlenia."};var Nn={search_header:"検索",search_no_results:"結果なし",locales_header:"ロカール",show_layers_for_locale:"以下のロカールに対しレイヤーを表示",layers_header:"レイヤー",locations_header:"ロケーション",clear_all_locations:"全ロケーションをクリア",layer_group_hide_layers:"グループからレイヤーを隠す",layer_group_toggle:"グループパネル切替え",layer_default_icon:"デフォルトアイコン",layer_zoom_to_extent:"フィルターされたレイヤー範囲をズームに",layer_visibility:"表示切替",layer_toggle_dashboard:"レイヤーダッシュボード切替え",layer_style_header:"スタイル",layer_style_select_theme:"テーマスタイルを選択",layer_style_bring_to_front:"レイヤーを前に",layer_style_display_labels:"ラベルを表示",layer_style_switch_caption:"表示切替えには各ラベルをクリックするか ",layer_style_switch_all:"全表示或いは全非表示",layer_grid_legend_min:"最小",layer_grid_legend_max:"最大",layer_grid_legend_avg:"平均",layer_grid_legend_ratio:"色はサイズの比率で表示",layer_style_other:"その他",layer_style_cluster:"多数のロケーション",layer_filter_header:"フィルター",layer_filter_select:"リストからフィルターを選択",layer_filter_run:"アウトプットを実行",layer_filter_clear_all:"全フィルターをクリア",layer_filter_date_after:"後",layer_filter_date_before:"前",layer_filter_pick:"カレンダーから選択",layer_filter_boolean:"TRUE",layer_filter_greater:"以上",layer_filter_smaller:"以下",layer_filter_text:"検索",layer_data:"Layer data",layer_data_viewport_only:"Features in viewport only",layer_data_geojson:"Download as GeoJSON",layer_dataview_header:"データビュー",layer_add_new_location:"新しいロケーションを追加",layer_draw_point:"ポイント",layer_draw_polygon:"ポリゴン",layer_draw_rectangle:"長方形",layer_draw_circle:"丸",layer_draw_line:"線",layer_draw_freehand:"フリーハンド",layer_draw_edit:"編集",layer_draw_save:"保存",layer_draw_update:"更新",layer_draw_undo:"アンドゥ",layer_draw_cancel:"キャンセル",layer_draw_last:"最後のバーテックスを削除",layer_draw_error:"無効なジオメトリー 右クリックで続ける",layer_draw_isoline_mapbox:"イソリン MAPBOX",layer_draw_isoline_here:"イソリン HERE",mapbox_isoline_settings:"MAPBOXのイソリン設定",mapbox_mode:"モード",mapbox_travel_time:"移動時間 (分) ",mapbox_driving:"ドライビング",mapbox_walking:"ウォーキング",mapbox_cycling:"サイクリング",mapbox_recent:"最近のイソリン",mapbox_minutes:"移動時間 (分)",mapbox_created:"作成済",mapbox_error:"ルートなし、他の設定を選んでください",here_isoline_settings:"HEREのイソリン設定",here_mode:"モード",here_range:"範囲",here_range_type:"範囲タイプ",here_time:"移動時間 (分)",here_distance:"移動距離 (km)",here_driving:"ドライビング",here_walking:"ウォーキング",here_cargo:"貨物",here_hov_lane:"HOV（High Occupied Vehicle乗車率の高い車用）レーン",here_recent:"最近のイソリン",here_created:"作成済",here_travel_time:"移動時間 (分) ",here_travel_distance:"移動距離 (km) ",here_error:"ルートなし、より長い移動時間、或いは他の設定を選んでください",location_drawer_toggle:"ロケーションビュードロワーをトグル",location_zoom:"フィーチャ範囲にはマップをズーム",location_hide_marker:"マーカーを隠す",location_save:"クラウドに変更を保存",location_remove:"選択からフィーチャー（機能）を削除",location_edit_geometry:"ロケーションジオメトリーを編集",location_no_geometry:"この場所のジオメトリが見つかりません。",location_geometry_delete_msg:"追加ジオメトリーを本当に削除しますか。取り消し不可",location_delete:"ロケーションを削除",location_source_layer:"元のレイヤー",location_json_edit_msg:"無効なJSON",toolbar_zoom_in:"ズームイン",toolbar_zoom_out:"ズームアウト",toolbar_zoom_to_area:"エリアをズームに",toolbar_current_location:"現在地",toolbar_measure:"距離を計測",toolbar_fullscreen:"フルスクリーン マップビュー",toolbar_admin:"アカウントアドミンビューを開く",toolbar_logout:"ログアウト"};var Rn={search_header:"검색",search_no_results:"검색결과 없음",locales_header:"현장",show_layers_for_locale:"다음 현장의 레이어(층) 보여주기",layers_header:"레이어(층)",locations_header:"위치",clear_all_locations:"모든 위치 제거",layer_group_hide_layers:"그룹에서 레이어 숨기기",layer_group_toggle:"토글 그룹 패널",layer_default_icon:"기본 아이콘",layer_zoom_to_extent:"필터된 레이어크기에 줌(zoom)",layer_visibility:"토글 가시성",layer_toggle_dashboard:"토글 레이어 계기판",layer_style_header:"스타일",layer_style_select_theme:"주제별 스타일 선택",layer_style_bring_to_front:"레이어 앞으로 가져오기",layer_style_display_labels:"라벨 표시",layer_style_switch_caption:"가시성 변경을 위해 라벨 클릭 또는 ",layer_style_switch_all:"모두 변경",layer_grid_legend_min:"최소",layer_grid_legend_max:"최대",layer_grid_legend_avg:"평균",layer_grid_legend_ratio:"크기비율에 따른 색상 표시",layer_style_other:"기타",layer_style_cluster:"복수 위치",layer_filter_header:"필터",layer_filter_select:"리스트로 부터 필터 선택",layer_filter_run:"결과 표시",layer_filter_clear_all:"전체 필터 제거",layer_filter_date_after:"전",layer_filter_date_before:"후",layer_filter_pick:"달력에서 선택",layer_filter_boolean:"참",layer_filter_greater:"이상",layer_filter_smaller:"이하",layer_filter_text:"검색",layer_data:"Layer data",layer_data_viewport_only:"Features in viewport only",layer_data_geojson:"Download as GeoJSON",layer_dataview_header:"데이터 보기",layer_add_new_location:"새로운 위치 추가",layer_draw_point:"점",layer_draw_polygon:"다각형",layer_draw_rectangle:"직사각형",layer_draw_circle:"원",layer_draw_line:"선",layer_draw_freehand:"손으로 그림(자유 재량)",layer_draw_edit:"편집",layer_draw_save:"저장",layer_draw_update:"업데이트",layer_draw_undo:"되돌리기",layer_draw_cancel:"취소",layer_draw_last:"마지막 정점(꼭지점) 제거",layer_draw_error:"타당하지 않는 지오메트리. 계속하려면 마우스오른쪽 클릭",layer_draw_isoline_mapbox:"등치선 맵박스",layer_draw_isoline_here:"Here 등치선",mapbox_isoline_settings:"등치선 Mapbox",mapbox_mode:"모드",mapbox_travel_time:"여행시간(분) ",mapbox_driving:"운전",mapbox_walking:"도보",mapbox_cycling:"사이클",mapbox_recent:"최근 등치선",mapbox_minutes:"여행시간(분)",mapbox_created:"생성",mapbox_error:"경로 없음. 다른 설정 시도",here_isoline_settings:"등치선 Here",here_mode:"모드",here_range:"범위",here_range_type:"범위 유형",here_time:"여행시간(분)",here_distance:"여행거리(km)",here_driving:"운전",here_walking:"도보",here_cargo:"화물",here_hov_lane:"다인승 전용차로",here_recent:"최근 등치선",here_created:"생성",here_travel_time:"여행시간(분) ",here_travel_distance:"여행거리(km) ",here_error:"경로 없음. 더 긴 여행시간 또는 다른 설정 시도",location_drawer_toggle:"토글 위치 뷰 함",location_zoom:"한계를 포함한 줌 지도",location_hide_marker:"마커 숨기기",location_save:"변경사항 크라우드 저장",location_remove:"선택에서 특징 제거",location_edit_geometry:"위치 지오메트리 편집",location_no_geometry:"이 위치에 대한 지오메트리가 없습니다.",location_geometry_delete_msg:"추가적인 지오메트리 삭제를 원하십니까? 되돌리기 불가",location_delete:"위치 삭제",location_source_layer:"자료 출처 레이어",location_json_edit_msg:"타당하지않은 JSON",toolbar_zoom_in:"줌인",toolbar_zoom_out:"줌아웃",toolbar_zoom_to_area:"해당지역 줌(Zoom)",toolbar_current_location:"현재 위치",toolbar_measure:"거리측정",toolbar_fullscreen:"지도뷰 전체화면",toolbar_admin:"계정관리뷰 오픈",toolbar_logout:"로그아웃"};var Gn={search_header:"搜索",search_no_results:"未找到相关地点",locales_header:"地区",show_layers_for_locale:"显示以下地区",layers_header:"图层",locations_header:"地点",clear_all_locations:"清除所有地点",layer_group_hide_layers:"隐藏图层",layer_group_toggle:"切换组面板",layer_default_icon:"默认图标",layer_zoom_to_extent:"缩放至相应筛选范围",layer_visibility:"切换可见性",layer_toggle_dashboard:"切换图层仪表板",layer_style_header:"风格样式",layer_style_select_theme:"选择主题风格",layer_style_bring_to_front:"图层置顶",layer_style_display_labels:"显示标签",layer_style_switch_caption:"单击图标以切换可见性 ",layer_style_switch_all:"全部切换",layer_grid_legend_min:"最低",layer_grid_legend_max:"最高",layer_grid_legend_avg:"平均",layer_grid_legend_ratio:"显示颜色与尺寸比例",layer_style_other:"其它",layer_style_cluster:"多个地点",layer_filter_header:"筛选",layer_filter_select:"从列表筛选",layer_filter_run:"输出结果",layer_filter_clear_all:"清除所有筛选设置",layer_filter_date_after:"后",layer_filter_date_before:"前",layer_filter_pick:"从日历中选择",layer_filter_boolean:"TRUE",layer_filter_greater:"大于或等于",layer_filter_smaller:"小于或等于",layer_filter_text:"搜索",layer_data:"图层数据",layer_data_viewport_only:"仅当前页面要素",layer_data_geojson:"下载为GeoJSON",layer_dataview_header:"数据检视",layer_add_new_location:"数据检视",layer_draw_point:"点",layer_draw_polygon:"多边形",layer_draw_rectangle:"长方形",layer_draw_circle:"圈",layer_draw_line:"线",layer_draw_freehand:"任意图形",layer_draw_edit:"编辑",layer_draw_save:"保存",layer_draw_update:"更新",layer_draw_undo:"撤消",layer_draw_cancel:"取消",layer_draw_last:"删除最后一个顶点",layer_draw_error:"无效图形，单击右键以继续",layer_draw_isoline_mapbox:"等值线图框",layer_draw_isoline_here:"此处等值线",mapbox_isoline_settings:"Mapbox等值线设置",mapbox_mode:"模式",mapbox_travel_time:"以分钟计交通时间 ",mapbox_driving:"机动车行",mapbox_walking:"步行",mapbox_cycling:"骑行",mapbox_recent:"最近期的等值线",mapbox_minutes:"以分钟计交通时间",mapbox_created:"已建立",mapbox_error:"找不到路线，尝试其他设置",here_isoline_settings:"Here等值线设置",here_mode:"模式",here_range:"范围",here_range_type:"范围类型",here_time:"以分钟计交通时间",here_distance:"行驶距离（公里）",here_driving:"机动车行",here_walking:"步行",here_cargo:"货物",here_hov_lane:"HOV（High Occupied Vehicle)车道",here_recent:"最近期的等值线",here_created:"已建立",here_travel_time:"以分钟计交通时间 ",here_travel_distance:"行驶距离（公里）",here_error:"找不到路线，请尝试增长交通时间或其他设置。",location_drawer_toggle:"切换地点位置视图",location_zoom:"缩放地图至目标范围",location_hide_marker:"隐藏标记",location_save:"将更改保存至云",location_remove:"删除所选目标要素",location_edit_geometry:"编辑地点或位置边界",location_no_geometry:"在此位置找不到幾何。",location_geometry_delete_msg:"是否确定删除新增的几何图形？命令执行后将无法撤消。",location_delete:"删除地点",location_source_layer:"查看所在图层",location_json_edit_msg:"无效的JSON",toolbar_zoom_in:"放大",toolbar_zoom_out:"缩小",toolbar_zoom_to_area:"缩放至区域",toolbar_current_location:"当前位置",toolbar_measure:"测量距离",toolbar_fullscreen:"全屏显示地图",toolbar_admin:"开启帐户管理员视图",toolbar_logout:"退出"};var Tt={en:An,de:Ln,fr:Fn,pl:In,ja:Nn,ko:Rn,zh:Gn};function Dn(e){let r=this,o=new ol.format.GeoJSON().readFeature({type:"Feature",geometry:e.geometry},{dataProjection:"EPSG:"+(e.dataProjection||r.srid),featureProjection:"EPSG:"+(e.featureProjection||r.srid)}),l=new ol.source.Vector({features:[o]}),s=new ol.layer.Vector({source:l,zIndex:isNaN(e.zIndex)?2e3:e.zIndex});return r.Map.addLayer(s),s}function qn(e){let r=this;r._popup={},r._popup.node&&r._popup.node.remove(),r._popup.node=mapp.utils.html.node`<div class="popup">`,r._popup.node.appendChild(e.content),r._popup.overlay&&r.Map.removeOverlay(r._popup.overlay),r._popup.overlay=new ol.Overlay({element:r._popup.node,position:e.coords||r.position,positioning:"bottom-center",autoPan:e.autoPan,insertFirst:!0,autoPanAnimation:{duration:250}}),r.Map.addOverlay(r._popup.overlay)}function Bn(e){let r=this,t=r.Map.getView().calculateExtent();if(!e)return{south:t[1],west:t[0],north:t[3],east:t[2]};let o=ol.proj.transformExtent(t,"EPSG:"+r.srid,"EPSG:"+e);return{south:o[1],west:o[0],north:o[3],east:o[2]}}function Un(){let e=this,r={featureSet:new Set};e.Map.on("pointermove",t),e.node.addEventListener("mouseout",o),e.Map.on("singleclick",s),e.node.style.cursor="auto";function t(u){e.pointerLocation={x:u.originalEvent.clientX,y:u.originalEvent.clientY},clearTimeout(r.timeout),r.timeout=setTimeout(()=>{let p=e.Map.forEachFeatureAtPixel(u.pixel,(_,m)=>({feature:_,featureLayer:m}),{layerFilter:_=>Object.values(e.layers.list).some(m=>m.display&&m.qID&&m.style?.highlight&&m.L===_),hitTolerance:5});if(!p){r.layer?.highlight&&l();return}r.layer===p.featureLayer.get("layer")&&r.layer.highlight===p.feature.get("id")||(r.layer!==p.featureLayer.get("layer")&&l(),r.feature=p.feature,r.layer=p.featureLayer.get("layer"),r.layer.highlight=p.feature.get("id"),u.originalEvent.pointerType!=="touch"&&r.layer.L.changed())},100)}function o(){e.pointerLocation={x:null,y:null},l()}function l(){!r.layer||(delete r.feature,delete r.layer.highlight,e.node.style.cursor="auto",r.layer.L.changed())}async function s(u){if(u.originalEvent.pointerType==="touch"&&t(u),!r.layer)return;let p=u.pixel;if(r.feature.get("properties")?.count)return e.locations.nnearest({layer:r.layer,table:r.layer.table||r.layer.tableCurrent(),feature:r.feature});e.locations.select({layer:r.layer,table:r.layer.table||r.layer.tableCurrent(),id:r.layer.highlight})}}var Hn=(e={})=>{if(!e.target||!e.locale)return;let r=e.locale,t={host:e.host||"",node:e.target,hooks:e.hooks,srid:r.srid||"3857",locale:e.locale,getZoom:O_,getBounds:Bn,geoJSON:Dn,popup:qn,flyToBounds:S_};t.locations={list:{},get:mapp.location.get.bind(t),select:mapp.location.select.bind(t),nnearest:mapp.location.nnearest.bind(t)},t.layers={list:{},add:mapp.layer.add.bind(t),get:mapp.layer.get.bind(t),decorate:mapp.layer.decorate.bind(t)},t.interactions={highlight:Un.bind(t)};let o=mapp.hooks?.current?.z||r.view?.z||r.minZoom||0,l=ol.proj.fromLonLat([parseFloat(mapp.hooks?.current?.lng||r.view?.lng||0),parseFloat(mapp.hooks?.current?.lat||r.view?.lat||0)]),s=r.bounds&&ol.proj.transformExtent([parseFloat(r.bounds.west||-180),parseFloat(r.bounds.south||-90),parseFloat(r.bounds.east||180),parseFloat(r.bounds.north||90)],"EPSG:4326",`EPSG:${t.srid}`),u=new ol.Map({target:t.node,interactions:ol.interaction.defaults({mouseWheelZoom:r.scrollWheelZoom||!1,PinchRotate:{threshold:3}}),controls:[],view:new ol.View({projection:`EPSG:${t.srid}`,zoom:o,minZoom:r.minZoom,maxZoom:r.maxZoom,center:l,extent:s})});if(t.Map=u,t.node.addEventListener("changeEnd",()=>{if(t.hooks){let m=ol.proj.transform(u.getView().getCenter(),`EPSG:${t.srid}`,"EPSG:4326");mapp.hooks.set({lat:m[1],lng:m[0],z:u.getView().getZoom()})}}),r.zoomControl&&u.addControl(new ol.control.Zoom),e.attribution?.target&&(t.attribution={target:e.attribution.target,links:mapp.utils.html.node`<div>`,check:()=>{let m=Object.assign({},e.attribution.links||{});Object.values(t.layers).forEach(w=>{w.display&&w.attribution&&Object.assign(m,w.attribution)}),mapp.utils.render(t.attribution.links,mapp.utils.html`
        ${Object.entries(m).map(w=>mapp.utils.html`
          <a target="_blank" href="${w[1]}">${w[0]}`)}`)}},t.attribution.target.appendChild(t.attribution.links),t.attribution.check()),r.showScaleBar&&u.addControl(new ol.control.ScaleLine({target:"ol-scale",units:r.showScaleBar.units?r.showScaleBar.units:"metric"})),r.maskBounds){let m=[[180,90],[180,-90],[-180,-90],[-180,90],[180,90]],w=[[r.bounds.east,r.bounds.north],[r.bounds.east,r.bounds.south],[r.bounds.west,r.bounds.south],[r.bounds.west,r.bounds.north],[r.bounds.east,r.bounds.north]],b=new ol.Feature({geometry:new ol.geom.Polygon([m,w]).transform("EPSG:4326",`EPSG:${t.srid}`)}),y=new ol.layer.Vector({source:new ol.source.Vector({features:[b]}),style:new ol.style.Style({fill:new ol.style.Fill({color:mapp.utils.chroma("#000").alpha(.2).rgba()})}),zIndex:999});u.addLayer(y)}u.on("moveend",_);let p;function _(){clearTimeout(p),p=setTimeout(()=>{t.node.dispatchEvent(new CustomEvent("changeEnd"))},500)}return t};function S_(e,r={}){this.Map.getView().fit(e,Object.assign({padding:[50,50,50,50],duration:1e3},r))}function O_(){return this.Map.getView().getZoom()}function Zn(){let e=this;if(!e.tables)return e.table;let r,t=parseInt(e.mapview.Map.getView().getZoom()),o=Object.keys(e.tables),l=parseInt(o[0]),s=parseInt(o[o.length-1]);return r=e.tables[t],r=t<l?e.tables[l]:r,r=t>s?e.tables[s]:r,r}function Wn(){let e=this;if(!e.tables)return e.table;let r=Object.keys(e.tables);return e.tables[r[0]]||e.tables[r[1]]}function Vn(){let e=this;if(!e.tables)return e.table;let r=Object.keys(e.tables);return e.tables[r[r.length-1]]||e.tables[r[r.length-2]]}var Jn=e=>function(r){let t=this,o=new XMLHttpRequest;o.open("GET",e.host+"/api/query/layer_extent?"+mapp.utils.paramString({locale:e.locale.key,layer:t.key,table:t.table||Object.values(t.tables)[0]||Object.values(t.tables)[1],geom:t.geom,proj:t.srid,srid:e.mapview.srid,filter:t.filter&&t.filter.current})),o.setRequestHeader("Content-Type","application/json"),o.responseType="json",o.onload=l=>{if(l.target.status!==200)return;let s=/\((.*?)\)/.exec(l.target.response.box2d)[1].replace(/ /g,",");e.mapview.flyToBounds(s.split(",").map(u=>parseFloat(u)),r)},o.send()};function Kn(){let e=this;e.display=!0,e.view&&e.view.dispatchEvent(new CustomEvent("display-on")),e.L&&e.mapview.Map.removeLayer(e.L),e.mapview.Map.addLayer(e.L),e.mapview.attribution?.check(),e.mapview.hooks&&mapp.hooks.push("layers",e.key)}function Xn(){let e=this;e.display=!1,e.view&&e.view.dispatchEvent(new CustomEvent("display-off")),e.L&&e.mapview.Map.removeLayer(e.L),e.mapview.attribution?.check(),e.mapview.hooks&&mapp.hooks.filter("layers",e.key)}async function Yn(e){let r=this,t=await mapp.query({query:"count_locations",locale:_xyz.locale.key,layer:r,filter:r.filter&&r.filter.current,queryparams:{table:r.tableMin()}});return e?e(parseInt(t.count)):parseInt(t.count)}function Qn(){let e=this;e.L.getZIndex()!==1e3&&(Object.values(_xyz.layers.list).map(r=>{r.format!=="tiles"&&r.L.setZIndex(r.style.zIndex||1)&&r.display&&r.reload()}),e.L.setZIndex(1e3),e.reload())}var eo=e=>{e.L=new ol.layer.Layer({render:r=>{if(!!e.display)return e.mbMap||(e.mbMap=new maplibregl.Map({container:e.mapview.node,style:e.mbStyle,accessToken:e.accessToken,attributionControl:!1,boxZoom:!1,doubleClickZoom:!1,dragPan:!1,dragRotate:!1,interactive:!1,keyboard:!1,pitchWithRotate:!1,scrollZoom:!1,touchZoomRotate:!1})),e.canvas=e.mbMap.getCanvas(),e.zIndex&&(e.canvas.style.zIndex=e.zIndex),e.canvas.style.position="absolute",e.canvas.style.display=e.display&&"block"||"none",e.mbMap.jumpTo({center:ol.proj.toLonLat(r.viewState.center),zoom:r.viewState.zoom-1,bearing:-r.viewState.rotation*180/Math.PI,animate:!1}),e.mbMap._frame&&(e.mbMap._frame.cancel(),e.mbMap._frame=null),e.mbMap._render(),e.resized||(e.resized=!0,window.setTimeout(()=>e.mbMap.resize(),500)),e.canvas}})};var ro=e=>{let r=e.proxy&&`${e.mapview.host}/api/proxy?url=${e.URI}`||e.URI,t=new ol.source.OSM({url:decodeURIComponent(r),opaque:!1,transition:0});e.L=new ol.layer.Tile({source:t,layer:e,zIndex:e.style.zIndex||0})};var to=e=>{e.reload=()=>{l.refresh()};let r=!1,t=performance.now();function o(b){if(!r)return;let y=performance.now();console.log(`${y-t} | ${b}`),t=y}let l=new ol.source.VectorTile({format:new ol.format.MVT({}),transition:0,cacheSize:0,tileUrlFunction:b=>{o(`tileUrlFunction - ${e.key}:${b[0]}/${b[1]}/${b[2]}`);let y=e.tableCurrent();return y?`${e.mapview.host}/api/layer/mvt/${b[0]}/${b[1]}/${b[2]}?`+mapp.utils.paramString({locale:e.mapview.locale.key,layer:e.key,srid:e.mapview.srid,table:y,filter:e.filter&&e.filter.current}):l.clear()}});e.L=new ol.layer.VectorTile({source:l,renderBuffer:200,zIndex:e.style.zIndex||1}),e.L.set("layer",e,!0),e.mapview.Map.on("movestart",b=>{!e.display||(o("movestart"),e.mapview.Map.removeLayer(e.L),l.clear())});let s;e.mapview.Map.on("moveend",b=>{!e.display||!e.tableCurrent()||(o("moveend"),e.L.setStyle(null),e.mapview.Map.addLayer(e.L),s=setTimeout(()=>{e.L.setStyle(w)},400))});let u=new Set;l.on("tileloaderror",b=>{console.log(b)}),l.on("tileloadstart",b=>{s&&clearTimeout(s);let y=b.tile.tileCoord.join("-");o(y),u.add(y)}),l.on("tileloadend",b=>{let y=b.tile.tileCoord.join("-");o(`tileloadend - ${y}`),u.delete(y),u.size===0&&p()});function p(){if(o("tilesloaded"),e.style.theme&&e.style.theme.dynamic){let b=function(K){let W=H.map(G=>G.get(K.field)),M=new geostats(W).getQuantile(K.cat_arr.length);K.cat_arr.forEach((G,O)=>{G.value=M[O]}),K.theme&&b(K.theme)},k=e.mapview.Map.getView().calculateExtent(),H=l.getFeaturesInExtent(k);if(o(`${H.length||0} Features loaded`),!H.length)return;b(e.style.theme)}e.L.setStyle(w)}let _=new Map,m=new Map;function w(b){let y=b.get("id");if(e.highlight!==y&&m.has(y))return m.get(b);let k=Object.assign({},e.style.default);e.style.theme&&e.style.theme.type&&H(e.style.theme);function H(A){if(A&&A.type==="categorized"){let G=b.get(A.field);G&&mapp.utils.lodash.merge(k,A.cat[G]&&A.cat[G].style||A.cat[G])}if(A&&A.type==="graduated"){let G=parseFloat(b.get(A.field));if(G||G===0){for(let O=0;O<A.cat_arr.length&&!(G<A.cat_arr[O].value);O++)var M=A.cat_arr[O].style||A.cat_arr[O];mapp.utils.lodash.merge(k,M)}}A.theme&&H(A.theme)}Object.assign(k,e.highlight===y?e.style.highlight:{},e.highlight===y?{zIndex:30}:{zIndex:10});let K=JSON.stringify(k);if(_.has(K))return _.get(K);let W=new ol.style.Style({zIndex:k.zIndex,stroke:k.strokeColor&&new ol.style.Stroke({color:mapp.utils.chroma(k.strokeColor).alpha(k.strokeOpacity===void 0?1:parseFloat(k.strokeOpacity)||0).rgba(),width:parseFloat(k.strokeWidth)||1}),fill:k.fillColor&&new ol.style.Fill({color:mapp.utils.chroma(k.fillColor).alpha(k.fillOpacity===void 0?1:parseFloat(k.fillOpacity)||0).rgba()}),image:k.marker&&mapp.utils.icon(k.marker)});return _.set(K,W),e.highlight!==y&&m.set(y,W),W}};var ao=e=>{e.highlight=!0,e.reload=()=>{r.clear(),r.refresh({force:!0})};let r=new ol.source.Vector({loader:function(o,l,s){e.xhr&&e.xhr.abort(),this.resolution=l,r.clear();let u=e.tableCurrent();!u||(e.xhr=new XMLHttpRequest,e.xhr.open("GET",e.mapview.host+`/api/layer/cluster/${e.mapview.getZoom()}?`+mapp.utils.paramString({locale:e.mapview.locale.key,layer:e.key,table:u,kmeans:e.cluster_kmeans,dbscan:e.cluster_dbscan,pixelRatio:window.devicePixelRatio,aggregate:e.style.theme&&e.style.theme.aggregate,theme:e.style.theme&&e.style.themes&&encodeURIComponent(Object.keys(e.style.themes).find(p=>e.style.themes[p]===e.style.theme)),label:e.style.label&&e.style.label.field,count:e.style.label&&e.style.label.count,filter:e.filter&&e.filter.current,viewport:[o[0],o[1],o[2],o[3]]})),e.xhr.setRequestHeader("Content-Type","application/json"),e.xhr.responseType="json",e.xhr.onload=p=>{if(p.target.status!==200)return;let _=p.target.response;e.max_size=_.reduce((b,y)=>Math.max(b,y.properties.size),0);let m=1,w=_.map(b=>new ol.Feature({id:m++,geometry:new ol.geom.Point(e.srid==4326&&ol.proj.fromLonLat([b.geometry.x,b.geometry.y])||[b.geometry.x,b.geometry.y]),properties:b.properties}));r.addFeatures(w)},e.xhr.send())},strategy:function(o,l){return this.resolution&&this.resolution!=l&&this.loadedExtentsRtree_.clear(),[ol.proj.transformExtent(o,"EPSG:"+e.mapview.srid,"EPSG:"+e.srid)]}});e.L=new ol.layer.Vector({layer:e,source:r,zIndex:e.style.zIndex||10,style:t});function t(o){let l=o.getProperties().properties,s=l.size>1?Object.assign({},e.style.default,e.style.cluster):Object.assign({},e.style.default);s.scale=s.scale||1;let u=Object.assign({},e.style.theme);if(u&&u.type==="categorized"&&Object.assign(s,u.cat[l.cat]&&u.cat[l.cat].style||u.cat[l.cat]),u&&u.type==="graduated"){let w=parseFloat(l.cat);if(w||w===0){for(let b=0;b<u.cat_arr.length&&!(w<u.cat_arr[b].value);b++)var p=u.cat_arr[b].style||u.cat_arr[b];Object.assign(s,p)}}if(u&&u.type==="competition"){let w=l.size,b={layers:{}};Object.entries(l.cat).sort((y,k)=>y[1]-k[1]).forEach(y=>{u.cat[y[0]]&&(b.layers[w/l.size]=u.cat[y[0]].style.fillColor),w-=y[1]}),Object.assign({},s,b)}let _=e.cluster_logscale?l.count===1?s.size||e.style.size:(s.size||e.style.size)+(s.size||e.style.size)/Math.log(e.max_size)*Math.log(l.size):l.count===1?s.size||e.style.size:(s.size||e.style.size)+(s.size||e.style.size)/e.max_size*l.size;if(s.layers&&Array.isArray(s.layers))return s.layers.map(w=>new ol.style.Style({zIndex:parseInt(e.max_size-l.size),image:mapp.utils.icon(Object.assign({},w,{scale:_/(w.size||e.style.size)*(w.scale||1)*(w.relative?e.mapview.getZoom()/(e.mapview.locale.maxZoom-e.mapview.locale.minZoom):1)}))}));if(e.highlight===o.get("id")){let w=mapp.utils.lodash.cloneDeep(e.style.highlight);delete w.scale,s.scale&&e.style.highlight.scale&&(s.scale*=e.style.highlight.scale),Object.assign(s,w)}let m=mapp.utils.icon(Object.assign({},s,{scale:_/(s.size||e.style.size)*(s.scale||1)*(s.relative?e.mapview.getZoom()/(e.mapview.locale.maxZoom-e.mapview.locale.minZoom):1)}));return new ol.style.Style({zIndex:e.style.zIndex,image:m})}};var no=e=>{e.highlight=!0,e.reload=()=>{r.refresh()};let r=new ol.source.Vector({loader:function(){e.xhr&&e.xhr.abort(),r.clear();let t=e.tableCurrent();!t||(e.xhr=new XMLHttpRequest,e.xhr.open("GET",e.mapview.host+"/api/layer/geojson?"+mapp.utils.paramString({locale:e.mapview.locale.key,layer:e.key,table:t,cat:e.style.theme&&e.style.theme.field,filter:e.filter&&e.filter.current})),e.xhr.setRequestHeader("Content-Type","application/json"),e.xhr.responseType="json",e.xhr.onload=o=>{if(o.target.status!==200)return;let l=new ol.format.GeoJSON,s=o.target.response.map(u=>l.readFeature({type:"Feature",geometry:u.geometry,properties:{id:u.properties.id,cat:u.properties.cat}},{dataProjection:"EPSG:"+e.srid,featureProjection:"EPSG:"+e.mapview.srid}));r.addFeatures(s)},e.xhr.send())},strategy:function(t,o){return this.resolution&&this.resolution!=o&&this.loadedExtentsRtree_.clear(),[ol.proj.transformExtent(t,"EPSG:"+e.mapview.srid,"EPSG:"+e.srid)]}});e.L=new ol.layer.Vector({source:r,zIndex:e.style.zIndex||1,style:t=>{let o=Object.assign({},e.style.default),l=e.style.theme;if(l&&l.type==="categorized"&&Object.assign(o,l.cat[t.get("cat")]||{}),l&&l.type==="graduated"&&l.cat_arr){let u=parseFloat(t.get(l.field));if(u){for(let p=0;p<l.cat_arr.length&&!(u<l.cat_arr[p].value);p++)var s=l.cat_arr[p].style;Object.assign(o,s)}}if(e.highlight===t.get("id")){let u=mapp.utils.lodash.cloneDeep(e.style.highlight);o.marker&&o.marker.scale&&u.marker&&u.marker.scale&&(u.marker.scale*=o.marker.scale),Object.assign(o,u||{})}return new ol.style.Style({zIndex:o.zIndex,stroke:o.strokeColor&&new ol.style.Stroke({color:mapp.utils.chroma(o.strokeColor).alpha(o.strokeOpacity===void 0?1:parseFloat(o.strokeOpacity)||0).rgba(),width:parseInt(o.strokeWidth)||1}),fill:o.fillColor&&new ol.style.Fill({color:mapp.utils.chroma(o.fillColor).alpha(o.fillOpacity===void 0?1:parseFloat(o.fillOpacity)||0).rgba()}),image:o.marker&&mapp.utils.icon(o.marker)})}}),e.L.set("layer",e,!0)};var oo={mbtiles:eo,tiles:ro,mvt:to,cluster:ao,geojson:no},lo={add:$_,get:P_,decorate:io};function io(e){return e.mapview=e.mapview||this,oo[e.format]&&oo[e.format](e),Object.assign(e,{show:Kn,remove:Xn,tableCurrent:Zn,tableMin:Wn,tableMax:Vn,zoomToExtent:Jn,count:Yn,bringToFront:Qn,tabs:new Set}),e.filter={current:{}},e.style&&e.style.themes&&(e.style.theme=e.style.theme||e.style.themes[Object.keys(e.style.themes)[0]]),e}function $_(e,r){let t=r||this;if(!!Array.isArray(e))return e.forEach((o,l)=>{let s=mapp.utils.lodash.cloneDeep(o);s.mapview=t,io(s),t.layers.list[s.key]=s}),e}function P_(e,r){let t=r||this;if(!!Array.isArray(e))return new Promise((o,l)=>{let s=e.map(u=>mapp.utils.xhr(`${t.host}/api/workspace/get/layer?locale=${t.locale.key}&layer=${u}`));Promise.all(s).then(o).catch(u=>{console.error(u),l(u)})})}var uo={get:so,select:co,nnearest:E_};async function so(e){if(e.mapview=e.mapview||this,!e.mapview||!e.layer||!e.id)return;let r=await mapp.utils.xhr(e.mapview.host+"/api/location/get?"+mapp.utils.paramString({locale:e.mapview.locale.key,layer:e.layer.key,table:e.table,id:e.id})),t=e.layer.infoj.map(o=>{let l=mapp.utils.lodash.cloneDeep(o);return l.title=r.properties[l.field+"_label"]||l.title,l.value=r.properties[l.field],l});return Object.assign(e,r,{infoj:t}),e.remove=z_,e}function z_(){let e=this;e.mapview.hooks&&mapp.hooks.filter("locations",e.hook),delete e.mapview.locations.list[e.hook],e.mapview.Map.removeLayer(e.Layer),e.view?.remove()}async function co(e){if(e.mapview=e.mapview||this,!!e.mapview)return e.hook=`${e.layer.key}!${e.table}!${e.id}`,e.mapview.locations.list[e.hook]?e.mapview.locations.list[e.hook].remove():(await so(e),e.mapview.locations.list[e.hook]=e,e.mapview.hooks&&mapp.hooks.push("locations",e.hook),e.Layer=e.mapview.geoJSON({geometry:e.geometry,zIndex:1999,dataProjection:e.layer.srid,featureProjection:e.mapview.srid}),e)}async function E_(e){e.mapview=e.mapview||this;let r=e.feature.get("properties").count,t=e.feature.getGeometry(),o=t.getCoordinates(),l=ol.proj.transform(o,"EPSG:"+e.mapview.srid,"EPSG:"+e.layer.srid),s=await mapp.utils.xhr(e.mapview.host+"/api/query/get_nnearest?"+mapp.utils.paramString({locale:e.mapview.locale.key,layer:e.layer.key,geom:e.layer.geom,qID:e.layer.qID,cluster_label:e.layer.cluster_label||e.layer.qID,table:e.table,n:r>99?99:r,x:l[0],y:l[1],coords:l}));if(s.length>1){let u=mapp.utils.html.node`
      <div style="
        width: 400px;
        max-width: 75vw;
        max-height: 300px;
        overflow-x: hidden;">
      <ul>
      ${s.map(p=>mapp.utils.html.node`
        <li
          style="padding: 5px 0 5px 10px; white-space: nowrap; line-height: 1.5;"
          class="secondary-colour-hover"
          onclick=${_=>{_.preventDefault(),co({mapview:e.mapview,layer:e.layer,table:e.table,id:p.id,marker:p.coords})}}>${p.label||'"'+e.layer.cluster_label+'"'}`)}`;e.mapview.popup({coords:ol.proj.transform(l,"EPSG:"+e.layer.srid,"EPSG:"+e.mapview.srid),content:u,autoPan:!0});return}}Ct.parse();var fo={version:"4.0.0",utils:En,hooks:Ct,mapview:Hn,layer:lo,location:uo,plugins:{},dictionaries:Tt,dictionary:Tt.en};window.mapp=window.mapp||{};Object.assign(window.mapp,fo);var A_=fo;export{A_ as default};
/*! (c) Andrea Giammarchi - ISC */
/**
 * chroma.js - JavaScript library for color conversions
 *
 * Copyright (c) 2011-2019, Gregor Aisch
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice, this
 * list of conditions and the following disclaimer.
 *
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 * this list of conditions and the following disclaimer in the documentation
 * and/or other materials provided with the distribution.
 *
 * 3. The name Gregor Aisch may not be used to endorse or promote products
 * derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL GREGOR AISCH OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * -------------------------------------------------------
 *
 * chroma.js includes colors from colorbrewer2.org, which are released under
 * the following license:
 *
 * Copyright (c) 2002 Cynthia Brewer, Mark Harrower,
 * and The Pennsylvania State University.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
 * either express or implied. See the License for the specific
 * language governing permissions and limitations under the License.
 *
 * ------------------------------------------------------
 *
 * Named colors are taken from X11 Color Names.
 * http://www.w3.org/TR/css3-color/#svg-color
 *
 * @preserve
 */
//# sourceMappingURL=mapp.js.map
